(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&a(d)}).observe(document,{childList:!0,subtree:!0});function i(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerPolicy&&(c.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?c.credentials="include":o.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function a(o){if(o.ep)return;o.ep=!0;const c=i(o);fetch(o.href,c)}})();var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs$1(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l$1=Symbol.for("react.element"),n$1=Symbol.for("react.portal"),p$2=Symbol.for("react.fragment"),q$1=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),t=Symbol.for("react.provider"),u=Symbol.for("react.context"),v$2=Symbol.for("react.forward_ref"),w$1=Symbol.for("react.suspense"),x=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),z$1=Symbol.iterator;function A$1(s){return s===null||typeof s!="object"?null:(s=z$1&&s[z$1]||s["@@iterator"],typeof s=="function"?s:null)}var B$1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C$1=Object.assign,D$1={};function E$1(s,e,i){this.props=s,this.context=e,this.refs=D$1,this.updater=i||B$1}E$1.prototype.isReactComponent={};E$1.prototype.setState=function(s,e){if(typeof s!="object"&&typeof s!="function"&&s!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,s,e,"setState")};E$1.prototype.forceUpdate=function(s){this.updater.enqueueForceUpdate(this,s,"forceUpdate")};function F(){}F.prototype=E$1.prototype;function G$1(s,e,i){this.props=s,this.context=e,this.refs=D$1,this.updater=i||B$1}var H$1=G$1.prototype=new F;H$1.constructor=G$1;C$1(H$1,E$1.prototype);H$1.isPureReactComponent=!0;var I$1=Array.isArray,J=Object.prototype.hasOwnProperty,K$1={current:null},L$1={key:!0,ref:!0,__self:!0,__source:!0};function M$1(s,e,i){var a,o={},c=null,d=null;if(e!=null)for(a in e.ref!==void 0&&(d=e.ref),e.key!==void 0&&(c=""+e.key),e)J.call(e,a)&&!L$1.hasOwnProperty(a)&&(o[a]=e[a]);var g=arguments.length-2;if(g===1)o.children=i;else if(1<g){for(var b=Array(g),_=0;_<g;_++)b[_]=arguments[_+2];o.children=b}if(s&&s.defaultProps)for(a in g=s.defaultProps,g)o[a]===void 0&&(o[a]=g[a]);return{$$typeof:l$1,type:s,key:c,ref:d,props:o,_owner:K$1.current}}function N$1(s,e){return{$$typeof:l$1,type:s.type,key:e,ref:s.ref,props:s.props,_owner:s._owner}}function O$1(s){return typeof s=="object"&&s!==null&&s.$$typeof===l$1}function escape(s){var e={"=":"=0",":":"=2"};return"$"+s.replace(/[=:]/g,function(i){return e[i]})}var P$1=/\/+/g;function Q$1(s,e){return typeof s=="object"&&s!==null&&s.key!=null?escape(""+s.key):e.toString(36)}function R$1(s,e,i,a,o){var c=typeof s;(c==="undefined"||c==="boolean")&&(s=null);var d=!1;if(s===null)d=!0;else switch(c){case"string":case"number":d=!0;break;case"object":switch(s.$$typeof){case l$1:case n$1:d=!0}}if(d)return d=s,o=o(d),s=a===""?"."+Q$1(d,0):a,I$1(o)?(i="",s!=null&&(i=s.replace(P$1,"$&/")+"/"),R$1(o,e,i,"",function(_){return _})):o!=null&&(O$1(o)&&(o=N$1(o,i+(!o.key||d&&d.key===o.key?"":(""+o.key).replace(P$1,"$&/")+"/")+s)),e.push(o)),1;if(d=0,a=a===""?".":a+":",I$1(s))for(var g=0;g<s.length;g++){c=s[g];var b=a+Q$1(c,g);d+=R$1(c,e,i,b,o)}else if(b=A$1(s),typeof b=="function")for(s=b.call(s),g=0;!(c=s.next()).done;)c=c.value,b=a+Q$1(c,g++),d+=R$1(c,e,i,b,o);else if(c==="object")throw e=String(s),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return d}function S$1(s,e,i){if(s==null)return s;var a=[],o=0;return R$1(s,a,"","",function(c){return e.call(i,c,o++)}),a}function T$1(s){if(s._status===-1){var e=s._result;e=e(),e.then(function(i){(s._status===0||s._status===-1)&&(s._status=1,s._result=i)},function(i){(s._status===0||s._status===-1)&&(s._status=2,s._result=i)}),s._status===-1&&(s._status=0,s._result=e)}if(s._status===1)return s._result.default;throw s._result}var U$1={current:null},V$1={transition:null},W$1={ReactCurrentDispatcher:U$1,ReactCurrentBatchConfig:V$1,ReactCurrentOwner:K$1};function X$2(){throw Error("act(...) is not supported in production builds of React.")}react_production_min.Children={map:S$1,forEach:function(s,e,i){S$1(s,function(){e.apply(this,arguments)},i)},count:function(s){var e=0;return S$1(s,function(){e++}),e},toArray:function(s){return S$1(s,function(e){return e})||[]},only:function(s){if(!O$1(s))throw Error("React.Children.only expected to receive a single React element child.");return s}};react_production_min.Component=E$1;react_production_min.Fragment=p$2;react_production_min.Profiler=r;react_production_min.PureComponent=G$1;react_production_min.StrictMode=q$1;react_production_min.Suspense=w$1;react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W$1;react_production_min.act=X$2;react_production_min.cloneElement=function(s,e,i){if(s==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+s+".");var a=C$1({},s.props),o=s.key,c=s.ref,d=s._owner;if(e!=null){if(e.ref!==void 0&&(c=e.ref,d=K$1.current),e.key!==void 0&&(o=""+e.key),s.type&&s.type.defaultProps)var g=s.type.defaultProps;for(b in e)J.call(e,b)&&!L$1.hasOwnProperty(b)&&(a[b]=e[b]===void 0&&g!==void 0?g[b]:e[b])}var b=arguments.length-2;if(b===1)a.children=i;else if(1<b){g=Array(b);for(var _=0;_<b;_++)g[_]=arguments[_+2];a.children=g}return{$$typeof:l$1,type:s.type,key:o,ref:c,props:a,_owner:d}};react_production_min.createContext=function(s){return s={$$typeof:u,_currentValue:s,_currentValue2:s,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},s.Provider={$$typeof:t,_context:s},s.Consumer=s};react_production_min.createElement=M$1;react_production_min.createFactory=function(s){var e=M$1.bind(null,s);return e.type=s,e};react_production_min.createRef=function(){return{current:null}};react_production_min.forwardRef=function(s){return{$$typeof:v$2,render:s}};react_production_min.isValidElement=O$1;react_production_min.lazy=function(s){return{$$typeof:y,_payload:{_status:-1,_result:s},_init:T$1}};react_production_min.memo=function(s,e){return{$$typeof:x,type:s,compare:e===void 0?null:e}};react_production_min.startTransition=function(s){var e=V$1.transition;V$1.transition={};try{s()}finally{V$1.transition=e}};react_production_min.unstable_act=X$2;react_production_min.useCallback=function(s,e){return U$1.current.useCallback(s,e)};react_production_min.useContext=function(s){return U$1.current.useContext(s)};react_production_min.useDebugValue=function(){};react_production_min.useDeferredValue=function(s){return U$1.current.useDeferredValue(s)};react_production_min.useEffect=function(s,e){return U$1.current.useEffect(s,e)};react_production_min.useId=function(){return U$1.current.useId()};react_production_min.useImperativeHandle=function(s,e,i){return U$1.current.useImperativeHandle(s,e,i)};react_production_min.useInsertionEffect=function(s,e){return U$1.current.useInsertionEffect(s,e)};react_production_min.useLayoutEffect=function(s,e){return U$1.current.useLayoutEffect(s,e)};react_production_min.useMemo=function(s,e){return U$1.current.useMemo(s,e)};react_production_min.useReducer=function(s,e,i){return U$1.current.useReducer(s,e,i)};react_production_min.useRef=function(s){return U$1.current.useRef(s)};react_production_min.useState=function(s){return U$1.current.useState(s)};react_production_min.useSyncExternalStore=function(s,e,i){return U$1.current.useSyncExternalStore(s,e,i)};react_production_min.useTransition=function(){return U$1.current.useTransition()};react_production_min.version="18.3.1";react.exports=react_production_min;var reactExports=react.exports;const React=getDefaultExportFromCjs$1(reactExports);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f=reactExports,k=Symbol.for("react.element"),l=Symbol.for("react.fragment"),m$1=Object.prototype.hasOwnProperty,n=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p$1={key:!0,ref:!0,__self:!0,__source:!0};function q(s,e,i){var a,o={},c=null,d=null;i!==void 0&&(c=""+i),e.key!==void 0&&(c=""+e.key),e.ref!==void 0&&(d=e.ref);for(a in e)m$1.call(e,a)&&!p$1.hasOwnProperty(a)&&(o[a]=e[a]);if(s&&s.defaultProps)for(a in e=s.defaultProps,e)o[a]===void 0&&(o[a]=e[a]);return{$$typeof:k,type:s,key:c,ref:d,props:o,_owner:n.current}}reactJsxRuntime_production_min.Fragment=l;reactJsxRuntime_production_min.jsx=q;reactJsxRuntime_production_min.jsxs=q;jsxRuntime.exports=reactJsxRuntime_production_min;var jsxRuntimeExports=jsxRuntime.exports,client={},reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(s){function e(ut,ft){var xt=ut.length;ut.push(ft);e:for(;0<xt;){var mt=xt-1>>>1,Et=ut[mt];if(0<o(Et,ft))ut[mt]=ft,ut[xt]=Et,xt=mt;else break e}}function i(ut){return ut.length===0?null:ut[0]}function a(ut){if(ut.length===0)return null;var ft=ut[0],xt=ut.pop();if(xt!==ft){ut[0]=xt;e:for(var mt=0,Et=ut.length,At=Et>>>1;mt<At;){var Pt=2*(mt+1)-1,wt=ut[Pt],It=Pt+1,Mt=ut[It];if(0>o(wt,xt))It<Et&&0>o(Mt,wt)?(ut[mt]=Mt,ut[It]=xt,mt=It):(ut[mt]=wt,ut[Pt]=xt,mt=Pt);else if(It<Et&&0>o(Mt,xt))ut[mt]=Mt,ut[It]=xt,mt=It;else break e}}return ft}function o(ut,ft){var xt=ut.sortIndex-ft.sortIndex;return xt!==0?xt:ut.id-ft.id}if(typeof performance=="object"&&typeof performance.now=="function"){var c=performance;s.unstable_now=function(){return c.now()}}else{var d=Date,g=d.now();s.unstable_now=function(){return d.now()-g}}var b=[],_=[],j=1,$=null,_e=3,tt=!1,et=!1,st=!1,at=typeof setTimeout=="function"?setTimeout:null,rt=typeof clearTimeout=="function"?clearTimeout:null,nt=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function it(ut){for(var ft=i(_);ft!==null;){if(ft.callback===null)a(_);else if(ft.startTime<=ut)a(_),ft.sortIndex=ft.expirationTime,e(b,ft);else break;ft=i(_)}}function ot(ut){if(st=!1,it(ut),!et)if(i(b)!==null)et=!0,pt(lt);else{var ft=i(_);ft!==null&&yt(ot,ft.startTime-ut)}}function lt(ut,ft){et=!1,st&&(st=!1,rt(dt),dt=-1),tt=!0;var xt=_e;try{for(it(ft),$=i(b);$!==null&&(!($.expirationTime>ft)||ut&&!St());){var mt=$.callback;if(typeof mt=="function"){$.callback=null,_e=$.priorityLevel;var Et=mt($.expirationTime<=ft);ft=s.unstable_now(),typeof Et=="function"?$.callback=Et:$===i(b)&&a(b),it(ft)}else a(b);$=i(b)}if($!==null)var At=!0;else{var Pt=i(_);Pt!==null&&yt(ot,Pt.startTime-ft),At=!1}return At}finally{$=null,_e=xt,tt=!1}}var ct=!1,ht=null,dt=-1,gt=5,vt=-1;function St(){return!(s.unstable_now()-vt<gt)}function Tt(){if(ht!==null){var ut=s.unstable_now();vt=ut;var ft=!0;try{ft=ht(!0,ut)}finally{ft?Ct():(ct=!1,ht=null)}}else ct=!1}var Ct;if(typeof nt=="function")Ct=function(){nt(Tt)};else if(typeof MessageChannel<"u"){var Rt=new MessageChannel,bt=Rt.port2;Rt.port1.onmessage=Tt,Ct=function(){bt.postMessage(null)}}else Ct=function(){at(Tt,0)};function pt(ut){ht=ut,ct||(ct=!0,Ct())}function yt(ut,ft){dt=at(function(){ut(s.unstable_now())},ft)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(ut){ut.callback=null},s.unstable_continueExecution=function(){et||tt||(et=!0,pt(lt))},s.unstable_forceFrameRate=function(ut){0>ut||125<ut?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):gt=0<ut?Math.floor(1e3/ut):5},s.unstable_getCurrentPriorityLevel=function(){return _e},s.unstable_getFirstCallbackNode=function(){return i(b)},s.unstable_next=function(ut){switch(_e){case 1:case 2:case 3:var ft=3;break;default:ft=_e}var xt=_e;_e=ft;try{return ut()}finally{_e=xt}},s.unstable_pauseExecution=function(){},s.unstable_requestPaint=function(){},s.unstable_runWithPriority=function(ut,ft){switch(ut){case 1:case 2:case 3:case 4:case 5:break;default:ut=3}var xt=_e;_e=ut;try{return ft()}finally{_e=xt}},s.unstable_scheduleCallback=function(ut,ft,xt){var mt=s.unstable_now();switch(typeof xt=="object"&&xt!==null?(xt=xt.delay,xt=typeof xt=="number"&&0<xt?mt+xt:mt):xt=mt,ut){case 1:var Et=-1;break;case 2:Et=250;break;case 5:Et=1073741823;break;case 4:Et=1e4;break;default:Et=5e3}return Et=xt+Et,ut={id:j++,callback:ft,priorityLevel:ut,startTime:xt,expirationTime:Et,sortIndex:-1},xt>mt?(ut.sortIndex=xt,e(_,ut),i(b)===null&&ut===i(_)&&(st?(rt(dt),dt=-1):st=!0,yt(ot,xt-mt))):(ut.sortIndex=Et,e(b,ut),et||tt||(et=!0,pt(lt))),ut},s.unstable_shouldYield=St,s.unstable_wrapCallback=function(ut){var ft=_e;return function(){var xt=_e;_e=ft;try{return ut.apply(this,arguments)}finally{_e=xt}}}})(scheduler_production_min);scheduler.exports=scheduler_production_min;var schedulerExports=scheduler.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aa=reactExports,ca=schedulerExports;function p(s){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+s,i=1;i<arguments.length;i++)e+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+s+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var da=new Set,ea={};function fa(s,e){ha(s,e),ha(s+"Capture",e)}function ha(s,e){for(ea[s]=e,s=0;s<e.length;s++)da.add(e[s])}var ia=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ja=Object.prototype.hasOwnProperty,ka=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,la={},ma={};function oa(s){return ja.call(ma,s)?!0:ja.call(la,s)?!1:ka.test(s)?ma[s]=!0:(la[s]=!0,!1)}function pa(s,e,i,a){if(i!==null&&i.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return a?!1:i!==null?!i.acceptsBooleans:(s=s.toLowerCase().slice(0,5),s!=="data-"&&s!=="aria-");default:return!1}}function qa(s,e,i,a){if(e===null||typeof e>"u"||pa(s,e,i,a))return!0;if(a)return!1;if(i!==null)switch(i.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function v$1(s,e,i,a,o,c,d){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=a,this.attributeNamespace=o,this.mustUseProperty=i,this.propertyName=s,this.type=e,this.sanitizeURL=c,this.removeEmptyString=d}var z={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(s){z[s]=new v$1(s,0,!1,s,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(s){var e=s[0];z[e]=new v$1(e,1,!1,s[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(s){z[s]=new v$1(s,2,!1,s.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(s){z[s]=new v$1(s,2,!1,s,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(s){z[s]=new v$1(s,3,!1,s.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(s){z[s]=new v$1(s,3,!0,s,null,!1,!1)});["capture","download"].forEach(function(s){z[s]=new v$1(s,4,!1,s,null,!1,!1)});["cols","rows","size","span"].forEach(function(s){z[s]=new v$1(s,6,!1,s,null,!1,!1)});["rowSpan","start"].forEach(function(s){z[s]=new v$1(s,5,!1,s.toLowerCase(),null,!1,!1)});var ra=/[\-:]([a-z])/g;function sa(s){return s[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(s){var e=s.replace(ra,sa);z[e]=new v$1(e,1,!1,s,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(s){var e=s.replace(ra,sa);z[e]=new v$1(e,1,!1,s,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(s){var e=s.replace(ra,sa);z[e]=new v$1(e,1,!1,s,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(s){z[s]=new v$1(s,1,!1,s.toLowerCase(),null,!1,!1)});z.xlinkHref=new v$1("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(s){z[s]=new v$1(s,1,!1,s.toLowerCase(),null,!0,!0)});function ta(s,e,i,a){var o=z.hasOwnProperty(e)?z[e]:null;(o!==null?o.type!==0:a||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(qa(e,i,o,a)&&(i=null),a||o===null?oa(e)&&(i===null?s.removeAttribute(e):s.setAttribute(e,""+i)):o.mustUseProperty?s[o.propertyName]=i===null?o.type===3?!1:"":i:(e=o.attributeName,a=o.attributeNamespace,i===null?s.removeAttribute(e):(o=o.type,i=o===3||o===4&&i===!0?"":""+i,a?s.setAttributeNS(a,e,i):s.setAttribute(e,i))))}var ua=aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,va=Symbol.for("react.element"),wa=Symbol.for("react.portal"),ya=Symbol.for("react.fragment"),za=Symbol.for("react.strict_mode"),Aa=Symbol.for("react.profiler"),Ba=Symbol.for("react.provider"),Ca=Symbol.for("react.context"),Da=Symbol.for("react.forward_ref"),Ea=Symbol.for("react.suspense"),Fa=Symbol.for("react.suspense_list"),Ga=Symbol.for("react.memo"),Ha=Symbol.for("react.lazy"),Ia=Symbol.for("react.offscreen"),Ja=Symbol.iterator;function Ka(s){return s===null||typeof s!="object"?null:(s=Ja&&s[Ja]||s["@@iterator"],typeof s=="function"?s:null)}var A=Object.assign,La;function Ma(s){if(La===void 0)try{throw Error()}catch(i){var e=i.stack.trim().match(/\n( *(at )?)/);La=e&&e[1]||""}return`
`+La+s}var Na=!1;function Oa(s,e){if(!s||Na)return"";Na=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(_){var a=_}Reflect.construct(s,[],e)}else{try{e.call()}catch(_){a=_}s.call(e.prototype)}else{try{throw Error()}catch(_){a=_}s()}}catch(_){if(_&&a&&typeof _.stack=="string"){for(var o=_.stack.split(`
`),c=a.stack.split(`
`),d=o.length-1,g=c.length-1;1<=d&&0<=g&&o[d]!==c[g];)g--;for(;1<=d&&0<=g;d--,g--)if(o[d]!==c[g]){if(d!==1||g!==1)do if(d--,g--,0>g||o[d]!==c[g]){var b=`
`+o[d].replace(" at new "," at ");return s.displayName&&b.includes("<anonymous>")&&(b=b.replace("<anonymous>",s.displayName)),b}while(1<=d&&0<=g);break}}}finally{Na=!1,Error.prepareStackTrace=i}return(s=s?s.displayName||s.name:"")?Ma(s):""}function Pa(s){switch(s.tag){case 5:return Ma(s.type);case 16:return Ma("Lazy");case 13:return Ma("Suspense");case 19:return Ma("SuspenseList");case 0:case 2:case 15:return s=Oa(s.type,!1),s;case 11:return s=Oa(s.type.render,!1),s;case 1:return s=Oa(s.type,!0),s;default:return""}}function Qa(s){if(s==null)return null;if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case ya:return"Fragment";case wa:return"Portal";case Aa:return"Profiler";case za:return"StrictMode";case Ea:return"Suspense";case Fa:return"SuspenseList"}if(typeof s=="object")switch(s.$$typeof){case Ca:return(s.displayName||"Context")+".Consumer";case Ba:return(s._context.displayName||"Context")+".Provider";case Da:var e=s.render;return s=s.displayName,s||(s=e.displayName||e.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case Ga:return e=s.displayName||null,e!==null?e:Qa(s.type)||"Memo";case Ha:e=s._payload,s=s._init;try{return Qa(s(e))}catch{}}return null}function Ra(s){var e=s.type;switch(s.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return s=e.render,s=s.displayName||s.name||"",e.displayName||(s!==""?"ForwardRef("+s+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qa(e);case 8:return e===za?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Sa(s){switch(typeof s){case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Ta(s){var e=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Ua(s){var e=Ta(s)?"checked":"value",i=Object.getOwnPropertyDescriptor(s.constructor.prototype,e),a=""+s[e];if(!s.hasOwnProperty(e)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var o=i.get,c=i.set;return Object.defineProperty(s,e,{configurable:!0,get:function(){return o.call(this)},set:function(d){a=""+d,c.call(this,d)}}),Object.defineProperty(s,e,{enumerable:i.enumerable}),{getValue:function(){return a},setValue:function(d){a=""+d},stopTracking:function(){s._valueTracker=null,delete s[e]}}}}function Va(s){s._valueTracker||(s._valueTracker=Ua(s))}function Wa(s){if(!s)return!1;var e=s._valueTracker;if(!e)return!0;var i=e.getValue(),a="";return s&&(a=Ta(s)?s.checked?"true":"false":s.value),s=a,s!==i?(e.setValue(s),!0):!1}function Xa(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}function Ya(s,e){var i=e.checked;return A({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:i??s._wrapperState.initialChecked})}function Za(s,e){var i=e.defaultValue==null?"":e.defaultValue,a=e.checked!=null?e.checked:e.defaultChecked;i=Sa(e.value!=null?e.value:i),s._wrapperState={initialChecked:a,initialValue:i,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function ab(s,e){e=e.checked,e!=null&&ta(s,"checked",e,!1)}function bb(s,e){ab(s,e);var i=Sa(e.value),a=e.type;if(i!=null)a==="number"?(i===0&&s.value===""||s.value!=i)&&(s.value=""+i):s.value!==""+i&&(s.value=""+i);else if(a==="submit"||a==="reset"){s.removeAttribute("value");return}e.hasOwnProperty("value")?cb(s,e.type,i):e.hasOwnProperty("defaultValue")&&cb(s,e.type,Sa(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(s.defaultChecked=!!e.defaultChecked)}function db(s,e,i){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var a=e.type;if(!(a!=="submit"&&a!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+s._wrapperState.initialValue,i||e===s.value||(s.value=e),s.defaultValue=e}i=s.name,i!==""&&(s.name=""),s.defaultChecked=!!s._wrapperState.initialChecked,i!==""&&(s.name=i)}function cb(s,e,i){(e!=="number"||Xa(s.ownerDocument)!==s)&&(i==null?s.defaultValue=""+s._wrapperState.initialValue:s.defaultValue!==""+i&&(s.defaultValue=""+i))}var eb=Array.isArray;function fb(s,e,i,a){if(s=s.options,e){e={};for(var o=0;o<i.length;o++)e["$"+i[o]]=!0;for(i=0;i<s.length;i++)o=e.hasOwnProperty("$"+s[i].value),s[i].selected!==o&&(s[i].selected=o),o&&a&&(s[i].defaultSelected=!0)}else{for(i=""+Sa(i),e=null,o=0;o<s.length;o++){if(s[o].value===i){s[o].selected=!0,a&&(s[o].defaultSelected=!0);return}e!==null||s[o].disabled||(e=s[o])}e!==null&&(e.selected=!0)}}function gb(s,e){if(e.dangerouslySetInnerHTML!=null)throw Error(p(91));return A({},e,{value:void 0,defaultValue:void 0,children:""+s._wrapperState.initialValue})}function hb(s,e){var i=e.value;if(i==null){if(i=e.children,e=e.defaultValue,i!=null){if(e!=null)throw Error(p(92));if(eb(i)){if(1<i.length)throw Error(p(93));i=i[0]}e=i}e==null&&(e=""),i=e}s._wrapperState={initialValue:Sa(i)}}function ib(s,e){var i=Sa(e.value),a=Sa(e.defaultValue);i!=null&&(i=""+i,i!==s.value&&(s.value=i),e.defaultValue==null&&s.defaultValue!==i&&(s.defaultValue=i)),a!=null&&(s.defaultValue=""+a)}function jb(s){var e=s.textContent;e===s._wrapperState.initialValue&&e!==""&&e!==null&&(s.value=e)}function kb(s){switch(s){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lb(s,e){return s==null||s==="http://www.w3.org/1999/xhtml"?kb(e):s==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":s}var mb,nb=function(s){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,i,a,o){MSApp.execUnsafeLocalFunction(function(){return s(e,i,a,o)})}:s}(function(s,e){if(s.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in s)s.innerHTML=e;else{for(mb=mb||document.createElement("div"),mb.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=mb.firstChild;s.firstChild;)s.removeChild(s.firstChild);for(;e.firstChild;)s.appendChild(e.firstChild)}});function ob(s,e){if(e){var i=s.firstChild;if(i&&i===s.lastChild&&i.nodeType===3){i.nodeValue=e;return}}s.textContent=e}var pb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qb=["Webkit","ms","Moz","O"];Object.keys(pb).forEach(function(s){qb.forEach(function(e){e=e+s.charAt(0).toUpperCase()+s.substring(1),pb[e]=pb[s]})});function rb(s,e,i){return e==null||typeof e=="boolean"||e===""?"":i||typeof e!="number"||e===0||pb.hasOwnProperty(s)&&pb[s]?(""+e).trim():e+"px"}function sb(s,e){s=s.style;for(var i in e)if(e.hasOwnProperty(i)){var a=i.indexOf("--")===0,o=rb(i,e[i],a);i==="float"&&(i="cssFloat"),a?s.setProperty(i,o):s[i]=o}}var tb=A({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ub(s,e){if(e){if(tb[s]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(p(137,s));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(p(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(p(61))}if(e.style!=null&&typeof e.style!="object")throw Error(p(62))}}function vb(s,e){if(s.indexOf("-")===-1)return typeof e.is=="string";switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wb=null;function xb(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var yb=null,zb=null,Ab=null;function Bb(s){if(s=Cb(s)){if(typeof yb!="function")throw Error(p(280));var e=s.stateNode;e&&(e=Db(e),yb(s.stateNode,s.type,e))}}function Eb(s){zb?Ab?Ab.push(s):Ab=[s]:zb=s}function Fb(){if(zb){var s=zb,e=Ab;if(Ab=zb=null,Bb(s),e)for(s=0;s<e.length;s++)Bb(e[s])}}function Gb(s,e){return s(e)}function Hb(){}var Ib=!1;function Jb(s,e,i){if(Ib)return s(e,i);Ib=!0;try{return Gb(s,e,i)}finally{Ib=!1,(zb!==null||Ab!==null)&&(Hb(),Fb())}}function Kb(s,e){var i=s.stateNode;if(i===null)return null;var a=Db(i);if(a===null)return null;i=a[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(a=!a.disabled)||(s=s.type,a=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!a;break e;default:s=!1}if(s)return null;if(i&&typeof i!="function")throw Error(p(231,e,typeof i));return i}var Lb=!1;if(ia)try{var Mb={};Object.defineProperty(Mb,"passive",{get:function(){Lb=!0}}),window.addEventListener("test",Mb,Mb),window.removeEventListener("test",Mb,Mb)}catch{Lb=!1}function Nb(s,e,i,a,o,c,d,g,b){var _=Array.prototype.slice.call(arguments,3);try{e.apply(i,_)}catch(j){this.onError(j)}}var Ob=!1,Pb=null,Qb=!1,Rb=null,Sb={onError:function(s){Ob=!0,Pb=s}};function Tb(s,e,i,a,o,c,d,g,b){Ob=!1,Pb=null,Nb.apply(Sb,arguments)}function Ub(s,e,i,a,o,c,d,g,b){if(Tb.apply(this,arguments),Ob){if(Ob){var _=Pb;Ob=!1,Pb=null}else throw Error(p(198));Qb||(Qb=!0,Rb=_)}}function Vb(s){var e=s,i=s;if(s.alternate)for(;e.return;)e=e.return;else{s=e;do e=s,e.flags&4098&&(i=e.return),s=e.return;while(s)}return e.tag===3?i:null}function Wb(s){if(s.tag===13){var e=s.memoizedState;if(e===null&&(s=s.alternate,s!==null&&(e=s.memoizedState)),e!==null)return e.dehydrated}return null}function Xb(s){if(Vb(s)!==s)throw Error(p(188))}function Yb(s){var e=s.alternate;if(!e){if(e=Vb(s),e===null)throw Error(p(188));return e!==s?null:s}for(var i=s,a=e;;){var o=i.return;if(o===null)break;var c=o.alternate;if(c===null){if(a=o.return,a!==null){i=a;continue}break}if(o.child===c.child){for(c=o.child;c;){if(c===i)return Xb(o),s;if(c===a)return Xb(o),e;c=c.sibling}throw Error(p(188))}if(i.return!==a.return)i=o,a=c;else{for(var d=!1,g=o.child;g;){if(g===i){d=!0,i=o,a=c;break}if(g===a){d=!0,a=o,i=c;break}g=g.sibling}if(!d){for(g=c.child;g;){if(g===i){d=!0,i=c,a=o;break}if(g===a){d=!0,a=c,i=o;break}g=g.sibling}if(!d)throw Error(p(189))}}if(i.alternate!==a)throw Error(p(190))}if(i.tag!==3)throw Error(p(188));return i.stateNode.current===i?s:e}function Zb(s){return s=Yb(s),s!==null?$b(s):null}function $b(s){if(s.tag===5||s.tag===6)return s;for(s=s.child;s!==null;){var e=$b(s);if(e!==null)return e;s=s.sibling}return null}var ac=ca.unstable_scheduleCallback,bc=ca.unstable_cancelCallback,cc=ca.unstable_shouldYield,dc=ca.unstable_requestPaint,B=ca.unstable_now,ec=ca.unstable_getCurrentPriorityLevel,fc=ca.unstable_ImmediatePriority,gc=ca.unstable_UserBlockingPriority,hc=ca.unstable_NormalPriority,ic=ca.unstable_LowPriority,jc=ca.unstable_IdlePriority,kc=null,lc=null;function mc(s){if(lc&&typeof lc.onCommitFiberRoot=="function")try{lc.onCommitFiberRoot(kc,s,void 0,(s.current.flags&128)===128)}catch{}}var oc=Math.clz32?Math.clz32:nc,pc=Math.log,qc=Math.LN2;function nc(s){return s>>>=0,s===0?32:31-(pc(s)/qc|0)|0}var rc=64,sc=4194304;function tc(s){switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return s&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return s}}function uc(s,e){var i=s.pendingLanes;if(i===0)return 0;var a=0,o=s.suspendedLanes,c=s.pingedLanes,d=i&268435455;if(d!==0){var g=d&~o;g!==0?a=tc(g):(c&=d,c!==0&&(a=tc(c)))}else d=i&~o,d!==0?a=tc(d):c!==0&&(a=tc(c));if(a===0)return 0;if(e!==0&&e!==a&&!(e&o)&&(o=a&-a,c=e&-e,o>=c||o===16&&(c&4194240)!==0))return e;if(a&4&&(a|=i&16),e=s.entangledLanes,e!==0)for(s=s.entanglements,e&=a;0<e;)i=31-oc(e),o=1<<i,a|=s[i],e&=~o;return a}function vc(s,e){switch(s){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wc(s,e){for(var i=s.suspendedLanes,a=s.pingedLanes,o=s.expirationTimes,c=s.pendingLanes;0<c;){var d=31-oc(c),g=1<<d,b=o[d];b===-1?(!(g&i)||g&a)&&(o[d]=vc(g,e)):b<=e&&(s.expiredLanes|=g),c&=~g}}function xc(s){return s=s.pendingLanes&-1073741825,s!==0?s:s&1073741824?1073741824:0}function yc(){var s=rc;return rc<<=1,!(rc&4194240)&&(rc=64),s}function zc(s){for(var e=[],i=0;31>i;i++)e.push(s);return e}function Ac(s,e,i){s.pendingLanes|=e,e!==536870912&&(s.suspendedLanes=0,s.pingedLanes=0),s=s.eventTimes,e=31-oc(e),s[e]=i}function Bc(s,e){var i=s.pendingLanes&~e;s.pendingLanes=e,s.suspendedLanes=0,s.pingedLanes=0,s.expiredLanes&=e,s.mutableReadLanes&=e,s.entangledLanes&=e,e=s.entanglements;var a=s.eventTimes;for(s=s.expirationTimes;0<i;){var o=31-oc(i),c=1<<o;e[o]=0,a[o]=-1,s[o]=-1,i&=~c}}function Cc(s,e){var i=s.entangledLanes|=e;for(s=s.entanglements;i;){var a=31-oc(i),o=1<<a;o&e|s[a]&e&&(s[a]|=e),i&=~o}}var C=0;function Dc(s){return s&=-s,1<s?4<s?s&268435455?16:536870912:4:1}var Ec,Fc,Gc,Hc,Ic,Jc=!1,Kc=[],Lc=null,Mc=null,Nc=null,Oc=new Map,Pc=new Map,Qc=[],Rc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sc(s,e){switch(s){case"focusin":case"focusout":Lc=null;break;case"dragenter":case"dragleave":Mc=null;break;case"mouseover":case"mouseout":Nc=null;break;case"pointerover":case"pointerout":Oc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pc.delete(e.pointerId)}}function Tc(s,e,i,a,o,c){return s===null||s.nativeEvent!==c?(s={blockedOn:e,domEventName:i,eventSystemFlags:a,nativeEvent:c,targetContainers:[o]},e!==null&&(e=Cb(e),e!==null&&Fc(e)),s):(s.eventSystemFlags|=a,e=s.targetContainers,o!==null&&e.indexOf(o)===-1&&e.push(o),s)}function Uc(s,e,i,a,o){switch(e){case"focusin":return Lc=Tc(Lc,s,e,i,a,o),!0;case"dragenter":return Mc=Tc(Mc,s,e,i,a,o),!0;case"mouseover":return Nc=Tc(Nc,s,e,i,a,o),!0;case"pointerover":var c=o.pointerId;return Oc.set(c,Tc(Oc.get(c)||null,s,e,i,a,o)),!0;case"gotpointercapture":return c=o.pointerId,Pc.set(c,Tc(Pc.get(c)||null,s,e,i,a,o)),!0}return!1}function Vc(s){var e=Wc(s.target);if(e!==null){var i=Vb(e);if(i!==null){if(e=i.tag,e===13){if(e=Wb(i),e!==null){s.blockedOn=e,Ic(s.priority,function(){Gc(i)});return}}else if(e===3&&i.stateNode.current.memoizedState.isDehydrated){s.blockedOn=i.tag===3?i.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Xc(s){if(s.blockedOn!==null)return!1;for(var e=s.targetContainers;0<e.length;){var i=Yc(s.domEventName,s.eventSystemFlags,e[0],s.nativeEvent);if(i===null){i=s.nativeEvent;var a=new i.constructor(i.type,i);wb=a,i.target.dispatchEvent(a),wb=null}else return e=Cb(i),e!==null&&Fc(e),s.blockedOn=i,!1;e.shift()}return!0}function Zc(s,e,i){Xc(s)&&i.delete(e)}function $c(){Jc=!1,Lc!==null&&Xc(Lc)&&(Lc=null),Mc!==null&&Xc(Mc)&&(Mc=null),Nc!==null&&Xc(Nc)&&(Nc=null),Oc.forEach(Zc),Pc.forEach(Zc)}function ad(s,e){s.blockedOn===e&&(s.blockedOn=null,Jc||(Jc=!0,ca.unstable_scheduleCallback(ca.unstable_NormalPriority,$c)))}function bd(s){function e(o){return ad(o,s)}if(0<Kc.length){ad(Kc[0],s);for(var i=1;i<Kc.length;i++){var a=Kc[i];a.blockedOn===s&&(a.blockedOn=null)}}for(Lc!==null&&ad(Lc,s),Mc!==null&&ad(Mc,s),Nc!==null&&ad(Nc,s),Oc.forEach(e),Pc.forEach(e),i=0;i<Qc.length;i++)a=Qc[i],a.blockedOn===s&&(a.blockedOn=null);for(;0<Qc.length&&(i=Qc[0],i.blockedOn===null);)Vc(i),i.blockedOn===null&&Qc.shift()}var cd=ua.ReactCurrentBatchConfig,dd=!0;function ed(s,e,i,a){var o=C,c=cd.transition;cd.transition=null;try{C=1,fd(s,e,i,a)}finally{C=o,cd.transition=c}}function gd(s,e,i,a){var o=C,c=cd.transition;cd.transition=null;try{C=4,fd(s,e,i,a)}finally{C=o,cd.transition=c}}function fd(s,e,i,a){if(dd){var o=Yc(s,e,i,a);if(o===null)hd(s,e,a,id$2,i),Sc(s,a);else if(Uc(o,s,e,i,a))a.stopPropagation();else if(Sc(s,a),e&4&&-1<Rc.indexOf(s)){for(;o!==null;){var c=Cb(o);if(c!==null&&Ec(c),c=Yc(s,e,i,a),c===null&&hd(s,e,a,id$2,i),c===o)break;o=c}o!==null&&a.stopPropagation()}else hd(s,e,a,null,i)}}var id$2=null;function Yc(s,e,i,a){if(id$2=null,s=xb(a),s=Wc(s),s!==null)if(e=Vb(s),e===null)s=null;else if(i=e.tag,i===13){if(s=Wb(e),s!==null)return s;s=null}else if(i===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;s=null}else e!==s&&(s=null);return id$2=s,null}function jd(s){switch(s){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ec()){case fc:return 1;case gc:return 4;case hc:case ic:return 16;case jc:return 536870912;default:return 16}default:return 16}}var kd=null,ld=null,md=null;function nd(){if(md)return md;var s,e=ld,i=e.length,a,o="value"in kd?kd.value:kd.textContent,c=o.length;for(s=0;s<i&&e[s]===o[s];s++);var d=i-s;for(a=1;a<=d&&e[i-a]===o[c-a];a++);return md=o.slice(s,1<a?1-a:void 0)}function od(s){var e=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&e===13&&(s=13)):s=e,s===10&&(s=13),32<=s||s===13?s:0}function pd(){return!0}function qd(){return!1}function rd(s){function e(i,a,o,c,d){this._reactName=i,this._targetInst=o,this.type=a,this.nativeEvent=c,this.target=d,this.currentTarget=null;for(var g in s)s.hasOwnProperty(g)&&(i=s[g],this[g]=i?i(c):c[g]);return this.isDefaultPrevented=(c.defaultPrevented!=null?c.defaultPrevented:c.returnValue===!1)?pd:qd,this.isPropagationStopped=qd,this}return A(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var i=this.nativeEvent;i&&(i.preventDefault?i.preventDefault():typeof i.returnValue!="unknown"&&(i.returnValue=!1),this.isDefaultPrevented=pd)},stopPropagation:function(){var i=this.nativeEvent;i&&(i.stopPropagation?i.stopPropagation():typeof i.cancelBubble!="unknown"&&(i.cancelBubble=!0),this.isPropagationStopped=pd)},persist:function(){},isPersistent:pd}),e}var sd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td=rd(sd),ud=A({},sd,{view:0,detail:0}),vd=rd(ud),wd,xd,yd,Ad=A({},ud,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==yd&&(yd&&s.type==="mousemove"?(wd=s.screenX-yd.screenX,xd=s.screenY-yd.screenY):xd=wd=0,yd=s),wd)},movementY:function(s){return"movementY"in s?s.movementY:xd}}),Bd=rd(Ad),Cd=A({},Ad,{dataTransfer:0}),Dd=rd(Cd),Ed=A({},ud,{relatedTarget:0}),Fd=rd(Ed),Gd=A({},sd,{animationName:0,elapsedTime:0,pseudoElement:0}),Hd=rd(Gd),Id=A({},sd,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Jd=rd(Id),Kd=A({},sd,{data:0}),Ld=rd(Kd),Md={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Od={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pd(s){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(s):(s=Od[s])?!!e[s]:!1}function zd(){return Pd}var Qd=A({},ud,{key:function(s){if(s.key){var e=Md[s.key]||s.key;if(e!=="Unidentified")return e}return s.type==="keypress"?(s=od(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Nd[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd,charCode:function(s){return s.type==="keypress"?od(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?od(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Rd=rd(Qd),Sd=A({},Ad,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td=rd(Sd),Ud=A({},ud,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd}),Vd=rd(Ud),Wd=A({},sd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd=rd(Wd),Yd=A({},Ad,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),Zd=rd(Yd),$d=[9,13,27,32],ae=ia&&"CompositionEvent"in window,be=null;ia&&"documentMode"in document&&(be=document.documentMode);var ce=ia&&"TextEvent"in window&&!be,de=ia&&(!ae||be&&8<be&&11>=be),ee=" ",fe=!1;function ge(s,e){switch(s){case"keyup":return $d.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function he(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var ie=!1;function je(s,e){switch(s){case"compositionend":return he(e);case"keypress":return e.which!==32?null:(fe=!0,ee);case"textInput":return s=e.data,s===ee&&fe?null:s;default:return null}}function ke(s,e){if(ie)return s==="compositionend"||!ae&&ge(s,e)?(s=nd(),md=ld=kd=null,ie=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return de&&e.locale!=="ko"?null:e.data;default:return null}}var le={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function me(s){var e=s&&s.nodeName&&s.nodeName.toLowerCase();return e==="input"?!!le[s.type]:e==="textarea"}function ne(s,e,i,a){Eb(a),e=oe(e,"onChange"),0<e.length&&(i=new td("onChange","change",null,i,a),s.push({event:i,listeners:e}))}var pe=null,qe=null;function re(s){se(s,0)}function te(s){var e=ue(s);if(Wa(e))return s}function ve(s,e){if(s==="change")return e}var we=!1;if(ia){var xe;if(ia){var ye="oninput"in document;if(!ye){var ze=document.createElement("div");ze.setAttribute("oninput","return;"),ye=typeof ze.oninput=="function"}xe=ye}else xe=!1;we=xe&&(!document.documentMode||9<document.documentMode)}function Ae(){pe&&(pe.detachEvent("onpropertychange",Be),qe=pe=null)}function Be(s){if(s.propertyName==="value"&&te(qe)){var e=[];ne(e,qe,s,xb(s)),Jb(re,e)}}function Ce(s,e,i){s==="focusin"?(Ae(),pe=e,qe=i,pe.attachEvent("onpropertychange",Be)):s==="focusout"&&Ae()}function De(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return te(qe)}function Ee(s,e){if(s==="click")return te(e)}function Fe(s,e){if(s==="input"||s==="change")return te(e)}function Ge(s,e){return s===e&&(s!==0||1/s===1/e)||s!==s&&e!==e}var He=typeof Object.is=="function"?Object.is:Ge;function Ie(s,e){if(He(s,e))return!0;if(typeof s!="object"||s===null||typeof e!="object"||e===null)return!1;var i=Object.keys(s),a=Object.keys(e);if(i.length!==a.length)return!1;for(a=0;a<i.length;a++){var o=i[a];if(!ja.call(e,o)||!He(s[o],e[o]))return!1}return!0}function Je(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Ke(s,e){var i=Je(s);s=0;for(var a;i;){if(i.nodeType===3){if(a=s+i.textContent.length,s<=e&&a>=e)return{node:i,offset:e-s};s=a}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=Je(i)}}function Le(s,e){return s&&e?s===e?!0:s&&s.nodeType===3?!1:e&&e.nodeType===3?Le(s,e.parentNode):"contains"in s?s.contains(e):s.compareDocumentPosition?!!(s.compareDocumentPosition(e)&16):!1:!1}function Me(){for(var s=window,e=Xa();e instanceof s.HTMLIFrameElement;){try{var i=typeof e.contentWindow.location.href=="string"}catch{i=!1}if(i)s=e.contentWindow;else break;e=Xa(s.document)}return e}function Ne(s){var e=s&&s.nodeName&&s.nodeName.toLowerCase();return e&&(e==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||e==="textarea"||s.contentEditable==="true")}function Oe(s){var e=Me(),i=s.focusedElem,a=s.selectionRange;if(e!==i&&i&&i.ownerDocument&&Le(i.ownerDocument.documentElement,i)){if(a!==null&&Ne(i)){if(e=a.start,s=a.end,s===void 0&&(s=e),"selectionStart"in i)i.selectionStart=e,i.selectionEnd=Math.min(s,i.value.length);else if(s=(e=i.ownerDocument||document)&&e.defaultView||window,s.getSelection){s=s.getSelection();var o=i.textContent.length,c=Math.min(a.start,o);a=a.end===void 0?c:Math.min(a.end,o),!s.extend&&c>a&&(o=a,a=c,c=o),o=Ke(i,c);var d=Ke(i,a);o&&d&&(s.rangeCount!==1||s.anchorNode!==o.node||s.anchorOffset!==o.offset||s.focusNode!==d.node||s.focusOffset!==d.offset)&&(e=e.createRange(),e.setStart(o.node,o.offset),s.removeAllRanges(),c>a?(s.addRange(e),s.extend(d.node,d.offset)):(e.setEnd(d.node,d.offset),s.addRange(e)))}}for(e=[],s=i;s=s.parentNode;)s.nodeType===1&&e.push({element:s,left:s.scrollLeft,top:s.scrollTop});for(typeof i.focus=="function"&&i.focus(),i=0;i<e.length;i++)s=e[i],s.element.scrollLeft=s.left,s.element.scrollTop=s.top}}var Pe=ia&&"documentMode"in document&&11>=document.documentMode,Qe=null,Re=null,Se=null,Te=!1;function Ue(s,e,i){var a=i.window===i?i.document:i.nodeType===9?i:i.ownerDocument;Te||Qe==null||Qe!==Xa(a)||(a=Qe,"selectionStart"in a&&Ne(a)?a={start:a.selectionStart,end:a.selectionEnd}:(a=(a.ownerDocument&&a.ownerDocument.defaultView||window).getSelection(),a={anchorNode:a.anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset}),Se&&Ie(Se,a)||(Se=a,a=oe(Re,"onSelect"),0<a.length&&(e=new td("onSelect","select",null,e,i),s.push({event:e,listeners:a}),e.target=Qe)))}function Ve(s,e){var i={};return i[s.toLowerCase()]=e.toLowerCase(),i["Webkit"+s]="webkit"+e,i["Moz"+s]="moz"+e,i}var We={animationend:Ve("Animation","AnimationEnd"),animationiteration:Ve("Animation","AnimationIteration"),animationstart:Ve("Animation","AnimationStart"),transitionend:Ve("Transition","TransitionEnd")},Xe={},Ye={};ia&&(Ye=document.createElement("div").style,"AnimationEvent"in window||(delete We.animationend.animation,delete We.animationiteration.animation,delete We.animationstart.animation),"TransitionEvent"in window||delete We.transitionend.transition);function Ze(s){if(Xe[s])return Xe[s];if(!We[s])return s;var e=We[s],i;for(i in e)if(e.hasOwnProperty(i)&&i in Ye)return Xe[s]=e[i];return s}var $e=Ze("animationend"),af=Ze("animationiteration"),bf=Ze("animationstart"),cf=Ze("transitionend"),df=new Map,ef="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ff(s,e){df.set(s,e),fa(e,[s])}for(var gf=0;gf<ef.length;gf++){var hf=ef[gf],jf=hf.toLowerCase(),kf=hf[0].toUpperCase()+hf.slice(1);ff(jf,"on"+kf)}ff($e,"onAnimationEnd");ff(af,"onAnimationIteration");ff(bf,"onAnimationStart");ff("dblclick","onDoubleClick");ff("focusin","onFocus");ff("focusout","onBlur");ff(cf,"onTransitionEnd");ha("onMouseEnter",["mouseout","mouseover"]);ha("onMouseLeave",["mouseout","mouseover"]);ha("onPointerEnter",["pointerout","pointerover"]);ha("onPointerLeave",["pointerout","pointerover"]);fa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fa("onBeforeInput",["compositionend","keypress","textInput","paste"]);fa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mf=new Set("cancel close invalid load scroll toggle".split(" ").concat(lf));function nf(s,e,i){var a=s.type||"unknown-event";s.currentTarget=i,Ub(a,e,void 0,s),s.currentTarget=null}function se(s,e){e=(e&4)!==0;for(var i=0;i<s.length;i++){var a=s[i],o=a.event;a=a.listeners;e:{var c=void 0;if(e)for(var d=a.length-1;0<=d;d--){var g=a[d],b=g.instance,_=g.currentTarget;if(g=g.listener,b!==c&&o.isPropagationStopped())break e;nf(o,g,_),c=b}else for(d=0;d<a.length;d++){if(g=a[d],b=g.instance,_=g.currentTarget,g=g.listener,b!==c&&o.isPropagationStopped())break e;nf(o,g,_),c=b}}}if(Qb)throw s=Rb,Qb=!1,Rb=null,s}function D(s,e){var i=e[of];i===void 0&&(i=e[of]=new Set);var a=s+"__bubble";i.has(a)||(pf(e,s,2,!1),i.add(a))}function qf(s,e,i){var a=0;e&&(a|=4),pf(i,s,a,e)}var rf="_reactListening"+Math.random().toString(36).slice(2);function sf(s){if(!s[rf]){s[rf]=!0,da.forEach(function(i){i!=="selectionchange"&&(mf.has(i)||qf(i,!1,s),qf(i,!0,s))});var e=s.nodeType===9?s:s.ownerDocument;e===null||e[rf]||(e[rf]=!0,qf("selectionchange",!1,e))}}function pf(s,e,i,a){switch(jd(e)){case 1:var o=ed;break;case 4:o=gd;break;default:o=fd}i=o.bind(null,e,i,s),o=void 0,!Lb||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(o=!0),a?o!==void 0?s.addEventListener(e,i,{capture:!0,passive:o}):s.addEventListener(e,i,!0):o!==void 0?s.addEventListener(e,i,{passive:o}):s.addEventListener(e,i,!1)}function hd(s,e,i,a,o){var c=a;if(!(e&1)&&!(e&2)&&a!==null)e:for(;;){if(a===null)return;var d=a.tag;if(d===3||d===4){var g=a.stateNode.containerInfo;if(g===o||g.nodeType===8&&g.parentNode===o)break;if(d===4)for(d=a.return;d!==null;){var b=d.tag;if((b===3||b===4)&&(b=d.stateNode.containerInfo,b===o||b.nodeType===8&&b.parentNode===o))return;d=d.return}for(;g!==null;){if(d=Wc(g),d===null)return;if(b=d.tag,b===5||b===6){a=c=d;continue e}g=g.parentNode}}a=a.return}Jb(function(){var _=c,j=xb(i),$=[];e:{var _e=df.get(s);if(_e!==void 0){var tt=td,et=s;switch(s){case"keypress":if(od(i)===0)break e;case"keydown":case"keyup":tt=Rd;break;case"focusin":et="focus",tt=Fd;break;case"focusout":et="blur",tt=Fd;break;case"beforeblur":case"afterblur":tt=Fd;break;case"click":if(i.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":tt=Bd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":tt=Dd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":tt=Vd;break;case $e:case af:case bf:tt=Hd;break;case cf:tt=Xd;break;case"scroll":tt=vd;break;case"wheel":tt=Zd;break;case"copy":case"cut":case"paste":tt=Jd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":tt=Td}var st=(e&4)!==0,at=!st&&s==="scroll",rt=st?_e!==null?_e+"Capture":null:_e;st=[];for(var nt=_,it;nt!==null;){it=nt;var ot=it.stateNode;if(it.tag===5&&ot!==null&&(it=ot,rt!==null&&(ot=Kb(nt,rt),ot!=null&&st.push(tf(nt,ot,it)))),at)break;nt=nt.return}0<st.length&&(_e=new tt(_e,et,null,i,j),$.push({event:_e,listeners:st}))}}if(!(e&7)){e:{if(_e=s==="mouseover"||s==="pointerover",tt=s==="mouseout"||s==="pointerout",_e&&i!==wb&&(et=i.relatedTarget||i.fromElement)&&(Wc(et)||et[uf]))break e;if((tt||_e)&&(_e=j.window===j?j:(_e=j.ownerDocument)?_e.defaultView||_e.parentWindow:window,tt?(et=i.relatedTarget||i.toElement,tt=_,et=et?Wc(et):null,et!==null&&(at=Vb(et),et!==at||et.tag!==5&&et.tag!==6)&&(et=null)):(tt=null,et=_),tt!==et)){if(st=Bd,ot="onMouseLeave",rt="onMouseEnter",nt="mouse",(s==="pointerout"||s==="pointerover")&&(st=Td,ot="onPointerLeave",rt="onPointerEnter",nt="pointer"),at=tt==null?_e:ue(tt),it=et==null?_e:ue(et),_e=new st(ot,nt+"leave",tt,i,j),_e.target=at,_e.relatedTarget=it,ot=null,Wc(j)===_&&(st=new st(rt,nt+"enter",et,i,j),st.target=it,st.relatedTarget=at,ot=st),at=ot,tt&&et)t:{for(st=tt,rt=et,nt=0,it=st;it;it=vf(it))nt++;for(it=0,ot=rt;ot;ot=vf(ot))it++;for(;0<nt-it;)st=vf(st),nt--;for(;0<it-nt;)rt=vf(rt),it--;for(;nt--;){if(st===rt||rt!==null&&st===rt.alternate)break t;st=vf(st),rt=vf(rt)}st=null}else st=null;tt!==null&&wf($,_e,tt,st,!1),et!==null&&at!==null&&wf($,at,et,st,!0)}}e:{if(_e=_?ue(_):window,tt=_e.nodeName&&_e.nodeName.toLowerCase(),tt==="select"||tt==="input"&&_e.type==="file")var lt=ve;else if(me(_e))if(we)lt=Fe;else{lt=De;var ct=Ce}else(tt=_e.nodeName)&&tt.toLowerCase()==="input"&&(_e.type==="checkbox"||_e.type==="radio")&&(lt=Ee);if(lt&&(lt=lt(s,_))){ne($,lt,i,j);break e}ct&&ct(s,_e,_),s==="focusout"&&(ct=_e._wrapperState)&&ct.controlled&&_e.type==="number"&&cb(_e,"number",_e.value)}switch(ct=_?ue(_):window,s){case"focusin":(me(ct)||ct.contentEditable==="true")&&(Qe=ct,Re=_,Se=null);break;case"focusout":Se=Re=Qe=null;break;case"mousedown":Te=!0;break;case"contextmenu":case"mouseup":case"dragend":Te=!1,Ue($,i,j);break;case"selectionchange":if(Pe)break;case"keydown":case"keyup":Ue($,i,j)}var ht;if(ae)e:{switch(s){case"compositionstart":var dt="onCompositionStart";break e;case"compositionend":dt="onCompositionEnd";break e;case"compositionupdate":dt="onCompositionUpdate";break e}dt=void 0}else ie?ge(s,i)&&(dt="onCompositionEnd"):s==="keydown"&&i.keyCode===229&&(dt="onCompositionStart");dt&&(de&&i.locale!=="ko"&&(ie||dt!=="onCompositionStart"?dt==="onCompositionEnd"&&ie&&(ht=nd()):(kd=j,ld="value"in kd?kd.value:kd.textContent,ie=!0)),ct=oe(_,dt),0<ct.length&&(dt=new Ld(dt,s,null,i,j),$.push({event:dt,listeners:ct}),ht?dt.data=ht:(ht=he(i),ht!==null&&(dt.data=ht)))),(ht=ce?je(s,i):ke(s,i))&&(_=oe(_,"onBeforeInput"),0<_.length&&(j=new Ld("onBeforeInput","beforeinput",null,i,j),$.push({event:j,listeners:_}),j.data=ht))}se($,e)})}function tf(s,e,i){return{instance:s,listener:e,currentTarget:i}}function oe(s,e){for(var i=e+"Capture",a=[];s!==null;){var o=s,c=o.stateNode;o.tag===5&&c!==null&&(o=c,c=Kb(s,i),c!=null&&a.unshift(tf(s,c,o)),c=Kb(s,e),c!=null&&a.push(tf(s,c,o))),s=s.return}return a}function vf(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5);return s||null}function wf(s,e,i,a,o){for(var c=e._reactName,d=[];i!==null&&i!==a;){var g=i,b=g.alternate,_=g.stateNode;if(b!==null&&b===a)break;g.tag===5&&_!==null&&(g=_,o?(b=Kb(i,c),b!=null&&d.unshift(tf(i,b,g))):o||(b=Kb(i,c),b!=null&&d.push(tf(i,b,g)))),i=i.return}d.length!==0&&s.push({event:e,listeners:d})}var xf=/\r\n?/g,yf=/\u0000|\uFFFD/g;function zf(s){return(typeof s=="string"?s:""+s).replace(xf,`
`).replace(yf,"")}function Af(s,e,i){if(e=zf(e),zf(s)!==e&&i)throw Error(p(425))}function Bf(){}var Cf=null,Df=null;function Ef(s,e){return s==="textarea"||s==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Ff=typeof setTimeout=="function"?setTimeout:void 0,Gf=typeof clearTimeout=="function"?clearTimeout:void 0,Hf=typeof Promise=="function"?Promise:void 0,Jf=typeof queueMicrotask=="function"?queueMicrotask:typeof Hf<"u"?function(s){return Hf.resolve(null).then(s).catch(If)}:Ff;function If(s){setTimeout(function(){throw s})}function Kf(s,e){var i=e,a=0;do{var o=i.nextSibling;if(s.removeChild(i),o&&o.nodeType===8)if(i=o.data,i==="/$"){if(a===0){s.removeChild(o),bd(e);return}a--}else i!=="$"&&i!=="$?"&&i!=="$!"||a++;i=o}while(i);bd(e)}function Lf(s){for(;s!=null;s=s.nextSibling){var e=s.nodeType;if(e===1||e===3)break;if(e===8){if(e=s.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return s}function Mf(s){s=s.previousSibling;for(var e=0;s;){if(s.nodeType===8){var i=s.data;if(i==="$"||i==="$!"||i==="$?"){if(e===0)return s;e--}else i==="/$"&&e++}s=s.previousSibling}return null}var Nf=Math.random().toString(36).slice(2),Of="__reactFiber$"+Nf,Pf="__reactProps$"+Nf,uf="__reactContainer$"+Nf,of="__reactEvents$"+Nf,Qf="__reactListeners$"+Nf,Rf="__reactHandles$"+Nf;function Wc(s){var e=s[Of];if(e)return e;for(var i=s.parentNode;i;){if(e=i[uf]||i[Of]){if(i=e.alternate,e.child!==null||i!==null&&i.child!==null)for(s=Mf(s);s!==null;){if(i=s[Of])return i;s=Mf(s)}return e}s=i,i=s.parentNode}return null}function Cb(s){return s=s[Of]||s[uf],!s||s.tag!==5&&s.tag!==6&&s.tag!==13&&s.tag!==3?null:s}function ue(s){if(s.tag===5||s.tag===6)return s.stateNode;throw Error(p(33))}function Db(s){return s[Pf]||null}var Sf=[],Tf=-1;function Uf(s){return{current:s}}function E(s){0>Tf||(s.current=Sf[Tf],Sf[Tf]=null,Tf--)}function G(s,e){Tf++,Sf[Tf]=s.current,s.current=e}var Vf={},H=Uf(Vf),Wf=Uf(!1),Xf=Vf;function Yf(s,e){var i=s.type.contextTypes;if(!i)return Vf;var a=s.stateNode;if(a&&a.__reactInternalMemoizedUnmaskedChildContext===e)return a.__reactInternalMemoizedMaskedChildContext;var o={},c;for(c in i)o[c]=e[c];return a&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=e,s.__reactInternalMemoizedMaskedChildContext=o),o}function Zf(s){return s=s.childContextTypes,s!=null}function $f(){E(Wf),E(H)}function ag(s,e,i){if(H.current!==Vf)throw Error(p(168));G(H,e),G(Wf,i)}function bg(s,e,i){var a=s.stateNode;if(e=e.childContextTypes,typeof a.getChildContext!="function")return i;a=a.getChildContext();for(var o in a)if(!(o in e))throw Error(p(108,Ra(s)||"Unknown",o));return A({},i,a)}function cg(s){return s=(s=s.stateNode)&&s.__reactInternalMemoizedMergedChildContext||Vf,Xf=H.current,G(H,s),G(Wf,Wf.current),!0}function dg(s,e,i){var a=s.stateNode;if(!a)throw Error(p(169));i?(s=bg(s,e,Xf),a.__reactInternalMemoizedMergedChildContext=s,E(Wf),E(H),G(H,s)):E(Wf),G(Wf,i)}var eg=null,fg=!1,gg=!1;function hg(s){eg===null?eg=[s]:eg.push(s)}function ig(s){fg=!0,hg(s)}function jg(){if(!gg&&eg!==null){gg=!0;var s=0,e=C;try{var i=eg;for(C=1;s<i.length;s++){var a=i[s];do a=a(!0);while(a!==null)}eg=null,fg=!1}catch(o){throw eg!==null&&(eg=eg.slice(s+1)),ac(fc,jg),o}finally{C=e,gg=!1}}return null}var kg=[],lg=0,mg=null,ng=0,og=[],pg=0,qg=null,rg=1,sg="";function tg(s,e){kg[lg++]=ng,kg[lg++]=mg,mg=s,ng=e}function ug(s,e,i){og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,qg=s;var a=rg;s=sg;var o=32-oc(a)-1;a&=~(1<<o),i+=1;var c=32-oc(e)+o;if(30<c){var d=o-o%5;c=(a&(1<<d)-1).toString(32),a>>=d,o-=d,rg=1<<32-oc(e)+o|i<<o|a,sg=c+s}else rg=1<<c|i<<o|a,sg=s}function vg(s){s.return!==null&&(tg(s,1),ug(s,1,0))}function wg(s){for(;s===mg;)mg=kg[--lg],kg[lg]=null,ng=kg[--lg],kg[lg]=null;for(;s===qg;)qg=og[--pg],og[pg]=null,sg=og[--pg],og[pg]=null,rg=og[--pg],og[pg]=null}var xg=null,yg=null,I=!1,zg=null;function Ag(s,e){var i=Bg(5,null,null,0);i.elementType="DELETED",i.stateNode=e,i.return=s,e=s.deletions,e===null?(s.deletions=[i],s.flags|=16):e.push(i)}function Cg(s,e){switch(s.tag){case 5:var i=s.type;return e=e.nodeType!==1||i.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(s.stateNode=e,xg=s,yg=Lf(e.firstChild),!0):!1;case 6:return e=s.pendingProps===""||e.nodeType!==3?null:e,e!==null?(s.stateNode=e,xg=s,yg=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(i=qg!==null?{id:rg,overflow:sg}:null,s.memoizedState={dehydrated:e,treeContext:i,retryLane:1073741824},i=Bg(18,null,null,0),i.stateNode=e,i.return=s,s.child=i,xg=s,yg=null,!0):!1;default:return!1}}function Dg(s){return(s.mode&1)!==0&&(s.flags&128)===0}function Eg(s){if(I){var e=yg;if(e){var i=e;if(!Cg(s,e)){if(Dg(s))throw Error(p(418));e=Lf(i.nextSibling);var a=xg;e&&Cg(s,e)?Ag(a,i):(s.flags=s.flags&-4097|2,I=!1,xg=s)}}else{if(Dg(s))throw Error(p(418));s.flags=s.flags&-4097|2,I=!1,xg=s}}}function Fg(s){for(s=s.return;s!==null&&s.tag!==5&&s.tag!==3&&s.tag!==13;)s=s.return;xg=s}function Gg(s){if(s!==xg)return!1;if(!I)return Fg(s),I=!0,!1;var e;if((e=s.tag!==3)&&!(e=s.tag!==5)&&(e=s.type,e=e!=="head"&&e!=="body"&&!Ef(s.type,s.memoizedProps)),e&&(e=yg)){if(Dg(s))throw Hg(),Error(p(418));for(;e;)Ag(s,e),e=Lf(e.nextSibling)}if(Fg(s),s.tag===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(p(317));e:{for(s=s.nextSibling,e=0;s;){if(s.nodeType===8){var i=s.data;if(i==="/$"){if(e===0){yg=Lf(s.nextSibling);break e}e--}else i!=="$"&&i!=="$!"&&i!=="$?"||e++}s=s.nextSibling}yg=null}}else yg=xg?Lf(s.stateNode.nextSibling):null;return!0}function Hg(){for(var s=yg;s;)s=Lf(s.nextSibling)}function Ig(){yg=xg=null,I=!1}function Jg(s){zg===null?zg=[s]:zg.push(s)}var Kg=ua.ReactCurrentBatchConfig;function Lg(s,e,i){if(s=i.ref,s!==null&&typeof s!="function"&&typeof s!="object"){if(i._owner){if(i=i._owner,i){if(i.tag!==1)throw Error(p(309));var a=i.stateNode}if(!a)throw Error(p(147,s));var o=a,c=""+s;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===c?e.ref:(e=function(d){var g=o.refs;d===null?delete g[c]:g[c]=d},e._stringRef=c,e)}if(typeof s!="string")throw Error(p(284));if(!i._owner)throw Error(p(290,s))}return s}function Mg(s,e){throw s=Object.prototype.toString.call(e),Error(p(31,s==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":s))}function Ng(s){var e=s._init;return e(s._payload)}function Og(s){function e(rt,nt){if(s){var it=rt.deletions;it===null?(rt.deletions=[nt],rt.flags|=16):it.push(nt)}}function i(rt,nt){if(!s)return null;for(;nt!==null;)e(rt,nt),nt=nt.sibling;return null}function a(rt,nt){for(rt=new Map;nt!==null;)nt.key!==null?rt.set(nt.key,nt):rt.set(nt.index,nt),nt=nt.sibling;return rt}function o(rt,nt){return rt=Pg(rt,nt),rt.index=0,rt.sibling=null,rt}function c(rt,nt,it){return rt.index=it,s?(it=rt.alternate,it!==null?(it=it.index,it<nt?(rt.flags|=2,nt):it):(rt.flags|=2,nt)):(rt.flags|=1048576,nt)}function d(rt){return s&&rt.alternate===null&&(rt.flags|=2),rt}function g(rt,nt,it,ot){return nt===null||nt.tag!==6?(nt=Qg(it,rt.mode,ot),nt.return=rt,nt):(nt=o(nt,it),nt.return=rt,nt)}function b(rt,nt,it,ot){var lt=it.type;return lt===ya?j(rt,nt,it.props.children,ot,it.key):nt!==null&&(nt.elementType===lt||typeof lt=="object"&&lt!==null&&lt.$$typeof===Ha&&Ng(lt)===nt.type)?(ot=o(nt,it.props),ot.ref=Lg(rt,nt,it),ot.return=rt,ot):(ot=Rg(it.type,it.key,it.props,null,rt.mode,ot),ot.ref=Lg(rt,nt,it),ot.return=rt,ot)}function _(rt,nt,it,ot){return nt===null||nt.tag!==4||nt.stateNode.containerInfo!==it.containerInfo||nt.stateNode.implementation!==it.implementation?(nt=Sg(it,rt.mode,ot),nt.return=rt,nt):(nt=o(nt,it.children||[]),nt.return=rt,nt)}function j(rt,nt,it,ot,lt){return nt===null||nt.tag!==7?(nt=Tg(it,rt.mode,ot,lt),nt.return=rt,nt):(nt=o(nt,it),nt.return=rt,nt)}function $(rt,nt,it){if(typeof nt=="string"&&nt!==""||typeof nt=="number")return nt=Qg(""+nt,rt.mode,it),nt.return=rt,nt;if(typeof nt=="object"&&nt!==null){switch(nt.$$typeof){case va:return it=Rg(nt.type,nt.key,nt.props,null,rt.mode,it),it.ref=Lg(rt,null,nt),it.return=rt,it;case wa:return nt=Sg(nt,rt.mode,it),nt.return=rt,nt;case Ha:var ot=nt._init;return $(rt,ot(nt._payload),it)}if(eb(nt)||Ka(nt))return nt=Tg(nt,rt.mode,it,null),nt.return=rt,nt;Mg(rt,nt)}return null}function _e(rt,nt,it,ot){var lt=nt!==null?nt.key:null;if(typeof it=="string"&&it!==""||typeof it=="number")return lt!==null?null:g(rt,nt,""+it,ot);if(typeof it=="object"&&it!==null){switch(it.$$typeof){case va:return it.key===lt?b(rt,nt,it,ot):null;case wa:return it.key===lt?_(rt,nt,it,ot):null;case Ha:return lt=it._init,_e(rt,nt,lt(it._payload),ot)}if(eb(it)||Ka(it))return lt!==null?null:j(rt,nt,it,ot,null);Mg(rt,it)}return null}function tt(rt,nt,it,ot,lt){if(typeof ot=="string"&&ot!==""||typeof ot=="number")return rt=rt.get(it)||null,g(nt,rt,""+ot,lt);if(typeof ot=="object"&&ot!==null){switch(ot.$$typeof){case va:return rt=rt.get(ot.key===null?it:ot.key)||null,b(nt,rt,ot,lt);case wa:return rt=rt.get(ot.key===null?it:ot.key)||null,_(nt,rt,ot,lt);case Ha:var ct=ot._init;return tt(rt,nt,it,ct(ot._payload),lt)}if(eb(ot)||Ka(ot))return rt=rt.get(it)||null,j(nt,rt,ot,lt,null);Mg(nt,ot)}return null}function et(rt,nt,it,ot){for(var lt=null,ct=null,ht=nt,dt=nt=0,gt=null;ht!==null&&dt<it.length;dt++){ht.index>dt?(gt=ht,ht=null):gt=ht.sibling;var vt=_e(rt,ht,it[dt],ot);if(vt===null){ht===null&&(ht=gt);break}s&&ht&&vt.alternate===null&&e(rt,ht),nt=c(vt,nt,dt),ct===null?lt=vt:ct.sibling=vt,ct=vt,ht=gt}if(dt===it.length)return i(rt,ht),I&&tg(rt,dt),lt;if(ht===null){for(;dt<it.length;dt++)ht=$(rt,it[dt],ot),ht!==null&&(nt=c(ht,nt,dt),ct===null?lt=ht:ct.sibling=ht,ct=ht);return I&&tg(rt,dt),lt}for(ht=a(rt,ht);dt<it.length;dt++)gt=tt(ht,rt,dt,it[dt],ot),gt!==null&&(s&&gt.alternate!==null&&ht.delete(gt.key===null?dt:gt.key),nt=c(gt,nt,dt),ct===null?lt=gt:ct.sibling=gt,ct=gt);return s&&ht.forEach(function(St){return e(rt,St)}),I&&tg(rt,dt),lt}function st(rt,nt,it,ot){var lt=Ka(it);if(typeof lt!="function")throw Error(p(150));if(it=lt.call(it),it==null)throw Error(p(151));for(var ct=lt=null,ht=nt,dt=nt=0,gt=null,vt=it.next();ht!==null&&!vt.done;dt++,vt=it.next()){ht.index>dt?(gt=ht,ht=null):gt=ht.sibling;var St=_e(rt,ht,vt.value,ot);if(St===null){ht===null&&(ht=gt);break}s&&ht&&St.alternate===null&&e(rt,ht),nt=c(St,nt,dt),ct===null?lt=St:ct.sibling=St,ct=St,ht=gt}if(vt.done)return i(rt,ht),I&&tg(rt,dt),lt;if(ht===null){for(;!vt.done;dt++,vt=it.next())vt=$(rt,vt.value,ot),vt!==null&&(nt=c(vt,nt,dt),ct===null?lt=vt:ct.sibling=vt,ct=vt);return I&&tg(rt,dt),lt}for(ht=a(rt,ht);!vt.done;dt++,vt=it.next())vt=tt(ht,rt,dt,vt.value,ot),vt!==null&&(s&&vt.alternate!==null&&ht.delete(vt.key===null?dt:vt.key),nt=c(vt,nt,dt),ct===null?lt=vt:ct.sibling=vt,ct=vt);return s&&ht.forEach(function(Tt){return e(rt,Tt)}),I&&tg(rt,dt),lt}function at(rt,nt,it,ot){if(typeof it=="object"&&it!==null&&it.type===ya&&it.key===null&&(it=it.props.children),typeof it=="object"&&it!==null){switch(it.$$typeof){case va:e:{for(var lt=it.key,ct=nt;ct!==null;){if(ct.key===lt){if(lt=it.type,lt===ya){if(ct.tag===7){i(rt,ct.sibling),nt=o(ct,it.props.children),nt.return=rt,rt=nt;break e}}else if(ct.elementType===lt||typeof lt=="object"&&lt!==null&&lt.$$typeof===Ha&&Ng(lt)===ct.type){i(rt,ct.sibling),nt=o(ct,it.props),nt.ref=Lg(rt,ct,it),nt.return=rt,rt=nt;break e}i(rt,ct);break}else e(rt,ct);ct=ct.sibling}it.type===ya?(nt=Tg(it.props.children,rt.mode,ot,it.key),nt.return=rt,rt=nt):(ot=Rg(it.type,it.key,it.props,null,rt.mode,ot),ot.ref=Lg(rt,nt,it),ot.return=rt,rt=ot)}return d(rt);case wa:e:{for(ct=it.key;nt!==null;){if(nt.key===ct)if(nt.tag===4&&nt.stateNode.containerInfo===it.containerInfo&&nt.stateNode.implementation===it.implementation){i(rt,nt.sibling),nt=o(nt,it.children||[]),nt.return=rt,rt=nt;break e}else{i(rt,nt);break}else e(rt,nt);nt=nt.sibling}nt=Sg(it,rt.mode,ot),nt.return=rt,rt=nt}return d(rt);case Ha:return ct=it._init,at(rt,nt,ct(it._payload),ot)}if(eb(it))return et(rt,nt,it,ot);if(Ka(it))return st(rt,nt,it,ot);Mg(rt,it)}return typeof it=="string"&&it!==""||typeof it=="number"?(it=""+it,nt!==null&&nt.tag===6?(i(rt,nt.sibling),nt=o(nt,it),nt.return=rt,rt=nt):(i(rt,nt),nt=Qg(it,rt.mode,ot),nt.return=rt,rt=nt),d(rt)):i(rt,nt)}return at}var Ug=Og(!0),Vg=Og(!1),Wg=Uf(null),Xg=null,Yg=null,Zg=null;function $g(){Zg=Yg=Xg=null}function ah(s){var e=Wg.current;E(Wg),s._currentValue=e}function bh(s,e,i){for(;s!==null;){var a=s.alternate;if((s.childLanes&e)!==e?(s.childLanes|=e,a!==null&&(a.childLanes|=e)):a!==null&&(a.childLanes&e)!==e&&(a.childLanes|=e),s===i)break;s=s.return}}function ch(s,e){Xg=s,Zg=Yg=null,s=s.dependencies,s!==null&&s.firstContext!==null&&(s.lanes&e&&(dh=!0),s.firstContext=null)}function eh(s){var e=s._currentValue;if(Zg!==s)if(s={context:s,memoizedValue:e,next:null},Yg===null){if(Xg===null)throw Error(p(308));Yg=s,Xg.dependencies={lanes:0,firstContext:s}}else Yg=Yg.next=s;return e}var fh=null;function gh(s){fh===null?fh=[s]:fh.push(s)}function hh(s,e,i,a){var o=e.interleaved;return o===null?(i.next=i,gh(e)):(i.next=o.next,o.next=i),e.interleaved=i,ih(s,a)}function ih(s,e){s.lanes|=e;var i=s.alternate;for(i!==null&&(i.lanes|=e),i=s,s=s.return;s!==null;)s.childLanes|=e,i=s.alternate,i!==null&&(i.childLanes|=e),i=s,s=s.return;return i.tag===3?i.stateNode:null}var jh=!1;function kh(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function lh(s,e){s=s.updateQueue,e.updateQueue===s&&(e.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,effects:s.effects})}function mh(s,e){return{eventTime:s,lane:e,tag:0,payload:null,callback:null,next:null}}function nh(s,e,i){var a=s.updateQueue;if(a===null)return null;if(a=a.shared,K&2){var o=a.pending;return o===null?e.next=e:(e.next=o.next,o.next=e),a.pending=e,ih(s,i)}return o=a.interleaved,o===null?(e.next=e,gh(a)):(e.next=o.next,o.next=e),a.interleaved=e,ih(s,i)}function oh(s,e,i){if(e=e.updateQueue,e!==null&&(e=e.shared,(i&4194240)!==0)){var a=e.lanes;a&=s.pendingLanes,i|=a,e.lanes=i,Cc(s,i)}}function ph(s,e){var i=s.updateQueue,a=s.alternate;if(a!==null&&(a=a.updateQueue,i===a)){var o=null,c=null;if(i=i.firstBaseUpdate,i!==null){do{var d={eventTime:i.eventTime,lane:i.lane,tag:i.tag,payload:i.payload,callback:i.callback,next:null};c===null?o=c=d:c=c.next=d,i=i.next}while(i!==null);c===null?o=c=e:c=c.next=e}else o=c=e;i={baseState:a.baseState,firstBaseUpdate:o,lastBaseUpdate:c,shared:a.shared,effects:a.effects},s.updateQueue=i;return}s=i.lastBaseUpdate,s===null?i.firstBaseUpdate=e:s.next=e,i.lastBaseUpdate=e}function qh(s,e,i,a){var o=s.updateQueue;jh=!1;var c=o.firstBaseUpdate,d=o.lastBaseUpdate,g=o.shared.pending;if(g!==null){o.shared.pending=null;var b=g,_=b.next;b.next=null,d===null?c=_:d.next=_,d=b;var j=s.alternate;j!==null&&(j=j.updateQueue,g=j.lastBaseUpdate,g!==d&&(g===null?j.firstBaseUpdate=_:g.next=_,j.lastBaseUpdate=b))}if(c!==null){var $=o.baseState;d=0,j=_=b=null,g=c;do{var _e=g.lane,tt=g.eventTime;if((a&_e)===_e){j!==null&&(j=j.next={eventTime:tt,lane:0,tag:g.tag,payload:g.payload,callback:g.callback,next:null});e:{var et=s,st=g;switch(_e=e,tt=i,st.tag){case 1:if(et=st.payload,typeof et=="function"){$=et.call(tt,$,_e);break e}$=et;break e;case 3:et.flags=et.flags&-65537|128;case 0:if(et=st.payload,_e=typeof et=="function"?et.call(tt,$,_e):et,_e==null)break e;$=A({},$,_e);break e;case 2:jh=!0}}g.callback!==null&&g.lane!==0&&(s.flags|=64,_e=o.effects,_e===null?o.effects=[g]:_e.push(g))}else tt={eventTime:tt,lane:_e,tag:g.tag,payload:g.payload,callback:g.callback,next:null},j===null?(_=j=tt,b=$):j=j.next=tt,d|=_e;if(g=g.next,g===null){if(g=o.shared.pending,g===null)break;_e=g,g=_e.next,_e.next=null,o.lastBaseUpdate=_e,o.shared.pending=null}}while(!0);if(j===null&&(b=$),o.baseState=b,o.firstBaseUpdate=_,o.lastBaseUpdate=j,e=o.shared.interleaved,e!==null){o=e;do d|=o.lane,o=o.next;while(o!==e)}else c===null&&(o.shared.lanes=0);rh|=d,s.lanes=d,s.memoizedState=$}}function sh(s,e,i){if(s=e.effects,e.effects=null,s!==null)for(e=0;e<s.length;e++){var a=s[e],o=a.callback;if(o!==null){if(a.callback=null,a=i,typeof o!="function")throw Error(p(191,o));o.call(a)}}}var th={},uh=Uf(th),vh$1=Uf(th),wh=Uf(th);function xh(s){if(s===th)throw Error(p(174));return s}function yh(s,e){switch(G(wh,e),G(vh$1,s),G(uh,th),s=e.nodeType,s){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:lb(null,"");break;default:s=s===8?e.parentNode:e,e=s.namespaceURI||null,s=s.tagName,e=lb(e,s)}E(uh),G(uh,e)}function zh(){E(uh),E(vh$1),E(wh)}function Ah(s){xh(wh.current);var e=xh(uh.current),i=lb(e,s.type);e!==i&&(G(vh$1,s),G(uh,i))}function Bh(s){vh$1.current===s&&(E(uh),E(vh$1))}var L=Uf(0);function Ch(s){for(var e=s;e!==null;){if(e.tag===13){var i=e.memoizedState;if(i!==null&&(i=i.dehydrated,i===null||i.data==="$?"||i.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===s)break;for(;e.sibling===null;){if(e.return===null||e.return===s)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Dh=[];function Eh(){for(var s=0;s<Dh.length;s++)Dh[s]._workInProgressVersionPrimary=null;Dh.length=0}var Fh=ua.ReactCurrentDispatcher,Gh=ua.ReactCurrentBatchConfig,Hh=0,M=null,N=null,O=null,Ih=!1,Jh=!1,Kh=0,Lh=0;function P(){throw Error(p(321))}function Mh(s,e){if(e===null)return!1;for(var i=0;i<e.length&&i<s.length;i++)if(!He(s[i],e[i]))return!1;return!0}function Nh(s,e,i,a,o,c){if(Hh=c,M=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Fh.current=s===null||s.memoizedState===null?Oh:Ph,s=i(a,o),Jh){c=0;do{if(Jh=!1,Kh=0,25<=c)throw Error(p(301));c+=1,O=N=null,e.updateQueue=null,Fh.current=Qh,s=i(a,o)}while(Jh)}if(Fh.current=Rh,e=N!==null&&N.next!==null,Hh=0,O=N=M=null,Ih=!1,e)throw Error(p(300));return s}function Sh(){var s=Kh!==0;return Kh=0,s}function Th(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return O===null?M.memoizedState=O=s:O=O.next=s,O}function Uh(){if(N===null){var s=M.alternate;s=s!==null?s.memoizedState:null}else s=N.next;var e=O===null?M.memoizedState:O.next;if(e!==null)O=e,N=s;else{if(s===null)throw Error(p(310));N=s,s={memoizedState:N.memoizedState,baseState:N.baseState,baseQueue:N.baseQueue,queue:N.queue,next:null},O===null?M.memoizedState=O=s:O=O.next=s}return O}function Vh(s,e){return typeof e=="function"?e(s):e}function Wh(s){var e=Uh(),i=e.queue;if(i===null)throw Error(p(311));i.lastRenderedReducer=s;var a=N,o=a.baseQueue,c=i.pending;if(c!==null){if(o!==null){var d=o.next;o.next=c.next,c.next=d}a.baseQueue=o=c,i.pending=null}if(o!==null){c=o.next,a=a.baseState;var g=d=null,b=null,_=c;do{var j=_.lane;if((Hh&j)===j)b!==null&&(b=b.next={lane:0,action:_.action,hasEagerState:_.hasEagerState,eagerState:_.eagerState,next:null}),a=_.hasEagerState?_.eagerState:s(a,_.action);else{var $={lane:j,action:_.action,hasEagerState:_.hasEagerState,eagerState:_.eagerState,next:null};b===null?(g=b=$,d=a):b=b.next=$,M.lanes|=j,rh|=j}_=_.next}while(_!==null&&_!==c);b===null?d=a:b.next=g,He(a,e.memoizedState)||(dh=!0),e.memoizedState=a,e.baseState=d,e.baseQueue=b,i.lastRenderedState=a}if(s=i.interleaved,s!==null){o=s;do c=o.lane,M.lanes|=c,rh|=c,o=o.next;while(o!==s)}else o===null&&(i.lanes=0);return[e.memoizedState,i.dispatch]}function Xh(s){var e=Uh(),i=e.queue;if(i===null)throw Error(p(311));i.lastRenderedReducer=s;var a=i.dispatch,o=i.pending,c=e.memoizedState;if(o!==null){i.pending=null;var d=o=o.next;do c=s(c,d.action),d=d.next;while(d!==o);He(c,e.memoizedState)||(dh=!0),e.memoizedState=c,e.baseQueue===null&&(e.baseState=c),i.lastRenderedState=c}return[c,a]}function Yh(){}function Zh(s,e){var i=M,a=Uh(),o=e(),c=!He(a.memoizedState,o);if(c&&(a.memoizedState=o,dh=!0),a=a.queue,$h(ai.bind(null,i,a,s),[s]),a.getSnapshot!==e||c||O!==null&&O.memoizedState.tag&1){if(i.flags|=2048,bi(9,ci.bind(null,i,a,o,e),void 0,null),Q===null)throw Error(p(349));Hh&30||di(i,e,o)}return o}function di(s,e,i){s.flags|=16384,s={getSnapshot:e,value:i},e=M.updateQueue,e===null?(e={lastEffect:null,stores:null},M.updateQueue=e,e.stores=[s]):(i=e.stores,i===null?e.stores=[s]:i.push(s))}function ci(s,e,i,a){e.value=i,e.getSnapshot=a,ei(e)&&fi(s)}function ai(s,e,i){return i(function(){ei(e)&&fi(s)})}function ei(s){var e=s.getSnapshot;s=s.value;try{var i=e();return!He(s,i)}catch{return!0}}function fi(s){var e=ih(s,1);e!==null&&gi(e,s,1,-1)}function hi(s){var e=Th();return typeof s=="function"&&(s=s()),e.memoizedState=e.baseState=s,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vh,lastRenderedState:s},e.queue=s,s=s.dispatch=ii.bind(null,M,s),[e.memoizedState,s]}function bi(s,e,i,a){return s={tag:s,create:e,destroy:i,deps:a,next:null},e=M.updateQueue,e===null?(e={lastEffect:null,stores:null},M.updateQueue=e,e.lastEffect=s.next=s):(i=e.lastEffect,i===null?e.lastEffect=s.next=s:(a=i.next,i.next=s,s.next=a,e.lastEffect=s)),s}function ji(){return Uh().memoizedState}function ki(s,e,i,a){var o=Th();M.flags|=s,o.memoizedState=bi(1|e,i,void 0,a===void 0?null:a)}function li(s,e,i,a){var o=Uh();a=a===void 0?null:a;var c=void 0;if(N!==null){var d=N.memoizedState;if(c=d.destroy,a!==null&&Mh(a,d.deps)){o.memoizedState=bi(e,i,c,a);return}}M.flags|=s,o.memoizedState=bi(1|e,i,c,a)}function mi(s,e){return ki(8390656,8,s,e)}function $h(s,e){return li(2048,8,s,e)}function ni(s,e){return li(4,2,s,e)}function oi(s,e){return li(4,4,s,e)}function pi(s,e){if(typeof e=="function")return s=s(),e(s),function(){e(null)};if(e!=null)return s=s(),e.current=s,function(){e.current=null}}function qi(s,e,i){return i=i!=null?i.concat([s]):null,li(4,4,pi.bind(null,e,s),i)}function ri(){}function si(s,e){var i=Uh();e=e===void 0?null:e;var a=i.memoizedState;return a!==null&&e!==null&&Mh(e,a[1])?a[0]:(i.memoizedState=[s,e],s)}function ti(s,e){var i=Uh();e=e===void 0?null:e;var a=i.memoizedState;return a!==null&&e!==null&&Mh(e,a[1])?a[0]:(s=s(),i.memoizedState=[s,e],s)}function ui(s,e,i){return Hh&21?(He(i,e)||(i=yc(),M.lanes|=i,rh|=i,s.baseState=!0),e):(s.baseState&&(s.baseState=!1,dh=!0),s.memoizedState=i)}function vi(s,e){var i=C;C=i!==0&&4>i?i:4,s(!0);var a=Gh.transition;Gh.transition={};try{s(!1),e()}finally{C=i,Gh.transition=a}}function wi(){return Uh().memoizedState}function xi(s,e,i){var a=yi(s);if(i={lane:a,action:i,hasEagerState:!1,eagerState:null,next:null},zi(s))Ai(e,i);else if(i=hh(s,e,i,a),i!==null){var o=R();gi(i,s,a,o),Bi(i,e,a)}}function ii(s,e,i){var a=yi(s),o={lane:a,action:i,hasEagerState:!1,eagerState:null,next:null};if(zi(s))Ai(e,o);else{var c=s.alternate;if(s.lanes===0&&(c===null||c.lanes===0)&&(c=e.lastRenderedReducer,c!==null))try{var d=e.lastRenderedState,g=c(d,i);if(o.hasEagerState=!0,o.eagerState=g,He(g,d)){var b=e.interleaved;b===null?(o.next=o,gh(e)):(o.next=b.next,b.next=o),e.interleaved=o;return}}catch{}finally{}i=hh(s,e,o,a),i!==null&&(o=R(),gi(i,s,a,o),Bi(i,e,a))}}function zi(s){var e=s.alternate;return s===M||e!==null&&e===M}function Ai(s,e){Jh=Ih=!0;var i=s.pending;i===null?e.next=e:(e.next=i.next,i.next=e),s.pending=e}function Bi(s,e,i){if(i&4194240){var a=e.lanes;a&=s.pendingLanes,i|=a,e.lanes=i,Cc(s,i)}}var Rh={readContext:eh,useCallback:P,useContext:P,useEffect:P,useImperativeHandle:P,useInsertionEffect:P,useLayoutEffect:P,useMemo:P,useReducer:P,useRef:P,useState:P,useDebugValue:P,useDeferredValue:P,useTransition:P,useMutableSource:P,useSyncExternalStore:P,useId:P,unstable_isNewReconciler:!1},Oh={readContext:eh,useCallback:function(s,e){return Th().memoizedState=[s,e===void 0?null:e],s},useContext:eh,useEffect:mi,useImperativeHandle:function(s,e,i){return i=i!=null?i.concat([s]):null,ki(4194308,4,pi.bind(null,e,s),i)},useLayoutEffect:function(s,e){return ki(4194308,4,s,e)},useInsertionEffect:function(s,e){return ki(4,2,s,e)},useMemo:function(s,e){var i=Th();return e=e===void 0?null:e,s=s(),i.memoizedState=[s,e],s},useReducer:function(s,e,i){var a=Th();return e=i!==void 0?i(e):e,a.memoizedState=a.baseState=e,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:e},a.queue=s,s=s.dispatch=xi.bind(null,M,s),[a.memoizedState,s]},useRef:function(s){var e=Th();return s={current:s},e.memoizedState=s},useState:hi,useDebugValue:ri,useDeferredValue:function(s){return Th().memoizedState=s},useTransition:function(){var s=hi(!1),e=s[0];return s=vi.bind(null,s[1]),Th().memoizedState=s,[e,s]},useMutableSource:function(){},useSyncExternalStore:function(s,e,i){var a=M,o=Th();if(I){if(i===void 0)throw Error(p(407));i=i()}else{if(i=e(),Q===null)throw Error(p(349));Hh&30||di(a,e,i)}o.memoizedState=i;var c={value:i,getSnapshot:e};return o.queue=c,mi(ai.bind(null,a,c,s),[s]),a.flags|=2048,bi(9,ci.bind(null,a,c,i,e),void 0,null),i},useId:function(){var s=Th(),e=Q.identifierPrefix;if(I){var i=sg,a=rg;i=(a&~(1<<32-oc(a)-1)).toString(32)+i,e=":"+e+"R"+i,i=Kh++,0<i&&(e+="H"+i.toString(32)),e+=":"}else i=Lh++,e=":"+e+"r"+i.toString(32)+":";return s.memoizedState=e},unstable_isNewReconciler:!1},Ph={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Wh,useRef:ji,useState:function(){return Wh(Vh)},useDebugValue:ri,useDeferredValue:function(s){var e=Uh();return ui(e,N.memoizedState,s)},useTransition:function(){var s=Wh(Vh)[0],e=Uh().memoizedState;return[s,e]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1},Qh={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Xh,useRef:ji,useState:function(){return Xh(Vh)},useDebugValue:ri,useDeferredValue:function(s){var e=Uh();return N===null?e.memoizedState=s:ui(e,N.memoizedState,s)},useTransition:function(){var s=Xh(Vh)[0],e=Uh().memoizedState;return[s,e]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1};function Ci(s,e){if(s&&s.defaultProps){e=A({},e),s=s.defaultProps;for(var i in s)e[i]===void 0&&(e[i]=s[i]);return e}return e}function Di(s,e,i,a){e=s.memoizedState,i=i(a,e),i=i==null?e:A({},e,i),s.memoizedState=i,s.lanes===0&&(s.updateQueue.baseState=i)}var Ei={isMounted:function(s){return(s=s._reactInternals)?Vb(s)===s:!1},enqueueSetState:function(s,e,i){s=s._reactInternals;var a=R(),o=yi(s),c=mh(a,o);c.payload=e,i!=null&&(c.callback=i),e=nh(s,c,o),e!==null&&(gi(e,s,o,a),oh(e,s,o))},enqueueReplaceState:function(s,e,i){s=s._reactInternals;var a=R(),o=yi(s),c=mh(a,o);c.tag=1,c.payload=e,i!=null&&(c.callback=i),e=nh(s,c,o),e!==null&&(gi(e,s,o,a),oh(e,s,o))},enqueueForceUpdate:function(s,e){s=s._reactInternals;var i=R(),a=yi(s),o=mh(i,a);o.tag=2,e!=null&&(o.callback=e),e=nh(s,o,a),e!==null&&(gi(e,s,a,i),oh(e,s,a))}};function Fi(s,e,i,a,o,c,d){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(a,c,d):e.prototype&&e.prototype.isPureReactComponent?!Ie(i,a)||!Ie(o,c):!0}function Gi(s,e,i){var a=!1,o=Vf,c=e.contextType;return typeof c=="object"&&c!==null?c=eh(c):(o=Zf(e)?Xf:H.current,a=e.contextTypes,c=(a=a!=null)?Yf(s,o):Vf),e=new e(i,c),s.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Ei,s.stateNode=e,e._reactInternals=s,a&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=o,s.__reactInternalMemoizedMaskedChildContext=c),e}function Hi(s,e,i,a){s=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(i,a),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(i,a),e.state!==s&&Ei.enqueueReplaceState(e,e.state,null)}function Ii(s,e,i,a){var o=s.stateNode;o.props=i,o.state=s.memoizedState,o.refs={},kh(s);var c=e.contextType;typeof c=="object"&&c!==null?o.context=eh(c):(c=Zf(e)?Xf:H.current,o.context=Yf(s,c)),o.state=s.memoizedState,c=e.getDerivedStateFromProps,typeof c=="function"&&(Di(s,e,c,i),o.state=s.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(e=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),e!==o.state&&Ei.enqueueReplaceState(o,o.state,null),qh(s,i,o,a),o.state=s.memoizedState),typeof o.componentDidMount=="function"&&(s.flags|=4194308)}function Ji(s,e){try{var i="",a=e;do i+=Pa(a),a=a.return;while(a);var o=i}catch(c){o=`
Error generating stack: `+c.message+`
`+c.stack}return{value:s,source:e,stack:o,digest:null}}function Ki(s,e,i){return{value:s,source:null,stack:i??null,digest:e??null}}function Li(s,e){try{console.error(e.value)}catch(i){setTimeout(function(){throw i})}}var Mi=typeof WeakMap=="function"?WeakMap:Map;function Ni(s,e,i){i=mh(-1,i),i.tag=3,i.payload={element:null};var a=e.value;return i.callback=function(){Oi||(Oi=!0,Pi=a),Li(s,e)},i}function Qi(s,e,i){i=mh(-1,i),i.tag=3;var a=s.type.getDerivedStateFromError;if(typeof a=="function"){var o=e.value;i.payload=function(){return a(o)},i.callback=function(){Li(s,e)}}var c=s.stateNode;return c!==null&&typeof c.componentDidCatch=="function"&&(i.callback=function(){Li(s,e),typeof a!="function"&&(Ri===null?Ri=new Set([this]):Ri.add(this));var d=e.stack;this.componentDidCatch(e.value,{componentStack:d!==null?d:""})}),i}function Si(s,e,i){var a=s.pingCache;if(a===null){a=s.pingCache=new Mi;var o=new Set;a.set(e,o)}else o=a.get(e),o===void 0&&(o=new Set,a.set(e,o));o.has(i)||(o.add(i),s=Ti.bind(null,s,e,i),e.then(s,s))}function Ui(s){do{var e;if((e=s.tag===13)&&(e=s.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return s;s=s.return}while(s!==null);return null}function Vi(s,e,i,a,o){return s.mode&1?(s.flags|=65536,s.lanes=o,s):(s===e?s.flags|=65536:(s.flags|=128,i.flags|=131072,i.flags&=-52805,i.tag===1&&(i.alternate===null?i.tag=17:(e=mh(-1,1),e.tag=2,nh(i,e,1))),i.lanes|=1),s)}var Wi=ua.ReactCurrentOwner,dh=!1;function Xi(s,e,i,a){e.child=s===null?Vg(e,null,i,a):Ug(e,s.child,i,a)}function Yi(s,e,i,a,o){i=i.render;var c=e.ref;return ch(e,o),a=Nh(s,e,i,a,c,o),i=Sh(),s!==null&&!dh?(e.updateQueue=s.updateQueue,e.flags&=-2053,s.lanes&=~o,Zi(s,e,o)):(I&&i&&vg(e),e.flags|=1,Xi(s,e,a,o),e.child)}function $i(s,e,i,a,o){if(s===null){var c=i.type;return typeof c=="function"&&!aj(c)&&c.defaultProps===void 0&&i.compare===null&&i.defaultProps===void 0?(e.tag=15,e.type=c,bj(s,e,c,a,o)):(s=Rg(i.type,null,a,e,e.mode,o),s.ref=e.ref,s.return=e,e.child=s)}if(c=s.child,!(s.lanes&o)){var d=c.memoizedProps;if(i=i.compare,i=i!==null?i:Ie,i(d,a)&&s.ref===e.ref)return Zi(s,e,o)}return e.flags|=1,s=Pg(c,a),s.ref=e.ref,s.return=e,e.child=s}function bj(s,e,i,a,o){if(s!==null){var c=s.memoizedProps;if(Ie(c,a)&&s.ref===e.ref)if(dh=!1,e.pendingProps=a=c,(s.lanes&o)!==0)s.flags&131072&&(dh=!0);else return e.lanes=s.lanes,Zi(s,e,o)}return cj(s,e,i,a,o)}function dj(s,e,i){var a=e.pendingProps,o=a.children,c=s!==null?s.memoizedState:null;if(a.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},G(ej,fj),fj|=i;else{if(!(i&1073741824))return s=c!==null?c.baseLanes|i:i,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:s,cachePool:null,transitions:null},e.updateQueue=null,G(ej,fj),fj|=s,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},a=c!==null?c.baseLanes:i,G(ej,fj),fj|=a}else c!==null?(a=c.baseLanes|i,e.memoizedState=null):a=i,G(ej,fj),fj|=a;return Xi(s,e,o,i),e.child}function gj(s,e){var i=e.ref;(s===null&&i!==null||s!==null&&s.ref!==i)&&(e.flags|=512,e.flags|=2097152)}function cj(s,e,i,a,o){var c=Zf(i)?Xf:H.current;return c=Yf(e,c),ch(e,o),i=Nh(s,e,i,a,c,o),a=Sh(),s!==null&&!dh?(e.updateQueue=s.updateQueue,e.flags&=-2053,s.lanes&=~o,Zi(s,e,o)):(I&&a&&vg(e),e.flags|=1,Xi(s,e,i,o),e.child)}function hj(s,e,i,a,o){if(Zf(i)){var c=!0;cg(e)}else c=!1;if(ch(e,o),e.stateNode===null)ij(s,e),Gi(e,i,a),Ii(e,i,a,o),a=!0;else if(s===null){var d=e.stateNode,g=e.memoizedProps;d.props=g;var b=d.context,_=i.contextType;typeof _=="object"&&_!==null?_=eh(_):(_=Zf(i)?Xf:H.current,_=Yf(e,_));var j=i.getDerivedStateFromProps,$=typeof j=="function"||typeof d.getSnapshotBeforeUpdate=="function";$||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(g!==a||b!==_)&&Hi(e,d,a,_),jh=!1;var _e=e.memoizedState;d.state=_e,qh(e,a,d,o),b=e.memoizedState,g!==a||_e!==b||Wf.current||jh?(typeof j=="function"&&(Di(e,i,j,a),b=e.memoizedState),(g=jh||Fi(e,i,g,a,_e,b,_))?($||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount()),typeof d.componentDidMount=="function"&&(e.flags|=4194308)):(typeof d.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=a,e.memoizedState=b),d.props=a,d.state=b,d.context=_,a=g):(typeof d.componentDidMount=="function"&&(e.flags|=4194308),a=!1)}else{d=e.stateNode,lh(s,e),g=e.memoizedProps,_=e.type===e.elementType?g:Ci(e.type,g),d.props=_,$=e.pendingProps,_e=d.context,b=i.contextType,typeof b=="object"&&b!==null?b=eh(b):(b=Zf(i)?Xf:H.current,b=Yf(e,b));var tt=i.getDerivedStateFromProps;(j=typeof tt=="function"||typeof d.getSnapshotBeforeUpdate=="function")||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(g!==$||_e!==b)&&Hi(e,d,a,b),jh=!1,_e=e.memoizedState,d.state=_e,qh(e,a,d,o);var et=e.memoizedState;g!==$||_e!==et||Wf.current||jh?(typeof tt=="function"&&(Di(e,i,tt,a),et=e.memoizedState),(_=jh||Fi(e,i,_,a,_e,et,b)||!1)?(j||typeof d.UNSAFE_componentWillUpdate!="function"&&typeof d.componentWillUpdate!="function"||(typeof d.componentWillUpdate=="function"&&d.componentWillUpdate(a,et,b),typeof d.UNSAFE_componentWillUpdate=="function"&&d.UNSAFE_componentWillUpdate(a,et,b)),typeof d.componentDidUpdate=="function"&&(e.flags|=4),typeof d.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof d.componentDidUpdate!="function"||g===s.memoizedProps&&_e===s.memoizedState||(e.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||g===s.memoizedProps&&_e===s.memoizedState||(e.flags|=1024),e.memoizedProps=a,e.memoizedState=et),d.props=a,d.state=et,d.context=b,a=_):(typeof d.componentDidUpdate!="function"||g===s.memoizedProps&&_e===s.memoizedState||(e.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||g===s.memoizedProps&&_e===s.memoizedState||(e.flags|=1024),a=!1)}return jj(s,e,i,a,c,o)}function jj(s,e,i,a,o,c){gj(s,e);var d=(e.flags&128)!==0;if(!a&&!d)return o&&dg(e,i,!1),Zi(s,e,c);a=e.stateNode,Wi.current=e;var g=d&&typeof i.getDerivedStateFromError!="function"?null:a.render();return e.flags|=1,s!==null&&d?(e.child=Ug(e,s.child,null,c),e.child=Ug(e,null,g,c)):Xi(s,e,g,c),e.memoizedState=a.state,o&&dg(e,i,!0),e.child}function kj(s){var e=s.stateNode;e.pendingContext?ag(s,e.pendingContext,e.pendingContext!==e.context):e.context&&ag(s,e.context,!1),yh(s,e.containerInfo)}function lj(s,e,i,a,o){return Ig(),Jg(o),e.flags|=256,Xi(s,e,i,a),e.child}var mj={dehydrated:null,treeContext:null,retryLane:0};function nj(s){return{baseLanes:s,cachePool:null,transitions:null}}function oj(s,e,i){var a=e.pendingProps,o=L.current,c=!1,d=(e.flags&128)!==0,g;if((g=d)||(g=s!==null&&s.memoizedState===null?!1:(o&2)!==0),g?(c=!0,e.flags&=-129):(s===null||s.memoizedState!==null)&&(o|=1),G(L,o&1),s===null)return Eg(e),s=e.memoizedState,s!==null&&(s=s.dehydrated,s!==null)?(e.mode&1?s.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(d=a.children,s=a.fallback,c?(a=e.mode,c=e.child,d={mode:"hidden",children:d},!(a&1)&&c!==null?(c.childLanes=0,c.pendingProps=d):c=pj(d,a,0,null),s=Tg(s,a,i,null),c.return=e,s.return=e,c.sibling=s,e.child=c,e.child.memoizedState=nj(i),e.memoizedState=mj,s):qj(e,d));if(o=s.memoizedState,o!==null&&(g=o.dehydrated,g!==null))return rj(s,e,d,a,g,o,i);if(c){c=a.fallback,d=e.mode,o=s.child,g=o.sibling;var b={mode:"hidden",children:a.children};return!(d&1)&&e.child!==o?(a=e.child,a.childLanes=0,a.pendingProps=b,e.deletions=null):(a=Pg(o,b),a.subtreeFlags=o.subtreeFlags&14680064),g!==null?c=Pg(g,c):(c=Tg(c,d,i,null),c.flags|=2),c.return=e,a.return=e,a.sibling=c,e.child=a,a=c,c=e.child,d=s.child.memoizedState,d=d===null?nj(i):{baseLanes:d.baseLanes|i,cachePool:null,transitions:d.transitions},c.memoizedState=d,c.childLanes=s.childLanes&~i,e.memoizedState=mj,a}return c=s.child,s=c.sibling,a=Pg(c,{mode:"visible",children:a.children}),!(e.mode&1)&&(a.lanes=i),a.return=e,a.sibling=null,s!==null&&(i=e.deletions,i===null?(e.deletions=[s],e.flags|=16):i.push(s)),e.child=a,e.memoizedState=null,a}function qj(s,e){return e=pj({mode:"visible",children:e},s.mode,0,null),e.return=s,s.child=e}function sj(s,e,i,a){return a!==null&&Jg(a),Ug(e,s.child,null,i),s=qj(e,e.pendingProps.children),s.flags|=2,e.memoizedState=null,s}function rj(s,e,i,a,o,c,d){if(i)return e.flags&256?(e.flags&=-257,a=Ki(Error(p(422))),sj(s,e,d,a)):e.memoizedState!==null?(e.child=s.child,e.flags|=128,null):(c=a.fallback,o=e.mode,a=pj({mode:"visible",children:a.children},o,0,null),c=Tg(c,o,d,null),c.flags|=2,a.return=e,c.return=e,a.sibling=c,e.child=a,e.mode&1&&Ug(e,s.child,null,d),e.child.memoizedState=nj(d),e.memoizedState=mj,c);if(!(e.mode&1))return sj(s,e,d,null);if(o.data==="$!"){if(a=o.nextSibling&&o.nextSibling.dataset,a)var g=a.dgst;return a=g,c=Error(p(419)),a=Ki(c,a,void 0),sj(s,e,d,a)}if(g=(d&s.childLanes)!==0,dh||g){if(a=Q,a!==null){switch(d&-d){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}o=o&(a.suspendedLanes|d)?0:o,o!==0&&o!==c.retryLane&&(c.retryLane=o,ih(s,o),gi(a,s,o,-1))}return tj(),a=Ki(Error(p(421))),sj(s,e,d,a)}return o.data==="$?"?(e.flags|=128,e.child=s.child,e=uj.bind(null,s),o._reactRetry=e,null):(s=c.treeContext,yg=Lf(o.nextSibling),xg=e,I=!0,zg=null,s!==null&&(og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,rg=s.id,sg=s.overflow,qg=e),e=qj(e,a.children),e.flags|=4096,e)}function vj(s,e,i){s.lanes|=e;var a=s.alternate;a!==null&&(a.lanes|=e),bh(s.return,e,i)}function wj(s,e,i,a,o){var c=s.memoizedState;c===null?s.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:a,tail:i,tailMode:o}:(c.isBackwards=e,c.rendering=null,c.renderingStartTime=0,c.last=a,c.tail=i,c.tailMode=o)}function xj(s,e,i){var a=e.pendingProps,o=a.revealOrder,c=a.tail;if(Xi(s,e,a.children,i),a=L.current,a&2)a=a&1|2,e.flags|=128;else{if(s!==null&&s.flags&128)e:for(s=e.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&vj(s,i,e);else if(s.tag===19)vj(s,i,e);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===e)break e;for(;s.sibling===null;){if(s.return===null||s.return===e)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}a&=1}if(G(L,a),!(e.mode&1))e.memoizedState=null;else switch(o){case"forwards":for(i=e.child,o=null;i!==null;)s=i.alternate,s!==null&&Ch(s)===null&&(o=i),i=i.sibling;i=o,i===null?(o=e.child,e.child=null):(o=i.sibling,i.sibling=null),wj(e,!1,o,i,c);break;case"backwards":for(i=null,o=e.child,e.child=null;o!==null;){if(s=o.alternate,s!==null&&Ch(s)===null){e.child=o;break}s=o.sibling,o.sibling=i,i=o,o=s}wj(e,!0,i,null,c);break;case"together":wj(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function ij(s,e){!(e.mode&1)&&s!==null&&(s.alternate=null,e.alternate=null,e.flags|=2)}function Zi(s,e,i){if(s!==null&&(e.dependencies=s.dependencies),rh|=e.lanes,!(i&e.childLanes))return null;if(s!==null&&e.child!==s.child)throw Error(p(153));if(e.child!==null){for(s=e.child,i=Pg(s,s.pendingProps),e.child=i,i.return=e;s.sibling!==null;)s=s.sibling,i=i.sibling=Pg(s,s.pendingProps),i.return=e;i.sibling=null}return e.child}function yj(s,e,i){switch(e.tag){case 3:kj(e),Ig();break;case 5:Ah(e);break;case 1:Zf(e.type)&&cg(e);break;case 4:yh(e,e.stateNode.containerInfo);break;case 10:var a=e.type._context,o=e.memoizedProps.value;G(Wg,a._currentValue),a._currentValue=o;break;case 13:if(a=e.memoizedState,a!==null)return a.dehydrated!==null?(G(L,L.current&1),e.flags|=128,null):i&e.child.childLanes?oj(s,e,i):(G(L,L.current&1),s=Zi(s,e,i),s!==null?s.sibling:null);G(L,L.current&1);break;case 19:if(a=(i&e.childLanes)!==0,s.flags&128){if(a)return xj(s,e,i);e.flags|=128}if(o=e.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),G(L,L.current),a)break;return null;case 22:case 23:return e.lanes=0,dj(s,e,i)}return Zi(s,e,i)}var zj,Aj,Bj,Cj;zj=function(s,e){for(var i=e.child;i!==null;){if(i.tag===5||i.tag===6)s.appendChild(i.stateNode);else if(i.tag!==4&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===e)break;for(;i.sibling===null;){if(i.return===null||i.return===e)return;i=i.return}i.sibling.return=i.return,i=i.sibling}};Aj=function(){};Bj=function(s,e,i,a){var o=s.memoizedProps;if(o!==a){s=e.stateNode,xh(uh.current);var c=null;switch(i){case"input":o=Ya(s,o),a=Ya(s,a),c=[];break;case"select":o=A({},o,{value:void 0}),a=A({},a,{value:void 0}),c=[];break;case"textarea":o=gb(s,o),a=gb(s,a),c=[];break;default:typeof o.onClick!="function"&&typeof a.onClick=="function"&&(s.onclick=Bf)}ub(i,a);var d;i=null;for(_ in o)if(!a.hasOwnProperty(_)&&o.hasOwnProperty(_)&&o[_]!=null)if(_==="style"){var g=o[_];for(d in g)g.hasOwnProperty(d)&&(i||(i={}),i[d]="")}else _!=="dangerouslySetInnerHTML"&&_!=="children"&&_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&_!=="autoFocus"&&(ea.hasOwnProperty(_)?c||(c=[]):(c=c||[]).push(_,null));for(_ in a){var b=a[_];if(g=o!=null?o[_]:void 0,a.hasOwnProperty(_)&&b!==g&&(b!=null||g!=null))if(_==="style")if(g){for(d in g)!g.hasOwnProperty(d)||b&&b.hasOwnProperty(d)||(i||(i={}),i[d]="");for(d in b)b.hasOwnProperty(d)&&g[d]!==b[d]&&(i||(i={}),i[d]=b[d])}else i||(c||(c=[]),c.push(_,i)),i=b;else _==="dangerouslySetInnerHTML"?(b=b?b.__html:void 0,g=g?g.__html:void 0,b!=null&&g!==b&&(c=c||[]).push(_,b)):_==="children"?typeof b!="string"&&typeof b!="number"||(c=c||[]).push(_,""+b):_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&(ea.hasOwnProperty(_)?(b!=null&&_==="onScroll"&&D("scroll",s),c||g===b||(c=[])):(c=c||[]).push(_,b))}i&&(c=c||[]).push("style",i);var _=c;(e.updateQueue=_)&&(e.flags|=4)}};Cj=function(s,e,i,a){i!==a&&(e.flags|=4)};function Dj(s,e){if(!I)switch(s.tailMode){case"hidden":e=s.tail;for(var i=null;e!==null;)e.alternate!==null&&(i=e),e=e.sibling;i===null?s.tail=null:i.sibling=null;break;case"collapsed":i=s.tail;for(var a=null;i!==null;)i.alternate!==null&&(a=i),i=i.sibling;a===null?e||s.tail===null?s.tail=null:s.tail.sibling=null:a.sibling=null}}function S(s){var e=s.alternate!==null&&s.alternate.child===s.child,i=0,a=0;if(e)for(var o=s.child;o!==null;)i|=o.lanes|o.childLanes,a|=o.subtreeFlags&14680064,a|=o.flags&14680064,o.return=s,o=o.sibling;else for(o=s.child;o!==null;)i|=o.lanes|o.childLanes,a|=o.subtreeFlags,a|=o.flags,o.return=s,o=o.sibling;return s.subtreeFlags|=a,s.childLanes=i,e}function Ej(s,e,i){var a=e.pendingProps;switch(wg(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return S(e),null;case 1:return Zf(e.type)&&$f(),S(e),null;case 3:return a=e.stateNode,zh(),E(Wf),E(H),Eh(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(s===null||s.child===null)&&(Gg(e)?e.flags|=4:s===null||s.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,zg!==null&&(Fj(zg),zg=null))),Aj(s,e),S(e),null;case 5:Bh(e);var o=xh(wh.current);if(i=e.type,s!==null&&e.stateNode!=null)Bj(s,e,i,a,o),s.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!a){if(e.stateNode===null)throw Error(p(166));return S(e),null}if(s=xh(uh.current),Gg(e)){a=e.stateNode,i=e.type;var c=e.memoizedProps;switch(a[Of]=e,a[Pf]=c,s=(e.mode&1)!==0,i){case"dialog":D("cancel",a),D("close",a);break;case"iframe":case"object":case"embed":D("load",a);break;case"video":case"audio":for(o=0;o<lf.length;o++)D(lf[o],a);break;case"source":D("error",a);break;case"img":case"image":case"link":D("error",a),D("load",a);break;case"details":D("toggle",a);break;case"input":Za(a,c),D("invalid",a);break;case"select":a._wrapperState={wasMultiple:!!c.multiple},D("invalid",a);break;case"textarea":hb(a,c),D("invalid",a)}ub(i,c),o=null;for(var d in c)if(c.hasOwnProperty(d)){var g=c[d];d==="children"?typeof g=="string"?a.textContent!==g&&(c.suppressHydrationWarning!==!0&&Af(a.textContent,g,s),o=["children",g]):typeof g=="number"&&a.textContent!==""+g&&(c.suppressHydrationWarning!==!0&&Af(a.textContent,g,s),o=["children",""+g]):ea.hasOwnProperty(d)&&g!=null&&d==="onScroll"&&D("scroll",a)}switch(i){case"input":Va(a),db(a,c,!0);break;case"textarea":Va(a),jb(a);break;case"select":case"option":break;default:typeof c.onClick=="function"&&(a.onclick=Bf)}a=o,e.updateQueue=a,a!==null&&(e.flags|=4)}else{d=o.nodeType===9?o:o.ownerDocument,s==="http://www.w3.org/1999/xhtml"&&(s=kb(i)),s==="http://www.w3.org/1999/xhtml"?i==="script"?(s=d.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild)):typeof a.is=="string"?s=d.createElement(i,{is:a.is}):(s=d.createElement(i),i==="select"&&(d=s,a.multiple?d.multiple=!0:a.size&&(d.size=a.size))):s=d.createElementNS(s,i),s[Of]=e,s[Pf]=a,zj(s,e,!1,!1),e.stateNode=s;e:{switch(d=vb(i,a),i){case"dialog":D("cancel",s),D("close",s),o=a;break;case"iframe":case"object":case"embed":D("load",s),o=a;break;case"video":case"audio":for(o=0;o<lf.length;o++)D(lf[o],s);o=a;break;case"source":D("error",s),o=a;break;case"img":case"image":case"link":D("error",s),D("load",s),o=a;break;case"details":D("toggle",s),o=a;break;case"input":Za(s,a),o=Ya(s,a),D("invalid",s);break;case"option":o=a;break;case"select":s._wrapperState={wasMultiple:!!a.multiple},o=A({},a,{value:void 0}),D("invalid",s);break;case"textarea":hb(s,a),o=gb(s,a),D("invalid",s);break;default:o=a}ub(i,o),g=o;for(c in g)if(g.hasOwnProperty(c)){var b=g[c];c==="style"?sb(s,b):c==="dangerouslySetInnerHTML"?(b=b?b.__html:void 0,b!=null&&nb(s,b)):c==="children"?typeof b=="string"?(i!=="textarea"||b!=="")&&ob(s,b):typeof b=="number"&&ob(s,""+b):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(ea.hasOwnProperty(c)?b!=null&&c==="onScroll"&&D("scroll",s):b!=null&&ta(s,c,b,d))}switch(i){case"input":Va(s),db(s,a,!1);break;case"textarea":Va(s),jb(s);break;case"option":a.value!=null&&s.setAttribute("value",""+Sa(a.value));break;case"select":s.multiple=!!a.multiple,c=a.value,c!=null?fb(s,!!a.multiple,c,!1):a.defaultValue!=null&&fb(s,!!a.multiple,a.defaultValue,!0);break;default:typeof o.onClick=="function"&&(s.onclick=Bf)}switch(i){case"button":case"input":case"select":case"textarea":a=!!a.autoFocus;break e;case"img":a=!0;break e;default:a=!1}}a&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return S(e),null;case 6:if(s&&e.stateNode!=null)Cj(s,e,s.memoizedProps,a);else{if(typeof a!="string"&&e.stateNode===null)throw Error(p(166));if(i=xh(wh.current),xh(uh.current),Gg(e)){if(a=e.stateNode,i=e.memoizedProps,a[Of]=e,(c=a.nodeValue!==i)&&(s=xg,s!==null))switch(s.tag){case 3:Af(a.nodeValue,i,(s.mode&1)!==0);break;case 5:s.memoizedProps.suppressHydrationWarning!==!0&&Af(a.nodeValue,i,(s.mode&1)!==0)}c&&(e.flags|=4)}else a=(i.nodeType===9?i:i.ownerDocument).createTextNode(a),a[Of]=e,e.stateNode=a}return S(e),null;case 13:if(E(L),a=e.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(I&&yg!==null&&e.mode&1&&!(e.flags&128))Hg(),Ig(),e.flags|=98560,c=!1;else if(c=Gg(e),a!==null&&a.dehydrated!==null){if(s===null){if(!c)throw Error(p(318));if(c=e.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(p(317));c[Of]=e}else Ig(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;S(e),c=!1}else zg!==null&&(Fj(zg),zg=null),c=!0;if(!c)return e.flags&65536?e:null}return e.flags&128?(e.lanes=i,e):(a=a!==null,a!==(s!==null&&s.memoizedState!==null)&&a&&(e.child.flags|=8192,e.mode&1&&(s===null||L.current&1?T===0&&(T=3):tj())),e.updateQueue!==null&&(e.flags|=4),S(e),null);case 4:return zh(),Aj(s,e),s===null&&sf(e.stateNode.containerInfo),S(e),null;case 10:return ah(e.type._context),S(e),null;case 17:return Zf(e.type)&&$f(),S(e),null;case 19:if(E(L),c=e.memoizedState,c===null)return S(e),null;if(a=(e.flags&128)!==0,d=c.rendering,d===null)if(a)Dj(c,!1);else{if(T!==0||s!==null&&s.flags&128)for(s=e.child;s!==null;){if(d=Ch(s),d!==null){for(e.flags|=128,Dj(c,!1),a=d.updateQueue,a!==null&&(e.updateQueue=a,e.flags|=4),e.subtreeFlags=0,a=i,i=e.child;i!==null;)c=i,s=a,c.flags&=14680066,d=c.alternate,d===null?(c.childLanes=0,c.lanes=s,c.child=null,c.subtreeFlags=0,c.memoizedProps=null,c.memoizedState=null,c.updateQueue=null,c.dependencies=null,c.stateNode=null):(c.childLanes=d.childLanes,c.lanes=d.lanes,c.child=d.child,c.subtreeFlags=0,c.deletions=null,c.memoizedProps=d.memoizedProps,c.memoizedState=d.memoizedState,c.updateQueue=d.updateQueue,c.type=d.type,s=d.dependencies,c.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),i=i.sibling;return G(L,L.current&1|2),e.child}s=s.sibling}c.tail!==null&&B()>Gj&&(e.flags|=128,a=!0,Dj(c,!1),e.lanes=4194304)}else{if(!a)if(s=Ch(d),s!==null){if(e.flags|=128,a=!0,i=s.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),Dj(c,!0),c.tail===null&&c.tailMode==="hidden"&&!d.alternate&&!I)return S(e),null}else 2*B()-c.renderingStartTime>Gj&&i!==1073741824&&(e.flags|=128,a=!0,Dj(c,!1),e.lanes=4194304);c.isBackwards?(d.sibling=e.child,e.child=d):(i=c.last,i!==null?i.sibling=d:e.child=d,c.last=d)}return c.tail!==null?(e=c.tail,c.rendering=e,c.tail=e.sibling,c.renderingStartTime=B(),e.sibling=null,i=L.current,G(L,a?i&1|2:i&1),e):(S(e),null);case 22:case 23:return Hj(),a=e.memoizedState!==null,s!==null&&s.memoizedState!==null!==a&&(e.flags|=8192),a&&e.mode&1?fj&1073741824&&(S(e),e.subtreeFlags&6&&(e.flags|=8192)):S(e),null;case 24:return null;case 25:return null}throw Error(p(156,e.tag))}function Ij(s,e){switch(wg(e),e.tag){case 1:return Zf(e.type)&&$f(),s=e.flags,s&65536?(e.flags=s&-65537|128,e):null;case 3:return zh(),E(Wf),E(H),Eh(),s=e.flags,s&65536&&!(s&128)?(e.flags=s&-65537|128,e):null;case 5:return Bh(e),null;case 13:if(E(L),s=e.memoizedState,s!==null&&s.dehydrated!==null){if(e.alternate===null)throw Error(p(340));Ig()}return s=e.flags,s&65536?(e.flags=s&-65537|128,e):null;case 19:return E(L),null;case 4:return zh(),null;case 10:return ah(e.type._context),null;case 22:case 23:return Hj(),null;case 24:return null;default:return null}}var Jj=!1,U=!1,Kj=typeof WeakSet=="function"?WeakSet:Set,V=null;function Lj(s,e){var i=s.ref;if(i!==null)if(typeof i=="function")try{i(null)}catch(a){W(s,e,a)}else i.current=null}function Mj(s,e,i){try{i()}catch(a){W(s,e,a)}}var Nj=!1;function Oj(s,e){if(Cf=dd,s=Me(),Ne(s)){if("selectionStart"in s)var i={start:s.selectionStart,end:s.selectionEnd};else e:{i=(i=s.ownerDocument)&&i.defaultView||window;var a=i.getSelection&&i.getSelection();if(a&&a.rangeCount!==0){i=a.anchorNode;var o=a.anchorOffset,c=a.focusNode;a=a.focusOffset;try{i.nodeType,c.nodeType}catch{i=null;break e}var d=0,g=-1,b=-1,_=0,j=0,$=s,_e=null;t:for(;;){for(var tt;$!==i||o!==0&&$.nodeType!==3||(g=d+o),$!==c||a!==0&&$.nodeType!==3||(b=d+a),$.nodeType===3&&(d+=$.nodeValue.length),(tt=$.firstChild)!==null;)_e=$,$=tt;for(;;){if($===s)break t;if(_e===i&&++_===o&&(g=d),_e===c&&++j===a&&(b=d),(tt=$.nextSibling)!==null)break;$=_e,_e=$.parentNode}$=tt}i=g===-1||b===-1?null:{start:g,end:b}}else i=null}i=i||{start:0,end:0}}else i=null;for(Df={focusedElem:s,selectionRange:i},dd=!1,V=e;V!==null;)if(e=V,s=e.child,(e.subtreeFlags&1028)!==0&&s!==null)s.return=e,V=s;else for(;V!==null;){e=V;try{var et=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(et!==null){var st=et.memoizedProps,at=et.memoizedState,rt=e.stateNode,nt=rt.getSnapshotBeforeUpdate(e.elementType===e.type?st:Ci(e.type,st),at);rt.__reactInternalSnapshotBeforeUpdate=nt}break;case 3:var it=e.stateNode.containerInfo;it.nodeType===1?it.textContent="":it.nodeType===9&&it.documentElement&&it.removeChild(it.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(p(163))}}catch(ot){W(e,e.return,ot)}if(s=e.sibling,s!==null){s.return=e.return,V=s;break}V=e.return}return et=Nj,Nj=!1,et}function Pj(s,e,i){var a=e.updateQueue;if(a=a!==null?a.lastEffect:null,a!==null){var o=a=a.next;do{if((o.tag&s)===s){var c=o.destroy;o.destroy=void 0,c!==void 0&&Mj(e,i,c)}o=o.next}while(o!==a)}}function Qj(s,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var i=e=e.next;do{if((i.tag&s)===s){var a=i.create;i.destroy=a()}i=i.next}while(i!==e)}}function Rj(s){var e=s.ref;if(e!==null){var i=s.stateNode;switch(s.tag){case 5:s=i;break;default:s=i}typeof e=="function"?e(s):e.current=s}}function Sj(s){var e=s.alternate;e!==null&&(s.alternate=null,Sj(e)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(e=s.stateNode,e!==null&&(delete e[Of],delete e[Pf],delete e[of],delete e[Qf],delete e[Rf])),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function Tj(s){return s.tag===5||s.tag===3||s.tag===4}function Uj(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Tj(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Vj(s,e,i){var a=s.tag;if(a===5||a===6)s=s.stateNode,e?i.nodeType===8?i.parentNode.insertBefore(s,e):i.insertBefore(s,e):(i.nodeType===8?(e=i.parentNode,e.insertBefore(s,i)):(e=i,e.appendChild(s)),i=i._reactRootContainer,i!=null||e.onclick!==null||(e.onclick=Bf));else if(a!==4&&(s=s.child,s!==null))for(Vj(s,e,i),s=s.sibling;s!==null;)Vj(s,e,i),s=s.sibling}function Wj(s,e,i){var a=s.tag;if(a===5||a===6)s=s.stateNode,e?i.insertBefore(s,e):i.appendChild(s);else if(a!==4&&(s=s.child,s!==null))for(Wj(s,e,i),s=s.sibling;s!==null;)Wj(s,e,i),s=s.sibling}var X$1=null,Xj=!1;function Yj(s,e,i){for(i=i.child;i!==null;)Zj(s,e,i),i=i.sibling}function Zj(s,e,i){if(lc&&typeof lc.onCommitFiberUnmount=="function")try{lc.onCommitFiberUnmount(kc,i)}catch{}switch(i.tag){case 5:U||Lj(i,e);case 6:var a=X$1,o=Xj;X$1=null,Yj(s,e,i),X$1=a,Xj=o,X$1!==null&&(Xj?(s=X$1,i=i.stateNode,s.nodeType===8?s.parentNode.removeChild(i):s.removeChild(i)):X$1.removeChild(i.stateNode));break;case 18:X$1!==null&&(Xj?(s=X$1,i=i.stateNode,s.nodeType===8?Kf(s.parentNode,i):s.nodeType===1&&Kf(s,i),bd(s)):Kf(X$1,i.stateNode));break;case 4:a=X$1,o=Xj,X$1=i.stateNode.containerInfo,Xj=!0,Yj(s,e,i),X$1=a,Xj=o;break;case 0:case 11:case 14:case 15:if(!U&&(a=i.updateQueue,a!==null&&(a=a.lastEffect,a!==null))){o=a=a.next;do{var c=o,d=c.destroy;c=c.tag,d!==void 0&&(c&2||c&4)&&Mj(i,e,d),o=o.next}while(o!==a)}Yj(s,e,i);break;case 1:if(!U&&(Lj(i,e),a=i.stateNode,typeof a.componentWillUnmount=="function"))try{a.props=i.memoizedProps,a.state=i.memoizedState,a.componentWillUnmount()}catch(g){W(i,e,g)}Yj(s,e,i);break;case 21:Yj(s,e,i);break;case 22:i.mode&1?(U=(a=U)||i.memoizedState!==null,Yj(s,e,i),U=a):Yj(s,e,i);break;default:Yj(s,e,i)}}function ak(s){var e=s.updateQueue;if(e!==null){s.updateQueue=null;var i=s.stateNode;i===null&&(i=s.stateNode=new Kj),e.forEach(function(a){var o=bk.bind(null,s,a);i.has(a)||(i.add(a),a.then(o,o))})}}function ck(s,e){var i=e.deletions;if(i!==null)for(var a=0;a<i.length;a++){var o=i[a];try{var c=s,d=e,g=d;e:for(;g!==null;){switch(g.tag){case 5:X$1=g.stateNode,Xj=!1;break e;case 3:X$1=g.stateNode.containerInfo,Xj=!0;break e;case 4:X$1=g.stateNode.containerInfo,Xj=!0;break e}g=g.return}if(X$1===null)throw Error(p(160));Zj(c,d,o),X$1=null,Xj=!1;var b=o.alternate;b!==null&&(b.return=null),o.return=null}catch(_){W(o,e,_)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)dk(e,s),e=e.sibling}function dk(s,e){var i=s.alternate,a=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:if(ck(e,s),ek(s),a&4){try{Pj(3,s,s.return),Qj(3,s)}catch(st){W(s,s.return,st)}try{Pj(5,s,s.return)}catch(st){W(s,s.return,st)}}break;case 1:ck(e,s),ek(s),a&512&&i!==null&&Lj(i,i.return);break;case 5:if(ck(e,s),ek(s),a&512&&i!==null&&Lj(i,i.return),s.flags&32){var o=s.stateNode;try{ob(o,"")}catch(st){W(s,s.return,st)}}if(a&4&&(o=s.stateNode,o!=null)){var c=s.memoizedProps,d=i!==null?i.memoizedProps:c,g=s.type,b=s.updateQueue;if(s.updateQueue=null,b!==null)try{g==="input"&&c.type==="radio"&&c.name!=null&&ab(o,c),vb(g,d);var _=vb(g,c);for(d=0;d<b.length;d+=2){var j=b[d],$=b[d+1];j==="style"?sb(o,$):j==="dangerouslySetInnerHTML"?nb(o,$):j==="children"?ob(o,$):ta(o,j,$,_)}switch(g){case"input":bb(o,c);break;case"textarea":ib(o,c);break;case"select":var _e=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!c.multiple;var tt=c.value;tt!=null?fb(o,!!c.multiple,tt,!1):_e!==!!c.multiple&&(c.defaultValue!=null?fb(o,!!c.multiple,c.defaultValue,!0):fb(o,!!c.multiple,c.multiple?[]:"",!1))}o[Pf]=c}catch(st){W(s,s.return,st)}}break;case 6:if(ck(e,s),ek(s),a&4){if(s.stateNode===null)throw Error(p(162));o=s.stateNode,c=s.memoizedProps;try{o.nodeValue=c}catch(st){W(s,s.return,st)}}break;case 3:if(ck(e,s),ek(s),a&4&&i!==null&&i.memoizedState.isDehydrated)try{bd(e.containerInfo)}catch(st){W(s,s.return,st)}break;case 4:ck(e,s),ek(s);break;case 13:ck(e,s),ek(s),o=s.child,o.flags&8192&&(c=o.memoizedState!==null,o.stateNode.isHidden=c,!c||o.alternate!==null&&o.alternate.memoizedState!==null||(fk=B())),a&4&&ak(s);break;case 22:if(j=i!==null&&i.memoizedState!==null,s.mode&1?(U=(_=U)||j,ck(e,s),U=_):ck(e,s),ek(s),a&8192){if(_=s.memoizedState!==null,(s.stateNode.isHidden=_)&&!j&&s.mode&1)for(V=s,j=s.child;j!==null;){for($=V=j;V!==null;){switch(_e=V,tt=_e.child,_e.tag){case 0:case 11:case 14:case 15:Pj(4,_e,_e.return);break;case 1:Lj(_e,_e.return);var et=_e.stateNode;if(typeof et.componentWillUnmount=="function"){a=_e,i=_e.return;try{e=a,et.props=e.memoizedProps,et.state=e.memoizedState,et.componentWillUnmount()}catch(st){W(a,i,st)}}break;case 5:Lj(_e,_e.return);break;case 22:if(_e.memoizedState!==null){gk($);continue}}tt!==null?(tt.return=_e,V=tt):gk($)}j=j.sibling}e:for(j=null,$=s;;){if($.tag===5){if(j===null){j=$;try{o=$.stateNode,_?(c=o.style,typeof c.setProperty=="function"?c.setProperty("display","none","important"):c.display="none"):(g=$.stateNode,b=$.memoizedProps.style,d=b!=null&&b.hasOwnProperty("display")?b.display:null,g.style.display=rb("display",d))}catch(st){W(s,s.return,st)}}}else if($.tag===6){if(j===null)try{$.stateNode.nodeValue=_?"":$.memoizedProps}catch(st){W(s,s.return,st)}}else if(($.tag!==22&&$.tag!==23||$.memoizedState===null||$===s)&&$.child!==null){$.child.return=$,$=$.child;continue}if($===s)break e;for(;$.sibling===null;){if($.return===null||$.return===s)break e;j===$&&(j=null),$=$.return}j===$&&(j=null),$.sibling.return=$.return,$=$.sibling}}break;case 19:ck(e,s),ek(s),a&4&&ak(s);break;case 21:break;default:ck(e,s),ek(s)}}function ek(s){var e=s.flags;if(e&2){try{e:{for(var i=s.return;i!==null;){if(Tj(i)){var a=i;break e}i=i.return}throw Error(p(160))}switch(a.tag){case 5:var o=a.stateNode;a.flags&32&&(ob(o,""),a.flags&=-33);var c=Uj(s);Wj(s,c,o);break;case 3:case 4:var d=a.stateNode.containerInfo,g=Uj(s);Vj(s,g,d);break;default:throw Error(p(161))}}catch(b){W(s,s.return,b)}s.flags&=-3}e&4096&&(s.flags&=-4097)}function hk(s,e,i){V=s,ik(s)}function ik(s,e,i){for(var a=(s.mode&1)!==0;V!==null;){var o=V,c=o.child;if(o.tag===22&&a){var d=o.memoizedState!==null||Jj;if(!d){var g=o.alternate,b=g!==null&&g.memoizedState!==null||U;g=Jj;var _=U;if(Jj=d,(U=b)&&!_)for(V=o;V!==null;)d=V,b=d.child,d.tag===22&&d.memoizedState!==null?jk(o):b!==null?(b.return=d,V=b):jk(o);for(;c!==null;)V=c,ik(c),c=c.sibling;V=o,Jj=g,U=_}kk(s)}else o.subtreeFlags&8772&&c!==null?(c.return=o,V=c):kk(s)}}function kk(s){for(;V!==null;){var e=V;if(e.flags&8772){var i=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:U||Qj(5,e);break;case 1:var a=e.stateNode;if(e.flags&4&&!U)if(i===null)a.componentDidMount();else{var o=e.elementType===e.type?i.memoizedProps:Ci(e.type,i.memoizedProps);a.componentDidUpdate(o,i.memoizedState,a.__reactInternalSnapshotBeforeUpdate)}var c=e.updateQueue;c!==null&&sh(e,c,a);break;case 3:var d=e.updateQueue;if(d!==null){if(i=null,e.child!==null)switch(e.child.tag){case 5:i=e.child.stateNode;break;case 1:i=e.child.stateNode}sh(e,d,i)}break;case 5:var g=e.stateNode;if(i===null&&e.flags&4){i=g;var b=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":b.autoFocus&&i.focus();break;case"img":b.src&&(i.src=b.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var _=e.alternate;if(_!==null){var j=_.memoizedState;if(j!==null){var $=j.dehydrated;$!==null&&bd($)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(p(163))}U||e.flags&512&&Rj(e)}catch(_e){W(e,e.return,_e)}}if(e===s){V=null;break}if(i=e.sibling,i!==null){i.return=e.return,V=i;break}V=e.return}}function gk(s){for(;V!==null;){var e=V;if(e===s){V=null;break}var i=e.sibling;if(i!==null){i.return=e.return,V=i;break}V=e.return}}function jk(s){for(;V!==null;){var e=V;try{switch(e.tag){case 0:case 11:case 15:var i=e.return;try{Qj(4,e)}catch(b){W(e,i,b)}break;case 1:var a=e.stateNode;if(typeof a.componentDidMount=="function"){var o=e.return;try{a.componentDidMount()}catch(b){W(e,o,b)}}var c=e.return;try{Rj(e)}catch(b){W(e,c,b)}break;case 5:var d=e.return;try{Rj(e)}catch(b){W(e,d,b)}}}catch(b){W(e,e.return,b)}if(e===s){V=null;break}var g=e.sibling;if(g!==null){g.return=e.return,V=g;break}V=e.return}}var lk=Math.ceil,mk=ua.ReactCurrentDispatcher,nk=ua.ReactCurrentOwner,ok=ua.ReactCurrentBatchConfig,K=0,Q=null,Y=null,Z=0,fj=0,ej=Uf(0),T=0,pk=null,rh=0,qk=0,rk=0,sk=null,tk=null,fk=0,Gj=1/0,uk=null,Oi=!1,Pi=null,Ri=null,vk=!1,wk=null,xk=0,yk=0,zk=null,Ak=-1,Bk=0;function R(){return K&6?B():Ak!==-1?Ak:Ak=B()}function yi(s){return s.mode&1?K&2&&Z!==0?Z&-Z:Kg.transition!==null?(Bk===0&&(Bk=yc()),Bk):(s=C,s!==0||(s=window.event,s=s===void 0?16:jd(s.type)),s):1}function gi(s,e,i,a){if(50<yk)throw yk=0,zk=null,Error(p(185));Ac(s,i,a),(!(K&2)||s!==Q)&&(s===Q&&(!(K&2)&&(qk|=i),T===4&&Ck(s,Z)),Dk(s,a),i===1&&K===0&&!(e.mode&1)&&(Gj=B()+500,fg&&jg()))}function Dk(s,e){var i=s.callbackNode;wc(s,e);var a=uc(s,s===Q?Z:0);if(a===0)i!==null&&bc(i),s.callbackNode=null,s.callbackPriority=0;else if(e=a&-a,s.callbackPriority!==e){if(i!=null&&bc(i),e===1)s.tag===0?ig(Ek.bind(null,s)):hg(Ek.bind(null,s)),Jf(function(){!(K&6)&&jg()}),i=null;else{switch(Dc(a)){case 1:i=fc;break;case 4:i=gc;break;case 16:i=hc;break;case 536870912:i=jc;break;default:i=hc}i=Fk(i,Gk.bind(null,s))}s.callbackPriority=e,s.callbackNode=i}}function Gk(s,e){if(Ak=-1,Bk=0,K&6)throw Error(p(327));var i=s.callbackNode;if(Hk()&&s.callbackNode!==i)return null;var a=uc(s,s===Q?Z:0);if(a===0)return null;if(a&30||a&s.expiredLanes||e)e=Ik(s,a);else{e=a;var o=K;K|=2;var c=Jk();(Q!==s||Z!==e)&&(uk=null,Gj=B()+500,Kk(s,e));do try{Lk();break}catch(g){Mk(s,g)}while(!0);$g(),mk.current=c,K=o,Y!==null?e=0:(Q=null,Z=0,e=T)}if(e!==0){if(e===2&&(o=xc(s),o!==0&&(a=o,e=Nk(s,o))),e===1)throw i=pk,Kk(s,0),Ck(s,a),Dk(s,B()),i;if(e===6)Ck(s,a);else{if(o=s.current.alternate,!(a&30)&&!Ok(o)&&(e=Ik(s,a),e===2&&(c=xc(s),c!==0&&(a=c,e=Nk(s,c))),e===1))throw i=pk,Kk(s,0),Ck(s,a),Dk(s,B()),i;switch(s.finishedWork=o,s.finishedLanes=a,e){case 0:case 1:throw Error(p(345));case 2:Pk(s,tk,uk);break;case 3:if(Ck(s,a),(a&130023424)===a&&(e=fk+500-B(),10<e)){if(uc(s,0)!==0)break;if(o=s.suspendedLanes,(o&a)!==a){R(),s.pingedLanes|=s.suspendedLanes&o;break}s.timeoutHandle=Ff(Pk.bind(null,s,tk,uk),e);break}Pk(s,tk,uk);break;case 4:if(Ck(s,a),(a&4194240)===a)break;for(e=s.eventTimes,o=-1;0<a;){var d=31-oc(a);c=1<<d,d=e[d],d>o&&(o=d),a&=~c}if(a=o,a=B()-a,a=(120>a?120:480>a?480:1080>a?1080:1920>a?1920:3e3>a?3e3:4320>a?4320:1960*lk(a/1960))-a,10<a){s.timeoutHandle=Ff(Pk.bind(null,s,tk,uk),a);break}Pk(s,tk,uk);break;case 5:Pk(s,tk,uk);break;default:throw Error(p(329))}}}return Dk(s,B()),s.callbackNode===i?Gk.bind(null,s):null}function Nk(s,e){var i=sk;return s.current.memoizedState.isDehydrated&&(Kk(s,e).flags|=256),s=Ik(s,e),s!==2&&(e=tk,tk=i,e!==null&&Fj(e)),s}function Fj(s){tk===null?tk=s:tk.push.apply(tk,s)}function Ok(s){for(var e=s;;){if(e.flags&16384){var i=e.updateQueue;if(i!==null&&(i=i.stores,i!==null))for(var a=0;a<i.length;a++){var o=i[a],c=o.getSnapshot;o=o.value;try{if(!He(c(),o))return!1}catch{return!1}}}if(i=e.child,e.subtreeFlags&16384&&i!==null)i.return=e,e=i;else{if(e===s)break;for(;e.sibling===null;){if(e.return===null||e.return===s)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ck(s,e){for(e&=~rk,e&=~qk,s.suspendedLanes|=e,s.pingedLanes&=~e,s=s.expirationTimes;0<e;){var i=31-oc(e),a=1<<i;s[i]=-1,e&=~a}}function Ek(s){if(K&6)throw Error(p(327));Hk();var e=uc(s,0);if(!(e&1))return Dk(s,B()),null;var i=Ik(s,e);if(s.tag!==0&&i===2){var a=xc(s);a!==0&&(e=a,i=Nk(s,a))}if(i===1)throw i=pk,Kk(s,0),Ck(s,e),Dk(s,B()),i;if(i===6)throw Error(p(345));return s.finishedWork=s.current.alternate,s.finishedLanes=e,Pk(s,tk,uk),Dk(s,B()),null}function Qk(s,e){var i=K;K|=1;try{return s(e)}finally{K=i,K===0&&(Gj=B()+500,fg&&jg())}}function Rk(s){wk!==null&&wk.tag===0&&!(K&6)&&Hk();var e=K;K|=1;var i=ok.transition,a=C;try{if(ok.transition=null,C=1,s)return s()}finally{C=a,ok.transition=i,K=e,!(K&6)&&jg()}}function Hj(){fj=ej.current,E(ej)}function Kk(s,e){s.finishedWork=null,s.finishedLanes=0;var i=s.timeoutHandle;if(i!==-1&&(s.timeoutHandle=-1,Gf(i)),Y!==null)for(i=Y.return;i!==null;){var a=i;switch(wg(a),a.tag){case 1:a=a.type.childContextTypes,a!=null&&$f();break;case 3:zh(),E(Wf),E(H),Eh();break;case 5:Bh(a);break;case 4:zh();break;case 13:E(L);break;case 19:E(L);break;case 10:ah(a.type._context);break;case 22:case 23:Hj()}i=i.return}if(Q=s,Y=s=Pg(s.current,null),Z=fj=e,T=0,pk=null,rk=qk=rh=0,tk=sk=null,fh!==null){for(e=0;e<fh.length;e++)if(i=fh[e],a=i.interleaved,a!==null){i.interleaved=null;var o=a.next,c=i.pending;if(c!==null){var d=c.next;c.next=o,a.next=d}i.pending=a}fh=null}return s}function Mk(s,e){do{var i=Y;try{if($g(),Fh.current=Rh,Ih){for(var a=M.memoizedState;a!==null;){var o=a.queue;o!==null&&(o.pending=null),a=a.next}Ih=!1}if(Hh=0,O=N=M=null,Jh=!1,Kh=0,nk.current=null,i===null||i.return===null){T=1,pk=e,Y=null;break}e:{var c=s,d=i.return,g=i,b=e;if(e=Z,g.flags|=32768,b!==null&&typeof b=="object"&&typeof b.then=="function"){var _=b,j=g,$=j.tag;if(!(j.mode&1)&&($===0||$===11||$===15)){var _e=j.alternate;_e?(j.updateQueue=_e.updateQueue,j.memoizedState=_e.memoizedState,j.lanes=_e.lanes):(j.updateQueue=null,j.memoizedState=null)}var tt=Ui(d);if(tt!==null){tt.flags&=-257,Vi(tt,d,g,c,e),tt.mode&1&&Si(c,_,e),e=tt,b=_;var et=e.updateQueue;if(et===null){var st=new Set;st.add(b),e.updateQueue=st}else et.add(b);break e}else{if(!(e&1)){Si(c,_,e),tj();break e}b=Error(p(426))}}else if(I&&g.mode&1){var at=Ui(d);if(at!==null){!(at.flags&65536)&&(at.flags|=256),Vi(at,d,g,c,e),Jg(Ji(b,g));break e}}c=b=Ji(b,g),T!==4&&(T=2),sk===null?sk=[c]:sk.push(c),c=d;do{switch(c.tag){case 3:c.flags|=65536,e&=-e,c.lanes|=e;var rt=Ni(c,b,e);ph(c,rt);break e;case 1:g=b;var nt=c.type,it=c.stateNode;if(!(c.flags&128)&&(typeof nt.getDerivedStateFromError=="function"||it!==null&&typeof it.componentDidCatch=="function"&&(Ri===null||!Ri.has(it)))){c.flags|=65536,e&=-e,c.lanes|=e;var ot=Qi(c,g,e);ph(c,ot);break e}}c=c.return}while(c!==null)}Sk(i)}catch(lt){e=lt,Y===i&&i!==null&&(Y=i=i.return);continue}break}while(!0)}function Jk(){var s=mk.current;return mk.current=Rh,s===null?Rh:s}function tj(){(T===0||T===3||T===2)&&(T=4),Q===null||!(rh&268435455)&&!(qk&268435455)||Ck(Q,Z)}function Ik(s,e){var i=K;K|=2;var a=Jk();(Q!==s||Z!==e)&&(uk=null,Kk(s,e));do try{Tk();break}catch(o){Mk(s,o)}while(!0);if($g(),K=i,mk.current=a,Y!==null)throw Error(p(261));return Q=null,Z=0,T}function Tk(){for(;Y!==null;)Uk(Y)}function Lk(){for(;Y!==null&&!cc();)Uk(Y)}function Uk(s){var e=Vk(s.alternate,s,fj);s.memoizedProps=s.pendingProps,e===null?Sk(s):Y=e,nk.current=null}function Sk(s){var e=s;do{var i=e.alternate;if(s=e.return,e.flags&32768){if(i=Ij(i,e),i!==null){i.flags&=32767,Y=i;return}if(s!==null)s.flags|=32768,s.subtreeFlags=0,s.deletions=null;else{T=6,Y=null;return}}else if(i=Ej(i,e,fj),i!==null){Y=i;return}if(e=e.sibling,e!==null){Y=e;return}Y=e=s}while(e!==null);T===0&&(T=5)}function Pk(s,e,i){var a=C,o=ok.transition;try{ok.transition=null,C=1,Wk(s,e,i,a)}finally{ok.transition=o,C=a}return null}function Wk(s,e,i,a){do Hk();while(wk!==null);if(K&6)throw Error(p(327));i=s.finishedWork;var o=s.finishedLanes;if(i===null)return null;if(s.finishedWork=null,s.finishedLanes=0,i===s.current)throw Error(p(177));s.callbackNode=null,s.callbackPriority=0;var c=i.lanes|i.childLanes;if(Bc(s,c),s===Q&&(Y=Q=null,Z=0),!(i.subtreeFlags&2064)&&!(i.flags&2064)||vk||(vk=!0,Fk(hc,function(){return Hk(),null})),c=(i.flags&15990)!==0,i.subtreeFlags&15990||c){c=ok.transition,ok.transition=null;var d=C;C=1;var g=K;K|=4,nk.current=null,Oj(s,i),dk(i,s),Oe(Df),dd=!!Cf,Df=Cf=null,s.current=i,hk(i),dc(),K=g,C=d,ok.transition=c}else s.current=i;if(vk&&(vk=!1,wk=s,xk=o),c=s.pendingLanes,c===0&&(Ri=null),mc(i.stateNode),Dk(s,B()),e!==null)for(a=s.onRecoverableError,i=0;i<e.length;i++)o=e[i],a(o.value,{componentStack:o.stack,digest:o.digest});if(Oi)throw Oi=!1,s=Pi,Pi=null,s;return xk&1&&s.tag!==0&&Hk(),c=s.pendingLanes,c&1?s===zk?yk++:(yk=0,zk=s):yk=0,jg(),null}function Hk(){if(wk!==null){var s=Dc(xk),e=ok.transition,i=C;try{if(ok.transition=null,C=16>s?16:s,wk===null)var a=!1;else{if(s=wk,wk=null,xk=0,K&6)throw Error(p(331));var o=K;for(K|=4,V=s.current;V!==null;){var c=V,d=c.child;if(V.flags&16){var g=c.deletions;if(g!==null){for(var b=0;b<g.length;b++){var _=g[b];for(V=_;V!==null;){var j=V;switch(j.tag){case 0:case 11:case 15:Pj(8,j,c)}var $=j.child;if($!==null)$.return=j,V=$;else for(;V!==null;){j=V;var _e=j.sibling,tt=j.return;if(Sj(j),j===_){V=null;break}if(_e!==null){_e.return=tt,V=_e;break}V=tt}}}var et=c.alternate;if(et!==null){var st=et.child;if(st!==null){et.child=null;do{var at=st.sibling;st.sibling=null,st=at}while(st!==null)}}V=c}}if(c.subtreeFlags&2064&&d!==null)d.return=c,V=d;else e:for(;V!==null;){if(c=V,c.flags&2048)switch(c.tag){case 0:case 11:case 15:Pj(9,c,c.return)}var rt=c.sibling;if(rt!==null){rt.return=c.return,V=rt;break e}V=c.return}}var nt=s.current;for(V=nt;V!==null;){d=V;var it=d.child;if(d.subtreeFlags&2064&&it!==null)it.return=d,V=it;else e:for(d=nt;V!==null;){if(g=V,g.flags&2048)try{switch(g.tag){case 0:case 11:case 15:Qj(9,g)}}catch(lt){W(g,g.return,lt)}if(g===d){V=null;break e}var ot=g.sibling;if(ot!==null){ot.return=g.return,V=ot;break e}V=g.return}}if(K=o,jg(),lc&&typeof lc.onPostCommitFiberRoot=="function")try{lc.onPostCommitFiberRoot(kc,s)}catch{}a=!0}return a}finally{C=i,ok.transition=e}}return!1}function Xk(s,e,i){e=Ji(i,e),e=Ni(s,e,1),s=nh(s,e,1),e=R(),s!==null&&(Ac(s,1,e),Dk(s,e))}function W(s,e,i){if(s.tag===3)Xk(s,s,i);else for(;e!==null;){if(e.tag===3){Xk(e,s,i);break}else if(e.tag===1){var a=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof a.componentDidCatch=="function"&&(Ri===null||!Ri.has(a))){s=Ji(i,s),s=Qi(e,s,1),e=nh(e,s,1),s=R(),e!==null&&(Ac(e,1,s),Dk(e,s));break}}e=e.return}}function Ti(s,e,i){var a=s.pingCache;a!==null&&a.delete(e),e=R(),s.pingedLanes|=s.suspendedLanes&i,Q===s&&(Z&i)===i&&(T===4||T===3&&(Z&130023424)===Z&&500>B()-fk?Kk(s,0):rk|=i),Dk(s,e)}function Yk(s,e){e===0&&(s.mode&1?(e=sc,sc<<=1,!(sc&130023424)&&(sc=4194304)):e=1);var i=R();s=ih(s,e),s!==null&&(Ac(s,e,i),Dk(s,i))}function uj(s){var e=s.memoizedState,i=0;e!==null&&(i=e.retryLane),Yk(s,i)}function bk(s,e){var i=0;switch(s.tag){case 13:var a=s.stateNode,o=s.memoizedState;o!==null&&(i=o.retryLane);break;case 19:a=s.stateNode;break;default:throw Error(p(314))}a!==null&&a.delete(e),Yk(s,i)}var Vk;Vk=function(s,e,i){if(s!==null)if(s.memoizedProps!==e.pendingProps||Wf.current)dh=!0;else{if(!(s.lanes&i)&&!(e.flags&128))return dh=!1,yj(s,e,i);dh=!!(s.flags&131072)}else dh=!1,I&&e.flags&1048576&&ug(e,ng,e.index);switch(e.lanes=0,e.tag){case 2:var a=e.type;ij(s,e),s=e.pendingProps;var o=Yf(e,H.current);ch(e,i),o=Nh(null,e,a,s,o,i);var c=Sh();return e.flags|=1,typeof o=="object"&&o!==null&&typeof o.render=="function"&&o.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Zf(a)?(c=!0,cg(e)):c=!1,e.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,kh(e),o.updater=Ei,e.stateNode=o,o._reactInternals=e,Ii(e,a,s,i),e=jj(null,e,a,!0,c,i)):(e.tag=0,I&&c&&vg(e),Xi(null,e,o,i),e=e.child),e;case 16:a=e.elementType;e:{switch(ij(s,e),s=e.pendingProps,o=a._init,a=o(a._payload),e.type=a,o=e.tag=Zk(a),s=Ci(a,s),o){case 0:e=cj(null,e,a,s,i);break e;case 1:e=hj(null,e,a,s,i);break e;case 11:e=Yi(null,e,a,s,i);break e;case 14:e=$i(null,e,a,Ci(a.type,s),i);break e}throw Error(p(306,a,""))}return e;case 0:return a=e.type,o=e.pendingProps,o=e.elementType===a?o:Ci(a,o),cj(s,e,a,o,i);case 1:return a=e.type,o=e.pendingProps,o=e.elementType===a?o:Ci(a,o),hj(s,e,a,o,i);case 3:e:{if(kj(e),s===null)throw Error(p(387));a=e.pendingProps,c=e.memoizedState,o=c.element,lh(s,e),qh(e,a,null,i);var d=e.memoizedState;if(a=d.element,c.isDehydrated)if(c={element:a,isDehydrated:!1,cache:d.cache,pendingSuspenseBoundaries:d.pendingSuspenseBoundaries,transitions:d.transitions},e.updateQueue.baseState=c,e.memoizedState=c,e.flags&256){o=Ji(Error(p(423)),e),e=lj(s,e,a,i,o);break e}else if(a!==o){o=Ji(Error(p(424)),e),e=lj(s,e,a,i,o);break e}else for(yg=Lf(e.stateNode.containerInfo.firstChild),xg=e,I=!0,zg=null,i=Vg(e,null,a,i),e.child=i;i;)i.flags=i.flags&-3|4096,i=i.sibling;else{if(Ig(),a===o){e=Zi(s,e,i);break e}Xi(s,e,a,i)}e=e.child}return e;case 5:return Ah(e),s===null&&Eg(e),a=e.type,o=e.pendingProps,c=s!==null?s.memoizedProps:null,d=o.children,Ef(a,o)?d=null:c!==null&&Ef(a,c)&&(e.flags|=32),gj(s,e),Xi(s,e,d,i),e.child;case 6:return s===null&&Eg(e),null;case 13:return oj(s,e,i);case 4:return yh(e,e.stateNode.containerInfo),a=e.pendingProps,s===null?e.child=Ug(e,null,a,i):Xi(s,e,a,i),e.child;case 11:return a=e.type,o=e.pendingProps,o=e.elementType===a?o:Ci(a,o),Yi(s,e,a,o,i);case 7:return Xi(s,e,e.pendingProps,i),e.child;case 8:return Xi(s,e,e.pendingProps.children,i),e.child;case 12:return Xi(s,e,e.pendingProps.children,i),e.child;case 10:e:{if(a=e.type._context,o=e.pendingProps,c=e.memoizedProps,d=o.value,G(Wg,a._currentValue),a._currentValue=d,c!==null)if(He(c.value,d)){if(c.children===o.children&&!Wf.current){e=Zi(s,e,i);break e}}else for(c=e.child,c!==null&&(c.return=e);c!==null;){var g=c.dependencies;if(g!==null){d=c.child;for(var b=g.firstContext;b!==null;){if(b.context===a){if(c.tag===1){b=mh(-1,i&-i),b.tag=2;var _=c.updateQueue;if(_!==null){_=_.shared;var j=_.pending;j===null?b.next=b:(b.next=j.next,j.next=b),_.pending=b}}c.lanes|=i,b=c.alternate,b!==null&&(b.lanes|=i),bh(c.return,i,e),g.lanes|=i;break}b=b.next}}else if(c.tag===10)d=c.type===e.type?null:c.child;else if(c.tag===18){if(d=c.return,d===null)throw Error(p(341));d.lanes|=i,g=d.alternate,g!==null&&(g.lanes|=i),bh(d,i,e),d=c.sibling}else d=c.child;if(d!==null)d.return=c;else for(d=c;d!==null;){if(d===e){d=null;break}if(c=d.sibling,c!==null){c.return=d.return,d=c;break}d=d.return}c=d}Xi(s,e,o.children,i),e=e.child}return e;case 9:return o=e.type,a=e.pendingProps.children,ch(e,i),o=eh(o),a=a(o),e.flags|=1,Xi(s,e,a,i),e.child;case 14:return a=e.type,o=Ci(a,e.pendingProps),o=Ci(a.type,o),$i(s,e,a,o,i);case 15:return bj(s,e,e.type,e.pendingProps,i);case 17:return a=e.type,o=e.pendingProps,o=e.elementType===a?o:Ci(a,o),ij(s,e),e.tag=1,Zf(a)?(s=!0,cg(e)):s=!1,ch(e,i),Gi(e,a,o),Ii(e,a,o,i),jj(null,e,a,!0,s,i);case 19:return xj(s,e,i);case 22:return dj(s,e,i)}throw Error(p(156,e.tag))};function Fk(s,e){return ac(s,e)}function $k(s,e,i,a){this.tag=s,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=a,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bg(s,e,i,a){return new $k(s,e,i,a)}function aj(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Zk(s){if(typeof s=="function")return aj(s)?1:0;if(s!=null){if(s=s.$$typeof,s===Da)return 11;if(s===Ga)return 14}return 2}function Pg(s,e){var i=s.alternate;return i===null?(i=Bg(s.tag,e,s.key,s.mode),i.elementType=s.elementType,i.type=s.type,i.stateNode=s.stateNode,i.alternate=s,s.alternate=i):(i.pendingProps=e,i.type=s.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=s.flags&14680064,i.childLanes=s.childLanes,i.lanes=s.lanes,i.child=s.child,i.memoizedProps=s.memoizedProps,i.memoizedState=s.memoizedState,i.updateQueue=s.updateQueue,e=s.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},i.sibling=s.sibling,i.index=s.index,i.ref=s.ref,i}function Rg(s,e,i,a,o,c){var d=2;if(a=s,typeof s=="function")aj(s)&&(d=1);else if(typeof s=="string")d=5;else e:switch(s){case ya:return Tg(i.children,o,c,e);case za:d=8,o|=8;break;case Aa:return s=Bg(12,i,e,o|2),s.elementType=Aa,s.lanes=c,s;case Ea:return s=Bg(13,i,e,o),s.elementType=Ea,s.lanes=c,s;case Fa:return s=Bg(19,i,e,o),s.elementType=Fa,s.lanes=c,s;case Ia:return pj(i,o,c,e);default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case Ba:d=10;break e;case Ca:d=9;break e;case Da:d=11;break e;case Ga:d=14;break e;case Ha:d=16,a=null;break e}throw Error(p(130,s==null?s:typeof s,""))}return e=Bg(d,i,e,o),e.elementType=s,e.type=a,e.lanes=c,e}function Tg(s,e,i,a){return s=Bg(7,s,a,e),s.lanes=i,s}function pj(s,e,i,a){return s=Bg(22,s,a,e),s.elementType=Ia,s.lanes=i,s.stateNode={isHidden:!1},s}function Qg(s,e,i){return s=Bg(6,s,null,e),s.lanes=i,s}function Sg(s,e,i){return e=Bg(4,s.children!==null?s.children:[],s.key,e),e.lanes=i,e.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},e}function al(s,e,i,a,o){this.tag=e,this.containerInfo=s,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zc(0),this.expirationTimes=zc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zc(0),this.identifierPrefix=a,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function bl(s,e,i,a,o,c,d,g,b){return s=new al(s,e,i,g,b),e===1?(e=1,c===!0&&(e|=8)):e=0,c=Bg(3,null,null,e),s.current=c,c.stateNode=s,c.memoizedState={element:a,isDehydrated:i,cache:null,transitions:null,pendingSuspenseBoundaries:null},kh(c),s}function cl(s,e,i){var a=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wa,key:a==null?null:""+a,children:s,containerInfo:e,implementation:i}}function dl(s){if(!s)return Vf;s=s._reactInternals;e:{if(Vb(s)!==s||s.tag!==1)throw Error(p(170));var e=s;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Zf(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(p(171))}if(s.tag===1){var i=s.type;if(Zf(i))return bg(s,i,e)}return e}function el(s,e,i,a,o,c,d,g,b){return s=bl(i,a,!0,s,o,c,d,g,b),s.context=dl(null),i=s.current,a=R(),o=yi(i),c=mh(a,o),c.callback=e??null,nh(i,c,o),s.current.lanes=o,Ac(s,o,a),Dk(s,a),s}function fl(s,e,i,a){var o=e.current,c=R(),d=yi(o);return i=dl(i),e.context===null?e.context=i:e.pendingContext=i,e=mh(c,d),e.payload={element:s},a=a===void 0?null:a,a!==null&&(e.callback=a),s=nh(o,e,d),s!==null&&(gi(s,o,d,c),oh(s,o,d)),d}function gl(s){if(s=s.current,!s.child)return null;switch(s.child.tag){case 5:return s.child.stateNode;default:return s.child.stateNode}}function hl(s,e){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var i=s.retryLane;s.retryLane=i!==0&&i<e?i:e}}function il(s,e){hl(s,e),(s=s.alternate)&&hl(s,e)}function jl(){return null}var kl=typeof reportError=="function"?reportError:function(s){console.error(s)};function ll(s){this._internalRoot=s}ml.prototype.render=ll.prototype.render=function(s){var e=this._internalRoot;if(e===null)throw Error(p(409));fl(s,e,null,null)};ml.prototype.unmount=ll.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var e=s.containerInfo;Rk(function(){fl(null,s,null,null)}),e[uf]=null}};function ml(s){this._internalRoot=s}ml.prototype.unstable_scheduleHydration=function(s){if(s){var e=Hc();s={blockedOn:null,target:s,priority:e};for(var i=0;i<Qc.length&&e!==0&&e<Qc[i].priority;i++);Qc.splice(i,0,s),i===0&&Vc(s)}};function nl(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function ol(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11&&(s.nodeType!==8||s.nodeValue!==" react-mount-point-unstable "))}function pl(){}function ql(s,e,i,a,o){if(o){if(typeof a=="function"){var c=a;a=function(){var _=gl(d);c.call(_)}}var d=el(e,a,s,0,null,!1,!1,"",pl);return s._reactRootContainer=d,s[uf]=d.current,sf(s.nodeType===8?s.parentNode:s),Rk(),d}for(;o=s.lastChild;)s.removeChild(o);if(typeof a=="function"){var g=a;a=function(){var _=gl(b);g.call(_)}}var b=bl(s,0,!1,null,null,!1,!1,"",pl);return s._reactRootContainer=b,s[uf]=b.current,sf(s.nodeType===8?s.parentNode:s),Rk(function(){fl(e,b,i,a)}),b}function rl(s,e,i,a,o){var c=i._reactRootContainer;if(c){var d=c;if(typeof o=="function"){var g=o;o=function(){var b=gl(d);g.call(b)}}fl(e,d,s,o)}else d=ql(i,e,s,o,a);return gl(d)}Ec=function(s){switch(s.tag){case 3:var e=s.stateNode;if(e.current.memoizedState.isDehydrated){var i=tc(e.pendingLanes);i!==0&&(Cc(e,i|1),Dk(e,B()),!(K&6)&&(Gj=B()+500,jg()))}break;case 13:Rk(function(){var a=ih(s,1);if(a!==null){var o=R();gi(a,s,1,o)}}),il(s,1)}};Fc=function(s){if(s.tag===13){var e=ih(s,134217728);if(e!==null){var i=R();gi(e,s,134217728,i)}il(s,134217728)}};Gc=function(s){if(s.tag===13){var e=yi(s),i=ih(s,e);if(i!==null){var a=R();gi(i,s,e,a)}il(s,e)}};Hc=function(){return C};Ic=function(s,e){var i=C;try{return C=s,e()}finally{C=i}};yb=function(s,e,i){switch(e){case"input":if(bb(s,i),e=i.name,i.type==="radio"&&e!=null){for(i=s;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<i.length;e++){var a=i[e];if(a!==s&&a.form===s.form){var o=Db(a);if(!o)throw Error(p(90));Wa(a),bb(a,o)}}}break;case"textarea":ib(s,i);break;case"select":e=i.value,e!=null&&fb(s,!!i.multiple,e,!1)}};Gb=Qk;Hb=Rk;var sl={usingClientEntryPoint:!1,Events:[Cb,ue,Db,Eb,Fb,Qk]},tl={findFiberByHostInstance:Wc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ul={bundleType:tl.bundleType,version:tl.version,rendererPackageName:tl.rendererPackageName,rendererConfig:tl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ua.ReactCurrentDispatcher,findHostInstanceByFiber:function(s){return s=Zb(s),s===null?null:s.stateNode},findFiberByHostInstance:tl.findFiberByHostInstance||jl,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vl.isDisabled&&vl.supportsFiber)try{kc=vl.inject(ul),lc=vl}catch{}}reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sl;reactDom_production_min.createPortal=function(s,e){var i=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!nl(e))throw Error(p(200));return cl(s,e,null,i)};reactDom_production_min.createRoot=function(s,e){if(!nl(s))throw Error(p(299));var i=!1,a="",o=kl;return e!=null&&(e.unstable_strictMode===!0&&(i=!0),e.identifierPrefix!==void 0&&(a=e.identifierPrefix),e.onRecoverableError!==void 0&&(o=e.onRecoverableError)),e=bl(s,1,!1,null,null,i,!1,a,o),s[uf]=e.current,sf(s.nodeType===8?s.parentNode:s),new ll(e)};reactDom_production_min.findDOMNode=function(s){if(s==null)return null;if(s.nodeType===1)return s;var e=s._reactInternals;if(e===void 0)throw typeof s.render=="function"?Error(p(188)):(s=Object.keys(s).join(","),Error(p(268,s)));return s=Zb(e),s=s===null?null:s.stateNode,s};reactDom_production_min.flushSync=function(s){return Rk(s)};reactDom_production_min.hydrate=function(s,e,i){if(!ol(e))throw Error(p(200));return rl(null,s,e,!0,i)};reactDom_production_min.hydrateRoot=function(s,e,i){if(!nl(s))throw Error(p(405));var a=i!=null&&i.hydratedSources||null,o=!1,c="",d=kl;if(i!=null&&(i.unstable_strictMode===!0&&(o=!0),i.identifierPrefix!==void 0&&(c=i.identifierPrefix),i.onRecoverableError!==void 0&&(d=i.onRecoverableError)),e=el(e,null,s,1,i??null,o,!1,c,d),s[uf]=e.current,sf(s),a)for(s=0;s<a.length;s++)i=a[s],o=i._getVersion,o=o(i._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[i,o]:e.mutableSourceEagerHydrationData.push(i,o);return new ml(e)};reactDom_production_min.render=function(s,e,i){if(!ol(e))throw Error(p(200));return rl(null,s,e,!1,i)};reactDom_production_min.unmountComponentAtNode=function(s){if(!ol(s))throw Error(p(40));return s._reactRootContainer?(Rk(function(){rl(null,null,s,!1,function(){s._reactRootContainer=null,s[uf]=null})}),!0):!1};reactDom_production_min.unstable_batchedUpdates=Qk;reactDom_production_min.unstable_renderSubtreeIntoContainer=function(s,e,i,a){if(!ol(i))throw Error(p(200));if(s==null||s._reactInternals===void 0)throw Error(p(38));return rl(s,e,i,!1,a)};reactDom_production_min.version="18.3.1-next-f1338f8080-20240426";function checkDCE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE)}catch(s){console.error(s)}}checkDCE(),reactDom.exports=reactDom_production_min;var reactDomExports=reactDom.exports,m=reactDomExports;client.createRoot=m.createRoot,client.hydrateRoot=m.hydrateRoot;const Config={api_url:"http://172.16.5.32:5001"};function bind(s,e){return function(){return s.apply(e,arguments)}}const{toString}=Object.prototype,{getPrototypeOf}=Object,{iterator,toStringTag}=Symbol,kindOf=(s=>e=>{const i=toString.call(e);return s[i]||(s[i]=i.slice(8,-1).toLowerCase())})(Object.create(null)),kindOfTest=s=>(s=s.toLowerCase(),e=>kindOf(e)===s),typeOfTest=s=>e=>typeof e===s,{isArray}=Array,isUndefined=typeOfTest("undefined");function isBuffer(s){return s!==null&&!isUndefined(s)&&s.constructor!==null&&!isUndefined(s.constructor)&&isFunction$1(s.constructor.isBuffer)&&s.constructor.isBuffer(s)}const isArrayBuffer=kindOfTest("ArrayBuffer");function isArrayBufferView$1(s){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(s):e=s&&s.buffer&&isArrayBuffer(s.buffer),e}const isString=typeOfTest("string"),isFunction$1=typeOfTest("function"),isNumber=typeOfTest("number"),isObject$1=s=>s!==null&&typeof s=="object",isBoolean=s=>s===!0||s===!1,isPlainObject=s=>{if(kindOf(s)!=="object")return!1;const e=getPrototypeOf(s);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(toStringTag in s)&&!(iterator in s)},isEmptyObject=s=>{if(!isObject$1(s)||isBuffer(s))return!1;try{return Object.keys(s).length===0&&Object.getPrototypeOf(s)===Object.prototype}catch{return!1}},isDate=kindOfTest("Date"),isFile=kindOfTest("File"),isBlob=kindOfTest("Blob"),isFileList=kindOfTest("FileList"),isStream=s=>isObject$1(s)&&isFunction$1(s.pipe),isFormData=s=>{let e;return s&&(typeof FormData=="function"&&s instanceof FormData||isFunction$1(s.append)&&((e=kindOf(s))==="formdata"||e==="object"&&isFunction$1(s.toString)&&s.toString()==="[object FormData]"))},isURLSearchParams=kindOfTest("URLSearchParams"),[isReadableStream,isRequest,isResponse,isHeaders]=["ReadableStream","Request","Response","Headers"].map(kindOfTest),trim=s=>s.trim?s.trim():s.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function forEach(s,e,{allOwnKeys:i=!1}={}){if(s===null||typeof s>"u")return;let a,o;if(typeof s!="object"&&(s=[s]),isArray(s))for(a=0,o=s.length;a<o;a++)e.call(null,s[a],a,s);else{if(isBuffer(s))return;const c=i?Object.getOwnPropertyNames(s):Object.keys(s),d=c.length;let g;for(a=0;a<d;a++)g=c[a],e.call(null,s[g],g,s)}}function findKey(s,e){if(isBuffer(s))return null;e=e.toLowerCase();const i=Object.keys(s);let a=i.length,o;for(;a-- >0;)if(o=i[a],e===o.toLowerCase())return o;return null}const _global=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,isContextDefined=s=>!isUndefined(s)&&s!==_global;function merge(){const{caseless:s,skipUndefined:e}=isContextDefined(this)&&this||{},i={},a=(o,c)=>{const d=s&&findKey(i,c)||c;isPlainObject(i[d])&&isPlainObject(o)?i[d]=merge(i[d],o):isPlainObject(o)?i[d]=merge({},o):isArray(o)?i[d]=o.slice():(!e||!isUndefined(o))&&(i[d]=o)};for(let o=0,c=arguments.length;o<c;o++)arguments[o]&&forEach(arguments[o],a);return i}const extend=(s,e,i,{allOwnKeys:a}={})=>(forEach(e,(o,c)=>{i&&isFunction$1(o)?s[c]=bind(o,i):s[c]=o},{allOwnKeys:a}),s),stripBOM=s=>(s.charCodeAt(0)===65279&&(s=s.slice(1)),s),inherits=(s,e,i,a)=>{s.prototype=Object.create(e.prototype,a),s.prototype.constructor=s,Object.defineProperty(s,"super",{value:e.prototype}),i&&Object.assign(s.prototype,i)},toFlatObject=(s,e,i,a)=>{let o,c,d;const g={};if(e=e||{},s==null)return e;do{for(o=Object.getOwnPropertyNames(s),c=o.length;c-- >0;)d=o[c],(!a||a(d,s,e))&&!g[d]&&(e[d]=s[d],g[d]=!0);s=i!==!1&&getPrototypeOf(s)}while(s&&(!i||i(s,e))&&s!==Object.prototype);return e},endsWith=(s,e,i)=>{s=String(s),(i===void 0||i>s.length)&&(i=s.length),i-=e.length;const a=s.indexOf(e,i);return a!==-1&&a===i},toArray=s=>{if(!s)return null;if(isArray(s))return s;let e=s.length;if(!isNumber(e))return null;const i=new Array(e);for(;e-- >0;)i[e]=s[e];return i},isTypedArray=(s=>e=>s&&e instanceof s)(typeof Uint8Array<"u"&&getPrototypeOf(Uint8Array)),forEachEntry=(s,e)=>{const a=(s&&s[iterator]).call(s);let o;for(;(o=a.next())&&!o.done;){const c=o.value;e.call(s,c[0],c[1])}},matchAll=(s,e)=>{let i;const a=[];for(;(i=s.exec(e))!==null;)a.push(i);return a},isHTMLForm=kindOfTest("HTMLFormElement"),toCamelCase$1=s=>s.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(i,a,o){return a.toUpperCase()+o}),hasOwnProperty=(({hasOwnProperty:s})=>(e,i)=>s.call(e,i))(Object.prototype),isRegExp=kindOfTest("RegExp"),reduceDescriptors=(s,e)=>{const i=Object.getOwnPropertyDescriptors(s),a={};forEach(i,(o,c)=>{let d;(d=e(o,c,s))!==!1&&(a[c]=d||o)}),Object.defineProperties(s,a)},freezeMethods=s=>{reduceDescriptors(s,(e,i)=>{if(isFunction$1(s)&&["arguments","caller","callee"].indexOf(i)!==-1)return!1;const a=s[i];if(isFunction$1(a)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+i+"'")})}})},toObjectSet=(s,e)=>{const i={},a=o=>{o.forEach(c=>{i[c]=!0})};return isArray(s)?a(s):a(String(s).split(e)),i},noop$2=()=>{},toFiniteNumber=(s,e)=>s!=null&&Number.isFinite(s=+s)?s:e;function isSpecCompliantForm(s){return!!(s&&isFunction$1(s.append)&&s[toStringTag]==="FormData"&&s[iterator])}const toJSONObject=s=>{const e=new Array(10),i=(a,o)=>{if(isObject$1(a)){if(e.indexOf(a)>=0)return;if(isBuffer(a))return a;if(!("toJSON"in a)){e[o]=a;const c=isArray(a)?[]:{};return forEach(a,(d,g)=>{const b=i(d,o+1);!isUndefined(b)&&(c[g]=b)}),e[o]=void 0,c}}return a};return i(s,0)},isAsyncFn=kindOfTest("AsyncFunction"),isThenable=s=>s&&(isObject$1(s)||isFunction$1(s))&&isFunction$1(s.then)&&isFunction$1(s.catch),_setImmediate=((s,e)=>s?setImmediate:e?((i,a)=>(_global.addEventListener("message",({source:o,data:c})=>{o===_global&&c===i&&a.length&&a.shift()()},!1),o=>{a.push(o),_global.postMessage(i,"*")}))(`axios@${Math.random()}`,[]):i=>setTimeout(i))(typeof setImmediate=="function",isFunction$1(_global.postMessage)),asap=typeof queueMicrotask<"u"?queueMicrotask.bind(_global):typeof process<"u"&&process.nextTick||_setImmediate,isIterable=s=>s!=null&&isFunction$1(s[iterator]),utils$1={isArray,isArrayBuffer,isBuffer,isFormData,isArrayBufferView:isArrayBufferView$1,isString,isNumber,isBoolean,isObject:isObject$1,isPlainObject,isEmptyObject,isReadableStream,isRequest,isResponse,isHeaders,isUndefined,isDate,isFile,isBlob,isRegExp,isFunction:isFunction$1,isStream,isURLSearchParams,isTypedArray,isFileList,forEach,merge,extend,trim,stripBOM,inherits,toFlatObject,kindOf,kindOfTest,endsWith,toArray,forEachEntry,matchAll,isHTMLForm,hasOwnProperty,hasOwnProp:hasOwnProperty,reduceDescriptors,freezeMethods,toObjectSet,toCamelCase:toCamelCase$1,noop:noop$2,toFiniteNumber,findKey,global:_global,isContextDefined,isSpecCompliantForm,toJSONObject,isAsyncFn,isThenable,setImmediate:_setImmediate,asap,isIterable};function AxiosError$1(s,e,i,a,o){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=s,this.name="AxiosError",e&&(this.code=e),i&&(this.config=i),a&&(this.request=a),o&&(this.response=o,this.status=o.status?o.status:null)}utils$1.inherits(AxiosError$1,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:utils$1.toJSONObject(this.config),code:this.code,status:this.status}}});const prototype$1=AxiosError$1.prototype,descriptors={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(s=>{descriptors[s]={value:s}});Object.defineProperties(AxiosError$1,descriptors);Object.defineProperty(prototype$1,"isAxiosError",{value:!0});AxiosError$1.from=(s,e,i,a,o,c)=>{const d=Object.create(prototype$1);utils$1.toFlatObject(s,d,function(j){return j!==Error.prototype},_=>_!=="isAxiosError");const g=s&&s.message?s.message:"Error",b=e==null&&s?s.code:e;return AxiosError$1.call(d,g,b,i,a,o),s&&d.cause==null&&Object.defineProperty(d,"cause",{value:s,configurable:!0}),d.name=s&&s.name||"Error",c&&Object.assign(d,c),d};const httpAdapter=null;function isVisitable(s){return utils$1.isPlainObject(s)||utils$1.isArray(s)}function removeBrackets(s){return utils$1.endsWith(s,"[]")?s.slice(0,-2):s}function renderKey(s,e,i){return s?s.concat(e).map(function(o,c){return o=removeBrackets(o),!i&&c?"["+o+"]":o}).join(i?".":""):e}function isFlatArray(s){return utils$1.isArray(s)&&!s.some(isVisitable)}const predicates=utils$1.toFlatObject(utils$1,{},null,function(e){return/^is[A-Z]/.test(e)});function toFormData$1(s,e,i){if(!utils$1.isObject(s))throw new TypeError("target must be an object");e=e||new FormData,i=utils$1.toFlatObject(i,{metaTokens:!0,dots:!1,indexes:!1},!1,function(st,at){return!utils$1.isUndefined(at[st])});const a=i.metaTokens,o=i.visitor||j,c=i.dots,d=i.indexes,b=(i.Blob||typeof Blob<"u"&&Blob)&&utils$1.isSpecCompliantForm(e);if(!utils$1.isFunction(o))throw new TypeError("visitor must be a function");function _(et){if(et===null)return"";if(utils$1.isDate(et))return et.toISOString();if(utils$1.isBoolean(et))return et.toString();if(!b&&utils$1.isBlob(et))throw new AxiosError$1("Blob is not supported. Use a Buffer instead.");return utils$1.isArrayBuffer(et)||utils$1.isTypedArray(et)?b&&typeof Blob=="function"?new Blob([et]):Buffer.from(et):et}function j(et,st,at){let rt=et;if(et&&!at&&typeof et=="object"){if(utils$1.endsWith(st,"{}"))st=a?st:st.slice(0,-2),et=JSON.stringify(et);else if(utils$1.isArray(et)&&isFlatArray(et)||(utils$1.isFileList(et)||utils$1.endsWith(st,"[]"))&&(rt=utils$1.toArray(et)))return st=removeBrackets(st),rt.forEach(function(it,ot){!(utils$1.isUndefined(it)||it===null)&&e.append(d===!0?renderKey([st],ot,c):d===null?st:st+"[]",_(it))}),!1}return isVisitable(et)?!0:(e.append(renderKey(at,st,c),_(et)),!1)}const $=[],_e=Object.assign(predicates,{defaultVisitor:j,convertValue:_,isVisitable});function tt(et,st){if(!utils$1.isUndefined(et)){if($.indexOf(et)!==-1)throw Error("Circular reference detected in "+st.join("."));$.push(et),utils$1.forEach(et,function(rt,nt){(!(utils$1.isUndefined(rt)||rt===null)&&o.call(e,rt,utils$1.isString(nt)?nt.trim():nt,st,_e))===!0&&tt(rt,st?st.concat(nt):[nt])}),$.pop()}}if(!utils$1.isObject(s))throw new TypeError("data must be an object");return tt(s),e}function encode$1(s){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(s).replace(/[!'()~]|%20|%00/g,function(a){return e[a]})}function AxiosURLSearchParams(s,e){this._pairs=[],s&&toFormData$1(s,this,e)}const prototype=AxiosURLSearchParams.prototype;prototype.append=function(e,i){this._pairs.push([e,i])};prototype.toString=function(e){const i=e?function(a){return e.call(this,a,encode$1)}:encode$1;return this._pairs.map(function(o){return i(o[0])+"="+i(o[1])},"").join("&")};function encode(s){return encodeURIComponent(s).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function buildURL(s,e,i){if(!e)return s;const a=i&&i.encode||encode;utils$1.isFunction(i)&&(i={serialize:i});const o=i&&i.serialize;let c;if(o?c=o(e,i):c=utils$1.isURLSearchParams(e)?e.toString():new AxiosURLSearchParams(e,i).toString(a),c){const d=s.indexOf("#");d!==-1&&(s=s.slice(0,d)),s+=(s.indexOf("?")===-1?"?":"&")+c}return s}class InterceptorManager{constructor(){this.handlers=[]}use(e,i,a){return this.handlers.push({fulfilled:e,rejected:i,synchronous:a?a.synchronous:!1,runWhen:a?a.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){utils$1.forEach(this.handlers,function(a){a!==null&&e(a)})}}const transitionalDefaults={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},URLSearchParams$1=typeof URLSearchParams<"u"?URLSearchParams:AxiosURLSearchParams,FormData$1=typeof FormData<"u"?FormData:null,Blob$1=typeof Blob<"u"?Blob:null,platform$1={isBrowser:!0,classes:{URLSearchParams:URLSearchParams$1,FormData:FormData$1,Blob:Blob$1},protocols:["http","https","file","blob","url","data"]},hasBrowserEnv=typeof window<"u"&&typeof document<"u",_navigator=typeof navigator=="object"&&navigator||void 0,hasStandardBrowserEnv=hasBrowserEnv&&(!_navigator||["ReactNative","NativeScript","NS"].indexOf(_navigator.product)<0),hasStandardBrowserWebWorkerEnv=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",origin=hasBrowserEnv&&window.location.href||"http://localhost",utils=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv,hasStandardBrowserEnv,hasStandardBrowserWebWorkerEnv,navigator:_navigator,origin},Symbol.toStringTag,{value:"Module"})),platform={...utils,...platform$1};function toURLEncodedForm(s,e){return toFormData$1(s,new platform.classes.URLSearchParams,{visitor:function(i,a,o,c){return platform.isNode&&utils$1.isBuffer(i)?(this.append(a,i.toString("base64")),!1):c.defaultVisitor.apply(this,arguments)},...e})}function parsePropPath(s){return utils$1.matchAll(/\w+|\[(\w*)]/g,s).map(e=>e[0]==="[]"?"":e[1]||e[0])}function arrayToObject(s){const e={},i=Object.keys(s);let a;const o=i.length;let c;for(a=0;a<o;a++)c=i[a],e[c]=s[c];return e}function formDataToJSON(s){function e(i,a,o,c){let d=i[c++];if(d==="__proto__")return!0;const g=Number.isFinite(+d),b=c>=i.length;return d=!d&&utils$1.isArray(o)?o.length:d,b?(utils$1.hasOwnProp(o,d)?o[d]=[o[d],a]:o[d]=a,!g):((!o[d]||!utils$1.isObject(o[d]))&&(o[d]=[]),e(i,a,o[d],c)&&utils$1.isArray(o[d])&&(o[d]=arrayToObject(o[d])),!g)}if(utils$1.isFormData(s)&&utils$1.isFunction(s.entries)){const i={};return utils$1.forEachEntry(s,(a,o)=>{e(parsePropPath(a),o,i,0)}),i}return null}function stringifySafely(s,e,i){if(utils$1.isString(s))try{return(e||JSON.parse)(s),utils$1.trim(s)}catch(a){if(a.name!=="SyntaxError")throw a}return(i||JSON.stringify)(s)}const defaults$1={transitional:transitionalDefaults,adapter:["xhr","http","fetch"],transformRequest:[function(e,i){const a=i.getContentType()||"",o=a.indexOf("application/json")>-1,c=utils$1.isObject(e);if(c&&utils$1.isHTMLForm(e)&&(e=new FormData(e)),utils$1.isFormData(e))return o?JSON.stringify(formDataToJSON(e)):e;if(utils$1.isArrayBuffer(e)||utils$1.isBuffer(e)||utils$1.isStream(e)||utils$1.isFile(e)||utils$1.isBlob(e)||utils$1.isReadableStream(e))return e;if(utils$1.isArrayBufferView(e))return e.buffer;if(utils$1.isURLSearchParams(e))return i.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let g;if(c){if(a.indexOf("application/x-www-form-urlencoded")>-1)return toURLEncodedForm(e,this.formSerializer).toString();if((g=utils$1.isFileList(e))||a.indexOf("multipart/form-data")>-1){const b=this.env&&this.env.FormData;return toFormData$1(g?{"files[]":e}:e,b&&new b,this.formSerializer)}}return c||o?(i.setContentType("application/json",!1),stringifySafely(e)):e}],transformResponse:[function(e){const i=this.transitional||defaults$1.transitional,a=i&&i.forcedJSONParsing,o=this.responseType==="json";if(utils$1.isResponse(e)||utils$1.isReadableStream(e))return e;if(e&&utils$1.isString(e)&&(a&&!this.responseType||o)){const d=!(i&&i.silentJSONParsing)&&o;try{return JSON.parse(e,this.parseReviver)}catch(g){if(d)throw g.name==="SyntaxError"?AxiosError$1.from(g,AxiosError$1.ERR_BAD_RESPONSE,this,null,this.response):g}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:platform.classes.FormData,Blob:platform.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};utils$1.forEach(["delete","get","head","post","put","patch"],s=>{defaults$1.headers[s]={}});const ignoreDuplicateOf=utils$1.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),parseHeaders=s=>{const e={};let i,a,o;return s&&s.split(`
`).forEach(function(d){o=d.indexOf(":"),i=d.substring(0,o).trim().toLowerCase(),a=d.substring(o+1).trim(),!(!i||e[i]&&ignoreDuplicateOf[i])&&(i==="set-cookie"?e[i]?e[i].push(a):e[i]=[a]:e[i]=e[i]?e[i]+", "+a:a)}),e},$internals=Symbol("internals");function normalizeHeader(s){return s&&String(s).trim().toLowerCase()}function normalizeValue(s){return s===!1||s==null?s:utils$1.isArray(s)?s.map(normalizeValue):String(s)}function parseTokens(s){const e=Object.create(null),i=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let a;for(;a=i.exec(s);)e[a[1]]=a[2];return e}const isValidHeaderName=s=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(s.trim());function matchHeaderValue(s,e,i,a,o){if(utils$1.isFunction(a))return a.call(this,e,i);if(o&&(e=i),!!utils$1.isString(e)){if(utils$1.isString(a))return e.indexOf(a)!==-1;if(utils$1.isRegExp(a))return a.test(e)}}function formatHeader(s){return s.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,i,a)=>i.toUpperCase()+a)}function buildAccessors(s,e){const i=utils$1.toCamelCase(" "+e);["get","set","has"].forEach(a=>{Object.defineProperty(s,a+i,{value:function(o,c,d){return this[a].call(this,e,o,c,d)},configurable:!0})})}let AxiosHeaders$1=class{constructor(e){e&&this.set(e)}set(e,i,a){const o=this;function c(g,b,_){const j=normalizeHeader(b);if(!j)throw new Error("header name must be a non-empty string");const $=utils$1.findKey(o,j);(!$||o[$]===void 0||_===!0||_===void 0&&o[$]!==!1)&&(o[$||b]=normalizeValue(g))}const d=(g,b)=>utils$1.forEach(g,(_,j)=>c(_,j,b));if(utils$1.isPlainObject(e)||e instanceof this.constructor)d(e,i);else if(utils$1.isString(e)&&(e=e.trim())&&!isValidHeaderName(e))d(parseHeaders(e),i);else if(utils$1.isObject(e)&&utils$1.isIterable(e)){let g={},b,_;for(const j of e){if(!utils$1.isArray(j))throw TypeError("Object iterator must return a key-value pair");g[_=j[0]]=(b=g[_])?utils$1.isArray(b)?[...b,j[1]]:[b,j[1]]:j[1]}d(g,i)}else e!=null&&c(i,e,a);return this}get(e,i){if(e=normalizeHeader(e),e){const a=utils$1.findKey(this,e);if(a){const o=this[a];if(!i)return o;if(i===!0)return parseTokens(o);if(utils$1.isFunction(i))return i.call(this,o,a);if(utils$1.isRegExp(i))return i.exec(o);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,i){if(e=normalizeHeader(e),e){const a=utils$1.findKey(this,e);return!!(a&&this[a]!==void 0&&(!i||matchHeaderValue(this,this[a],a,i)))}return!1}delete(e,i){const a=this;let o=!1;function c(d){if(d=normalizeHeader(d),d){const g=utils$1.findKey(a,d);g&&(!i||matchHeaderValue(a,a[g],g,i))&&(delete a[g],o=!0)}}return utils$1.isArray(e)?e.forEach(c):c(e),o}clear(e){const i=Object.keys(this);let a=i.length,o=!1;for(;a--;){const c=i[a];(!e||matchHeaderValue(this,this[c],c,e,!0))&&(delete this[c],o=!0)}return o}normalize(e){const i=this,a={};return utils$1.forEach(this,(o,c)=>{const d=utils$1.findKey(a,c);if(d){i[d]=normalizeValue(o),delete i[c];return}const g=e?formatHeader(c):String(c).trim();g!==c&&delete i[c],i[g]=normalizeValue(o),a[g]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const i=Object.create(null);return utils$1.forEach(this,(a,o)=>{a!=null&&a!==!1&&(i[o]=e&&utils$1.isArray(a)?a.join(", "):a)}),i}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,i])=>e+": "+i).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...i){const a=new this(e);return i.forEach(o=>a.set(o)),a}static accessor(e){const a=(this[$internals]=this[$internals]={accessors:{}}).accessors,o=this.prototype;function c(d){const g=normalizeHeader(d);a[g]||(buildAccessors(o,d),a[g]=!0)}return utils$1.isArray(e)?e.forEach(c):c(e),this}};AxiosHeaders$1.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);utils$1.reduceDescriptors(AxiosHeaders$1.prototype,({value:s},e)=>{let i=e[0].toUpperCase()+e.slice(1);return{get:()=>s,set(a){this[i]=a}}});utils$1.freezeMethods(AxiosHeaders$1);function transformData(s,e){const i=this||defaults$1,a=e||i,o=AxiosHeaders$1.from(a.headers);let c=a.data;return utils$1.forEach(s,function(g){c=g.call(i,c,o.normalize(),e?e.status:void 0)}),o.normalize(),c}function isCancel$1(s){return!!(s&&s.__CANCEL__)}function CanceledError$1(s,e,i){AxiosError$1.call(this,s??"canceled",AxiosError$1.ERR_CANCELED,e,i),this.name="CanceledError"}utils$1.inherits(CanceledError$1,AxiosError$1,{__CANCEL__:!0});function settle(s,e,i){const a=i.config.validateStatus;!i.status||!a||a(i.status)?s(i):e(new AxiosError$1("Request failed with status code "+i.status,[AxiosError$1.ERR_BAD_REQUEST,AxiosError$1.ERR_BAD_RESPONSE][Math.floor(i.status/100)-4],i.config,i.request,i))}function parseProtocol(s){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(s);return e&&e[1]||""}function speedometer(s,e){s=s||10;const i=new Array(s),a=new Array(s);let o=0,c=0,d;return e=e!==void 0?e:1e3,function(b){const _=Date.now(),j=a[c];d||(d=_),i[o]=b,a[o]=_;let $=c,_e=0;for(;$!==o;)_e+=i[$++],$=$%s;if(o=(o+1)%s,o===c&&(c=(c+1)%s),_-d<e)return;const tt=j&&_-j;return tt?Math.round(_e*1e3/tt):void 0}}function throttle(s,e){let i=0,a=1e3/e,o,c;const d=(_,j=Date.now())=>{i=j,o=null,c&&(clearTimeout(c),c=null),s(..._)};return[(..._)=>{const j=Date.now(),$=j-i;$>=a?d(_,j):(o=_,c||(c=setTimeout(()=>{c=null,d(o)},a-$)))},()=>o&&d(o)]}const progressEventReducer=(s,e,i=3)=>{let a=0;const o=speedometer(50,250);return throttle(c=>{const d=c.loaded,g=c.lengthComputable?c.total:void 0,b=d-a,_=o(b),j=d<=g;a=d;const $={loaded:d,total:g,progress:g?d/g:void 0,bytes:b,rate:_||void 0,estimated:_&&g&&j?(g-d)/_:void 0,event:c,lengthComputable:g!=null,[e?"download":"upload"]:!0};s($)},i)},progressEventDecorator=(s,e)=>{const i=s!=null;return[a=>e[0]({lengthComputable:i,total:s,loaded:a}),e[1]]},asyncDecorator=s=>(...e)=>utils$1.asap(()=>s(...e)),isURLSameOrigin=platform.hasStandardBrowserEnv?((s,e)=>i=>(i=new URL(i,platform.origin),s.protocol===i.protocol&&s.host===i.host&&(e||s.port===i.port)))(new URL(platform.origin),platform.navigator&&/(msie|trident)/i.test(platform.navigator.userAgent)):()=>!0,cookies=platform.hasStandardBrowserEnv?{write(s,e,i,a,o,c,d){if(typeof document>"u")return;const g=[`${s}=${encodeURIComponent(e)}`];utils$1.isNumber(i)&&g.push(`expires=${new Date(i).toUTCString()}`),utils$1.isString(a)&&g.push(`path=${a}`),utils$1.isString(o)&&g.push(`domain=${o}`),c===!0&&g.push("secure"),utils$1.isString(d)&&g.push(`SameSite=${d}`),document.cookie=g.join("; ")},read(s){if(typeof document>"u")return null;const e=document.cookie.match(new RegExp("(?:^|; )"+s+"=([^;]*)"));return e?decodeURIComponent(e[1]):null},remove(s){this.write(s,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function isAbsoluteURL(s){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(s)}function combineURLs(s,e){return e?s.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):s}function buildFullPath(s,e,i){let a=!isAbsoluteURL(e);return s&&(a||i==!1)?combineURLs(s,e):e}const headersToObject=s=>s instanceof AxiosHeaders$1?{...s}:s;function mergeConfig$2(s,e){e=e||{};const i={};function a(_,j,$,_e){return utils$1.isPlainObject(_)&&utils$1.isPlainObject(j)?utils$1.merge.call({caseless:_e},_,j):utils$1.isPlainObject(j)?utils$1.merge({},j):utils$1.isArray(j)?j.slice():j}function o(_,j,$,_e){if(utils$1.isUndefined(j)){if(!utils$1.isUndefined(_))return a(void 0,_,$,_e)}else return a(_,j,$,_e)}function c(_,j){if(!utils$1.isUndefined(j))return a(void 0,j)}function d(_,j){if(utils$1.isUndefined(j)){if(!utils$1.isUndefined(_))return a(void 0,_)}else return a(void 0,j)}function g(_,j,$){if($ in e)return a(_,j);if($ in s)return a(void 0,_)}const b={url:c,method:c,data:c,baseURL:d,transformRequest:d,transformResponse:d,paramsSerializer:d,timeout:d,timeoutMessage:d,withCredentials:d,withXSRFToken:d,adapter:d,responseType:d,xsrfCookieName:d,xsrfHeaderName:d,onUploadProgress:d,onDownloadProgress:d,decompress:d,maxContentLength:d,maxBodyLength:d,beforeRedirect:d,transport:d,httpAgent:d,httpsAgent:d,cancelToken:d,socketPath:d,responseEncoding:d,validateStatus:g,headers:(_,j,$)=>o(headersToObject(_),headersToObject(j),$,!0)};return utils$1.forEach(Object.keys({...s,...e}),function(j){const $=b[j]||o,_e=$(s[j],e[j],j);utils$1.isUndefined(_e)&&$!==g||(i[j]=_e)}),i}const resolveConfig=s=>{const e=mergeConfig$2({},s);let{data:i,withXSRFToken:a,xsrfHeaderName:o,xsrfCookieName:c,headers:d,auth:g}=e;if(e.headers=d=AxiosHeaders$1.from(d),e.url=buildURL(buildFullPath(e.baseURL,e.url,e.allowAbsoluteUrls),s.params,s.paramsSerializer),g&&d.set("Authorization","Basic "+btoa((g.username||"")+":"+(g.password?unescape(encodeURIComponent(g.password)):""))),utils$1.isFormData(i)){if(platform.hasStandardBrowserEnv||platform.hasStandardBrowserWebWorkerEnv)d.setContentType(void 0);else if(utils$1.isFunction(i.getHeaders)){const b=i.getHeaders(),_=["content-type","content-length"];Object.entries(b).forEach(([j,$])=>{_.includes(j.toLowerCase())&&d.set(j,$)})}}if(platform.hasStandardBrowserEnv&&(a&&utils$1.isFunction(a)&&(a=a(e)),a||a!==!1&&isURLSameOrigin(e.url))){const b=o&&c&&cookies.read(c);b&&d.set(o,b)}return e},isXHRAdapterSupported=typeof XMLHttpRequest<"u",xhrAdapter=isXHRAdapterSupported&&function(s){return new Promise(function(i,a){const o=resolveConfig(s);let c=o.data;const d=AxiosHeaders$1.from(o.headers).normalize();let{responseType:g,onUploadProgress:b,onDownloadProgress:_}=o,j,$,_e,tt,et;function st(){tt&&tt(),et&&et(),o.cancelToken&&o.cancelToken.unsubscribe(j),o.signal&&o.signal.removeEventListener("abort",j)}let at=new XMLHttpRequest;at.open(o.method.toUpperCase(),o.url,!0),at.timeout=o.timeout;function rt(){if(!at)return;const it=AxiosHeaders$1.from("getAllResponseHeaders"in at&&at.getAllResponseHeaders()),lt={data:!g||g==="text"||g==="json"?at.responseText:at.response,status:at.status,statusText:at.statusText,headers:it,config:s,request:at};settle(function(ht){i(ht),st()},function(ht){a(ht),st()},lt),at=null}"onloadend"in at?at.onloadend=rt:at.onreadystatechange=function(){!at||at.readyState!==4||at.status===0&&!(at.responseURL&&at.responseURL.indexOf("file:")===0)||setTimeout(rt)},at.onabort=function(){at&&(a(new AxiosError$1("Request aborted",AxiosError$1.ECONNABORTED,s,at)),at=null)},at.onerror=function(ot){const lt=ot&&ot.message?ot.message:"Network Error",ct=new AxiosError$1(lt,AxiosError$1.ERR_NETWORK,s,at);ct.event=ot||null,a(ct),at=null},at.ontimeout=function(){let ot=o.timeout?"timeout of "+o.timeout+"ms exceeded":"timeout exceeded";const lt=o.transitional||transitionalDefaults;o.timeoutErrorMessage&&(ot=o.timeoutErrorMessage),a(new AxiosError$1(ot,lt.clarifyTimeoutError?AxiosError$1.ETIMEDOUT:AxiosError$1.ECONNABORTED,s,at)),at=null},c===void 0&&d.setContentType(null),"setRequestHeader"in at&&utils$1.forEach(d.toJSON(),function(ot,lt){at.setRequestHeader(lt,ot)}),utils$1.isUndefined(o.withCredentials)||(at.withCredentials=!!o.withCredentials),g&&g!=="json"&&(at.responseType=o.responseType),_&&([_e,et]=progressEventReducer(_,!0),at.addEventListener("progress",_e)),b&&at.upload&&([$,tt]=progressEventReducer(b),at.upload.addEventListener("progress",$),at.upload.addEventListener("loadend",tt)),(o.cancelToken||o.signal)&&(j=it=>{at&&(a(!it||it.type?new CanceledError$1(null,s,at):it),at.abort(),at=null)},o.cancelToken&&o.cancelToken.subscribe(j),o.signal&&(o.signal.aborted?j():o.signal.addEventListener("abort",j)));const nt=parseProtocol(o.url);if(nt&&platform.protocols.indexOf(nt)===-1){a(new AxiosError$1("Unsupported protocol "+nt+":",AxiosError$1.ERR_BAD_REQUEST,s));return}at.send(c||null)})},composeSignals=(s,e)=>{const{length:i}=s=s?s.filter(Boolean):[];if(e||i){let a=new AbortController,o;const c=function(_){if(!o){o=!0,g();const j=_ instanceof Error?_:this.reason;a.abort(j instanceof AxiosError$1?j:new CanceledError$1(j instanceof Error?j.message:j))}};let d=e&&setTimeout(()=>{d=null,c(new AxiosError$1(`timeout ${e} of ms exceeded`,AxiosError$1.ETIMEDOUT))},e);const g=()=>{s&&(d&&clearTimeout(d),d=null,s.forEach(_=>{_.unsubscribe?_.unsubscribe(c):_.removeEventListener("abort",c)}),s=null)};s.forEach(_=>_.addEventListener("abort",c));const{signal:b}=a;return b.unsubscribe=()=>utils$1.asap(g),b}},streamChunk=function*(s,e){let i=s.byteLength;if(i<e){yield s;return}let a=0,o;for(;a<i;)o=a+e,yield s.slice(a,o),a=o},readBytes=async function*(s,e){for await(const i of readStream(s))yield*streamChunk(i,e)},readStream=async function*(s){if(s[Symbol.asyncIterator]){yield*s;return}const e=s.getReader();try{for(;;){const{done:i,value:a}=await e.read();if(i)break;yield a}}finally{await e.cancel()}},trackStream=(s,e,i,a)=>{const o=readBytes(s,e);let c=0,d,g=b=>{d||(d=!0,a&&a(b))};return new ReadableStream({async pull(b){try{const{done:_,value:j}=await o.next();if(_){g(),b.close();return}let $=j.byteLength;if(i){let _e=c+=$;i(_e)}b.enqueue(new Uint8Array(j))}catch(_){throw g(_),_}},cancel(b){return g(b),o.return()}},{highWaterMark:2})},DEFAULT_CHUNK_SIZE=64*1024,{isFunction}=utils$1,globalFetchAPI=(({Request:s,Response:e})=>({Request:s,Response:e}))(utils$1.global),{ReadableStream:ReadableStream$1,TextEncoder}=utils$1.global,test$1=(s,...e)=>{try{return!!s(...e)}catch{return!1}},factory=s=>{s=utils$1.merge.call({skipUndefined:!0},globalFetchAPI,s);const{fetch:e,Request:i,Response:a}=s,o=e?isFunction(e):typeof fetch=="function",c=isFunction(i),d=isFunction(a);if(!o)return!1;const g=o&&isFunction(ReadableStream$1),b=o&&(typeof TextEncoder=="function"?(et=>st=>et.encode(st))(new TextEncoder):async et=>new Uint8Array(await new i(et).arrayBuffer())),_=c&&g&&test$1(()=>{let et=!1;const st=new i(platform.origin,{body:new ReadableStream$1,method:"POST",get duplex(){return et=!0,"half"}}).headers.has("Content-Type");return et&&!st}),j=d&&g&&test$1(()=>utils$1.isReadableStream(new a("").body)),$={stream:j&&(et=>et.body)};o&&["text","arrayBuffer","blob","formData","stream"].forEach(et=>{!$[et]&&($[et]=(st,at)=>{let rt=st&&st[et];if(rt)return rt.call(st);throw new AxiosError$1(`Response type '${et}' is not supported`,AxiosError$1.ERR_NOT_SUPPORT,at)})});const _e=async et=>{if(et==null)return 0;if(utils$1.isBlob(et))return et.size;if(utils$1.isSpecCompliantForm(et))return(await new i(platform.origin,{method:"POST",body:et}).arrayBuffer()).byteLength;if(utils$1.isArrayBufferView(et)||utils$1.isArrayBuffer(et))return et.byteLength;if(utils$1.isURLSearchParams(et)&&(et=et+""),utils$1.isString(et))return(await b(et)).byteLength},tt=async(et,st)=>{const at=utils$1.toFiniteNumber(et.getContentLength());return at??_e(st)};return async et=>{let{url:st,method:at,data:rt,signal:nt,cancelToken:it,timeout:ot,onDownloadProgress:lt,onUploadProgress:ct,responseType:ht,headers:dt,withCredentials:gt="same-origin",fetchOptions:vt}=resolveConfig(et),St=e||fetch;ht=ht?(ht+"").toLowerCase():"text";let Tt=composeSignals([nt,it&&it.toAbortSignal()],ot),Ct=null;const Rt=Tt&&Tt.unsubscribe&&(()=>{Tt.unsubscribe()});let bt;try{if(ct&&_&&at!=="get"&&at!=="head"&&(bt=await tt(dt,rt))!==0){let mt=new i(st,{method:"POST",body:rt,duplex:"half"}),Et;if(utils$1.isFormData(rt)&&(Et=mt.headers.get("content-type"))&&dt.setContentType(Et),mt.body){const[At,Pt]=progressEventDecorator(bt,progressEventReducer(asyncDecorator(ct)));rt=trackStream(mt.body,DEFAULT_CHUNK_SIZE,At,Pt)}}utils$1.isString(gt)||(gt=gt?"include":"omit");const pt=c&&"credentials"in i.prototype,yt={...vt,signal:Tt,method:at.toUpperCase(),headers:dt.normalize().toJSON(),body:rt,duplex:"half",credentials:pt?gt:void 0};Ct=c&&new i(st,yt);let ut=await(c?St(Ct,vt):St(st,yt));const ft=j&&(ht==="stream"||ht==="response");if(j&&(lt||ft&&Rt)){const mt={};["status","statusText","headers"].forEach(wt=>{mt[wt]=ut[wt]});const Et=utils$1.toFiniteNumber(ut.headers.get("content-length")),[At,Pt]=lt&&progressEventDecorator(Et,progressEventReducer(asyncDecorator(lt),!0))||[];ut=new a(trackStream(ut.body,DEFAULT_CHUNK_SIZE,At,()=>{Pt&&Pt(),Rt&&Rt()}),mt)}ht=ht||"text";let xt=await $[utils$1.findKey($,ht)||"text"](ut,et);return!ft&&Rt&&Rt(),await new Promise((mt,Et)=>{settle(mt,Et,{data:xt,headers:AxiosHeaders$1.from(ut.headers),status:ut.status,statusText:ut.statusText,config:et,request:Ct})})}catch(pt){throw Rt&&Rt(),pt&&pt.name==="TypeError"&&/Load failed|fetch/i.test(pt.message)?Object.assign(new AxiosError$1("Network Error",AxiosError$1.ERR_NETWORK,et,Ct),{cause:pt.cause||pt}):AxiosError$1.from(pt,pt&&pt.code,et,Ct)}}},seedCache=new Map,getFetch=s=>{let e=s&&s.env||{};const{fetch:i,Request:a,Response:o}=e,c=[a,o,i];let d=c.length,g=d,b,_,j=seedCache;for(;g--;)b=c[g],_=j.get(b),_===void 0&&j.set(b,_=g?new Map:factory(e)),j=_;return _};getFetch();const knownAdapters={http:httpAdapter,xhr:xhrAdapter,fetch:{get:getFetch}};utils$1.forEach(knownAdapters,(s,e)=>{if(s){try{Object.defineProperty(s,"name",{value:e})}catch{}Object.defineProperty(s,"adapterName",{value:e})}});const renderReason=s=>`- ${s}`,isResolvedHandle=s=>utils$1.isFunction(s)||s===null||s===!1;function getAdapter$1(s,e){s=utils$1.isArray(s)?s:[s];const{length:i}=s;let a,o;const c={};for(let d=0;d<i;d++){a=s[d];let g;if(o=a,!isResolvedHandle(a)&&(o=knownAdapters[(g=String(a)).toLowerCase()],o===void 0))throw new AxiosError$1(`Unknown adapter '${g}'`);if(o&&(utils$1.isFunction(o)||(o=o.get(e))))break;c[g||"#"+d]=o}if(!o){const d=Object.entries(c).map(([b,_])=>`adapter ${b} `+(_===!1?"is not supported by the environment":"is not available in the build"));let g=i?d.length>1?`since :
`+d.map(renderReason).join(`
`):" "+renderReason(d[0]):"as no adapter specified";throw new AxiosError$1("There is no suitable adapter to dispatch the request "+g,"ERR_NOT_SUPPORT")}return o}const adapters={getAdapter:getAdapter$1,adapters:knownAdapters};function throwIfCancellationRequested(s){if(s.cancelToken&&s.cancelToken.throwIfRequested(),s.signal&&s.signal.aborted)throw new CanceledError$1(null,s)}function dispatchRequest(s){return throwIfCancellationRequested(s),s.headers=AxiosHeaders$1.from(s.headers),s.data=transformData.call(s,s.transformRequest),["post","put","patch"].indexOf(s.method)!==-1&&s.headers.setContentType("application/x-www-form-urlencoded",!1),adapters.getAdapter(s.adapter||defaults$1.adapter,s)(s).then(function(a){return throwIfCancellationRequested(s),a.data=transformData.call(s,s.transformResponse,a),a.headers=AxiosHeaders$1.from(a.headers),a},function(a){return isCancel$1(a)||(throwIfCancellationRequested(s),a&&a.response&&(a.response.data=transformData.call(s,s.transformResponse,a.response),a.response.headers=AxiosHeaders$1.from(a.response.headers))),Promise.reject(a)})}const VERSION$1="1.13.2",validators$1={};["object","boolean","number","function","string","symbol"].forEach((s,e)=>{validators$1[s]=function(a){return typeof a===s||"a"+(e<1?"n ":" ")+s}});const deprecatedWarnings={};validators$1.transitional=function(e,i,a){function o(c,d){return"[Axios v"+VERSION$1+"] Transitional option '"+c+"'"+d+(a?". "+a:"")}return(c,d,g)=>{if(e===!1)throw new AxiosError$1(o(d," has been removed"+(i?" in "+i:"")),AxiosError$1.ERR_DEPRECATED);return i&&!deprecatedWarnings[d]&&(deprecatedWarnings[d]=!0,console.warn(o(d," has been deprecated since v"+i+" and will be removed in the near future"))),e?e(c,d,g):!0}};validators$1.spelling=function(e){return(i,a)=>(console.warn(`${a} is likely a misspelling of ${e}`),!0)};function assertOptions(s,e,i){if(typeof s!="object")throw new AxiosError$1("options must be an object",AxiosError$1.ERR_BAD_OPTION_VALUE);const a=Object.keys(s);let o=a.length;for(;o-- >0;){const c=a[o],d=e[c];if(d){const g=s[c],b=g===void 0||d(g,c,s);if(b!==!0)throw new AxiosError$1("option "+c+" must be "+b,AxiosError$1.ERR_BAD_OPTION_VALUE);continue}if(i!==!0)throw new AxiosError$1("Unknown option "+c,AxiosError$1.ERR_BAD_OPTION)}}const validator={assertOptions,validators:validators$1},validators=validator.validators;let Axios$1=class{constructor(e){this.defaults=e||{},this.interceptors={request:new InterceptorManager,response:new InterceptorManager}}async request(e,i){try{return await this._request(e,i)}catch(a){if(a instanceof Error){let o={};Error.captureStackTrace?Error.captureStackTrace(o):o=new Error;const c=o.stack?o.stack.replace(/^.+\n/,""):"";try{a.stack?c&&!String(a.stack).endsWith(c.replace(/^.+\n.+\n/,""))&&(a.stack+=`
`+c):a.stack=c}catch{}}throw a}}_request(e,i){typeof e=="string"?(i=i||{},i.url=e):i=e||{},i=mergeConfig$2(this.defaults,i);const{transitional:a,paramsSerializer:o,headers:c}=i;a!==void 0&&validator.assertOptions(a,{silentJSONParsing:validators.transitional(validators.boolean),forcedJSONParsing:validators.transitional(validators.boolean),clarifyTimeoutError:validators.transitional(validators.boolean)},!1),o!=null&&(utils$1.isFunction(o)?i.paramsSerializer={serialize:o}:validator.assertOptions(o,{encode:validators.function,serialize:validators.function},!0)),i.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?i.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:i.allowAbsoluteUrls=!0),validator.assertOptions(i,{baseUrl:validators.spelling("baseURL"),withXsrfToken:validators.spelling("withXSRFToken")},!0),i.method=(i.method||this.defaults.method||"get").toLowerCase();let d=c&&utils$1.merge(c.common,c[i.method]);c&&utils$1.forEach(["delete","get","head","post","put","patch","common"],et=>{delete c[et]}),i.headers=AxiosHeaders$1.concat(d,c);const g=[];let b=!0;this.interceptors.request.forEach(function(st){typeof st.runWhen=="function"&&st.runWhen(i)===!1||(b=b&&st.synchronous,g.unshift(st.fulfilled,st.rejected))});const _=[];this.interceptors.response.forEach(function(st){_.push(st.fulfilled,st.rejected)});let j,$=0,_e;if(!b){const et=[dispatchRequest.bind(this),void 0];for(et.unshift(...g),et.push(..._),_e=et.length,j=Promise.resolve(i);$<_e;)j=j.then(et[$++],et[$++]);return j}_e=g.length;let tt=i;for(;$<_e;){const et=g[$++],st=g[$++];try{tt=et(tt)}catch(at){st.call(this,at);break}}try{j=dispatchRequest.call(this,tt)}catch(et){return Promise.reject(et)}for($=0,_e=_.length;$<_e;)j=j.then(_[$++],_[$++]);return j}getUri(e){e=mergeConfig$2(this.defaults,e);const i=buildFullPath(e.baseURL,e.url,e.allowAbsoluteUrls);return buildURL(i,e.params,e.paramsSerializer)}};utils$1.forEach(["delete","get","head","options"],function(e){Axios$1.prototype[e]=function(i,a){return this.request(mergeConfig$2(a||{},{method:e,url:i,data:(a||{}).data}))}});utils$1.forEach(["post","put","patch"],function(e){function i(a){return function(c,d,g){return this.request(mergeConfig$2(g||{},{method:e,headers:a?{"Content-Type":"multipart/form-data"}:{},url:c,data:d}))}}Axios$1.prototype[e]=i(),Axios$1.prototype[e+"Form"]=i(!0)});let CancelToken$1=class hr{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let i;this.promise=new Promise(function(c){i=c});const a=this;this.promise.then(o=>{if(!a._listeners)return;let c=a._listeners.length;for(;c-- >0;)a._listeners[c](o);a._listeners=null}),this.promise.then=o=>{let c;const d=new Promise(g=>{a.subscribe(g),c=g}).then(o);return d.cancel=function(){a.unsubscribe(c)},d},e(function(c,d,g){a.reason||(a.reason=new CanceledError$1(c,d,g),i(a.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const i=this._listeners.indexOf(e);i!==-1&&this._listeners.splice(i,1)}toAbortSignal(){const e=new AbortController,i=a=>{e.abort(a)};return this.subscribe(i),e.signal.unsubscribe=()=>this.unsubscribe(i),e.signal}static source(){let e;return{token:new hr(function(o){e=o}),cancel:e}}};function spread$1(s){return function(i){return s.apply(null,i)}}function isAxiosError$1(s){return utils$1.isObject(s)&&s.isAxiosError===!0}const HttpStatusCode$1={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(HttpStatusCode$1).forEach(([s,e])=>{HttpStatusCode$1[e]=s});function createInstance(s){const e=new Axios$1(s),i=bind(Axios$1.prototype.request,e);return utils$1.extend(i,Axios$1.prototype,e,{allOwnKeys:!0}),utils$1.extend(i,e,null,{allOwnKeys:!0}),i.create=function(o){return createInstance(mergeConfig$2(s,o))},i}const axios=createInstance(defaults$1);axios.Axios=Axios$1;axios.CanceledError=CanceledError$1;axios.CancelToken=CancelToken$1;axios.isCancel=isCancel$1;axios.VERSION=VERSION$1;axios.toFormData=toFormData$1;axios.AxiosError=AxiosError$1;axios.Cancel=axios.CanceledError;axios.all=function(e){return Promise.all(e)};axios.spread=spread$1;axios.isAxiosError=isAxiosError$1;axios.mergeConfig=mergeConfig$2;axios.AxiosHeaders=AxiosHeaders$1;axios.formToJSON=s=>formDataToJSON(utils$1.isHTMLForm(s)?new FormData(s):s);axios.getAdapter=adapters.getAdapter;axios.HttpStatusCode=HttpStatusCode$1;axios.default=axios;const{Axios,AxiosError,CanceledError,isCancel,CancelToken,VERSION,all,Cancel,isAxiosError,spread,toFormData,AxiosHeaders,HttpStatusCode,formToJSON,getAdapter,mergeConfig:mergeConfig$1}=axios,Movieapi=axios.create({baseURL:`${Config.api_url}/movies/`,withCredentials:!0,headers:{Accept:"application/json","Content-Type":"application/json"}}),useDpadNavigation=({totalItems:s=0,columns:e=1,onEnter:i=null,enabled:a=!0,onDirectionChange:o=null,initialIndex:c=0}={})=>{const[d,g]=reactExports.useState(c),b=reactExports.useRef(null);reactExports.useEffect(()=>{a&&g(c)},[a,c]);const _=reactExports.useCallback(j=>{if(!a||s===0||!b.current)return;let $=!1;switch(j.key){case"ArrowUp":d>=e&&(g(et=>et-e),$=!0);break;case"ArrowDown":const _e=d+e;_e<s?(g(_e),$=!0):d<s-1&&Math.floor(d/e)<Math.floor((s-1)/e)&&(g(s-1),$=!0);break;case"ArrowLeft":d%e!==0&&(g(et=>et-1),$=!0);break;case"ArrowRight":!((d+1)%e===0)&&d<s-1&&(g(et=>et+1),$=!0);break;case"Enter":i&&i(d),$=!0;break}$&&j.preventDefault(),o&&o(j.key,$)},[a,s,e,d,i,o]);return reactExports.useEffect(()=>(window.addEventListener("keydown",_),()=>window.removeEventListener("keydown",_)),[_]),reactExports.useEffect(()=>{if(a&&b.current&&s>0){const j=b.current.children[d];j&&j.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})}},[d,s,a]),{selectedIndex:d,containerRef:b}},logo=""+new URL("logo-CneGCSyS.png",import.meta.url).href,HeroSection=({navigation:s,isActive:e,onNavigate:i})=>{var et;const[a,o]=reactExports.useState([]),[c,d]=reactExports.useState(null),[g,b]=reactExports.useState(!0),[_,j]=reactExports.useState(null),{selectedIndex:$,containerRef:_e}=useDpadNavigation({totalItems:2,columns:2,enabled:e&&!!c,onEnter:st=>{st===0&&s(`/movie/${c.uuid}`),st===1&&s("/login")},onDirectionChange:(st,at)=>{!at&&(st==="ArrowDown"||st==="ArrowUp")&&i(st)}}),tt=reactExports.useCallback(async()=>{var st;try{b(!0),j(null);const rt=(await Movieapi.get("getlandingmoviescarousel")).data;if(rt.status==="error")throw new Error(rt.message);if(((st=rt.movies_carousel_details)==null?void 0:st.length)>0)o(rt.movies_carousel_details),d(rt.movies_carousel_details[0]);else throw new Error("No movies found for carousel.")}catch(at){j(at.message||"Failed to fetch carousel movies.")}finally{b(!1)}},[]);return reactExports.useEffect(()=>{tt()},[tt]),g?jsxRuntimeExports.jsx("div",{className:"relative w-full bg-gray-900 h-[500px] flex items-center justify-center",children:jsxRuntimeExports.jsx("div",{className:"animate-pulse text-gray-400 text-lg",children:"Loading hero section..."})}):_?jsxRuntimeExports.jsx("div",{className:"w-full h-[500px] flex items-center justify-center bg-gray-900 text-red-400",children:_}):c?jsxRuntimeExports.jsxs("div",{className:"relative w-full h-[500px] bg-cover bg-center",style:{backgroundImage:`url(${c.main_banner})`},children:[jsxRuntimeExports.jsx("div",{className:"absolute inset-0 bg-linear-to-r from-black/80 via-black/50 to-transparent"}),jsxRuntimeExports.jsxs("div",{className:"relative z-10 px-6 pt-20 pb-16 max-w-[700px]",children:[jsxRuntimeExports.jsx("img",{src:logo,alt:"Logo",className:"w-[100px] h-10 object-contain mb-4"}),jsxRuntimeExports.jsx("h1",{className:"text-white text-5xl font-bold mb-4 drop-shadow-lg",children:c.title}),jsxRuntimeExports.jsx("p",{className:"text-white text-sm leading-6 mb-5 max-w-[500px] opacity-90",children:c.short_description||"No description available."}),jsxRuntimeExports.jsx("div",{className:"flex flex-wrap mb-6",children:(et=c==null?void 0:c.categories)==null?void 0:et.map((st,at)=>jsxRuntimeExports.jsx("span",{className:"bg-white/20 text-white rounded px-2.5 py-1 mr-2 mb-2 text-xs font-semibold",children:st==null?void 0:st.name},at))}),jsxRuntimeExports.jsxs("div",{ref:_e,className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:()=>s==null?void 0:s(`/movie/${c.uuid}`),className:`bg-[#C1272D] hover:bg-[#E13B3F] text-white font-bold px-7 py-2.5 rounded-md flex items-center gap-2 transition-transform duration-300
            ${e&&$===0?"scale-110 ring-4 ring-white":""}`,children:" Play"}),jsxRuntimeExports.jsx("button",{onClick:()=>s==null?void 0:s("/login"),className:`bg-gray-600/80 hover:bg-gray-500 text-white font-semibold px-5 py-2.5 rounded-md transition-transform duration-300
            ${e&&$===1?"scale-110 ring-4 ring-white":""}`,children:"Login"})]})]})]}):jsxRuntimeExports.jsx("div",{className:"flex justify-center items-center w-full bg-[#222] h-[500px] rounded-lg",children:jsxRuntimeExports.jsx("p",{className:"text-white text-lg font-bold",children:"No Carousel Movies Found."})})},SectionHeading=({title:s="Trending Movies",styleclass:e=""})=>{const[i,a]=reactExports.useState(0),o=reactExports.useRef(null);return reactExports.useEffect(()=>{o.current&&a(o.current.offsetWidth)},[s]),jsxRuntimeExports.jsx("div",{className:`mb-3 ${e}`,children:jsxRuntimeExports.jsxs("div",{className:"inline-block",children:[jsxRuntimeExports.jsx("h2",{ref:o,className:"text-white text-[22px] font-bold inline-block",children:s}),jsxRuntimeExports.jsx("div",{className:"h-1 bg-[#D94444] mt-1 rounded-full transition-all duration-300",style:{width:`${i*.7}px`}})]})})},MovieThumbnail=({source:s,style:e,alt:i,onClick:a,isFocused:o})=>{const d=e||{width:"200px",height:"300px"};return jsxRuntimeExports.jsx("button",{onClick:a,className:`relative items-center mt-2 overflow-hidden rounded-lg transition-transform duration-300 hover:scale-105 focus:scale-105 outline-none flex-shrink-0
        ${o?"ring-4 ring-red-500 ring-offset-2 ring-offset-black":""}
      `,style:d,children:jsxRuntimeExports.jsx("div",{className:"rounded-lg overflow-hidden shadow-md bg-white w-full h-full",children:jsxRuntimeExports.jsx("img",{src:s,alt:i||"Movie thumbnail",className:"object-cover w-full h-full"})})})};/**
 * react-router v7.9.5
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var PopStateEventType="popstate";function createHashHistory(s={}){function e(o,c){let{pathname:d="/",search:g="",hash:b=""}=parsePath(o.location.hash.substring(1));return!d.startsWith("/")&&!d.startsWith(".")&&(d="/"+d),createLocation("",{pathname:d,search:g,hash:b},c.state&&c.state.usr||null,c.state&&c.state.key||"default")}function i(o,c){let d=o.document.querySelector("base"),g="";if(d&&d.getAttribute("href")){let b=o.location.href,_=b.indexOf("#");g=_===-1?b:b.slice(0,_)}return g+"#"+(typeof c=="string"?c:createPath(c))}function a(o,c){warning(o.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(c)})`)}return getUrlBasedHistory(e,i,a,s)}function invariant$1(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function warning(s,e){if(!s){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function createKey(){return Math.random().toString(36).substring(2,10)}function getHistoryState(s,e){return{usr:s.state,key:s.key,idx:e}}function createLocation(s,e,i=null,a){return{pathname:typeof s=="string"?s:s.pathname,search:"",hash:"",...typeof e=="string"?parsePath(e):e,state:i,key:e&&e.key||a||createKey()}}function createPath({pathname:s="/",search:e="",hash:i=""}){return e&&e!=="?"&&(s+=e.charAt(0)==="?"?e:"?"+e),i&&i!=="#"&&(s+=i.charAt(0)==="#"?i:"#"+i),s}function parsePath(s){let e={};if(s){let i=s.indexOf("#");i>=0&&(e.hash=s.substring(i),s=s.substring(0,i));let a=s.indexOf("?");a>=0&&(e.search=s.substring(a),s=s.substring(0,a)),s&&(e.pathname=s)}return e}function getUrlBasedHistory(s,e,i,a={}){let{window:o=document.defaultView,v5Compat:c=!1}=a,d=o.history,g="POP",b=null,_=j();_==null&&(_=0,d.replaceState({...d.state,idx:_},""));function j(){return(d.state||{idx:null}).idx}function $(){g="POP";let at=j(),rt=at==null?null:at-_;_=at,b&&b({action:g,location:st.location,delta:rt})}function _e(at,rt){g="PUSH";let nt=createLocation(st.location,at,rt);i&&i(nt,at),_=j()+1;let it=getHistoryState(nt,_),ot=st.createHref(nt);try{d.pushState(it,"",ot)}catch(lt){if(lt instanceof DOMException&&lt.name==="DataCloneError")throw lt;o.location.assign(ot)}c&&b&&b({action:g,location:st.location,delta:1})}function tt(at,rt){g="REPLACE";let nt=createLocation(st.location,at,rt);i&&i(nt,at),_=j();let it=getHistoryState(nt,_),ot=st.createHref(nt);d.replaceState(it,"",ot),c&&b&&b({action:g,location:st.location,delta:0})}function et(at){return createBrowserURLImpl(at)}let st={get action(){return g},get location(){return s(o,d)},listen(at){if(b)throw new Error("A history only accepts one active listener");return o.addEventListener(PopStateEventType,$),b=at,()=>{o.removeEventListener(PopStateEventType,$),b=null}},createHref(at){return e(o,at)},createURL:et,encodeLocation(at){let rt=et(at);return{pathname:rt.pathname,search:rt.search,hash:rt.hash}},push:_e,replace:tt,go(at){return d.go(at)}};return st}function createBrowserURLImpl(s,e=!1){let i="http://localhost";typeof window<"u"&&(i=window.location.origin!=="null"?window.location.origin:window.location.href),invariant$1(i,"No window.location.(origin|href) available to create URL");let a=typeof s=="string"?s:createPath(s);return a=a.replace(/ $/,"%20"),!e&&a.startsWith("//")&&(a=i+a),new URL(a,i)}function matchRoutes(s,e,i="/"){return matchRoutesImpl(s,e,i,!1)}function matchRoutesImpl(s,e,i,a){let o=typeof e=="string"?parsePath(e):e,c=stripBasename(o.pathname||"/",i);if(c==null)return null;let d=flattenRoutes(s);rankRouteBranches(d);let g=null;for(let b=0;g==null&&b<d.length;++b){let _=decodePath(c);g=matchRouteBranch(d[b],_,a)}return g}function flattenRoutes(s,e=[],i=[],a="",o=!1){let c=(d,g,b=o,_)=>{let j={relativePath:_===void 0?d.path||"":_,caseSensitive:d.caseSensitive===!0,childrenIndex:g,route:d};if(j.relativePath.startsWith("/")){if(!j.relativePath.startsWith(a)&&b)return;invariant$1(j.relativePath.startsWith(a),`Absolute route path "${j.relativePath}" nested under path "${a}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),j.relativePath=j.relativePath.slice(a.length)}let $=joinPaths([a,j.relativePath]),_e=i.concat(j);d.children&&d.children.length>0&&(invariant$1(d.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${$}".`),flattenRoutes(d.children,e,_e,$,b)),!(d.path==null&&!d.index)&&e.push({path:$,score:computeScore($,d.index),routesMeta:_e})};return s.forEach((d,g)=>{var b;if(d.path===""||!((b=d.path)!=null&&b.includes("?")))c(d,g);else for(let _ of explodeOptionalSegments(d.path))c(d,g,!0,_)}),e}function explodeOptionalSegments(s){let e=s.split("/");if(e.length===0)return[];let[i,...a]=e,o=i.endsWith("?"),c=i.replace(/\?$/,"");if(a.length===0)return o?[c,""]:[c];let d=explodeOptionalSegments(a.join("/")),g=[];return g.push(...d.map(b=>b===""?c:[c,b].join("/"))),o&&g.push(...d),g.map(b=>s.startsWith("/")&&b===""?"/":b)}function rankRouteBranches(s){s.sort((e,i)=>e.score!==i.score?i.score-e.score:compareIndexes(e.routesMeta.map(a=>a.childrenIndex),i.routesMeta.map(a=>a.childrenIndex)))}var paramRe=/^:[\w-]+$/,dynamicSegmentValue=3,indexRouteValue=2,emptySegmentValue=1,staticSegmentValue=10,splatPenalty=-2,isSplat=s=>s==="*";function computeScore(s,e){let i=s.split("/"),a=i.length;return i.some(isSplat)&&(a+=splatPenalty),e&&(a+=indexRouteValue),i.filter(o=>!isSplat(o)).reduce((o,c)=>o+(paramRe.test(c)?dynamicSegmentValue:c===""?emptySegmentValue:staticSegmentValue),a)}function compareIndexes(s,e){return s.length===e.length&&s.slice(0,-1).every((a,o)=>a===e[o])?s[s.length-1]-e[e.length-1]:0}function matchRouteBranch(s,e,i=!1){let{routesMeta:a}=s,o={},c="/",d=[];for(let g=0;g<a.length;++g){let b=a[g],_=g===a.length-1,j=c==="/"?e:e.slice(c.length)||"/",$=matchPath({path:b.relativePath,caseSensitive:b.caseSensitive,end:_},j),_e=b.route;if(!$&&_&&i&&!a[a.length-1].route.index&&($=matchPath({path:b.relativePath,caseSensitive:b.caseSensitive,end:!1},j)),!$)return null;Object.assign(o,$.params),d.push({params:o,pathname:joinPaths([c,$.pathname]),pathnameBase:normalizePathname(joinPaths([c,$.pathnameBase])),route:_e}),$.pathnameBase!=="/"&&(c=joinPaths([c,$.pathnameBase]))}return d}function matchPath(s,e){typeof s=="string"&&(s={path:s,caseSensitive:!1,end:!0});let[i,a]=compilePath(s.path,s.caseSensitive,s.end),o=e.match(i);if(!o)return null;let c=o[0],d=c.replace(/(.)\/+$/,"$1"),g=o.slice(1);return{params:a.reduce((_,{paramName:j,isOptional:$},_e)=>{if(j==="*"){let et=g[_e]||"";d=c.slice(0,c.length-et.length).replace(/(.)\/+$/,"$1")}const tt=g[_e];return $&&!tt?_[j]=void 0:_[j]=(tt||"").replace(/%2F/g,"/"),_},{}),pathname:c,pathnameBase:d,pattern:s}}function compilePath(s,e=!1,i=!0){warning(s==="*"||!s.endsWith("*")||s.endsWith("/*"),`Route path "${s}" will be treated as if it were "${s.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${s.replace(/\*$/,"/*")}".`);let a=[],o="^"+s.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,g,b)=>(a.push({paramName:g,isOptional:b!=null}),b?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return s.endsWith("*")?(a.push({paramName:"*"}),o+=s==="*"||s==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):i?o+="\\/*$":s!==""&&s!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,e?void 0:"i"),a]}function decodePath(s){try{return s.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return warning(!1,`The URL path "${s}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),s}}function stripBasename(s,e){if(e==="/")return s;if(!s.toLowerCase().startsWith(e.toLowerCase()))return null;let i=e.endsWith("/")?e.length-1:e.length,a=s.charAt(i);return a&&a!=="/"?null:s.slice(i)||"/"}function resolvePath(s,e="/"){let{pathname:i,search:a="",hash:o=""}=typeof s=="string"?parsePath(s):s;return{pathname:i?i.startsWith("/")?i:resolvePathname(i,e):e,search:normalizeSearch(a),hash:normalizeHash(o)}}function resolvePathname(s,e){let i=e.replace(/\/+$/,"").split("/");return s.split("/").forEach(o=>{o===".."?i.length>1&&i.pop():o!=="."&&i.push(o)}),i.length>1?i.join("/"):"/"}function getInvalidPathError(s,e,i,a){return`Cannot include a '${s}' character in a manually specified \`to.${e}\` field [${JSON.stringify(a)}].  Please separate it out to the \`to.${i}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function getPathContributingMatches(s){return s.filter((e,i)=>i===0||e.route.path&&e.route.path.length>0)}function getResolveToMatches(s){let e=getPathContributingMatches(s);return e.map((i,a)=>a===e.length-1?i.pathname:i.pathnameBase)}function resolveTo(s,e,i,a=!1){let o;typeof s=="string"?o=parsePath(s):(o={...s},invariant$1(!o.pathname||!o.pathname.includes("?"),getInvalidPathError("?","pathname","search",o)),invariant$1(!o.pathname||!o.pathname.includes("#"),getInvalidPathError("#","pathname","hash",o)),invariant$1(!o.search||!o.search.includes("#"),getInvalidPathError("#","search","hash",o)));let c=s===""||o.pathname==="",d=c?"/":o.pathname,g;if(d==null)g=i;else{let $=e.length-1;if(!a&&d.startsWith("..")){let _e=d.split("/");for(;_e[0]==="..";)_e.shift(),$-=1;o.pathname=_e.join("/")}g=$>=0?e[$]:"/"}let b=resolvePath(o,g),_=d&&d!=="/"&&d.endsWith("/"),j=(c||d===".")&&i.endsWith("/");return!b.pathname.endsWith("/")&&(_||j)&&(b.pathname+="/"),b}var joinPaths=s=>s.join("/").replace(/\/\/+/g,"/"),normalizePathname=s=>s.replace(/\/+$/,"").replace(/^\/*/,"/"),normalizeSearch=s=>!s||s==="?"?"":s.startsWith("?")?s:"?"+s,normalizeHash=s=>!s||s==="#"?"":s.startsWith("#")?s:"#"+s;function isRouteErrorResponse(s){return s!=null&&typeof s.status=="number"&&typeof s.statusText=="string"&&typeof s.internal=="boolean"&&"data"in s}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var validMutationMethodsArr=["POST","PUT","PATCH","DELETE"];new Set(validMutationMethodsArr);var validRequestMethodsArr=["GET",...validMutationMethodsArr];new Set(validRequestMethodsArr);var DataRouterContext=reactExports.createContext(null);DataRouterContext.displayName="DataRouter";var DataRouterStateContext=reactExports.createContext(null);DataRouterStateContext.displayName="DataRouterState";reactExports.createContext(!1);var ViewTransitionContext=reactExports.createContext({isTransitioning:!1});ViewTransitionContext.displayName="ViewTransition";var FetchersContext=reactExports.createContext(new Map);FetchersContext.displayName="Fetchers";var AwaitContext=reactExports.createContext(null);AwaitContext.displayName="Await";var NavigationContext=reactExports.createContext(null);NavigationContext.displayName="Navigation";var LocationContext=reactExports.createContext(null);LocationContext.displayName="Location";var RouteContext=reactExports.createContext({outlet:null,matches:[],isDataRoute:!1});RouteContext.displayName="Route";var RouteErrorContext=reactExports.createContext(null);RouteErrorContext.displayName="RouteError";function useHref(s,{relative:e}={}){invariant$1(useInRouterContext(),"useHref() may be used only in the context of a <Router> component.");let{basename:i,navigator:a}=reactExports.useContext(NavigationContext),{hash:o,pathname:c,search:d}=useResolvedPath(s,{relative:e}),g=c;return i!=="/"&&(g=c==="/"?i:joinPaths([i,c])),a.createHref({pathname:g,search:d,hash:o})}function useInRouterContext(){return reactExports.useContext(LocationContext)!=null}function useLocation(){return invariant$1(useInRouterContext(),"useLocation() may be used only in the context of a <Router> component."),reactExports.useContext(LocationContext).location}var navigateEffectWarning="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function useIsomorphicLayoutEffect$1(s){reactExports.useContext(NavigationContext).static||reactExports.useLayoutEffect(s)}function useNavigate(){let{isDataRoute:s}=reactExports.useContext(RouteContext);return s?useNavigateStable():useNavigateUnstable()}function useNavigateUnstable(){invariant$1(useInRouterContext(),"useNavigate() may be used only in the context of a <Router> component.");let s=reactExports.useContext(DataRouterContext),{basename:e,navigator:i}=reactExports.useContext(NavigationContext),{matches:a}=reactExports.useContext(RouteContext),{pathname:o}=useLocation(),c=JSON.stringify(getResolveToMatches(a)),d=reactExports.useRef(!1);return useIsomorphicLayoutEffect$1(()=>{d.current=!0}),reactExports.useCallback((b,_={})=>{if(warning(d.current,navigateEffectWarning),!d.current)return;if(typeof b=="number"){i.go(b);return}let j=resolveTo(b,JSON.parse(c),o,_.relative==="path");s==null&&e!=="/"&&(j.pathname=j.pathname==="/"?e:joinPaths([e,j.pathname])),(_.replace?i.replace:i.push)(j,_.state,_)},[e,i,c,o,s])}var OutletContext=reactExports.createContext(null);function useOutlet(s){let e=reactExports.useContext(RouteContext).outlet;return reactExports.useMemo(()=>e&&reactExports.createElement(OutletContext.Provider,{value:s},e),[e,s])}function useParams(){let{matches:s}=reactExports.useContext(RouteContext),e=s[s.length-1];return e?e.params:{}}function useResolvedPath(s,{relative:e}={}){let{matches:i}=reactExports.useContext(RouteContext),{pathname:a}=useLocation(),o=JSON.stringify(getResolveToMatches(i));return reactExports.useMemo(()=>resolveTo(s,JSON.parse(o),a,e==="path"),[s,o,a,e])}function useRoutes(s,e){return useRoutesImpl(s,e)}function useRoutesImpl(s,e,i,a,o){var nt;invariant$1(useInRouterContext(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:c}=reactExports.useContext(NavigationContext),{matches:d}=reactExports.useContext(RouteContext),g=d[d.length-1],b=g?g.params:{},_=g?g.pathname:"/",j=g?g.pathnameBase:"/",$=g&&g.route;{let it=$&&$.path||"";warningOnce(_,!$||it.endsWith("*")||it.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${_}" (under <Route path="${it}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${it}"> to <Route path="${it==="/"?"*":`${it}/*`}">.`)}let _e=useLocation(),tt;if(e){let it=typeof e=="string"?parsePath(e):e;invariant$1(j==="/"||((nt=it.pathname)==null?void 0:nt.startsWith(j)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${j}" but pathname "${it.pathname}" was given in the \`location\` prop.`),tt=it}else tt=_e;let et=tt.pathname||"/",st=et;if(j!=="/"){let it=j.replace(/^\//,"").split("/");st="/"+et.replace(/^\//,"").split("/").slice(it.length).join("/")}let at=matchRoutes(s,{pathname:st});warning($||at!=null,`No routes matched location "${tt.pathname}${tt.search}${tt.hash}" `),warning(at==null||at[at.length-1].route.element!==void 0||at[at.length-1].route.Component!==void 0||at[at.length-1].route.lazy!==void 0,`Matched leaf route at location "${tt.pathname}${tt.search}${tt.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let rt=_renderMatches(at&&at.map(it=>Object.assign({},it,{params:Object.assign({},b,it.params),pathname:joinPaths([j,c.encodeLocation?c.encodeLocation(it.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:it.pathname]),pathnameBase:it.pathnameBase==="/"?j:joinPaths([j,c.encodeLocation?c.encodeLocation(it.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:it.pathnameBase])})),d,i,a,o);return e&&rt?reactExports.createElement(LocationContext.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...tt},navigationType:"POP"}},rt):rt}function DefaultErrorComponent(){let s=useRouteError(),e=isRouteErrorResponse(s)?`${s.status} ${s.statusText}`:s instanceof Error?s.message:JSON.stringify(s),i=s instanceof Error?s.stack:null,a="rgba(200,200,200, 0.5)",o={padding:"0.5rem",backgroundColor:a},c={padding:"2px 4px",backgroundColor:a},d=null;return console.error("Error handled by React Router default ErrorBoundary:",s),d=reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("p",null," Hey developer "),reactExports.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",reactExports.createElement("code",{style:c},"ErrorBoundary")," or"," ",reactExports.createElement("code",{style:c},"errorElement")," prop on your route.")),reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("h2",null,"Unexpected Application Error!"),reactExports.createElement("h3",{style:{fontStyle:"italic"}},e),i?reactExports.createElement("pre",{style:o},i):null,d)}var defaultErrorElement=reactExports.createElement(DefaultErrorComponent,null),RenderErrorBoundary=class extends reactExports.Component{constructor(s){super(s),this.state={location:s.location,revalidation:s.revalidation,error:s.error}}static getDerivedStateFromError(s){return{error:s}}static getDerivedStateFromProps(s,e){return e.location!==s.location||e.revalidation!=="idle"&&s.revalidation==="idle"?{error:s.error,location:s.location,revalidation:s.revalidation}:{error:s.error!==void 0?s.error:e.error,location:e.location,revalidation:s.revalidation||e.revalidation}}componentDidCatch(s,e){this.props.unstable_onError?this.props.unstable_onError(s,e):console.error("React Router caught the following error during render",s)}render(){return this.state.error!==void 0?reactExports.createElement(RouteContext.Provider,{value:this.props.routeContext},reactExports.createElement(RouteErrorContext.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function RenderedRoute({routeContext:s,match:e,children:i}){let a=reactExports.useContext(DataRouterContext);return a&&a.static&&a.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=e.route.id),reactExports.createElement(RouteContext.Provider,{value:s},i)}function _renderMatches(s,e=[],i=null,a=null,o=null){if(s==null){if(!i)return null;if(i.errors)s=i.matches;else if(e.length===0&&!i.initialized&&i.matches.length>0)s=i.matches;else return null}let c=s,d=i==null?void 0:i.errors;if(d!=null){let _=c.findIndex(j=>j.route.id&&(d==null?void 0:d[j.route.id])!==void 0);invariant$1(_>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(d).join(",")}`),c=c.slice(0,Math.min(c.length,_+1))}let g=!1,b=-1;if(i)for(let _=0;_<c.length;_++){let j=c[_];if((j.route.HydrateFallback||j.route.hydrateFallbackElement)&&(b=_),j.route.id){let{loaderData:$,errors:_e}=i,tt=j.route.loader&&!$.hasOwnProperty(j.route.id)&&(!_e||_e[j.route.id]===void 0);if(j.route.lazy||tt){g=!0,b>=0?c=c.slice(0,b+1):c=[c[0]];break}}}return c.reduceRight((_,j,$)=>{let _e,tt=!1,et=null,st=null;i&&(_e=d&&j.route.id?d[j.route.id]:void 0,et=j.route.errorElement||defaultErrorElement,g&&(b<0&&$===0?(warningOnce("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),tt=!0,st=null):b===$&&(tt=!0,st=j.route.hydrateFallbackElement||null)));let at=e.concat(c.slice(0,$+1)),rt=()=>{let nt;return _e?nt=et:tt?nt=st:j.route.Component?nt=reactExports.createElement(j.route.Component,null):j.route.element?nt=j.route.element:nt=_,reactExports.createElement(RenderedRoute,{match:j,routeContext:{outlet:_,matches:at,isDataRoute:i!=null},children:nt})};return i&&(j.route.ErrorBoundary||j.route.errorElement||$===0)?reactExports.createElement(RenderErrorBoundary,{location:i.location,revalidation:i.revalidation,component:et,error:_e,children:rt(),routeContext:{outlet:null,matches:at,isDataRoute:!0},unstable_onError:a}):rt()},null)}function getDataRouterConsoleError(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function useDataRouterContext(s){let e=reactExports.useContext(DataRouterContext);return invariant$1(e,getDataRouterConsoleError(s)),e}function useDataRouterState(s){let e=reactExports.useContext(DataRouterStateContext);return invariant$1(e,getDataRouterConsoleError(s)),e}function useRouteContext(s){let e=reactExports.useContext(RouteContext);return invariant$1(e,getDataRouterConsoleError(s)),e}function useCurrentRouteId(s){let e=useRouteContext(s),i=e.matches[e.matches.length-1];return invariant$1(i.route.id,`${s} can only be used on routes that contain a unique "id"`),i.route.id}function useRouteId(){return useCurrentRouteId("useRouteId")}function useRouteError(){var a;let s=reactExports.useContext(RouteErrorContext),e=useDataRouterState("useRouteError"),i=useCurrentRouteId("useRouteError");return s!==void 0?s:(a=e.errors)==null?void 0:a[i]}function useNavigateStable(){let{router:s}=useDataRouterContext("useNavigate"),e=useCurrentRouteId("useNavigate"),i=reactExports.useRef(!1);return useIsomorphicLayoutEffect$1(()=>{i.current=!0}),reactExports.useCallback(async(o,c={})=>{warning(i.current,navigateEffectWarning),i.current&&(typeof o=="number"?s.navigate(o):await s.navigate(o,{fromRouteId:e,...c}))},[s,e])}var alreadyWarned={};function warningOnce(s,e,i){!e&&!alreadyWarned[s]&&(alreadyWarned[s]=!0,warning(!1,i))}reactExports.memo(DataRoutes);function DataRoutes({routes:s,future:e,state:i,unstable_onError:a}){return useRoutesImpl(s,void 0,i,a,e)}function Navigate({to:s,replace:e,state:i,relative:a}){invariant$1(useInRouterContext(),"<Navigate> may be used only in the context of a <Router> component.");let{static:o}=reactExports.useContext(NavigationContext);warning(!o,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:c}=reactExports.useContext(RouteContext),{pathname:d}=useLocation(),g=useNavigate(),b=resolveTo(s,getResolveToMatches(c),d,a==="path"),_=JSON.stringify(b);return reactExports.useEffect(()=>{g(JSON.parse(_),{replace:e,state:i,relative:a})},[g,_,a,e,i]),null}function Outlet(s){return useOutlet(s.context)}function Route(s){invariant$1(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Router({basename:s="/",children:e=null,location:i,navigationType:a="POP",navigator:o,static:c=!1}){invariant$1(!useInRouterContext(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let d=s.replace(/^\/*/,"/"),g=reactExports.useMemo(()=>({basename:d,navigator:o,static:c,future:{}}),[d,o,c]);typeof i=="string"&&(i=parsePath(i));let{pathname:b="/",search:_="",hash:j="",state:$=null,key:_e="default"}=i,tt=reactExports.useMemo(()=>{let et=stripBasename(b,d);return et==null?null:{location:{pathname:et,search:_,hash:j,state:$,key:_e},navigationType:a}},[d,b,_,j,$,_e,a]);return warning(tt!=null,`<Router basename="${d}"> is not able to match the URL "${b}${_}${j}" because it does not start with the basename, so the <Router> won't render anything.`),tt==null?null:reactExports.createElement(NavigationContext.Provider,{value:g},reactExports.createElement(LocationContext.Provider,{children:e,value:tt}))}function Routes({children:s,location:e}){return useRoutes(createRoutesFromChildren(s),e)}function createRoutesFromChildren(s,e=[]){let i=[];return reactExports.Children.forEach(s,(a,o)=>{if(!reactExports.isValidElement(a))return;let c=[...e,o];if(a.type===reactExports.Fragment){i.push.apply(i,createRoutesFromChildren(a.props.children,c));return}invariant$1(a.type===Route,`[${typeof a.type=="string"?a.type:a.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),invariant$1(!a.props.index||!a.props.children,"An index route cannot have child routes.");let d={id:a.props.id||c.join("-"),caseSensitive:a.props.caseSensitive,element:a.props.element,Component:a.props.Component,index:a.props.index,path:a.props.path,middleware:a.props.middleware,loader:a.props.loader,action:a.props.action,hydrateFallbackElement:a.props.hydrateFallbackElement,HydrateFallback:a.props.HydrateFallback,errorElement:a.props.errorElement,ErrorBoundary:a.props.ErrorBoundary,hasErrorBoundary:a.props.hasErrorBoundary===!0||a.props.ErrorBoundary!=null||a.props.errorElement!=null,shouldRevalidate:a.props.shouldRevalidate,handle:a.props.handle,lazy:a.props.lazy};a.props.children&&(d.children=createRoutesFromChildren(a.props.children,c)),i.push(d)}),i}var defaultMethod="get",defaultEncType="application/x-www-form-urlencoded";function isHtmlElement(s){return s!=null&&typeof s.tagName=="string"}function isButtonElement(s){return isHtmlElement(s)&&s.tagName.toLowerCase()==="button"}function isFormElement(s){return isHtmlElement(s)&&s.tagName.toLowerCase()==="form"}function isInputElement(s){return isHtmlElement(s)&&s.tagName.toLowerCase()==="input"}function isModifiedEvent(s){return!!(s.metaKey||s.altKey||s.ctrlKey||s.shiftKey)}function shouldProcessLinkClick(s,e){return s.button===0&&(!e||e==="_self")&&!isModifiedEvent(s)}var _formDataSupportsSubmitter=null;function isFormDataSubmitterSupported(){if(_formDataSupportsSubmitter===null)try{new FormData(document.createElement("form"),0),_formDataSupportsSubmitter=!1}catch{_formDataSupportsSubmitter=!0}return _formDataSupportsSubmitter}var supportedFormEncTypes=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function getFormEncType(s){return s!=null&&!supportedFormEncTypes.has(s)?(warning(!1,`"${s}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${defaultEncType}"`),null):s}function getFormSubmissionInfo(s,e){let i,a,o,c,d;if(isFormElement(s)){let g=s.getAttribute("action");a=g?stripBasename(g,e):null,i=s.getAttribute("method")||defaultMethod,o=getFormEncType(s.getAttribute("enctype"))||defaultEncType,c=new FormData(s)}else if(isButtonElement(s)||isInputElement(s)&&(s.type==="submit"||s.type==="image")){let g=s.form;if(g==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let b=s.getAttribute("formaction")||g.getAttribute("action");if(a=b?stripBasename(b,e):null,i=s.getAttribute("formmethod")||g.getAttribute("method")||defaultMethod,o=getFormEncType(s.getAttribute("formenctype"))||getFormEncType(g.getAttribute("enctype"))||defaultEncType,c=new FormData(g,s),!isFormDataSubmitterSupported()){let{name:_,type:j,value:$}=s;if(j==="image"){let _e=_?`${_}.`:"";c.append(`${_e}x`,"0"),c.append(`${_e}y`,"0")}else _&&c.append(_,$)}}else{if(isHtmlElement(s))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');i=defaultMethod,a=null,o=defaultEncType,d=s}return c&&o==="text/plain"&&(d=c,c=void 0),{action:a,method:i.toLowerCase(),encType:o,formData:c,body:d}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function invariant2(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function singleFetchUrl(s,e,i){let a=typeof s=="string"?new URL(s,typeof window>"u"?"server://singlefetch/":window.location.origin):s;return a.pathname==="/"?a.pathname=`_root.${i}`:e&&stripBasename(a.pathname,e)==="/"?a.pathname=`${e.replace(/\/$/,"")}/_root.${i}`:a.pathname=`${a.pathname.replace(/\/$/,"")}.${i}`,a}async function loadRouteModule(s,e){if(s.id in e)return e[s.id];try{let i=await import(s.module);return e[s.id]=i,i}catch(i){return console.error(`Error loading route module \`${s.module}\`, reloading page...`),console.error(i),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function isHtmlLinkDescriptor(s){return s==null?!1:s.href==null?s.rel==="preload"&&typeof s.imageSrcSet=="string"&&typeof s.imageSizes=="string":typeof s.rel=="string"&&typeof s.href=="string"}async function getKeyedPrefetchLinks(s,e,i){let a=await Promise.all(s.map(async o=>{let c=e.routes[o.route.id];if(c){let d=await loadRouteModule(c,i);return d.links?d.links():[]}return[]}));return dedupeLinkDescriptors(a.flat(1).filter(isHtmlLinkDescriptor).filter(o=>o.rel==="stylesheet"||o.rel==="preload").map(o=>o.rel==="stylesheet"?{...o,rel:"prefetch",as:"style"}:{...o,rel:"prefetch"}))}function getNewMatchesForLinks(s,e,i,a,o,c){let d=(b,_)=>i[_]?b.route.id!==i[_].route.id:!0,g=(b,_)=>{var j;return i[_].pathname!==b.pathname||((j=i[_].route.path)==null?void 0:j.endsWith("*"))&&i[_].params["*"]!==b.params["*"]};return c==="assets"?e.filter((b,_)=>d(b,_)||g(b,_)):c==="data"?e.filter((b,_)=>{var $;let j=a.routes[b.route.id];if(!j||!j.hasLoader)return!1;if(d(b,_)||g(b,_))return!0;if(b.route.shouldRevalidate){let _e=b.route.shouldRevalidate({currentUrl:new URL(o.pathname+o.search+o.hash,window.origin),currentParams:(($=i[0])==null?void 0:$.params)||{},nextUrl:new URL(s,window.origin),nextParams:b.params,defaultShouldRevalidate:!0});if(typeof _e=="boolean")return _e}return!0}):[]}function getModuleLinkHrefs(s,e,{includeHydrateFallback:i}={}){return dedupeHrefs(s.map(a=>{let o=e.routes[a.route.id];if(!o)return[];let c=[o.module];return o.clientActionModule&&(c=c.concat(o.clientActionModule)),o.clientLoaderModule&&(c=c.concat(o.clientLoaderModule)),i&&o.hydrateFallbackModule&&(c=c.concat(o.hydrateFallbackModule)),o.imports&&(c=c.concat(o.imports)),c}).flat(1))}function dedupeHrefs(s){return[...new Set(s)]}function sortKeys(s){let e={},i=Object.keys(s).sort();for(let a of i)e[a]=s[a];return e}function dedupeLinkDescriptors(s,e){let i=new Set;return new Set(e),s.reduce((a,o)=>{let c=JSON.stringify(sortKeys(o));return i.has(c)||(i.add(c),a.push({key:c,link:o})),a},[])}function useDataRouterContext2(){let s=reactExports.useContext(DataRouterContext);return invariant2(s,"You must render this element inside a <DataRouterContext.Provider> element"),s}function useDataRouterStateContext(){let s=reactExports.useContext(DataRouterStateContext);return invariant2(s,"You must render this element inside a <DataRouterStateContext.Provider> element"),s}var FrameworkContext=reactExports.createContext(void 0);FrameworkContext.displayName="FrameworkContext";function useFrameworkContext(){let s=reactExports.useContext(FrameworkContext);return invariant2(s,"You must render this element inside a <HydratedRouter> element"),s}function usePrefetchBehavior(s,e){let i=reactExports.useContext(FrameworkContext),[a,o]=reactExports.useState(!1),[c,d]=reactExports.useState(!1),{onFocus:g,onBlur:b,onMouseEnter:_,onMouseLeave:j,onTouchStart:$}=e,_e=reactExports.useRef(null);reactExports.useEffect(()=>{if(s==="render"&&d(!0),s==="viewport"){let st=rt=>{rt.forEach(nt=>{d(nt.isIntersecting)})},at=new IntersectionObserver(st,{threshold:.5});return _e.current&&at.observe(_e.current),()=>{at.disconnect()}}},[s]),reactExports.useEffect(()=>{if(a){let st=setTimeout(()=>{d(!0)},100);return()=>{clearTimeout(st)}}},[a]);let tt=()=>{o(!0)},et=()=>{o(!1),d(!1)};return i?s!=="intent"?[c,_e,{}]:[c,_e,{onFocus:composeEventHandlers(g,tt),onBlur:composeEventHandlers(b,et),onMouseEnter:composeEventHandlers(_,tt),onMouseLeave:composeEventHandlers(j,et),onTouchStart:composeEventHandlers($,tt)}]:[!1,_e,{}]}function composeEventHandlers(s,e){return i=>{s&&s(i),i.defaultPrevented||e(i)}}function PrefetchPageLinks({page:s,...e}){let{router:i}=useDataRouterContext2(),a=reactExports.useMemo(()=>matchRoutes(i.routes,s,i.basename),[i.routes,s,i.basename]);return a?reactExports.createElement(PrefetchPageLinksImpl,{page:s,matches:a,...e}):null}function useKeyedPrefetchLinks(s){let{manifest:e,routeModules:i}=useFrameworkContext(),[a,o]=reactExports.useState([]);return reactExports.useEffect(()=>{let c=!1;return getKeyedPrefetchLinks(s,e,i).then(d=>{c||o(d)}),()=>{c=!0}},[s,e,i]),a}function PrefetchPageLinksImpl({page:s,matches:e,...i}){let a=useLocation(),{manifest:o,routeModules:c}=useFrameworkContext(),{basename:d}=useDataRouterContext2(),{loaderData:g,matches:b}=useDataRouterStateContext(),_=reactExports.useMemo(()=>getNewMatchesForLinks(s,e,b,o,a,"data"),[s,e,b,o,a]),j=reactExports.useMemo(()=>getNewMatchesForLinks(s,e,b,o,a,"assets"),[s,e,b,o,a]),$=reactExports.useMemo(()=>{if(s===a.pathname+a.search+a.hash)return[];let et=new Set,st=!1;if(e.forEach(rt=>{var it;let nt=o.routes[rt.route.id];!nt||!nt.hasLoader||(!_.some(ot=>ot.route.id===rt.route.id)&&rt.route.id in g&&((it=c[rt.route.id])!=null&&it.shouldRevalidate)||nt.hasClientLoader?st=!0:et.add(rt.route.id))}),et.size===0)return[];let at=singleFetchUrl(s,d,"data");return st&&et.size>0&&at.searchParams.set("_routes",e.filter(rt=>et.has(rt.route.id)).map(rt=>rt.route.id).join(",")),[at.pathname+at.search]},[d,g,a,o,_,e,s,c]),_e=reactExports.useMemo(()=>getModuleLinkHrefs(j,o),[j,o]),tt=useKeyedPrefetchLinks(j);return reactExports.createElement(reactExports.Fragment,null,$.map(et=>reactExports.createElement("link",{key:et,rel:"prefetch",as:"fetch",href:et,...i})),_e.map(et=>reactExports.createElement("link",{key:et,rel:"modulepreload",href:et,...i})),tt.map(({key:et,link:st})=>reactExports.createElement("link",{key:et,nonce:i.nonce,...st})))}function mergeRefs(...s){return e=>{s.forEach(i=>{typeof i=="function"?i(e):i!=null&&(i.current=e)})}}var isBrowser$1=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{isBrowser$1&&(window.__reactRouterVersion="7.9.5")}catch{}function HashRouter({basename:s,children:e,window:i}){let a=reactExports.useRef();a.current==null&&(a.current=createHashHistory({window:i,v5Compat:!0}));let o=a.current,[c,d]=reactExports.useState({action:o.action,location:o.location}),g=reactExports.useCallback(b=>{reactExports.startTransition(()=>d(b))},[d]);return reactExports.useLayoutEffect(()=>o.listen(g),[o,g]),reactExports.createElement(Router,{basename:s,children:e,location:c.location,navigationType:c.action,navigator:o})}var ABSOLUTE_URL_REGEX2=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Link=reactExports.forwardRef(function({onClick:e,discover:i="render",prefetch:a="none",relative:o,reloadDocument:c,replace:d,state:g,target:b,to:_,preventScrollReset:j,viewTransition:$,..._e},tt){let{basename:et}=reactExports.useContext(NavigationContext),st=typeof _=="string"&&ABSOLUTE_URL_REGEX2.test(_),at,rt=!1;if(typeof _=="string"&&st&&(at=_,isBrowser$1))try{let gt=new URL(window.location.href),vt=_.startsWith("//")?new URL(gt.protocol+_):new URL(_),St=stripBasename(vt.pathname,et);vt.origin===gt.origin&&St!=null?_=St+vt.search+vt.hash:rt=!0}catch{warning(!1,`<Link to="${_}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let nt=useHref(_,{relative:o}),[it,ot,lt]=usePrefetchBehavior(a,_e),ct=useLinkClickHandler(_,{replace:d,state:g,target:b,preventScrollReset:j,relative:o,viewTransition:$});function ht(gt){e&&e(gt),gt.defaultPrevented||ct(gt)}let dt=reactExports.createElement("a",{..._e,...lt,href:at||nt,onClick:rt||c?e:ht,ref:mergeRefs(tt,ot),target:b,"data-discover":!st&&i==="render"?"true":void 0});return it&&!st?reactExports.createElement(reactExports.Fragment,null,dt,reactExports.createElement(PrefetchPageLinks,{page:nt})):dt});Link.displayName="Link";var NavLink=reactExports.forwardRef(function({"aria-current":e="page",caseSensitive:i=!1,className:a="",end:o=!1,style:c,to:d,viewTransition:g,children:b,..._},j){let $=useResolvedPath(d,{relative:_.relative}),_e=useLocation(),tt=reactExports.useContext(DataRouterStateContext),{navigator:et,basename:st}=reactExports.useContext(NavigationContext),at=tt!=null&&useViewTransitionState($)&&g===!0,rt=et.encodeLocation?et.encodeLocation($).pathname:$.pathname,nt=_e.pathname,it=tt&&tt.navigation&&tt.navigation.location?tt.navigation.location.pathname:null;i||(nt=nt.toLowerCase(),it=it?it.toLowerCase():null,rt=rt.toLowerCase()),it&&st&&(it=stripBasename(it,st)||it);const ot=rt!=="/"&&rt.endsWith("/")?rt.length-1:rt.length;let lt=nt===rt||!o&&nt.startsWith(rt)&&nt.charAt(ot)==="/",ct=it!=null&&(it===rt||!o&&it.startsWith(rt)&&it.charAt(rt.length)==="/"),ht={isActive:lt,isPending:ct,isTransitioning:at},dt=lt?e:void 0,gt;typeof a=="function"?gt=a(ht):gt=[a,lt?"active":null,ct?"pending":null,at?"transitioning":null].filter(Boolean).join(" ");let vt=typeof c=="function"?c(ht):c;return reactExports.createElement(Link,{..._,"aria-current":dt,className:gt,ref:j,style:vt,to:d,viewTransition:g},typeof b=="function"?b(ht):b)});NavLink.displayName="NavLink";var Form=reactExports.forwardRef(({discover:s="render",fetcherKey:e,navigate:i,reloadDocument:a,replace:o,state:c,method:d=defaultMethod,action:g,onSubmit:b,relative:_,preventScrollReset:j,viewTransition:$,..._e},tt)=>{let et=useSubmit(),st=useFormAction(g,{relative:_}),at=d.toLowerCase()==="get"?"get":"post",rt=typeof g=="string"&&ABSOLUTE_URL_REGEX2.test(g),nt=it=>{if(b&&b(it),it.defaultPrevented)return;it.preventDefault();let ot=it.nativeEvent.submitter,lt=(ot==null?void 0:ot.getAttribute("formmethod"))||d;et(ot||it.currentTarget,{fetcherKey:e,method:lt,navigate:i,replace:o,state:c,relative:_,preventScrollReset:j,viewTransition:$})};return reactExports.createElement("form",{ref:tt,method:at,action:st,onSubmit:a?b:nt,..._e,"data-discover":!rt&&s==="render"?"true":void 0})});Form.displayName="Form";function getDataRouterConsoleError2(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function useDataRouterContext3(s){let e=reactExports.useContext(DataRouterContext);return invariant$1(e,getDataRouterConsoleError2(s)),e}function useLinkClickHandler(s,{target:e,replace:i,state:a,preventScrollReset:o,relative:c,viewTransition:d}={}){let g=useNavigate(),b=useLocation(),_=useResolvedPath(s,{relative:c});return reactExports.useCallback(j=>{if(shouldProcessLinkClick(j,e)){j.preventDefault();let $=i!==void 0?i:createPath(b)===createPath(_);g(s,{replace:$,state:a,preventScrollReset:o,relative:c,viewTransition:d})}},[b,g,_,i,a,e,s,o,c,d])}var fetcherId=0,getUniqueFetcherId=()=>`__${String(++fetcherId)}__`;function useSubmit(){let{router:s}=useDataRouterContext3("useSubmit"),{basename:e}=reactExports.useContext(NavigationContext),i=useRouteId();return reactExports.useCallback(async(a,o={})=>{let{action:c,method:d,encType:g,formData:b,body:_}=getFormSubmissionInfo(a,e);if(o.navigate===!1){let j=o.fetcherKey||getUniqueFetcherId();await s.fetch(j,i,o.action||c,{preventScrollReset:o.preventScrollReset,formData:b,body:_,formMethod:o.method||d,formEncType:o.encType||g,flushSync:o.flushSync})}else await s.navigate(o.action||c,{preventScrollReset:o.preventScrollReset,formData:b,body:_,formMethod:o.method||d,formEncType:o.encType||g,replace:o.replace,state:o.state,fromRouteId:i,flushSync:o.flushSync,viewTransition:o.viewTransition})},[s,e,i])}function useFormAction(s,{relative:e}={}){let{basename:i}=reactExports.useContext(NavigationContext),a=reactExports.useContext(RouteContext);invariant$1(a,"useFormAction must be used inside a RouteContext");let[o]=a.matches.slice(-1),c={...useResolvedPath(s||".",{relative:e})},d=useLocation();if(s==null){c.search=d.search;let g=new URLSearchParams(c.search),b=g.getAll("index");if(b.some(j=>j==="")){g.delete("index"),b.filter($=>$).forEach($=>g.append("index",$));let j=g.toString();c.search=j?`?${j}`:""}}return(!s||s===".")&&o.route.index&&(c.search=c.search?c.search.replace(/^\?/,"?index&"):"?index"),i!=="/"&&(c.pathname=c.pathname==="/"?i:joinPaths([i,c.pathname])),createPath(c)}function useViewTransitionState(s,{relative:e}={}){let i=reactExports.useContext(ViewTransitionContext);invariant$1(i!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:a}=useDataRouterContext3("useViewTransitionState"),o=useResolvedPath(s,{relative:e});if(!i.isTransitioning)return!1;let c=stripBasename(i.currentLocation.pathname,a)||i.currentLocation.pathname,d=stripBasename(i.nextLocation.pathname,a)||i.nextLocation.pathname;return matchPath(o.pathname,d)!=null||matchPath(o.pathname,c)!=null}const TrendingMoviesLanding=({isActive:s,onNavigate:e})=>{const[i,a]=reactExports.useState(!1),[o,c]=reactExports.useState(null),[d,g]=reactExports.useState([]),b=useNavigate(),{selectedIndex:_,containerRef:j}=useDpadNavigation({totalItems:d.length,columns:d.length,enabled:s&&d.length>0,onEnter:st=>{const at=d[st];at&&b(`/movie/${at.uuid}`)},onDirectionChange:(st,at)=>{!at&&(st==="ArrowDown"||st==="ArrowUp")&&e(st)}}),$=reactExports.useRef(null),_e=reactExports.useCallback(async()=>{try{a(!0),c(null);const at=(await Movieapi.get("trendingmovieslanding")).data;if(at.status==="error")throw new Error(at.message);g((at==null?void 0:at.trending_movie_details)||[])}catch(st){c(st.message||"Failed to fetch trending movies.")}finally{a(!1)}},[]);reactExports.useEffect(()=>{_e()},[_e]);const tt=reactExports.useCallback(st=>{const at=$.current;at&&(st.key==="ArrowRight"?at.scrollBy({left:300,behavior:"smooth"}):st.key==="ArrowLeft"&&at.scrollBy({left:-300,behavior:"smooth"}))},[]);reactExports.useEffect(()=>(window.addEventListener("keydown",tt),()=>window.removeEventListener("keydown",tt)),[tt]);const et=reactExports.useCallback(st=>{b(`/movie/${st.uuid}`)},[b]);return jsxRuntimeExports.jsxs("div",{className:"relative py-10 bg-linear-to-b from-[#0a0a0a] to-[#702728]",children:[jsxRuntimeExports.jsx("div",{className:"px-6 mb-6",children:jsxRuntimeExports.jsx(SectionHeading,{title:"Trending Movies",styleclass:"ml-2"})}),i?jsxRuntimeExports.jsx("div",{className:"flex gap-6 overflow-x-auto px-6 scrollbar-hide",children:[1,2,3,4,5,6].map(st=>jsxRuntimeExports.jsx("div",{className:"w-[200px] h-[300px] bg-gray-800 animate-pulse rounded-lg"},st))}):o?jsxRuntimeExports.jsx("div",{className:"text-center text-red-400",children:o}):d.length===0?jsxRuntimeExports.jsx("div",{className:"text-center text-white",children:"No Trending Movies Found."}):jsxRuntimeExports.jsx("div",{ref:j,className:"flex gap-6 overflow-x-auto px-6 pb-6 scrollbar-hide focus:outline-none",children:d.map((st,at)=>jsxRuntimeExports.jsx(MovieThumbnail,{isFocused:s&&_===at,source:st.main_thumbnail,alt:st.title,onClick:()=>et(st)},at))})]})},features=[{icon:"",title:"Stream. Share. Earn. Power in your hands",desc:"With Book My Theatre, share a movie and earn 30% of the net revenue when someone watches via your link. Our patented model ensures you get paid quarterly with a 10% bonus every March 31st."},{icon:"",title:"Fair prices, Everywhere. Cinema Without Borders.",desc:"Our gen-based pricing ensures that whether youre in New York or Nairobi, watching world-class films is affordable and accessible."},{icon:"",title:"Your Wallet is Legit. Instant, Clear, Secure.",desc:"Track every rupee in real-time through our blockchain-secured wallet. Transparent. Secure. Always in control."},{icon:"",title:"Back Creators. Shape Tomorrow",desc:"Each ticket you help move is direct support to those making cinema happen. This is more than streamingits a creator-powered revolution."}],FeatureGrid=()=>jsxRuntimeExports.jsxs("div",{className:" px-6 ml-2",children:[jsxRuntimeExports.jsx(SectionHeading,{title:"Why Book My Theatre?"}),jsxRuntimeExports.jsx("div",{className:"flex flex-wrap justify-between mt-6 gap-4",children:features.map((s,e)=>jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center bg-[#eee6e6] rounded-2xl p-5 w-[23%] min-w-[250px]",children:[jsxRuntimeExports.jsx("div",{className:"text-2xl mb-2 text-[#772728]",children:s.icon}),jsxRuntimeExports.jsx("h3",{className:"text-black font-bold text-center mb-1",children:s.title}),jsxRuntimeExports.jsx("p",{className:"text-black/70 text-sm text-justify",children:s.desc})]},e))})]}),faqs=[{question:"What is Book My Theatre?",answer:"Book My Theatre (BMT) is a digital streaming and movie-sharing platform designed for global audiences and creators."},{question:"How can I earn money on Book My Theatre?",answer:"You can earn by sharing movies using your referral link. You get a commission when someone watches through your link."},{question:"Is Book My Theatre free to use?",answer:"Yes, registration is free. Some premium movies require a one-time payment or rent."},{question:"Do I need a subscription to watch movies?",answer:"No monthly subscription  you only pay for what you watch."},{question:"How do filmmakers earn from Book My Theatre?",answer:"Filmmakers receive fair revenue every time their movie is watched on the platform."},{question:"Can I upload my own movie?",answer:"Yes, verified creators can upload films through the BMT Creator Portal."},{question:"What types of movies are available?",answer:"BMT offers regional, independent, short films, and global cinema across genres."},{question:"Is Book My Theatre available worldwide?",answer:"Yes, it's a global platform with localized recommendations and payments."},{question:"Does BMT support multiple languages?",answer:"Yes, users can browse and stream content in multiple languages."},{question:"How is BMT different from other OTT platforms?",answer:"BMT combines streaming, affiliate earnings, and fair creator payouts."},{question:"Is my payment information secure?",answer:"Yes, all payments are processed via secure, encrypted gateways."},{question:"Can I watch offline?",answer:"Currently, offline downloads are not supported but streaming is seamless."},{question:"How do I become an affiliate?",answer:"Sign up, verify, and start sharing referral links to earn instantly."},{question:"Can I watch on my Smart TV?",answer:"Yes! BMT supports Android TV, Firestick, and web browsers."},{question:"Does BMT have subtitles?",answer:"Yes, most titles have subtitles, and more languages are coming soon."},{question:"Is there an age restriction on content?",answer:"Some content is restricted by age. Parental guidance is advised."},{question:"Can I share movies with my friends?",answer:"Yes! Share your link and earn rewards for every successful watch."},{question:"How do I contact support?",answer:"You can email support@bookmytheatre.com or use the Help section in-app."},{question:"Can I request a refund?",answer:"Refunds are handled on a case-by-case basis per the refund policy."},{question:"Does Book My Theatre work on all devices?",answer:"Yes, you can use BMT on mobile, web, and TV platforms."},{question:"Is Book My Theatre legal and safe?",answer:"Absolutely. BMT is fully licensed, secure, and respects creator rights."}],FAQSection=()=>{const s=Math.ceil(faqs.length/2),e=faqs.slice(0,s),i=faqs.slice(s);return jsxRuntimeExports.jsxs("div",{className:"bg-[#712728] py-10 px-6 ml-2",children:[jsxRuntimeExports.jsx(SectionHeading,{title:"Frequently Asked Questions"}),jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap justify-between mt-8 gap-4",children:[jsxRuntimeExports.jsx("div",{className:"w-full md:w-[48%]",children:e.map((a,o)=>jsxRuntimeExports.jsxs("div",{className:"bg-black border border-[#B54445] rounded-2xl p-4 mb-4 flex",children:[jsxRuntimeExports.jsx("div",{className:"w-7 h-7 rounded-full flex items-center justify-center mr-3",children:jsxRuntimeExports.jsx("p",{className:"text-[#FFD700]/70 font-bold",children:o+1})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-[#FFD700]/70 text-base font-semibold mb-2",children:a.question}),jsxRuntimeExports.jsx("p",{className:"text-white text-sm leading-5",children:a.answer})]})]},o))}),jsxRuntimeExports.jsx("div",{className:"w-full md:w-[48%]",children:i.map((a,o)=>jsxRuntimeExports.jsxs("div",{className:"bg-black border border-[#B54445] rounded-2xl p-4 mb-4 flex",children:[jsxRuntimeExports.jsx("div",{className:"w-7 h-7 rounded-full flex items-center justify-center mr-3",children:jsxRuntimeExports.jsx("p",{className:"text-[#FFD700]/70 font-bold",children:o+s+1})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-[#FFD700]/70 text-base font-semibold mb-2",children:a.question}),jsxRuntimeExports.jsx("p",{className:"text-white text-sm leading-5",children:a.answer})]})]},o+s))})]})]})},SECTIONS$2={HERO:0,TRENDING:1,NONE:-1},LandingPage=()=>{const s=useNavigate(),e=reactExports.useRef(null),[i,a]=reactExports.useState(SECTIONS$2.HERO),o=reactExports.useCallback(c=>{let d=!1;return c==="ArrowDown"?a(g=>g===SECTIONS$2.HERO?(d=!0,SECTIONS$2.TRENDING):g===SECTIONS$2.TRENDING?(d=!0,SECTIONS$2.NONE):g):c==="ArrowUp"&&a(g=>g===SECTIONS$2.TRENDING?(d=!0,SECTIONS$2.HERO):g===SECTIONS$2.NONE?(d=!0,SECTIONS$2.TRENDING):g),d},[]);return reactExports.useEffect(()=>{const c=d=>{(d.key==="ArrowUp"||d.key==="ArrowDown")&&(o(d.key)?d.preventDefault():i===SECTIONS$2.NONE&&e.current&&(d.key==="ArrowDown"?e.current.scrollBy({top:200,behavior:"smooth"}):d.key==="ArrowUp"&&e.current.scrollBy({top:-200,behavior:"smooth"}),d.preventDefault()))};return window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[i,o]),jsxRuntimeExports.jsx("div",{className:"flex flex-col  bg-[#712728] h-screen",children:jsxRuntimeExports.jsxs("div",{ref:e,className:"flex-1 w-full overflow-y-auto scroll-smooth focus:outline-none scrollbar-hide",tabIndex:-1,children:[jsxRuntimeExports.jsx(HeroSection,{navigation:s,isActive:i===SECTIONS$2.HERO,onNavigate:o}),jsxRuntimeExports.jsx(TrendingMoviesLanding,{isActive:i===SECTIONS$2.TRENDING,onNavigate:o}),jsxRuntimeExports.jsx(FeatureGrid,{}),jsxRuntimeExports.jsx(FAQSection,{})]})})},background_login=""+new URL("background_login-BLxV17um.png",import.meta.url).href,login_logo=""+new URL("login_logo-CorLwnta.png",import.meta.url).href,Authapi=axios.create({baseURL:`${Config.api_url}/auth/`,withCredentials:!0,headers:{Accept:"application/json","Content-Type":"application/json"}}),createStoreImpl=s=>{let e;const i=new Set,a=(_,j)=>{const $=typeof _=="function"?_(e):_;if(!Object.is($,e)){const _e=e;e=j??(typeof $!="object"||$===null)?$:Object.assign({},e,$),i.forEach(tt=>tt(e,_e))}},o=()=>e,g={setState:a,getState:o,getInitialState:()=>b,subscribe:_=>(i.add(_),()=>i.delete(_))},b=e=s(a,o,g);return g},createStore=s=>s?createStoreImpl(s):createStoreImpl,identity=s=>s;function useStore(s,e=identity){const i=React.useSyncExternalStore(s.subscribe,React.useCallback(()=>e(s.getState()),[s,e]),React.useCallback(()=>e(s.getInitialState()),[s,e]));return React.useDebugValue(i),i}const createImpl=s=>{const e=createStore(s),i=a=>useStore(e,a);return Object.assign(i,e),i},create=s=>s?createImpl(s):createImpl;function createJSONStorage(s,e){let i;try{i=s()}catch{return}return{getItem:o=>{var c;const d=b=>b===null?null:JSON.parse(b,void 0),g=(c=i.getItem(o))!=null?c:null;return g instanceof Promise?g.then(d):d(g)},setItem:(o,c)=>i.setItem(o,JSON.stringify(c,void 0)),removeItem:o=>i.removeItem(o)}}const toThenable=s=>e=>{try{const i=s(e);return i instanceof Promise?i:{then(a){return toThenable(a)(i)},catch(a){return this}}}catch(i){return{then(a){return this},catch(a){return toThenable(a)(i)}}}},persistImpl=(s,e)=>(i,a,o)=>{let c={storage:createJSONStorage(()=>localStorage),partialize:st=>st,version:0,merge:(st,at)=>({...at,...st}),...e},d=!1;const g=new Set,b=new Set;let _=c.storage;if(!_)return s((...st)=>{console.warn(`[zustand persist middleware] Unable to update item '${c.name}', the given storage is currently unavailable.`),i(...st)},a,o);const j=()=>{const st=c.partialize({...a()});return _.setItem(c.name,{state:st,version:c.version})},$=o.setState;o.setState=(st,at)=>($(st,at),j());const _e=s((...st)=>(i(...st),j()),a,o);o.getInitialState=()=>_e;let tt;const et=()=>{var st,at;if(!_)return;d=!1,g.forEach(nt=>{var it;return nt((it=a())!=null?it:_e)});const rt=((at=c.onRehydrateStorage)==null?void 0:at.call(c,(st=a())!=null?st:_e))||void 0;return toThenable(_.getItem.bind(_))(c.name).then(nt=>{if(nt)if(typeof nt.version=="number"&&nt.version!==c.version){if(c.migrate){const it=c.migrate(nt.state,nt.version);return it instanceof Promise?it.then(ot=>[!0,ot]):[!0,it]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,nt.state];return[!1,void 0]}).then(nt=>{var it;const[ot,lt]=nt;if(tt=c.merge(lt,(it=a())!=null?it:_e),i(tt,!0),ot)return j()}).then(()=>{rt==null||rt(tt,void 0),tt=a(),d=!0,b.forEach(nt=>nt(tt))}).catch(nt=>{rt==null||rt(void 0,nt)})};return o.persist={setOptions:st=>{c={...c,...st},st.storage&&(_=st.storage)},clearStorage:()=>{_==null||_.removeItem(c.name)},getOptions:()=>c,rehydrate:()=>et(),hasHydrated:()=>d,onHydrate:st=>(g.add(st),()=>{g.delete(st)}),onFinishHydration:st=>(b.add(st),()=>{b.delete(st)})},c.skipHydration||et(),tt||_e},persist=persistImpl,useUserdetails=create(persist(s=>({userInfo:null,isLogged:!1,access_token:null,updateAuthDetails:(e,i)=>{s({userInfo:e,isLogged:!0,access_token:i})},resetAuthdetails:()=>{s({userInfo:null,isLogged:!1,access_token:null})}}),{name:"userAuthdetails"})),VirtualKeyboard=({isVisible:s,onClose:e,onInput:i,onBackspace:a,onClear:o,currentValue:c=""})=>{const[d,g]=reactExports.useState({row:0,col:0}),[b,_]=reactExports.useState(!1),[j,$]=reactExports.useState(!1),_e=reactExports.useMemo(()=>[["1","2","3","4","5","6","7","8","9","0"],["q","w","e","r","t","y","u","i","o","p"],["a","s","d","f","g","h","j","k","l","@"],["$%^","","z","x","c","v","b","n","m",""],["Space","Clear","Done"]],[]),tt=reactExports.useMemo(()=>[["!","@","#","$","%","^","&","*","(",")"],["-","_","=","+","[","]","{","}","|","\\"],[";",":","'",'"',",","<",".",">","/","?"],["$%^","","`","~","","","","","",""],["Space","Clear","Done"]],[]),et=reactExports.useMemo(()=>j?tt:_e,[j,tt,_e]);reactExports.useEffect(()=>{s&&(g({row:0,col:0}),_(!1),$(!1))},[s]),reactExports.useEffect(()=>{if(!s)return;const rt=et[d.row]||[];if(rt.length===0){g({row:0,col:0});return}d.col>=rt.length&&g(nt=>({row:nt.row,col:rt.length-1}))},[s,et,d.row,d.col]);const st=reactExports.useCallback((rt,nt)=>{var ot;const it=(ot=et[rt])==null?void 0:ot[nt];if(it){if(it===""){a();return}if(it==="Space"){i(" ");return}if(it==="Clear"){o();return}if(it==="Done"){e();return}if(it==="$%^"){$(lt=>!lt);return}if(it===""){_(lt=>!lt);return}if(it.length===1){const ct=/[a-z]/i.test(it)&&!j&&b?it.toUpperCase():it;i(ct)}}},[et,j,b,a,i,o,e]);if(reactExports.useEffect(()=>{if(!s)return;const rt=nt=>{["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Enter","Backspace","Escape"].includes(nt.key)&&nt.preventDefault();const ot=j?tt:_e,lt=ot.length,ct=ot[d.row]||[];nt.key==="ArrowUp"?d.row>0&&g(ht=>{const dt=ht.row-1,gt=ot[dt],vt=Math.min(ht.col,gt.length-1);return{row:dt,col:vt}}):nt.key==="ArrowDown"?d.row<lt-1&&g(ht=>{const dt=ht.row+1,gt=ot[dt],vt=Math.min(ht.col,gt.length-1);return{row:dt,col:vt}}):nt.key==="ArrowLeft"?d.col>0?g(ht=>({row:ht.row,col:ht.col-1})):d.row>0&&g(ht=>{const dt=ht.row-1,gt=ot[dt];return{row:dt,col:gt.length-1}}):nt.key==="ArrowRight"?d.col<ct.length-1?g(ht=>({row:ht.row,col:ht.col+1})):d.row<lt-1&&g(ht=>({row:ht.row+1,col:0})):nt.key==="Enter"?st(d.row,d.col):nt.key==="Backspace"?a():nt.key==="Escape"&&e()};return window.addEventListener("keydown",rt),()=>window.removeEventListener("keydown",rt)},[s,d,j,st,a,e,_e,tt]),!s)return null;const at=rt=>rt==="Space"?"Space":rt===""?b&&!j?"":"":rt.length===1&&/[a-z]/.test(rt)&&!j&&b?rt.toUpperCase():rt;return jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-black/70",children:jsxRuntimeExports.jsxs("div",{className:"bg-gray-900 p-8 rounded-2xl border-2 border-gray-700 shadow-2xl w-[90%] max-w-4xl",children:[jsxRuntimeExports.jsx("div",{className:"mb-6 bg-gray-800 p-4 rounded-lg text-white text-2xl font-mono text-center h-16 flex items-center justify-center",children:c||"Type here..."}),jsxRuntimeExports.jsx("div",{className:"space-y-3 mb-6",children:et.map((rt,nt)=>jsxRuntimeExports.jsx("div",{className:"flex gap-2 justify-center",children:rt.map((it,ot)=>{const lt=d.row===nt&&d.col===ot,ct=["$%^","","","Space","Clear","Done"].includes(it),ht=it==="$%^"&&j||it===""&&b&&!j;return jsxRuntimeExports.jsx("button",{onClick:()=>st(nt,ot),className:`
                      px-4 py-3 rounded-lg font-semibold tracking-wide transition-all transform
                      ${ct?"bg-[#5B0203] text-white":"bg-gray-600 text-white"}
                      ${lt?"scale-105 ring-4 ring-red-600":"hover:bg-gray-500"}
                      ${it==="Space"?"flex-1 px-16":"min-w-[60px]"}
                      ${it==="Done"?"bg-green-600 text-white":""}
                      ${it==="Clear"?"bg-gray-700 text-white":""}
                      ${it===""?"bg-red-700 text-white":""}
                      ${ht?"bg-white text-black":""}
                    `,children:at(it)},`${nt}-${ot}`)})},nt))}),jsxRuntimeExports.jsx("p",{className:"text-gray-400 text-center text-sm",children:"Use arrow keys to navigate  Enter to select  Esc to close"})]})})},BookMyTheatreHeader=()=>jsxRuntimeExports.jsx("div",{className:"absolute top-4 right-8 z-10",children:jsxRuntimeExports.jsx("img",{src:login_logo,alt:"Book My Theatre Logo",className:"w-[150px] h-20 object-contain"})}),Modal=({isOpen:s,onClose:e,children:i,preventClose:a=!1})=>s?jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60",children:jsxRuntimeExports.jsxs("div",{className:"relative",children:[i,!a&&jsxRuntimeExports.jsx("button",{onClick:e,className:"absolute top-2 right-2 text-white hover:text-gray-300","aria-label":"Close modal",children:""})]})}):null,LoginPage=()=>{const{updateAuthDetails:s}=useUserdetails(),[e,i]=reactExports.useState({email:"",password:""}),[a,o]=reactExports.useState(!1),[c,d]=reactExports.useState(null),[g,b]=reactExports.useState(null),[_,j]=reactExports.useState(!1),$=useNavigate(),[_e,tt]=reactExports.useState(!1),[et,st]=reactExports.useState(!1),[at,rt]=reactExports.useState(""),[nt,it]=reactExports.useState(null),ot=reactExports.useRef(!1),[lt,ct]=reactExports.useState(!1),[ht,dt]=reactExports.useState(10),gt=reactExports.useRef(null),vt=reactExports.useRef(null),[St,Tt]=reactExports.useState(!1),[Ct,Rt]=reactExports.useState(null),[bt,pt]=reactExports.useState("FORM"),[yt,ut]=reactExports.useState(0),ft=reactExports.useRef([]),xt=reactExports.useRef(null);reactExports.useEffect(()=>{var kt;bt==="FORM"&&((kt=ft.current[0])==null||kt.focus())},[bt]),reactExports.useEffect(()=>{if(a)return;const kt=Lt=>{var Wt,Nt;if(Lt.preventDefault(),bt==="MODAL"){(Lt.key==="Enter"||Lt.key==="Escape"||Lt.key==="Backspace")&&((Wt=xt.current)==null||Wt.click());return}bt==="FORM"&&(Lt.key==="ArrowDown"?ut(Kt=>Math.min(3,Kt+1)):Lt.key==="ArrowUp"?ut(Kt=>Math.max(0,Kt-1)):Lt.key==="Enter"&&((Nt=ft.current[yt])==null||Nt.click()))};return window.addEventListener("keydown",kt),()=>window.removeEventListener("keydown",kt)},[bt,yt,a]),reactExports.useEffect(()=>{var kt,Lt;bt==="FORM"?(kt=ft.current[yt])==null||kt.focus():bt==="MODAL"&&((Lt=xt.current)==null||Lt.focus())},[yt,bt]);const mt=kt=>{Rt(kt),Tt(!0)},Et=()=>{Tt(!1),Rt(null)},At=kt=>{Ct&&(i(Lt=>({...Lt,[Ct]:Lt[Ct]+kt})),c&&d(null))},Pt=()=>{Ct&&i(kt=>({...kt,[Ct]:kt[Ct].slice(0,-1)}))},wt=()=>{Ct&&i(kt=>({...kt,[Ct]:""}))};console.log("use User Details",useUserdetails);const It=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,Mt=reactExports.useCallback(()=>!e.email||!e.password?(d({message:"Email and password are required."}),!1):It.test(e.email)?!0:(d({message:"Please enter a valid email address."}),!1),[e.email,e.password]),Bt=async()=>{try{const kt=await Authapi.get("/generateqrcode"),Lt=kt.data.qrCode,Wt=kt.data.verifycode;it(Lt),rt(Wt),gt.current&&clearTimeout(gt.current),gt.current=setTimeout(()=>{ct(!0),dt(10),Gt()},6e5)}catch(kt){console.error("Error fetching QR code:",kt)}},Gt=()=>{vt.current&&clearInterval(vt.current),vt.current=setInterval(()=>{dt(kt=>kt<=1?(clearInterval(vt.current),Ft(),10):kt-1)},1e3)},Ft=()=>{ct(!1),dt(10),vt.current&&clearInterval(vt.current),Bt()},Ut=async()=>{if(!ot.current)try{const Lt=(await Authapi.post("verifyqrcode",{verifycode:at})).data;Lt.status==="success"?(ot.current=!0,localStorage.setItem("access_token",Lt.access_token),localStorage.setItem("user_info",JSON.stringify(Lt.user_details)),s(Lt.user_details,Lt.access_token)):Lt.status!=="pending"&&d({message:Lt.message})}catch(kt){console.error("QR verification error:",kt)}},Xt=reactExports.useCallback(async()=>{var Lt;if(o(!0),d(null),!Mt()){o(!1);return}const kt={emailOrPhone:e.email,password:e.password,isEmail:!0};try{const Nt=(await Authapi.post("/user/signin",kt)).data;if((Lt=Nt==null?void 0:Nt.user_details)!=null&&Lt.is_deactivated){d({message:"Your account is deactivated. Please contact support."});return}if(Nt.status==="error"||Nt.status==="error_user_not_found"||Nt.status==="error_invalid_password"){d({message:Nt.message});return}if(Nt.requiresOtp){j(!0),pt("MODAL"),o(!1);return}localStorage.setItem("access_token",Nt.access_token),localStorage.setItem("user_info",JSON.stringify(Nt.user_details)),s(Nt.user_details,Nt.access_token),setTimeout(()=>{$&&$("/browse")},50)}catch{d({message:"Something went wrong. Please try again later."})}finally{o(!1)}},[e,Mt,$,s]);return reactExports.useEffect(()=>(Bt(),()=>{gt.current&&clearTimeout(gt.current),vt.current&&clearInterval(vt.current)}),[]),reactExports.useEffect(()=>{if(!at)return;const kt=setInterval(()=>{Ut()},2e3);return()=>{clearInterval(kt)}},[at]),jsxRuntimeExports.jsxs("div",{className:"relative flex flex-col w-screen h-screen bg-cover bg-center text-white font-sans overflow-hidden",style:{minHeight:"100vh",height:"100vh",width:"100vw",backgroundImage:`url(${background_login})`},children:[jsxRuntimeExports.jsx("div",{className:"absolute inset-0 bg-black/70"}),jsxRuntimeExports.jsx(BookMyTheatreHeader,{}),jsxRuntimeExports.jsx(Modal,{isOpen:_,onClose:()=>j(!1),children:jsxRuntimeExports.jsxs("div",{className:"bg-gray-800 p-10 rounded-lg w-[600px] text-center border border-gray-600",children:[jsxRuntimeExports.jsx("p",{className:"text-white text-2xl mb-8 font-semibold",children:"Please complete the signup process in mobile app or browser to login here"}),jsxRuntimeExports.jsx("button",{ref:xt,onClick:()=>j(!1),className:"bg-red-700 hover:bg-red-800 py-3 px-12 rounded-md text-white font-bold text-lg transition-colors focus:outline-none focus:ring-2 focus:ring-white",children:"OK"})]})}),jsxRuntimeExports.jsx(Modal,{isOpen:_e,onClose:()=>tt(!1),children:jsxRuntimeExports.jsxs("div",{className:"bg-gray-800 p-10 rounded-lg w-[600px] text-center border border-gray-600",children:[jsxRuntimeExports.jsxs("p",{className:"text-white text-2xl mb-8 font-semibold",children:["Forgot your password? ",jsxRuntimeExports.jsx("br",{}),"Reset it using your browser at",jsxRuntimeExports.jsx("br",{}),jsxRuntimeExports.jsx("span",{className:"underline",children:"https://uat.bookmytheatre.com/login"})]}),jsxRuntimeExports.jsx("button",{onClick:()=>tt(!1),className:"bg-red-700 hover:bg-red-800 py-3 px-12 rounded-md text-white font-bold text-lg transition-colors focus:outline-none focus:ring-2 focus:ring-white",children:"OK"})]})}),jsxRuntimeExports.jsx(Modal,{isOpen:lt,onClose:()=>{},preventClose:!0,children:jsxRuntimeExports.jsxs("div",{className:"bg-gray-800 p-10 rounded-lg w-[600px] text-center border-2 border-red-600",children:[jsxRuntimeExports.jsx("p",{className:"text-red-500 text-3xl font-bold mb-4",children:" Session Timed Out"}),jsxRuntimeExports.jsx("p",{className:"text-white text-2xl mb-6 font-semibold",children:"Your session has expired after 10 minutes of inactivity."}),jsxRuntimeExports.jsxs("p",{className:"text-gray-300 text-xl mb-8",children:["A new QR code will be generated automatically in"," ",jsxRuntimeExports.jsx("span",{className:"text-red-500 font-bold text-2xl",children:ht})," seconds..."]}),jsxRuntimeExports.jsx("div",{className:"bg-gray-700 h-2 w-full rounded-full overflow-hidden",children:jsxRuntimeExports.jsx("div",{className:"bg-red-600 h-full transition-all duration-1000",style:{width:`${ht/10*100}%`}})})]})}),jsxRuntimeExports.jsxs("div",{className:"relative z-10 flex flex-1 flex-row items-stretch",children:[jsxRuntimeExports.jsxs("div",{className:"flex-1 p-16 flex flex-col justify-center",children:[jsxRuntimeExports.jsx("h1",{className:"text-white text-4xl font-bold mb-3 text-center",children:"Login to your account"}),jsxRuntimeExports.jsx("h2",{className:"text-white text-xl font-semibold mb-2 text-center",children:"Scan QR code"}),jsxRuntimeExports.jsx("p",{className:"text-gray-300 text-base mb-4 text-center",children:"Use your mobile device's camera or a QR scanner to get started."}),nt&&jsxRuntimeExports.jsx("img",{src:nt,alt:"QR Code",className:"w-full h-[200px] object-contain"}),jsxRuntimeExports.jsxs("div",{className:"mt-6 flex flex-col items-center",children:[jsxRuntimeExports.jsx("div",{className:"flex flex-row justify-center bg-[#1e1e1e] px-6 py-4 rounded-xl border border-gray-600",children:jsxRuntimeExports.jsx("span",{className:"text-white text-4xl font-extrabold tracking-[0.375rem] mx-1",style:{fontFamily:"monospace"},children:at})}),jsxRuntimeExports.jsx("p",{className:"text-gray-400 text-base mt-3 text-center",children:"Enter this code on your mobile device to verify the TV login."})]}),jsxRuntimeExports.jsx("p",{className:"text-gray-400 text-base mt-4 text-center",children:"Keep the QR code clearly visible. This page will automatically update when the connection is established"})]}),jsxRuntimeExports.jsxs("div",{className:"flex-1 p-16 flex flex-col justify-center border-l border-gray-700/50",children:[jsxRuntimeExports.jsx("h2",{className:"text-white text-2xl font-semibold mb-4",children:"Get started with your email."}),jsxRuntimeExports.jsx("p",{className:"text-gray-300 text-lg mb-6",children:"Please enter your email and password to continue."}),jsxRuntimeExports.jsx("div",{className:`flex flex-row items-center pb-3 mb-2 border-b-2 transition-colors cursor-pointer ${g==="email"?"border-red-700":"border-gray-400"}`,onClick:()=>mt("email"),children:jsxRuntimeExports.jsx("input",{type:"email",ref:kt=>ft.current[0]=kt,readOnly:!0,onFocus:()=>b("email"),onBlur:()=>b(null),onKeyPress:kt=>{kt.key==="Enter"&&mt("email")},className:"flex-1 bg-transparent text-white text-xl p-0 outline-none placeholder-gray-400",placeholder:"Enter Email Address",value:e.email})}),jsxRuntimeExports.jsx("p",{className:"text-gray-500 text-sm mb-8",children:"Press Enter or click to open keyboard"}),jsxRuntimeExports.jsxs("div",{className:`flex flex-row items-center pb-3 mb-2 border-b-2 transition-colors cursor-pointer ${g==="password"?"border-red-700":"border-gray-400"}`,onClick:()=>mt("password"),children:[jsxRuntimeExports.jsx("input",{type:et?"text":"password",ref:kt=>ft.current[1]=kt,readOnly:!0,onFocus:()=>b("password"),onBlur:()=>b(null),onKeyPress:kt=>{kt.key==="Enter"&&mt("password")},className:"flex-1 bg-transparent text-white text-xl p-0 outline-none placeholder-gray-400",placeholder:"Enter Password",value:e.password}),jsxRuntimeExports.jsx("button",{onClick:kt=>{kt.stopPropagation(),st(!et)},onFocus:()=>b("passwordToggle"),onBlur:()=>b(null),className:`ml-3 p-2 rounded transition-colors ${g==="passwordToggle"?"bg-red-700":"bg-transparent"}`,children:jsxRuntimeExports.jsx("span",{className:"text-white text-2xl font-bold",children:et?"":""})})]}),jsxRuntimeExports.jsx("p",{className:"text-gray-500 text-sm mb-8",children:"Press Enter or click to open keyboard"}),c&&jsxRuntimeExports.jsx("p",{className:"text-red-500 text-lg mb-4",children:c.message}),jsxRuntimeExports.jsx("button",{onClick:Xt,ref:kt=>ft.current[3]=kt,onFocus:()=>b("loginBtn"),onBlur:()=>b(null),disabled:a,className:`bg-red-700 hover:bg-red-800 py-4 rounded-md shadow-2xl text-white text-xl font-bold text-center transition-all disabled:opacity-50 disabled:cursor-not-allowed ${g==="loginBtn"?"scale-105 border-2 border-white":""}`,children:a?"Logging in...":"Login"})]})]}),jsxRuntimeExports.jsx(VirtualKeyboard,{isVisible:St,onClose:Et,onInput:At,onBackspace:Pt,onClear:wt,currentValue:e[Ct]||""})]})},logo_white=""+new URL("logo_white-hRzDTKL2.png",import.meta.url).href;/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var defaultAttributes$1={outline:{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"},filled:{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"currentColor",stroke:"none"}};/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const createReactComponent=(s,e,i,a)=>{const o=reactExports.forwardRef(({color:c="currentColor",size:d=24,stroke:g=2,title:b,className:_,children:j,...$},_e)=>reactExports.createElement("svg",{ref:_e,...defaultAttributes$1[s],width:d,height:d,className:["tabler-icon",`tabler-icon-${e}`,_].join(" "),strokeWidth:g,stroke:c,...$},[b&&reactExports.createElement("title",{key:"svg-title"},b),...a.map(([tt,et])=>reactExports.createElement(tt,et)),...Array.isArray(j)?j:[j]]));return o.displayName=`${i}`,o};/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$q=[["path",{d:"M3 21l18 0",key:"svg-0"}],["path",{d:"M3 10l18 0",key:"svg-1"}],["path",{d:"M5 6l7 -3l7 3",key:"svg-2"}],["path",{d:"M4 10l0 11",key:"svg-3"}],["path",{d:"M20 10l0 11",key:"svg-4"}],["path",{d:"M8 14l0 3",key:"svg-5"}],["path",{d:"M12 14l0 3",key:"svg-6"}],["path",{d:"M16 14l0 3",key:"svg-7"}]],IconBuildingBank=createReactComponent("outline","building-bank","BuildingBank",__iconNode$q);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$p=[["path",{d:"M4 4h6v6h-6z",key:"svg-0"}],["path",{d:"M14 4h6v6h-6z",key:"svg-1"}],["path",{d:"M4 14h6v6h-6z",key:"svg-2"}],["path",{d:"M17 17m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0",key:"svg-3"}]],IconCategory=createReactComponent("outline","category","Category",__iconNode$p);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$o=[["path",{d:"M3 4m0 1a1 1 0 0 1 1 -1h16a1 1 0 0 1 1 1v10a1 1 0 0 1 -1 1h-16a1 1 0 0 1 -1 -1z",key:"svg-0"}],["path",{d:"M7 20l10 0",key:"svg-1"}],["path",{d:"M9 16l0 4",key:"svg-2"}],["path",{d:"M15 16l0 4",key:"svg-3"}],["path",{d:"M8 12l3 -3l2 2l3 -3",key:"svg-4"}]],IconDeviceAnalytics=createReactComponent("outline","device-analytics","DeviceAnalytics",__iconNode$o);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$n=[["path",{d:"M14 3v4a1 1 0 0 0 1 1h4",key:"svg-0"}],["path",{d:"M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z",key:"svg-1"}],["path",{d:"M9 17h6",key:"svg-2"}],["path",{d:"M9 13h6",key:"svg-3"}]],IconFileDescription=createReactComponent("outline","file-description","FileDescription",__iconNode$n);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$m=[["path",{d:"M14 3v4a1 1 0 0 0 1 1h4",key:"svg-0"}],["path",{d:"M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z",key:"svg-1"}],["path",{d:"M9 9l1 0",key:"svg-2"}],["path",{d:"M9 13l6 0",key:"svg-3"}],["path",{d:"M9 17l6 0",key:"svg-4"}]],IconFileText=createReactComponent("outline","file-text","FileText",__iconNode$m);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$l=[["path",{d:"M4 13m0 2a2 2 0 0 1 2 -2h1a2 2 0 0 1 2 2v3a2 2 0 0 1 -2 2h-1a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M15 13m0 2a2 2 0 0 1 2 -2h1a2 2 0 0 1 2 2v3a2 2 0 0 1 -2 2h-1a2 2 0 0 1 -2 -2z",key:"svg-1"}],["path",{d:"M4 15v-3a8 8 0 0 1 16 0v3",key:"svg-2"}]],IconHeadphones=createReactComponent("outline","headphones","Headphones",__iconNode$l);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$k=[["path",{d:"M5 12l-2 0l9 -9l9 9l-2 0",key:"svg-0"}],["path",{d:"M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7",key:"svg-1"}],["path",{d:"M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6",key:"svg-2"}]],IconHome=createReactComponent("outline","home","Home",__iconNode$k);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$j=[["path",{d:"M15 8v-2a2 2 0 0 0 -2 -2h-7a2 2 0 0 0 -2 2v12a2 2 0 0 0 2 2h7a2 2 0 0 0 2 -2v-2",key:"svg-0"}],["path",{d:"M21 12h-13l3 -3",key:"svg-1"}],["path",{d:"M11 15l-3 -3",key:"svg-2"}]],IconLogin=createReactComponent("outline","login","Login",__iconNode$j);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$i=[["path",{d:"M8 8a3.5 3 0 0 1 3.5 -3h1a3.5 3 0 0 1 3.5 3a3 3 0 0 1 -2 3a3 4 0 0 0 -2 4",key:"svg-0"}],["path",{d:"M12 19l0 .01",key:"svg-1"}]],IconQuestionMark=createReactComponent("outline","question-mark","QuestionMark",__iconNode$i);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$h=[["path",{d:"M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0",key:"svg-0"}],["path",{d:"M21 21l-6 -6",key:"svg-1"}]],IconSearch=createReactComponent("outline","search","Search",__iconNode$h);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$g=[["path",{d:"M12 3a12 12 0 0 0 8.5 3a12 12 0 0 1 -8.5 15a12 12 0 0 1 -8.5 -15a12 12 0 0 0 8.5 -3",key:"svg-0"}],["path",{d:"M12 11m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-1"}],["path",{d:"M12 12l0 2.5",key:"svg-2"}]],IconShieldLock=createReactComponent("outline","shield-lock","ShieldLock",__iconNode$g);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$f=[["path",{d:"M21 12h-6h1a3 3 0 0 1 0 6h-1l3 3",key:"svg-0"}],["path",{d:"M15 15h6",key:"svg-1"}],["path",{d:"M5 5m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-2"}],["path",{d:"M17 5m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-3"}],["path",{d:"M7 5h8",key:"svg-4"}],["path",{d:"M7 5v8a3 3 0 0 0 3 3h1",key:"svg-5"}]],IconTransactionRupee=createReactComponent("outline","transaction-rupee","TransactionRupee",__iconNode$f);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$e=[["path",{d:"M8 7a4 4 0 1 0 8 0a4 4 0 0 0 -8 0",key:"svg-0"}],["path",{d:"M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2",key:"svg-1"}]],IconUser=createReactComponent("outline","user","User",__iconNode$e);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$d=[["path",{d:"M10 13a2 2 0 1 0 4 0a2 2 0 0 0 -4 0",key:"svg-0"}],["path",{d:"M8 21v-1a2 2 0 0 1 2 -2h4a2 2 0 0 1 2 2v1",key:"svg-1"}],["path",{d:"M15 5a2 2 0 1 0 4 0a2 2 0 0 0 -4 0",key:"svg-2"}],["path",{d:"M17 10h2a2 2 0 0 1 2 2v1",key:"svg-3"}],["path",{d:"M5 5a2 2 0 1 0 4 0a2 2 0 0 0 -4 0",key:"svg-4"}],["path",{d:"M3 13v-1a2 2 0 0 1 2 -2h2",key:"svg-5"}]],IconUsersGroup=createReactComponent("outline","users-group","UsersGroup",__iconNode$d),SidebarItem=React.forwardRef(({name:s,to:e,routeNames:i,isFocused:a,isLogged:o,forceRedirect:c},d)=>{const g=useLocation(),b=e==="/"?g.pathname==="/":g.pathname.startsWith(e),_=c&&!o?c:e,j=_e=>s==="Search"?jsxRuntimeExports.jsx(IconSearch,{size:32,color:_e}):s==="Home"?jsxRuntimeExports.jsx(IconHome,{size:32,color:_e}):s==="Categories"?jsxRuntimeExports.jsx(IconCategory,{size:32,color:_e}):jsxRuntimeExports.jsx(IconUser,{size:32,color:_e}),$=b||a?"#c02628":"white";return jsxRuntimeExports.jsx(Link,{to:_,ref:d,className:"w-full flex justify-center p-1 group outline-none",children:jsxRuntimeExports.jsx("div",{className:`p-4 rounded-lg transition-all duration-200 ease-in-out 
          ${b||a?"bg-white/20 scale-110":"group-hover:bg-white/10 group-hover:scale-105 group-focus:bg-white/20 group-focus:scale-110"}`,children:j($)})})}),Sidebar=({isActive:s,onNavigate:e,isLogged:i,forceRedirect:a})=>{const o=useLocation(),c=[{name:"Search",to:"/searchmovie",routeNames:["searchmovie"]},{name:"Home",to:"/browse",routeNames:["browse","home"]},{name:"Categories",to:"/categories",routeNames:["categories"]},{name:"Profile",to:"/myaccount",routeNames:["myaccount"]}],d=()=>{o.pathname.replace("/","");const j=c.findIndex($=>o.pathname.startsWith($.to));return j!==-1?j:1},[g,b]=reactExports.useState(d),_=reactExports.useRef([]);return reactExports.useEffect(()=>{var j;if(s){const $=d();b($),(j=_.current[$])==null||j.focus()}},[s,o.pathname]),reactExports.useEffect(()=>{const j=$=>{var _e,tt,et;if(s)if($.key==="ArrowDown"){const st=(g+1)%c.length;b(st),(_e=_.current[st])==null||_e.focus()}else if($.key==="ArrowUp"){const st=(g-1+c.length)%c.length;b(st),(tt=_.current[st])==null||tt.focus()}else $.key==="ArrowRight"?e&&e($.key):$.key==="Enter"&&((et=_.current[g])==null||et.click())};return window.addEventListener("keydown",j),()=>window.removeEventListener("keydown",j)},[s,g,c.length,e]),jsxRuntimeExports.jsxs("div",{className:"w-32 bg-transparent flex flex-col items-center pt-5",children:[jsxRuntimeExports.jsx("img",{src:logo_white,alt:"Logo",className:"w-20 h-14 mx-auto mb-10 mt-3"}),jsxRuntimeExports.jsx("div",{className:"flex flex-col items-center space-y-4 pb-8",children:c.map((j,$)=>jsxRuntimeExports.jsx(SidebarItem,{ref:_e=>_.current[$]=_e,name:j.name,to:j.to,routeNames:j.routeNames,isFocused:s&&g===$,isLogged:i,forceRedirect:a},$))})]})};/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const toKebabCase=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),toCamelCase=s=>s.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,i,a)=>a?a.toUpperCase():i.toLowerCase()),toPascalCase=s=>{const e=toCamelCase(s);return e.charAt(0).toUpperCase()+e.slice(1)},mergeClasses=(...s)=>s.filter((e,i,a)=>!!e&&e.trim()!==""&&a.indexOf(e)===i).join(" ").trim(),hasA11yProp=s=>{for(const e in s)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var defaultAttributes={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Icon=reactExports.forwardRef(({color:s="currentColor",size:e=24,strokeWidth:i=2,absoluteStrokeWidth:a,className:o="",children:c,iconNode:d,...g},b)=>reactExports.createElement("svg",{ref:b,...defaultAttributes,width:e,height:e,stroke:s,strokeWidth:a?Number(i)*24/Number(e):i,className:mergeClasses("lucide",o),...!c&&!hasA11yProp(g)&&{"aria-hidden":"true"},...g},[...d.map(([_,j])=>reactExports.createElement(_,j)),...Array.isArray(c)?c:[c]]));/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const createLucideIcon=(s,e)=>{const i=reactExports.forwardRef(({className:a,...o},c)=>reactExports.createElement(Icon,{ref:c,iconNode:e,className:mergeClasses(`lucide-${toKebabCase(toPascalCase(s))}`,`lucide-${s}`,a),...o}));return i.displayName=toPascalCase(s),i};/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$c=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],ArrowLeft=createLucideIcon("arrow-left",__iconNode$c);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$b=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],CircleAlert=createLucideIcon("circle-alert",__iconNode$b);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$a=[["path",{d:"M5 12h14",key:"1ays0h"}]],Minus=createLucideIcon("minus",__iconNode$a);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$9=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],Pause=createLucideIcon("pause",__iconNode$9);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$8=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],Play=createLucideIcon("play",__iconNode$8);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$7=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Plus=createLucideIcon("plus",__iconNode$7);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$6=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],RotateCcw=createLucideIcon("rotate-ccw",__iconNode$6);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$5=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],RotateCw=createLucideIcon("rotate-cw",__iconNode$5);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$4=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Settings$1=createLucideIcon("settings",__iconNode$4);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$3=[["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}],["path",{d:"M3.103 6.034h17.794",key:"awc11p"}],["path",{d:"M3.4 5.467a2 2 0 0 0-.4 1.2V20a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6.667a2 2 0 0 0-.4-1.2l-2-2.667A2 2 0 0 0 17 2H7a2 2 0 0 0-1.6.8z",key:"o988cm"}]],ShoppingBag=createLucideIcon("shopping-bag",__iconNode$3);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$2=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],Volume2=createLucideIcon("volume-2",__iconNode$2);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$1=[["path",{d:"M16 9a5 5 0 0 1 .95 2.293",key:"1fgyg8"}],["path",{d:"M19.364 5.636a9 9 0 0 1 1.889 9.96",key:"l3zxae"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"m7 7-.587.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298V11",key:"1gbwow"}],["path",{d:"M9.828 4.172A.686.686 0 0 1 11 4.657v.686",key:"s2je0y"}]],VolumeOff=createLucideIcon("volume-off",__iconNode$1);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],X=createLucideIcon("x",__iconNode),Errorpanelcardview=({errorMessages:s,retry:e})=>s?jsxRuntimeExports.jsxs("div",{className:"bg-red-500/10 border border-red-400 rounded-lg p-4 mt-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx(CircleAlert,{size:22,color:"#FF4444"}),jsxRuntimeExports.jsx("p",{className:"ml-2 text-red-400 font-semibold flex-1",children:typeof s=="string"?s:"Something went wrong. Please try again later."})]}),e&&jsxRuntimeExports.jsx("button",{onClick:e,className:"mt-3 bg-red-500 hover:bg-red-600 px-3 py-2 rounded-lg text-white font-medium self-end",children:"Retry"})]}):null,Browse=({isActive:s,onNavigate:e})=>{var at;const[i,a]=reactExports.useState([]),[o,c]=reactExports.useState(null),[d,g]=reactExports.useState(!1),[b,_]=reactExports.useState(null),{selectedIndex:j,containerRef:$}=useDpadNavigation({totalItems:3,columns:3,enabled:s&&!!o,onEnter:rt=>{o&&st(o)},onDirectionChange:(rt,nt)=>{nt?rt==="ArrowLeft"&&j===0&&e(rt):e(rt)}}),_e=useNavigate(),tt=({width:rt,height:nt,borderRadius:it="0.25rem",className:ot=""})=>jsxRuntimeExports.jsxs("div",{className:`relative overflow-hidden bg-[#1a1a1a] ${ot}`,style:{width:rt,height:nt,borderRadius:it},children:[jsxRuntimeExports.jsx("div",{className:"absolute inset-0 bg-[#2a2a2a]"}),jsxRuntimeExports.jsx("div",{className:"absolute inset-0 animate-shimmer bg-linear-to-r from-transparent via-white/30 to-transparent"})]}),et=reactExports.useCallback(async()=>{var rt;try{_(null),g(!0);const it=(await Movieapi.get("getmoviescouroselbrowse")).data;if(it.status==="error")throw new Error(it.message);(rt=it.movies_carousel_browse_details)!=null&&rt.length?(a(it.movies_carousel_browse_details),c(it.movies_carousel_browse_details[0])):(a([]),c(null))}catch(nt){_({status:"error",message:nt.message||"Failed to load carousel movies."})}finally{g(!1)}},[]);reactExports.useEffect(()=>{et()},[et]);const st=rt=>{_e(`/movie/${rt.uuid}`)};return d?jsxRuntimeExports.jsx("div",{className:"relative w-full overflow-hidden bg-gray-900",children:jsxRuntimeExports.jsxs("div",{className:"w-full h-[650px] flex flex-col justify-end pb-10 bg-gray-900",children:[jsxRuntimeExports.jsx("div",{className:"absolute inset-0 bg-linear-to-t from-black via-black/70 to-transparent"}),jsxRuntimeExports.jsxs("div",{className:"relative z-10 px-6 pb-10 max-w-[600px]",children:[jsxRuntimeExports.jsx(tt,{width:"320px",height:"48px",className:"mb-3"}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col space-y-2 mb-6",children:[jsxRuntimeExports.jsx(tt,{width:"320px",height:"16px"}),jsxRuntimeExports.jsx(tt,{width:"280px",height:"16px"}),jsxRuntimeExports.jsx(tt,{width:"250px",height:"16px"})]}),jsxRuntimeExports.jsx("div",{className:"flex flex-wrap mb-8 gap-2",children:[1,2,3].map(rt=>jsxRuntimeExports.jsx(tt,{width:"70px",height:"28px",borderRadius:"14px"},rt))}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx(tt,{width:"100px",height:"42px",borderRadius:"6px"}),jsxRuntimeExports.jsx(tt,{width:"85px",height:"42px",borderRadius:"6px"}),jsxRuntimeExports.jsx(tt,{width:"42px",height:"42px",borderRadius:"50%"})]})]})]})}):b?jsxRuntimeExports.jsx("div",{className:"px-6 mt-6",children:jsxRuntimeExports.jsx(Errorpanelcardview,{errorMessages:b,retry:et})}):o?jsxRuntimeExports.jsx("div",{className:"relative w-full overflow-hidden",children:jsxRuntimeExports.jsxs("div",{className:"w-full h-[650px] bg-cover bg-center flex flex-col justify-end pb-10",style:{backgroundImage:`url(${o==null?void 0:o.main_banner})`},children:[jsxRuntimeExports.jsx("div",{className:"absolute inset-0 bg-linear-to-r from-black/95 via-black/70 to-transparent"}),jsxRuntimeExports.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-40 bg-linear-to-t from-black/90 to-transparent"}),jsxRuntimeExports.jsxs("div",{className:"relative z-10 px-6 pb-12 max-w-[600px]",children:[jsxRuntimeExports.jsx("h1",{className:"text-5xl font-bold mb-3 text-white drop-shadow-lg tracking-wide",children:o.title}),jsxRuntimeExports.jsx("p",{className:"text-gray-200 text-sm leading-5 mb-4 max-w-[450px] line-clamp-3 drop-shadow-md",children:o.description}),jsxRuntimeExports.jsx("div",{className:"flex flex-wrap items-center mb-6",children:(at=o==null?void 0:o.categories)==null?void 0:at.map((rt,nt)=>jsxRuntimeExports.jsx("span",{className:"bg-white/20 text-white rounded px-2.5 py-1 mr-2 mb-2 text-xs font-semibold",children:rt==null?void 0:rt.name},nt))}),jsxRuntimeExports.jsxs("div",{ref:$,className:"flex items-center gap-3",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>st(o),className:`flex items-center justify-center px-6 py-2.5 rounded-md text-white font-semibold text-base transition-all duration-300 outline-none
                ${s&&j===0?"bg-[#E13B3F] ring-4 ring-white scale-110":"bg-[#C1272D]"}`,children:[" ",jsxRuntimeExports.jsx("span",{className:"ml-2",children:"Play"})]}),jsxRuntimeExports.jsx("button",{onClick:()=>st(o),className:`px-5 py-2.5 rounded-md text-white font-semibold text-base transition-all duration-300 outline-none
                ${s&&j===1?"bg-gray-500 ring-4 ring-white scale-110":"bg-gray-600/80"}`,children:"Trailer"}),jsxRuntimeExports.jsx("button",{onClick:()=>st(o),className:`w-10 h-10 flex items-center justify-center rounded-full border-2 transition-all duration-300 outline-none
                ${s&&j===2?"border-white bg-gray-700 ring-4 ring-white scale-110":"border-gray-400 bg-black/40"}`,children:jsxRuntimeExports.jsx("span",{className:"text-white text-2xl leading-none",children:"+"})})]})]})]})}):jsxRuntimeExports.jsx("div",{className:"w-full h-[650px] flex justify-center items-center bg-black/80",children:jsxRuntimeExports.jsx("p",{className:"text-white text-lg font-semibold",children:"No movies available."})})};var lottie$1={exports:{}};(function(module,exports){typeof document<"u"&&typeof navigator<"u"&&function(s,e){module.exports=e()}(commonjsGlobal,function(){var svgNS="http://www.w3.org/2000/svg",locationHref="",_useWebWorker=!1,initialDefaultFrame=-999999,setWebWorker=function(e){_useWebWorker=!!e},getWebWorker=function(){return _useWebWorker},setLocationHref=function(e){locationHref=e},getLocationHref=function(){return locationHref};function createTag(s){return document.createElement(s)}function extendPrototype(s,e){var i,a=s.length,o;for(i=0;i<a;i+=1){o=s[i].prototype;for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(e.prototype[c]=o[c])}}function getDescriptor(s,e){return Object.getOwnPropertyDescriptor(s,e)}function createProxyFunction(s){function e(){}return e.prototype=s,e}var audioControllerFactory=function(){function s(e){this.audios=[],this.audioFactory=e,this._volume=1,this._isMuted=!1}return s.prototype={addAudio:function(i){this.audios.push(i)},pause:function(){var i,a=this.audios.length;for(i=0;i<a;i+=1)this.audios[i].pause()},resume:function(){var i,a=this.audios.length;for(i=0;i<a;i+=1)this.audios[i].resume()},setRate:function(i){var a,o=this.audios.length;for(a=0;a<o;a+=1)this.audios[a].setRate(i)},createAudio:function(i){return this.audioFactory?this.audioFactory(i):window.Howl?new window.Howl({src:[i]}):{isPlaying:!1,play:function(){this.isPlaying=!0},seek:function(){this.isPlaying=!1},playing:function(){},rate:function(){},setVolume:function(){}}},setAudioFactory:function(i){this.audioFactory=i},setVolume:function(i){this._volume=i,this._updateVolume()},mute:function(){this._isMuted=!0,this._updateVolume()},unmute:function(){this._isMuted=!1,this._updateVolume()},getVolume:function(){return this._volume},_updateVolume:function(){var i,a=this.audios.length;for(i=0;i<a;i+=1)this.audios[i].volume(this._volume*(this._isMuted?0:1))}},function(){return new s}}(),createTypedArray=function(){function s(i,a){var o=0,c=[],d;switch(i){case"int16":case"uint8c":d=1;break;default:d=1.1;break}for(o=0;o<a;o+=1)c.push(d);return c}function e(i,a){return i==="float32"?new Float32Array(a):i==="int16"?new Int16Array(a):i==="uint8c"?new Uint8ClampedArray(a):s(i,a)}return typeof Uint8ClampedArray=="function"&&typeof Float32Array=="function"?e:s}();function createSizedArray(s){return Array.apply(null,{length:s})}function _typeof$6(s){"@babel/helpers - typeof";return _typeof$6=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof$6(s)}var subframeEnabled=!0,expressionsPlugin=null,expressionsInterfaces=null,idPrefix$1="",isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),bmPow=Math.pow,bmSqrt=Math.sqrt,bmFloor=Math.floor,bmMax=Math.max,bmMin=Math.min,BMMath={};(function(){var s=["abs","acos","acosh","asin","asinh","atan","atanh","atan2","ceil","cbrt","expm1","clz32","cos","cosh","exp","floor","fround","hypot","imul","log","log1p","log2","log10","max","min","pow","random","round","sign","sin","sinh","sqrt","tan","tanh","trunc","E","LN10","LN2","LOG10E","LOG2E","PI","SQRT1_2","SQRT2"],e,i=s.length;for(e=0;e<i;e+=1)BMMath[s[e]]=Math[s[e]]})(),BMMath.random=Math.random,BMMath.abs=function(s){var e=_typeof$6(s);if(e==="object"&&s.length){var i=createSizedArray(s.length),a,o=s.length;for(a=0;a<o;a+=1)i[a]=Math.abs(s[a]);return i}return Math.abs(s)};var defaultCurveSegments=150,degToRads=Math.PI/180,roundCorner=.5519;function styleDiv(s){s.style.position="absolute",s.style.top=0,s.style.left=0,s.style.display="block",s.style.transformOrigin="0 0",s.style.webkitTransformOrigin="0 0",s.style.backfaceVisibility="visible",s.style.webkitBackfaceVisibility="visible",s.style.transformStyle="preserve-3d",s.style.webkitTransformStyle="preserve-3d",s.style.mozTransformStyle="preserve-3d"}function BMEnterFrameEvent(s,e,i,a){this.type=s,this.currentTime=e,this.totalTime=i,this.direction=a<0?-1:1}function BMCompleteEvent(s,e){this.type=s,this.direction=e<0?-1:1}function BMCompleteLoopEvent(s,e,i,a){this.type=s,this.currentLoop=i,this.totalLoops=e,this.direction=a<0?-1:1}function BMSegmentStartEvent(s,e,i){this.type=s,this.firstFrame=e,this.totalFrames=i}function BMDestroyEvent(s,e){this.type=s,this.target=e}function BMRenderFrameErrorEvent(s,e){this.type="renderFrameError",this.nativeError=s,this.currentTime=e}function BMConfigErrorEvent(s){this.type="configError",this.nativeError=s}var createElementID=function(){var s=0;return function(){return s+=1,idPrefix$1+"__lottie_element_"+s}}();function HSVtoRGB(s,e,i){var a,o,c,d,g,b,_,j;switch(d=Math.floor(s*6),g=s*6-d,b=i*(1-e),_=i*(1-g*e),j=i*(1-(1-g)*e),d%6){case 0:a=i,o=j,c=b;break;case 1:a=_,o=i,c=b;break;case 2:a=b,o=i,c=j;break;case 3:a=b,o=_,c=i;break;case 4:a=j,o=b,c=i;break;case 5:a=i,o=b,c=_;break}return[a,o,c]}function RGBtoHSV(s,e,i){var a=Math.max(s,e,i),o=Math.min(s,e,i),c=a-o,d,g=a===0?0:c/a,b=a/255;switch(a){case o:d=0;break;case s:d=e-i+c*(e<i?6:0),d/=6*c;break;case e:d=i-s+c*2,d/=6*c;break;case i:d=s-e+c*4,d/=6*c;break}return[d,g,b]}function addSaturationToRGB(s,e){var i=RGBtoHSV(s[0]*255,s[1]*255,s[2]*255);return i[1]+=e,i[1]>1?i[1]=1:i[1]<=0&&(i[1]=0),HSVtoRGB(i[0],i[1],i[2])}function addBrightnessToRGB(s,e){var i=RGBtoHSV(s[0]*255,s[1]*255,s[2]*255);return i[2]+=e,i[2]>1?i[2]=1:i[2]<0&&(i[2]=0),HSVtoRGB(i[0],i[1],i[2])}function addHueToRGB(s,e){var i=RGBtoHSV(s[0]*255,s[1]*255,s[2]*255);return i[0]+=e/360,i[0]>1?i[0]-=1:i[0]<0&&(i[0]+=1),HSVtoRGB(i[0],i[1],i[2])}var rgbToHex=function(){var s=[],e,i;for(e=0;e<256;e+=1)i=e.toString(16),s[e]=i.length===1?"0"+i:i;return function(a,o,c){return a<0&&(a=0),o<0&&(o=0),c<0&&(c=0),"#"+s[a]+s[o]+s[c]}}(),setSubframeEnabled=function(e){subframeEnabled=!!e},getSubframeEnabled=function(){return subframeEnabled},setExpressionsPlugin=function(e){expressionsPlugin=e},getExpressionsPlugin=function(){return expressionsPlugin},setExpressionInterfaces=function(e){expressionsInterfaces=e},getExpressionInterfaces=function(){return expressionsInterfaces},setDefaultCurveSegments=function(e){defaultCurveSegments=e},getDefaultCurveSegments=function(){return defaultCurveSegments},setIdPrefix=function(e){idPrefix$1=e};function createNS(s){return document.createElementNS(svgNS,s)}function _typeof$5(s){"@babel/helpers - typeof";return _typeof$5=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof$5(s)}var dataManager=function(){var s=1,e=[],i,a,o={onmessage:function(){},postMessage:function(tt){i({data:tt})}},c={postMessage:function(tt){o.onmessage({data:tt})}};function d(_e){if(window.Worker&&window.Blob&&getWebWorker()){var tt=new Blob(["var _workerSelf = self; self.onmessage = ",_e.toString()],{type:"text/javascript"}),et=URL.createObjectURL(tt);return new Worker(et)}return i=_e,o}function g(){a||(a=d(function(tt){function et(){function at(bt,pt){var yt,ut,ft=bt.length,xt,mt,Et,At;for(ut=0;ut<ft;ut+=1)if(yt=bt[ut],"ks"in yt&&!yt.completed){if(yt.completed=!0,yt.hasMask){var Pt=yt.masksProperties;for(mt=Pt.length,xt=0;xt<mt;xt+=1)if(Pt[xt].pt.k.i)lt(Pt[xt].pt.k);else for(At=Pt[xt].pt.k.length,Et=0;Et<At;Et+=1)Pt[xt].pt.k[Et].s&&lt(Pt[xt].pt.k[Et].s[0]),Pt[xt].pt.k[Et].e&&lt(Pt[xt].pt.k[Et].e[0])}yt.ty===0?(yt.layers=it(yt.refId,pt),at(yt.layers,pt)):yt.ty===4?ot(yt.shapes):yt.ty===5&&Ct(yt)}}function rt(bt,pt){if(bt){var yt=0,ut=bt.length;for(yt=0;yt<ut;yt+=1)bt[yt].t===1&&(bt[yt].data.layers=it(bt[yt].data.refId,pt),at(bt[yt].data.layers,pt))}}function nt(bt,pt){for(var yt=0,ut=pt.length;yt<ut;){if(pt[yt].id===bt)return pt[yt];yt+=1}return null}function it(bt,pt){var yt=nt(bt,pt);return yt?yt.layers.__used?JSON.parse(JSON.stringify(yt.layers)):(yt.layers.__used=!0,yt.layers):null}function ot(bt){var pt,yt=bt.length,ut,ft;for(pt=yt-1;pt>=0;pt-=1)if(bt[pt].ty==="sh")if(bt[pt].ks.k.i)lt(bt[pt].ks.k);else for(ft=bt[pt].ks.k.length,ut=0;ut<ft;ut+=1)bt[pt].ks.k[ut].s&&lt(bt[pt].ks.k[ut].s[0]),bt[pt].ks.k[ut].e&&lt(bt[pt].ks.k[ut].e[0]);else bt[pt].ty==="gr"&&ot(bt[pt].it)}function lt(bt){var pt,yt=bt.i.length;for(pt=0;pt<yt;pt+=1)bt.i[pt][0]+=bt.v[pt][0],bt.i[pt][1]+=bt.v[pt][1],bt.o[pt][0]+=bt.v[pt][0],bt.o[pt][1]+=bt.v[pt][1]}function ct(bt,pt){var yt=pt?pt.split("."):[100,100,100];return bt[0]>yt[0]?!0:yt[0]>bt[0]?!1:bt[1]>yt[1]?!0:yt[1]>bt[1]?!1:bt[2]>yt[2]?!0:yt[2]>bt[2]?!1:null}var ht=function(){var bt=[4,4,14];function pt(ut){var ft=ut.t.d;ut.t.d={k:[{s:ft,t:0}]}}function yt(ut){var ft,xt=ut.length;for(ft=0;ft<xt;ft+=1)ut[ft].ty===5&&pt(ut[ft])}return function(ut){if(ct(bt,ut.v)&&(yt(ut.layers),ut.assets)){var ft,xt=ut.assets.length;for(ft=0;ft<xt;ft+=1)ut.assets[ft].layers&&yt(ut.assets[ft].layers)}}}(),dt=function(){var bt=[4,7,99];return function(pt){if(pt.chars&&!ct(bt,pt.v)){var yt,ut=pt.chars.length;for(yt=0;yt<ut;yt+=1){var ft=pt.chars[yt];ft.data&&ft.data.shapes&&(ot(ft.data.shapes),ft.data.ip=0,ft.data.op=99999,ft.data.st=0,ft.data.sr=1,ft.data.ks={p:{k:[0,0],a:0},s:{k:[100,100],a:0},a:{k:[0,0],a:0},r:{k:0,a:0},o:{k:100,a:0}},pt.chars[yt].t||(ft.data.shapes.push({ty:"no"}),ft.data.shapes[0].it.push({p:{k:[0,0],a:0},s:{k:[100,100],a:0},a:{k:[0,0],a:0},r:{k:0,a:0},o:{k:100,a:0},sk:{k:0,a:0},sa:{k:0,a:0},ty:"tr"})))}}}}(),gt=function(){var bt=[5,7,15];function pt(ut){var ft=ut.t.p;typeof ft.a=="number"&&(ft.a={a:0,k:ft.a}),typeof ft.p=="number"&&(ft.p={a:0,k:ft.p}),typeof ft.r=="number"&&(ft.r={a:0,k:ft.r})}function yt(ut){var ft,xt=ut.length;for(ft=0;ft<xt;ft+=1)ut[ft].ty===5&&pt(ut[ft])}return function(ut){if(ct(bt,ut.v)&&(yt(ut.layers),ut.assets)){var ft,xt=ut.assets.length;for(ft=0;ft<xt;ft+=1)ut.assets[ft].layers&&yt(ut.assets[ft].layers)}}}(),vt=function(){var bt=[4,1,9];function pt(ut){var ft,xt=ut.length,mt,Et;for(ft=0;ft<xt;ft+=1)if(ut[ft].ty==="gr")pt(ut[ft].it);else if(ut[ft].ty==="fl"||ut[ft].ty==="st")if(ut[ft].c.k&&ut[ft].c.k[0].i)for(Et=ut[ft].c.k.length,mt=0;mt<Et;mt+=1)ut[ft].c.k[mt].s&&(ut[ft].c.k[mt].s[0]/=255,ut[ft].c.k[mt].s[1]/=255,ut[ft].c.k[mt].s[2]/=255,ut[ft].c.k[mt].s[3]/=255),ut[ft].c.k[mt].e&&(ut[ft].c.k[mt].e[0]/=255,ut[ft].c.k[mt].e[1]/=255,ut[ft].c.k[mt].e[2]/=255,ut[ft].c.k[mt].e[3]/=255);else ut[ft].c.k[0]/=255,ut[ft].c.k[1]/=255,ut[ft].c.k[2]/=255,ut[ft].c.k[3]/=255}function yt(ut){var ft,xt=ut.length;for(ft=0;ft<xt;ft+=1)ut[ft].ty===4&&pt(ut[ft].shapes)}return function(ut){if(ct(bt,ut.v)&&(yt(ut.layers),ut.assets)){var ft,xt=ut.assets.length;for(ft=0;ft<xt;ft+=1)ut.assets[ft].layers&&yt(ut.assets[ft].layers)}}}(),St=function(){var bt=[4,4,18];function pt(ut){var ft,xt=ut.length,mt,Et;for(ft=xt-1;ft>=0;ft-=1)if(ut[ft].ty==="sh")if(ut[ft].ks.k.i)ut[ft].ks.k.c=ut[ft].closed;else for(Et=ut[ft].ks.k.length,mt=0;mt<Et;mt+=1)ut[ft].ks.k[mt].s&&(ut[ft].ks.k[mt].s[0].c=ut[ft].closed),ut[ft].ks.k[mt].e&&(ut[ft].ks.k[mt].e[0].c=ut[ft].closed);else ut[ft].ty==="gr"&&pt(ut[ft].it)}function yt(ut){var ft,xt,mt=ut.length,Et,At,Pt,wt;for(xt=0;xt<mt;xt+=1){if(ft=ut[xt],ft.hasMask){var It=ft.masksProperties;for(At=It.length,Et=0;Et<At;Et+=1)if(It[Et].pt.k.i)It[Et].pt.k.c=It[Et].cl;else for(wt=It[Et].pt.k.length,Pt=0;Pt<wt;Pt+=1)It[Et].pt.k[Pt].s&&(It[Et].pt.k[Pt].s[0].c=It[Et].cl),It[Et].pt.k[Pt].e&&(It[Et].pt.k[Pt].e[0].c=It[Et].cl)}ft.ty===4&&pt(ft.shapes)}}return function(ut){if(ct(bt,ut.v)&&(yt(ut.layers),ut.assets)){var ft,xt=ut.assets.length;for(ft=0;ft<xt;ft+=1)ut.assets[ft].layers&&yt(ut.assets[ft].layers)}}}();function Tt(bt){bt.__complete||(vt(bt),ht(bt),dt(bt),gt(bt),St(bt),at(bt.layers,bt.assets),rt(bt.chars,bt.assets),bt.__complete=!0)}function Ct(bt){bt.t.a.length===0&&"m"in bt.t.p}var Rt={};return Rt.completeData=Tt,Rt.checkColors=vt,Rt.checkChars=dt,Rt.checkPathProperties=gt,Rt.checkShapes=St,Rt.completeLayers=at,Rt}if(c.dataManager||(c.dataManager=et()),c.assetLoader||(c.assetLoader=function(){function at(nt){var it=nt.getResponseHeader("content-type");return it&&nt.responseType==="json"&&it.indexOf("json")!==-1||nt.response&&_typeof$5(nt.response)==="object"?nt.response:nt.response&&typeof nt.response=="string"?JSON.parse(nt.response):nt.responseText?JSON.parse(nt.responseText):null}function rt(nt,it,ot,lt){var ct,ht=new XMLHttpRequest;try{ht.responseType="json"}catch{}ht.onreadystatechange=function(){if(ht.readyState===4)if(ht.status===200)ct=at(ht),ot(ct);else try{ct=at(ht),ot(ct)}catch(dt){lt&&lt(dt)}};try{ht.open(["G","E","T"].join(""),nt,!0)}catch{ht.open(["G","E","T"].join(""),it+"/"+nt,!0)}ht.send()}return{load:rt}}()),tt.data.type==="loadAnimation")c.assetLoader.load(tt.data.path,tt.data.fullPath,function(at){c.dataManager.completeData(at),c.postMessage({id:tt.data.id,payload:at,status:"success"})},function(){c.postMessage({id:tt.data.id,status:"error"})});else if(tt.data.type==="complete"){var st=tt.data.animation;c.dataManager.completeData(st),c.postMessage({id:tt.data.id,payload:st,status:"success"})}else tt.data.type==="loadData"&&c.assetLoader.load(tt.data.path,tt.data.fullPath,function(at){c.postMessage({id:tt.data.id,payload:at,status:"success"})},function(){c.postMessage({id:tt.data.id,status:"error"})})}),a.onmessage=function(_e){var tt=_e.data,et=tt.id,st=e[et];e[et]=null,tt.status==="success"?st.onComplete(tt.payload):st.onError&&st.onError()})}function b(_e,tt){s+=1;var et="processId_"+s;return e[et]={onComplete:_e,onError:tt},et}function _(_e,tt,et){g();var st=b(tt,et);a.postMessage({type:"loadAnimation",path:_e,fullPath:window.location.origin+window.location.pathname,id:st})}function j(_e,tt,et){g();var st=b(tt,et);a.postMessage({type:"loadData",path:_e,fullPath:window.location.origin+window.location.pathname,id:st})}function $(_e,tt,et){g();var st=b(tt,et);a.postMessage({type:"complete",animation:_e,id:st})}return{loadAnimation:_,loadData:j,completeAnimation:$}}(),ImagePreloader=function(){var s=function(){var rt=createTag("canvas");rt.width=1,rt.height=1;var nt=rt.getContext("2d");return nt.fillStyle="rgba(0,0,0,0)",nt.fillRect(0,0,1,1),rt}();function e(){this.loadedAssets+=1,this.loadedAssets===this.totalImages&&this.loadedFootagesCount===this.totalFootages&&this.imagesLoadedCb&&this.imagesLoadedCb(null)}function i(){this.loadedFootagesCount+=1,this.loadedAssets===this.totalImages&&this.loadedFootagesCount===this.totalFootages&&this.imagesLoadedCb&&this.imagesLoadedCb(null)}function a(rt,nt,it){var ot="";if(rt.e)ot=rt.p;else if(nt){var lt=rt.p;lt.indexOf("images/")!==-1&&(lt=lt.split("/")[1]),ot=nt+lt}else ot=it,ot+=rt.u?rt.u:"",ot+=rt.p;return ot}function o(rt){var nt=0,it=setInterval((function(){var ot=rt.getBBox();(ot.width||nt>500)&&(this._imageLoaded(),clearInterval(it)),nt+=1}).bind(this),50)}function c(rt){var nt=a(rt,this.assetsPath,this.path),it=createNS("image");isSafari?this.testImageLoaded(it):it.addEventListener("load",this._imageLoaded,!1),it.addEventListener("error",(function(){ot.img=s,this._imageLoaded()}).bind(this),!1),it.setAttributeNS("http://www.w3.org/1999/xlink","href",nt),this._elementHelper.append?this._elementHelper.append(it):this._elementHelper.appendChild(it);var ot={img:it,assetData:rt};return ot}function d(rt){var nt=a(rt,this.assetsPath,this.path),it=createTag("img");it.crossOrigin="anonymous",it.addEventListener("load",this._imageLoaded,!1),it.addEventListener("error",(function(){ot.img=s,this._imageLoaded()}).bind(this),!1),it.src=nt;var ot={img:it,assetData:rt};return ot}function g(rt){var nt={assetData:rt},it=a(rt,this.assetsPath,this.path);return dataManager.loadData(it,(function(ot){nt.img=ot,this._footageLoaded()}).bind(this),(function(){nt.img={},this._footageLoaded()}).bind(this)),nt}function b(rt,nt){this.imagesLoadedCb=nt;var it,ot=rt.length;for(it=0;it<ot;it+=1)rt[it].layers||(!rt[it].t||rt[it].t==="seq"?(this.totalImages+=1,this.images.push(this._createImageData(rt[it]))):rt[it].t===3&&(this.totalFootages+=1,this.images.push(this.createFootageData(rt[it]))))}function _(rt){this.path=rt||""}function j(rt){this.assetsPath=rt||""}function $(rt){for(var nt=0,it=this.images.length;nt<it;){if(this.images[nt].assetData===rt)return this.images[nt].img;nt+=1}return null}function _e(){this.imagesLoadedCb=null,this.images.length=0}function tt(){return this.totalImages===this.loadedAssets}function et(){return this.totalFootages===this.loadedFootagesCount}function st(rt,nt){rt==="svg"?(this._elementHelper=nt,this._createImageData=this.createImageData.bind(this)):this._createImageData=this.createImgData.bind(this)}function at(){this._imageLoaded=e.bind(this),this._footageLoaded=i.bind(this),this.testImageLoaded=o.bind(this),this.createFootageData=g.bind(this),this.assetsPath="",this.path="",this.totalImages=0,this.totalFootages=0,this.loadedAssets=0,this.loadedFootagesCount=0,this.imagesLoadedCb=null,this.images=[]}return at.prototype={loadAssets:b,setAssetsPath:j,setPath:_,loadedImages:tt,loadedFootages:et,destroy:_e,getAsset:$,createImgData:d,createImageData:c,imageLoaded:e,footageLoaded:i,setCacheType:st},at}();function BaseEvent(){}BaseEvent.prototype={triggerEvent:function(e,i){if(this._cbs[e])for(var a=this._cbs[e],o=0;o<a.length;o+=1)a[o](i)},addEventListener:function(e,i){return this._cbs[e]||(this._cbs[e]=[]),this._cbs[e].push(i),(function(){this.removeEventListener(e,i)}).bind(this)},removeEventListener:function(e,i){if(!i)this._cbs[e]=null;else if(this._cbs[e]){for(var a=0,o=this._cbs[e].length;a<o;)this._cbs[e][a]===i&&(this._cbs[e].splice(a,1),a-=1,o-=1),a+=1;this._cbs[e].length||(this._cbs[e]=null)}}};var markerParser=function(){function s(e){for(var i=e.split(`\r
`),a={},o,c=0,d=0;d<i.length;d+=1)o=i[d].split(":"),o.length===2&&(a[o[0]]=o[1].trim(),c+=1);if(c===0)throw new Error;return a}return function(e){for(var i=[],a=0;a<e.length;a+=1){var o=e[a],c={time:o.tm,duration:o.dr};try{c.payload=JSON.parse(e[a].cm)}catch{try{c.payload=s(e[a].cm)}catch{c.payload={name:e[a].cm}}}i.push(c)}return i}}(),ProjectInterface=function(){function s(e){this.compositions.push(e)}return function(){function e(i){for(var a=0,o=this.compositions.length;a<o;){if(this.compositions[a].data&&this.compositions[a].data.nm===i)return this.compositions[a].prepareFrame&&this.compositions[a].data.xt&&this.compositions[a].prepareFrame(this.currentFrame),this.compositions[a].compInterface;a+=1}return null}return e.compositions=[],e.currentFrame=0,e.registerComposition=s,e}}(),renderers={},registerRenderer=function(e,i){renderers[e]=i};function getRenderer(s){return renderers[s]}function getRegisteredRenderer(){if(renderers.canvas)return"canvas";for(var s in renderers)if(renderers[s])return s;return""}function _typeof$4(s){"@babel/helpers - typeof";return _typeof$4=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof$4(s)}var AnimationItem=function(){this._cbs=[],this.name="",this.path="",this.isLoaded=!1,this.currentFrame=0,this.currentRawFrame=0,this.firstFrame=0,this.totalFrames=0,this.frameRate=0,this.frameMult=0,this.playSpeed=1,this.playDirection=1,this.playCount=0,this.animationData={},this.assets=[],this.isPaused=!0,this.autoplay=!1,this.loop=!0,this.renderer=null,this.animationID=createElementID(),this.assetsPath="",this.timeCompleted=0,this.segmentPos=0,this.isSubframeEnabled=getSubframeEnabled(),this.segments=[],this._idle=!0,this._completedLoop=!1,this.projectInterface=ProjectInterface(),this.imagePreloader=new ImagePreloader,this.audioController=audioControllerFactory(),this.markers=[],this.configAnimation=this.configAnimation.bind(this),this.onSetupError=this.onSetupError.bind(this),this.onSegmentComplete=this.onSegmentComplete.bind(this),this.drawnFrameEvent=new BMEnterFrameEvent("drawnFrame",0,0,0),this.expressionsPlugin=getExpressionsPlugin()};extendPrototype([BaseEvent],AnimationItem),AnimationItem.prototype.setParams=function(s){(s.wrapper||s.container)&&(this.wrapper=s.wrapper||s.container);var e="svg";s.animType?e=s.animType:s.renderer&&(e=s.renderer);var i=getRenderer(e);this.renderer=new i(this,s.rendererSettings),this.imagePreloader.setCacheType(e,this.renderer.globalData.defs),this.renderer.setProjectInterface(this.projectInterface),this.animType=e,s.loop===""||s.loop===null||s.loop===void 0||s.loop===!0?this.loop=!0:s.loop===!1?this.loop=!1:this.loop=parseInt(s.loop,10),this.autoplay="autoplay"in s?s.autoplay:!0,this.name=s.name?s.name:"",this.autoloadSegments=Object.prototype.hasOwnProperty.call(s,"autoloadSegments")?s.autoloadSegments:!0,this.assetsPath=s.assetsPath,this.initialSegment=s.initialSegment,s.audioFactory&&this.audioController.setAudioFactory(s.audioFactory),s.animationData?this.setupAnimation(s.animationData):s.path&&(s.path.lastIndexOf("\\")!==-1?this.path=s.path.substr(0,s.path.lastIndexOf("\\")+1):this.path=s.path.substr(0,s.path.lastIndexOf("/")+1),this.fileName=s.path.substr(s.path.lastIndexOf("/")+1),this.fileName=this.fileName.substr(0,this.fileName.lastIndexOf(".json")),dataManager.loadAnimation(s.path,this.configAnimation,this.onSetupError))},AnimationItem.prototype.onSetupError=function(){this.trigger("data_failed")},AnimationItem.prototype.setupAnimation=function(s){dataManager.completeAnimation(s,this.configAnimation)},AnimationItem.prototype.setData=function(s,e){e&&_typeof$4(e)!=="object"&&(e=JSON.parse(e));var i={wrapper:s,animationData:e},a=s.attributes;i.path=a.getNamedItem("data-animation-path")?a.getNamedItem("data-animation-path").value:a.getNamedItem("data-bm-path")?a.getNamedItem("data-bm-path").value:a.getNamedItem("bm-path")?a.getNamedItem("bm-path").value:"",i.animType=a.getNamedItem("data-anim-type")?a.getNamedItem("data-anim-type").value:a.getNamedItem("data-bm-type")?a.getNamedItem("data-bm-type").value:a.getNamedItem("bm-type")?a.getNamedItem("bm-type").value:a.getNamedItem("data-bm-renderer")?a.getNamedItem("data-bm-renderer").value:a.getNamedItem("bm-renderer")?a.getNamedItem("bm-renderer").value:getRegisteredRenderer()||"canvas";var o=a.getNamedItem("data-anim-loop")?a.getNamedItem("data-anim-loop").value:a.getNamedItem("data-bm-loop")?a.getNamedItem("data-bm-loop").value:a.getNamedItem("bm-loop")?a.getNamedItem("bm-loop").value:"";o==="false"?i.loop=!1:o==="true"?i.loop=!0:o!==""&&(i.loop=parseInt(o,10));var c=a.getNamedItem("data-anim-autoplay")?a.getNamedItem("data-anim-autoplay").value:a.getNamedItem("data-bm-autoplay")?a.getNamedItem("data-bm-autoplay").value:a.getNamedItem("bm-autoplay")?a.getNamedItem("bm-autoplay").value:!0;i.autoplay=c!=="false",i.name=a.getNamedItem("data-name")?a.getNamedItem("data-name").value:a.getNamedItem("data-bm-name")?a.getNamedItem("data-bm-name").value:a.getNamedItem("bm-name")?a.getNamedItem("bm-name").value:"";var d=a.getNamedItem("data-anim-prerender")?a.getNamedItem("data-anim-prerender").value:a.getNamedItem("data-bm-prerender")?a.getNamedItem("data-bm-prerender").value:a.getNamedItem("bm-prerender")?a.getNamedItem("bm-prerender").value:"";d==="false"&&(i.prerender=!1),i.path?this.setParams(i):this.trigger("destroy")},AnimationItem.prototype.includeLayers=function(s){s.op>this.animationData.op&&(this.animationData.op=s.op,this.totalFrames=Math.floor(s.op-this.animationData.ip));var e=this.animationData.layers,i,a=e.length,o=s.layers,c,d=o.length;for(c=0;c<d;c+=1)for(i=0;i<a;){if(e[i].id===o[c].id){e[i]=o[c];break}i+=1}if((s.chars||s.fonts)&&(this.renderer.globalData.fontManager.addChars(s.chars),this.renderer.globalData.fontManager.addFonts(s.fonts,this.renderer.globalData.defs)),s.assets)for(a=s.assets.length,i=0;i<a;i+=1)this.animationData.assets.push(s.assets[i]);this.animationData.__complete=!1,dataManager.completeAnimation(this.animationData,this.onSegmentComplete)},AnimationItem.prototype.onSegmentComplete=function(s){this.animationData=s;var e=getExpressionsPlugin();e&&e.initExpressions(this),this.loadNextSegment()},AnimationItem.prototype.loadNextSegment=function(){var s=this.animationData.segments;if(!s||s.length===0||!this.autoloadSegments){this.trigger("data_ready"),this.timeCompleted=this.totalFrames;return}var e=s.shift();this.timeCompleted=e.time*this.frameRate;var i=this.path+this.fileName+"_"+this.segmentPos+".json";this.segmentPos+=1,dataManager.loadData(i,this.includeLayers.bind(this),(function(){this.trigger("data_failed")}).bind(this))},AnimationItem.prototype.loadSegments=function(){var s=this.animationData.segments;s||(this.timeCompleted=this.totalFrames),this.loadNextSegment()},AnimationItem.prototype.imagesLoaded=function(){this.trigger("loaded_images"),this.checkLoaded()},AnimationItem.prototype.preloadImages=function(){this.imagePreloader.setAssetsPath(this.assetsPath),this.imagePreloader.setPath(this.path),this.imagePreloader.loadAssets(this.animationData.assets,this.imagesLoaded.bind(this))},AnimationItem.prototype.configAnimation=function(s){if(this.renderer)try{this.animationData=s,this.initialSegment?(this.totalFrames=Math.floor(this.initialSegment[1]-this.initialSegment[0]),this.firstFrame=Math.round(this.initialSegment[0])):(this.totalFrames=Math.floor(this.animationData.op-this.animationData.ip),this.firstFrame=Math.round(this.animationData.ip)),this.renderer.configAnimation(s),s.assets||(s.assets=[]),this.assets=this.animationData.assets,this.frameRate=this.animationData.fr,this.frameMult=this.animationData.fr/1e3,this.renderer.searchExtraCompositions(s.assets),this.markers=markerParser(s.markers||[]),this.trigger("config_ready"),this.preloadImages(),this.loadSegments(),this.updaFrameModifier(),this.waitForFontsLoaded(),this.isPaused&&this.audioController.pause()}catch(e){this.triggerConfigError(e)}},AnimationItem.prototype.waitForFontsLoaded=function(){this.renderer&&(this.renderer.globalData.fontManager.isLoaded?this.checkLoaded():setTimeout(this.waitForFontsLoaded.bind(this),20))},AnimationItem.prototype.checkLoaded=function(){if(!this.isLoaded&&this.renderer.globalData.fontManager.isLoaded&&(this.imagePreloader.loadedImages()||this.renderer.rendererType!=="canvas")&&this.imagePreloader.loadedFootages()){this.isLoaded=!0;var s=getExpressionsPlugin();s&&s.initExpressions(this),this.renderer.initItems(),setTimeout((function(){this.trigger("DOMLoaded")}).bind(this),0),this.gotoFrame(),this.autoplay&&this.play()}},AnimationItem.prototype.resize=function(s,e){var i=typeof s=="number"?s:void 0,a=typeof e=="number"?e:void 0;this.renderer.updateContainerSize(i,a)},AnimationItem.prototype.setSubframe=function(s){this.isSubframeEnabled=!!s},AnimationItem.prototype.gotoFrame=function(){this.currentFrame=this.isSubframeEnabled?this.currentRawFrame:~~this.currentRawFrame,this.timeCompleted!==this.totalFrames&&this.currentFrame>this.timeCompleted&&(this.currentFrame=this.timeCompleted),this.trigger("enterFrame"),this.renderFrame(),this.trigger("drawnFrame")},AnimationItem.prototype.renderFrame=function(){if(!(this.isLoaded===!1||!this.renderer))try{this.expressionsPlugin&&this.expressionsPlugin.resetFrame(),this.renderer.renderFrame(this.currentFrame+this.firstFrame)}catch(s){this.triggerRenderFrameError(s)}},AnimationItem.prototype.play=function(s){s&&this.name!==s||this.isPaused===!0&&(this.isPaused=!1,this.trigger("_play"),this.audioController.resume(),this._idle&&(this._idle=!1,this.trigger("_active")))},AnimationItem.prototype.pause=function(s){s&&this.name!==s||this.isPaused===!1&&(this.isPaused=!0,this.trigger("_pause"),this._idle=!0,this.trigger("_idle"),this.audioController.pause())},AnimationItem.prototype.togglePause=function(s){s&&this.name!==s||(this.isPaused===!0?this.play():this.pause())},AnimationItem.prototype.stop=function(s){s&&this.name!==s||(this.pause(),this.playCount=0,this._completedLoop=!1,this.setCurrentRawFrameValue(0))},AnimationItem.prototype.getMarkerData=function(s){for(var e,i=0;i<this.markers.length;i+=1)if(e=this.markers[i],e.payload&&e.payload.name===s)return e;return null},AnimationItem.prototype.goToAndStop=function(s,e,i){if(!(i&&this.name!==i)){var a=Number(s);if(isNaN(a)){var o=this.getMarkerData(s);o&&this.goToAndStop(o.time,!0)}else e?this.setCurrentRawFrameValue(s):this.setCurrentRawFrameValue(s*this.frameModifier);this.pause()}},AnimationItem.prototype.goToAndPlay=function(s,e,i){if(!(i&&this.name!==i)){var a=Number(s);if(isNaN(a)){var o=this.getMarkerData(s);o&&(o.duration?this.playSegments([o.time,o.time+o.duration],!0):this.goToAndStop(o.time,!0))}else this.goToAndStop(a,e,i);this.play()}},AnimationItem.prototype.advanceTime=function(s){if(!(this.isPaused===!0||this.isLoaded===!1)){var e=this.currentRawFrame+s*this.frameModifier,i=!1;e>=this.totalFrames-1&&this.frameModifier>0?!this.loop||this.playCount===this.loop?this.checkSegments(e>this.totalFrames?e%this.totalFrames:0)||(i=!0,e=this.totalFrames-1):e>=this.totalFrames?(this.playCount+=1,this.checkSegments(e%this.totalFrames)||(this.setCurrentRawFrameValue(e%this.totalFrames),this._completedLoop=!0,this.trigger("loopComplete"))):this.setCurrentRawFrameValue(e):e<0?this.checkSegments(e%this.totalFrames)||(this.loop&&!(this.playCount--<=0&&this.loop!==!0)?(this.setCurrentRawFrameValue(this.totalFrames+e%this.totalFrames),this._completedLoop?this.trigger("loopComplete"):this._completedLoop=!0):(i=!0,e=0)):this.setCurrentRawFrameValue(e),i&&(this.setCurrentRawFrameValue(e),this.pause(),this.trigger("complete"))}},AnimationItem.prototype.adjustSegment=function(s,e){this.playCount=0,s[1]<s[0]?(this.frameModifier>0&&(this.playSpeed<0?this.setSpeed(-this.playSpeed):this.setDirection(-1)),this.totalFrames=s[0]-s[1],this.timeCompleted=this.totalFrames,this.firstFrame=s[1],this.setCurrentRawFrameValue(this.totalFrames-.001-e)):s[1]>s[0]&&(this.frameModifier<0&&(this.playSpeed<0?this.setSpeed(-this.playSpeed):this.setDirection(1)),this.totalFrames=s[1]-s[0],this.timeCompleted=this.totalFrames,this.firstFrame=s[0],this.setCurrentRawFrameValue(.001+e)),this.trigger("segmentStart")},AnimationItem.prototype.setSegment=function(s,e){var i=-1;this.isPaused&&(this.currentRawFrame+this.firstFrame<s?i=s:this.currentRawFrame+this.firstFrame>e&&(i=e-s)),this.firstFrame=s,this.totalFrames=e-s,this.timeCompleted=this.totalFrames,i!==-1&&this.goToAndStop(i,!0)},AnimationItem.prototype.playSegments=function(s,e){if(e&&(this.segments.length=0),_typeof$4(s[0])==="object"){var i,a=s.length;for(i=0;i<a;i+=1)this.segments.push(s[i])}else this.segments.push(s);this.segments.length&&e&&this.adjustSegment(this.segments.shift(),0),this.isPaused&&this.play()},AnimationItem.prototype.resetSegments=function(s){this.segments.length=0,this.segments.push([this.animationData.ip,this.animationData.op]),s&&this.checkSegments(0)},AnimationItem.prototype.checkSegments=function(s){return this.segments.length?(this.adjustSegment(this.segments.shift(),s),!0):!1},AnimationItem.prototype.destroy=function(s){s&&this.name!==s||!this.renderer||(this.renderer.destroy(),this.imagePreloader.destroy(),this.trigger("destroy"),this._cbs=null,this.onEnterFrame=null,this.onLoopComplete=null,this.onComplete=null,this.onSegmentStart=null,this.onDestroy=null,this.renderer=null,this.expressionsPlugin=null,this.imagePreloader=null,this.projectInterface=null)},AnimationItem.prototype.setCurrentRawFrameValue=function(s){this.currentRawFrame=s,this.gotoFrame()},AnimationItem.prototype.setSpeed=function(s){this.playSpeed=s,this.updaFrameModifier()},AnimationItem.prototype.setDirection=function(s){this.playDirection=s<0?-1:1,this.updaFrameModifier()},AnimationItem.prototype.setLoop=function(s){this.loop=s},AnimationItem.prototype.setVolume=function(s,e){e&&this.name!==e||this.audioController.setVolume(s)},AnimationItem.prototype.getVolume=function(){return this.audioController.getVolume()},AnimationItem.prototype.mute=function(s){s&&this.name!==s||this.audioController.mute()},AnimationItem.prototype.unmute=function(s){s&&this.name!==s||this.audioController.unmute()},AnimationItem.prototype.updaFrameModifier=function(){this.frameModifier=this.frameMult*this.playSpeed*this.playDirection,this.audioController.setRate(this.playSpeed*this.playDirection)},AnimationItem.prototype.getPath=function(){return this.path},AnimationItem.prototype.getAssetsPath=function(s){var e="";if(s.e)e=s.p;else if(this.assetsPath){var i=s.p;i.indexOf("images/")!==-1&&(i=i.split("/")[1]),e=this.assetsPath+i}else e=this.path,e+=s.u?s.u:"",e+=s.p;return e},AnimationItem.prototype.getAssetData=function(s){for(var e=0,i=this.assets.length;e<i;){if(s===this.assets[e].id)return this.assets[e];e+=1}return null},AnimationItem.prototype.hide=function(){this.renderer.hide()},AnimationItem.prototype.show=function(){this.renderer.show()},AnimationItem.prototype.getDuration=function(s){return s?this.totalFrames:this.totalFrames/this.frameRate},AnimationItem.prototype.updateDocumentData=function(s,e,i){try{var a=this.renderer.getElementByPath(s);a.updateDocumentData(e,i)}catch{}},AnimationItem.prototype.trigger=function(s){if(this._cbs&&this._cbs[s])switch(s){case"enterFrame":this.triggerEvent(s,new BMEnterFrameEvent(s,this.currentFrame,this.totalFrames,this.frameModifier));break;case"drawnFrame":this.drawnFrameEvent.currentTime=this.currentFrame,this.drawnFrameEvent.totalTime=this.totalFrames,this.drawnFrameEvent.direction=this.frameModifier,this.triggerEvent(s,this.drawnFrameEvent);break;case"loopComplete":this.triggerEvent(s,new BMCompleteLoopEvent(s,this.loop,this.playCount,this.frameMult));break;case"complete":this.triggerEvent(s,new BMCompleteEvent(s,this.frameMult));break;case"segmentStart":this.triggerEvent(s,new BMSegmentStartEvent(s,this.firstFrame,this.totalFrames));break;case"destroy":this.triggerEvent(s,new BMDestroyEvent(s,this));break;default:this.triggerEvent(s)}s==="enterFrame"&&this.onEnterFrame&&this.onEnterFrame.call(this,new BMEnterFrameEvent(s,this.currentFrame,this.totalFrames,this.frameMult)),s==="loopComplete"&&this.onLoopComplete&&this.onLoopComplete.call(this,new BMCompleteLoopEvent(s,this.loop,this.playCount,this.frameMult)),s==="complete"&&this.onComplete&&this.onComplete.call(this,new BMCompleteEvent(s,this.frameMult)),s==="segmentStart"&&this.onSegmentStart&&this.onSegmentStart.call(this,new BMSegmentStartEvent(s,this.firstFrame,this.totalFrames)),s==="destroy"&&this.onDestroy&&this.onDestroy.call(this,new BMDestroyEvent(s,this))},AnimationItem.prototype.triggerRenderFrameError=function(s){var e=new BMRenderFrameErrorEvent(s,this.currentFrame);this.triggerEvent("error",e),this.onError&&this.onError.call(this,e)},AnimationItem.prototype.triggerConfigError=function(s){var e=new BMConfigErrorEvent(s,this.currentFrame);this.triggerEvent("error",e),this.onError&&this.onError.call(this,e)};var animationManager=function(){var s={},e=[],i=0,a=0,o=0,c=!0,d=!1;function g(pt){for(var yt=0,ut=pt.target;yt<a;)e[yt].animation===ut&&(e.splice(yt,1),yt-=1,a-=1,ut.isPaused||$()),yt+=1}function b(pt,yt){if(!pt)return null;for(var ut=0;ut<a;){if(e[ut].elem===pt&&e[ut].elem!==null)return e[ut].animation;ut+=1}var ft=new AnimationItem;return _e(ft,pt),ft.setData(pt,yt),ft}function _(){var pt,yt=e.length,ut=[];for(pt=0;pt<yt;pt+=1)ut.push(e[pt].animation);return ut}function j(){o+=1,vt()}function $(){o-=1}function _e(pt,yt){pt.addEventListener("destroy",g),pt.addEventListener("_active",j),pt.addEventListener("_idle",$),e.push({elem:yt,animation:pt}),a+=1}function tt(pt){var yt=new AnimationItem;return _e(yt,null),yt.setParams(pt),yt}function et(pt,yt){var ut;for(ut=0;ut<a;ut+=1)e[ut].animation.setSpeed(pt,yt)}function st(pt,yt){var ut;for(ut=0;ut<a;ut+=1)e[ut].animation.setDirection(pt,yt)}function at(pt){var yt;for(yt=0;yt<a;yt+=1)e[yt].animation.play(pt)}function rt(pt){var yt=pt-i,ut;for(ut=0;ut<a;ut+=1)e[ut].animation.advanceTime(yt);i=pt,o&&!d?window.requestAnimationFrame(rt):c=!0}function nt(pt){i=pt,window.requestAnimationFrame(rt)}function it(pt){var yt;for(yt=0;yt<a;yt+=1)e[yt].animation.pause(pt)}function ot(pt,yt,ut){var ft;for(ft=0;ft<a;ft+=1)e[ft].animation.goToAndStop(pt,yt,ut)}function lt(pt){var yt;for(yt=0;yt<a;yt+=1)e[yt].animation.stop(pt)}function ct(pt){var yt;for(yt=0;yt<a;yt+=1)e[yt].animation.togglePause(pt)}function ht(pt){var yt;for(yt=a-1;yt>=0;yt-=1)e[yt].animation.destroy(pt)}function dt(pt,yt,ut){var ft=[].concat([].slice.call(document.getElementsByClassName("lottie")),[].slice.call(document.getElementsByClassName("bodymovin"))),xt,mt=ft.length;for(xt=0;xt<mt;xt+=1)ut&&ft[xt].setAttribute("data-bm-type",ut),b(ft[xt],pt);if(yt&&mt===0){ut||(ut="svg");var Et=document.getElementsByTagName("body")[0];Et.innerText="";var At=createTag("div");At.style.width="100%",At.style.height="100%",At.setAttribute("data-bm-type",ut),Et.appendChild(At),b(At,pt)}}function gt(){var pt;for(pt=0;pt<a;pt+=1)e[pt].animation.resize()}function vt(){!d&&o&&c&&(window.requestAnimationFrame(nt),c=!1)}function St(){d=!0}function Tt(){d=!1,vt()}function Ct(pt,yt){var ut;for(ut=0;ut<a;ut+=1)e[ut].animation.setVolume(pt,yt)}function Rt(pt){var yt;for(yt=0;yt<a;yt+=1)e[yt].animation.mute(pt)}function bt(pt){var yt;for(yt=0;yt<a;yt+=1)e[yt].animation.unmute(pt)}return s.registerAnimation=b,s.loadAnimation=tt,s.setSpeed=et,s.setDirection=st,s.play=at,s.pause=it,s.stop=lt,s.togglePause=ct,s.searchAnimations=dt,s.resize=gt,s.goToAndStop=ot,s.destroy=ht,s.freeze=St,s.unfreeze=Tt,s.setVolume=Ct,s.mute=Rt,s.unmute=bt,s.getRegisteredAnimations=_,s}(),BezierFactory=function(){var s={};s.getBezierEasing=i;var e={};function i(nt,it,ot,lt,ct){var ht=ct||("bez_"+nt+"_"+it+"_"+ot+"_"+lt).replace(/\./g,"p");if(e[ht])return e[ht];var dt=new rt([nt,it,ot,lt]);return e[ht]=dt,dt}var a=4,o=.001,c=1e-7,d=10,g=11,b=1/(g-1),_=typeof Float32Array=="function";function j(nt,it){return 1-3*it+3*nt}function $(nt,it){return 3*it-6*nt}function _e(nt){return 3*nt}function tt(nt,it,ot){return((j(it,ot)*nt+$(it,ot))*nt+_e(it))*nt}function et(nt,it,ot){return 3*j(it,ot)*nt*nt+2*$(it,ot)*nt+_e(it)}function st(nt,it,ot,lt,ct){var ht,dt,gt=0;do dt=it+(ot-it)/2,ht=tt(dt,lt,ct)-nt,ht>0?ot=dt:it=dt;while(Math.abs(ht)>c&&++gt<d);return dt}function at(nt,it,ot,lt){for(var ct=0;ct<a;++ct){var ht=et(it,ot,lt);if(ht===0)return it;var dt=tt(it,ot,lt)-nt;it-=dt/ht}return it}function rt(nt){this._p=nt,this._mSampleValues=_?new Float32Array(g):new Array(g),this._precomputed=!1,this.get=this.get.bind(this)}return rt.prototype={get:function(it){var ot=this._p[0],lt=this._p[1],ct=this._p[2],ht=this._p[3];return this._precomputed||this._precompute(),ot===lt&&ct===ht?it:it===0?0:it===1?1:tt(this._getTForX(it),lt,ht)},_precompute:function(){var it=this._p[0],ot=this._p[1],lt=this._p[2],ct=this._p[3];this._precomputed=!0,(it!==ot||lt!==ct)&&this._calcSampleValues()},_calcSampleValues:function(){for(var it=this._p[0],ot=this._p[2],lt=0;lt<g;++lt)this._mSampleValues[lt]=tt(lt*b,it,ot)},_getTForX:function(it){for(var ot=this._p[0],lt=this._p[2],ct=this._mSampleValues,ht=0,dt=1,gt=g-1;dt!==gt&&ct[dt]<=it;++dt)ht+=b;--dt;var vt=(it-ct[dt])/(ct[dt+1]-ct[dt]),St=ht+vt*b,Tt=et(St,ot,lt);return Tt>=o?at(it,St,ot,lt):Tt===0?St:st(it,ht,ht+b,ot,lt)}},s}(),pooling=function(){function s(e){return e.concat(createSizedArray(e.length))}return{double:s}}(),poolFactory=function(){return function(s,e,i){var a=0,o=s,c=createSizedArray(o),d={newElement:g,release:b};function g(){var _;return a?(a-=1,_=c[a]):_=e(),_}function b(_){a===o&&(c=pooling.double(c),o*=2),i&&i(_),c[a]=_,a+=1}return d}}(),bezierLengthPool=function(){function s(){return{addedLength:0,percents:createTypedArray("float32",getDefaultCurveSegments()),lengths:createTypedArray("float32",getDefaultCurveSegments())}}return poolFactory(8,s)}(),segmentsLengthPool=function(){function s(){return{lengths:[],totalLength:0}}function e(i){var a,o=i.lengths.length;for(a=0;a<o;a+=1)bezierLengthPool.release(i.lengths[a]);i.lengths.length=0}return poolFactory(8,s,e)}();function bezFunction(){var s=Math;function e(_e,tt,et,st,at,rt){var nt=_e*st+tt*at+et*rt-at*st-rt*_e-et*tt;return nt>-.001&&nt<.001}function i(_e,tt,et,st,at,rt,nt,it,ot){if(et===0&&rt===0&&ot===0)return e(_e,tt,st,at,nt,it);var lt=s.sqrt(s.pow(st-_e,2)+s.pow(at-tt,2)+s.pow(rt-et,2)),ct=s.sqrt(s.pow(nt-_e,2)+s.pow(it-tt,2)+s.pow(ot-et,2)),ht=s.sqrt(s.pow(nt-st,2)+s.pow(it-at,2)+s.pow(ot-rt,2)),dt;return lt>ct?lt>ht?dt=lt-ct-ht:dt=ht-ct-lt:ht>ct?dt=ht-ct-lt:dt=ct-lt-ht,dt>-1e-4&&dt<1e-4}var a=function(){return function(_e,tt,et,st){var at=getDefaultCurveSegments(),rt,nt,it,ot,lt,ct=0,ht,dt=[],gt=[],vt=bezierLengthPool.newElement();for(it=et.length,rt=0;rt<at;rt+=1){for(lt=rt/(at-1),ht=0,nt=0;nt<it;nt+=1)ot=bmPow(1-lt,3)*_e[nt]+3*bmPow(1-lt,2)*lt*et[nt]+3*(1-lt)*bmPow(lt,2)*st[nt]+bmPow(lt,3)*tt[nt],dt[nt]=ot,gt[nt]!==null&&(ht+=bmPow(dt[nt]-gt[nt],2)),gt[nt]=dt[nt];ht&&(ht=bmSqrt(ht),ct+=ht),vt.percents[rt]=lt,vt.lengths[rt]=ct}return vt.addedLength=ct,vt}}();function o(_e){var tt=segmentsLengthPool.newElement(),et=_e.c,st=_e.v,at=_e.o,rt=_e.i,nt,it=_e._length,ot=tt.lengths,lt=0;for(nt=0;nt<it-1;nt+=1)ot[nt]=a(st[nt],st[nt+1],at[nt],rt[nt+1]),lt+=ot[nt].addedLength;return et&&it&&(ot[nt]=a(st[nt],st[0],at[nt],rt[0]),lt+=ot[nt].addedLength),tt.totalLength=lt,tt}function c(_e){this.segmentLength=0,this.points=new Array(_e)}function d(_e,tt){this.partialLength=_e,this.point=tt}var g=function(){var _e={};return function(tt,et,st,at){var rt=(tt[0]+"_"+tt[1]+"_"+et[0]+"_"+et[1]+"_"+st[0]+"_"+st[1]+"_"+at[0]+"_"+at[1]).replace(/\./g,"p");if(!_e[rt]){var nt=getDefaultCurveSegments(),it,ot,lt,ct,ht,dt=0,gt,vt,St=null;tt.length===2&&(tt[0]!==et[0]||tt[1]!==et[1])&&e(tt[0],tt[1],et[0],et[1],tt[0]+st[0],tt[1]+st[1])&&e(tt[0],tt[1],et[0],et[1],et[0]+at[0],et[1]+at[1])&&(nt=2);var Tt=new c(nt);for(lt=st.length,it=0;it<nt;it+=1){for(vt=createSizedArray(lt),ht=it/(nt-1),gt=0,ot=0;ot<lt;ot+=1)ct=bmPow(1-ht,3)*tt[ot]+3*bmPow(1-ht,2)*ht*(tt[ot]+st[ot])+3*(1-ht)*bmPow(ht,2)*(et[ot]+at[ot])+bmPow(ht,3)*et[ot],vt[ot]=ct,St!==null&&(gt+=bmPow(vt[ot]-St[ot],2));gt=bmSqrt(gt),dt+=gt,Tt.points[it]=new d(gt,vt),St=vt}Tt.segmentLength=dt,_e[rt]=Tt}return _e[rt]}}();function b(_e,tt){var et=tt.percents,st=tt.lengths,at=et.length,rt=bmFloor((at-1)*_e),nt=_e*tt.addedLength,it=0;if(rt===at-1||rt===0||nt===st[rt])return et[rt];for(var ot=st[rt]>nt?-1:1,lt=!0;lt;)if(st[rt]<=nt&&st[rt+1]>nt?(it=(nt-st[rt])/(st[rt+1]-st[rt]),lt=!1):rt+=ot,rt<0||rt>=at-1){if(rt===at-1)return et[rt];lt=!1}return et[rt]+(et[rt+1]-et[rt])*it}function _(_e,tt,et,st,at,rt){var nt=b(at,rt),it=1-nt,ot=s.round((it*it*it*_e[0]+(nt*it*it+it*nt*it+it*it*nt)*et[0]+(nt*nt*it+it*nt*nt+nt*it*nt)*st[0]+nt*nt*nt*tt[0])*1e3)/1e3,lt=s.round((it*it*it*_e[1]+(nt*it*it+it*nt*it+it*it*nt)*et[1]+(nt*nt*it+it*nt*nt+nt*it*nt)*st[1]+nt*nt*nt*tt[1])*1e3)/1e3;return[ot,lt]}var j=createTypedArray("float32",8);function $(_e,tt,et,st,at,rt,nt){at<0?at=0:at>1&&(at=1);var it=b(at,nt);rt=rt>1?1:rt;var ot=b(rt,nt),lt,ct=_e.length,ht=1-it,dt=1-ot,gt=ht*ht*ht,vt=it*ht*ht*3,St=it*it*ht*3,Tt=it*it*it,Ct=ht*ht*dt,Rt=it*ht*dt+ht*it*dt+ht*ht*ot,bt=it*it*dt+ht*it*ot+it*ht*ot,pt=it*it*ot,yt=ht*dt*dt,ut=it*dt*dt+ht*ot*dt+ht*dt*ot,ft=it*ot*dt+ht*ot*ot+it*dt*ot,xt=it*ot*ot,mt=dt*dt*dt,Et=ot*dt*dt+dt*ot*dt+dt*dt*ot,At=ot*ot*dt+dt*ot*ot+ot*dt*ot,Pt=ot*ot*ot;for(lt=0;lt<ct;lt+=1)j[lt*4]=s.round((gt*_e[lt]+vt*et[lt]+St*st[lt]+Tt*tt[lt])*1e3)/1e3,j[lt*4+1]=s.round((Ct*_e[lt]+Rt*et[lt]+bt*st[lt]+pt*tt[lt])*1e3)/1e3,j[lt*4+2]=s.round((yt*_e[lt]+ut*et[lt]+ft*st[lt]+xt*tt[lt])*1e3)/1e3,j[lt*4+3]=s.round((mt*_e[lt]+Et*et[lt]+At*st[lt]+Pt*tt[lt])*1e3)/1e3;return j}return{getSegmentsLength:o,getNewSegment:$,getPointInSegment:_,buildBezierData:g,pointOnLine2D:e,pointOnLine3D:i}}var bez=bezFunction(),initFrame=initialDefaultFrame,mathAbs=Math.abs;function interpolateValue(s,e){var i=this.offsetTime,a;this.propType==="multidimensional"&&(a=createTypedArray("float32",this.pv.length));for(var o=e.lastIndex,c=o,d=this.keyframes.length-1,g=!0,b,_,j;g;){if(b=this.keyframes[c],_=this.keyframes[c+1],c===d-1&&s>=_.t-i){b.h&&(b=_),o=0;break}if(_.t-i>s){o=c;break}c<d-1?c+=1:(o=0,g=!1)}j=this.keyframesMetadata[c]||{};var $,_e,tt,et,st,at,rt=_.t-i,nt=b.t-i,it;if(b.to){j.bezierData||(j.bezierData=bez.buildBezierData(b.s,_.s||b.e,b.to,b.ti));var ot=j.bezierData;if(s>=rt||s<nt){var lt=s>=rt?ot.points.length-1:0;for(_e=ot.points[lt].point.length,$=0;$<_e;$+=1)a[$]=ot.points[lt].point[$]}else{j.__fnct?at=j.__fnct:(at=BezierFactory.getBezierEasing(b.o.x,b.o.y,b.i.x,b.i.y,b.n).get,j.__fnct=at),tt=at((s-nt)/(rt-nt));var ct=ot.segmentLength*tt,ht,dt=e.lastFrame<s&&e._lastKeyframeIndex===c?e._lastAddedLength:0;for(st=e.lastFrame<s&&e._lastKeyframeIndex===c?e._lastPoint:0,g=!0,et=ot.points.length;g;){if(dt+=ot.points[st].partialLength,ct===0||tt===0||st===ot.points.length-1){for(_e=ot.points[st].point.length,$=0;$<_e;$+=1)a[$]=ot.points[st].point[$];break}else if(ct>=dt&&ct<dt+ot.points[st+1].partialLength){for(ht=(ct-dt)/ot.points[st+1].partialLength,_e=ot.points[st].point.length,$=0;$<_e;$+=1)a[$]=ot.points[st].point[$]+(ot.points[st+1].point[$]-ot.points[st].point[$])*ht;break}st<et-1?st+=1:g=!1}e._lastPoint=st,e._lastAddedLength=dt-ot.points[st].partialLength,e._lastKeyframeIndex=c}}else{var gt,vt,St,Tt,Ct;if(d=b.s.length,it=_.s||b.e,this.sh&&b.h!==1)if(s>=rt)a[0]=it[0],a[1]=it[1],a[2]=it[2];else if(s<=nt)a[0]=b.s[0],a[1]=b.s[1],a[2]=b.s[2];else{var Rt=createQuaternion(b.s),bt=createQuaternion(it),pt=(s-nt)/(rt-nt);quaternionToEuler(a,slerp(Rt,bt,pt))}else for(c=0;c<d;c+=1)b.h!==1&&(s>=rt?tt=1:s<nt?tt=0:(b.o.x.constructor===Array?(j.__fnct||(j.__fnct=[]),j.__fnct[c]?at=j.__fnct[c]:(gt=b.o.x[c]===void 0?b.o.x[0]:b.o.x[c],vt=b.o.y[c]===void 0?b.o.y[0]:b.o.y[c],St=b.i.x[c]===void 0?b.i.x[0]:b.i.x[c],Tt=b.i.y[c]===void 0?b.i.y[0]:b.i.y[c],at=BezierFactory.getBezierEasing(gt,vt,St,Tt).get,j.__fnct[c]=at)):j.__fnct?at=j.__fnct:(gt=b.o.x,vt=b.o.y,St=b.i.x,Tt=b.i.y,at=BezierFactory.getBezierEasing(gt,vt,St,Tt).get,b.keyframeMetadata=at),tt=at((s-nt)/(rt-nt)))),it=_.s||b.e,Ct=b.h===1?b.s[c]:b.s[c]+(it[c]-b.s[c])*tt,this.propType==="multidimensional"?a[c]=Ct:a=Ct}return e.lastIndex=o,a}function slerp(s,e,i){var a=[],o=s[0],c=s[1],d=s[2],g=s[3],b=e[0],_=e[1],j=e[2],$=e[3],_e,tt,et,st,at;return tt=o*b+c*_+d*j+g*$,tt<0&&(tt=-tt,b=-b,_=-_,j=-j,$=-$),1-tt>1e-6?(_e=Math.acos(tt),et=Math.sin(_e),st=Math.sin((1-i)*_e)/et,at=Math.sin(i*_e)/et):(st=1-i,at=i),a[0]=st*o+at*b,a[1]=st*c+at*_,a[2]=st*d+at*j,a[3]=st*g+at*$,a}function quaternionToEuler(s,e){var i=e[0],a=e[1],o=e[2],c=e[3],d=Math.atan2(2*a*c-2*i*o,1-2*a*a-2*o*o),g=Math.asin(2*i*a+2*o*c),b=Math.atan2(2*i*c-2*a*o,1-2*i*i-2*o*o);s[0]=d/degToRads,s[1]=g/degToRads,s[2]=b/degToRads}function createQuaternion(s){var e=s[0]*degToRads,i=s[1]*degToRads,a=s[2]*degToRads,o=Math.cos(e/2),c=Math.cos(i/2),d=Math.cos(a/2),g=Math.sin(e/2),b=Math.sin(i/2),_=Math.sin(a/2),j=o*c*d-g*b*_,$=g*b*d+o*c*_,_e=g*c*d+o*b*_,tt=o*b*d-g*c*_;return[$,_e,tt,j]}function getValueAtCurrentTime(){var s=this.comp.renderedFrame-this.offsetTime,e=this.keyframes[0].t-this.offsetTime,i=this.keyframes[this.keyframes.length-1].t-this.offsetTime;if(!(s===this._caching.lastFrame||this._caching.lastFrame!==initFrame&&(this._caching.lastFrame>=i&&s>=i||this._caching.lastFrame<e&&s<e))){this._caching.lastFrame>=s&&(this._caching._lastKeyframeIndex=-1,this._caching.lastIndex=0);var a=this.interpolateValue(s,this._caching);this.pv=a}return this._caching.lastFrame=s,this.pv}function setVValue(s){var e;if(this.propType==="unidimensional")e=s*this.mult,mathAbs(this.v-e)>1e-5&&(this.v=e,this._mdf=!0);else for(var i=0,a=this.v.length;i<a;)e=s[i]*this.mult,mathAbs(this.v[i]-e)>1e-5&&(this.v[i]=e,this._mdf=!0),i+=1}function processEffectsSequence(){if(!(this.elem.globalData.frameId===this.frameId||!this.effectsSequence.length)){if(this.lock){this.setVValue(this.pv);return}this.lock=!0,this._mdf=this._isFirstFrame;var s,e=this.effectsSequence.length,i=this.kf?this.pv:this.data.k;for(s=0;s<e;s+=1)i=this.effectsSequence[s](i);this.setVValue(i),this._isFirstFrame=!1,this.lock=!1,this.frameId=this.elem.globalData.frameId}}function addEffect(s){this.effectsSequence.push(s),this.container.addDynamicProperty(this)}function ValueProperty(s,e,i,a){this.propType="unidimensional",this.mult=i||1,this.data=e,this.v=i?e.k*i:e.k,this.pv=e.k,this._mdf=!1,this.elem=s,this.container=a,this.comp=s.comp,this.k=!1,this.kf=!1,this.vel=0,this.effectsSequence=[],this._isFirstFrame=!0,this.getValue=processEffectsSequence,this.setVValue=setVValue,this.addEffect=addEffect}function MultiDimensionalProperty(s,e,i,a){this.propType="multidimensional",this.mult=i||1,this.data=e,this._mdf=!1,this.elem=s,this.container=a,this.comp=s.comp,this.k=!1,this.kf=!1,this.frameId=-1;var o,c=e.k.length;for(this.v=createTypedArray("float32",c),this.pv=createTypedArray("float32",c),this.vel=createTypedArray("float32",c),o=0;o<c;o+=1)this.v[o]=e.k[o]*this.mult,this.pv[o]=e.k[o];this._isFirstFrame=!0,this.effectsSequence=[],this.getValue=processEffectsSequence,this.setVValue=setVValue,this.addEffect=addEffect}function KeyframedValueProperty(s,e,i,a){this.propType="unidimensional",this.keyframes=e.k,this.keyframesMetadata=[],this.offsetTime=s.data.st,this.frameId=-1,this._caching={lastFrame:initFrame,lastIndex:0,value:0,_lastKeyframeIndex:-1},this.k=!0,this.kf=!0,this.data=e,this.mult=i||1,this.elem=s,this.container=a,this.comp=s.comp,this.v=initFrame,this.pv=initFrame,this._isFirstFrame=!0,this.getValue=processEffectsSequence,this.setVValue=setVValue,this.interpolateValue=interpolateValue,this.effectsSequence=[getValueAtCurrentTime.bind(this)],this.addEffect=addEffect}function KeyframedMultidimensionalProperty(s,e,i,a){this.propType="multidimensional";var o,c=e.k.length,d,g,b,_;for(o=0;o<c-1;o+=1)e.k[o].to&&e.k[o].s&&e.k[o+1]&&e.k[o+1].s&&(d=e.k[o].s,g=e.k[o+1].s,b=e.k[o].to,_=e.k[o].ti,(d.length===2&&!(d[0]===g[0]&&d[1]===g[1])&&bez.pointOnLine2D(d[0],d[1],g[0],g[1],d[0]+b[0],d[1]+b[1])&&bez.pointOnLine2D(d[0],d[1],g[0],g[1],g[0]+_[0],g[1]+_[1])||d.length===3&&!(d[0]===g[0]&&d[1]===g[1]&&d[2]===g[2])&&bez.pointOnLine3D(d[0],d[1],d[2],g[0],g[1],g[2],d[0]+b[0],d[1]+b[1],d[2]+b[2])&&bez.pointOnLine3D(d[0],d[1],d[2],g[0],g[1],g[2],g[0]+_[0],g[1]+_[1],g[2]+_[2]))&&(e.k[o].to=null,e.k[o].ti=null),d[0]===g[0]&&d[1]===g[1]&&b[0]===0&&b[1]===0&&_[0]===0&&_[1]===0&&(d.length===2||d[2]===g[2]&&b[2]===0&&_[2]===0)&&(e.k[o].to=null,e.k[o].ti=null));this.effectsSequence=[getValueAtCurrentTime.bind(this)],this.data=e,this.keyframes=e.k,this.keyframesMetadata=[],this.offsetTime=s.data.st,this.k=!0,this.kf=!0,this._isFirstFrame=!0,this.mult=i||1,this.elem=s,this.container=a,this.comp=s.comp,this.getValue=processEffectsSequence,this.setVValue=setVValue,this.interpolateValue=interpolateValue,this.frameId=-1;var j=e.k[0].s.length;for(this.v=createTypedArray("float32",j),this.pv=createTypedArray("float32",j),o=0;o<j;o+=1)this.v[o]=initFrame,this.pv[o]=initFrame;this._caching={lastFrame:initFrame,lastIndex:0,value:createTypedArray("float32",j)},this.addEffect=addEffect}var PropertyFactory=function(){function s(i,a,o,c,d){a.sid&&(a=i.globalData.slotManager.getProp(a));var g;if(!a.k.length)g=new ValueProperty(i,a,c,d);else if(typeof a.k[0]=="number")g=new MultiDimensionalProperty(i,a,c,d);else switch(o){case 0:g=new KeyframedValueProperty(i,a,c,d);break;case 1:g=new KeyframedMultidimensionalProperty(i,a,c,d);break}return g.effectsSequence.length&&d.addDynamicProperty(g),g}var e={getProp:s};return e}();function DynamicPropertyContainer(){}DynamicPropertyContainer.prototype={addDynamicProperty:function(e){this.dynamicProperties.indexOf(e)===-1&&(this.dynamicProperties.push(e),this.container.addDynamicProperty(this),this._isAnimated=!0)},iterateDynamicProperties:function(){this._mdf=!1;var e,i=this.dynamicProperties.length;for(e=0;e<i;e+=1)this.dynamicProperties[e].getValue(),this.dynamicProperties[e]._mdf&&(this._mdf=!0)},initDynamicPropertyContainer:function(e){this.container=e,this.dynamicProperties=[],this._mdf=!1,this._isAnimated=!1}};var pointPool=function(){function s(){return createTypedArray("float32",2)}return poolFactory(8,s)}();function ShapePath(){this.c=!1,this._length=0,this._maxLength=8,this.v=createSizedArray(this._maxLength),this.o=createSizedArray(this._maxLength),this.i=createSizedArray(this._maxLength)}ShapePath.prototype.setPathData=function(s,e){this.c=s,this.setLength(e);for(var i=0;i<e;)this.v[i]=pointPool.newElement(),this.o[i]=pointPool.newElement(),this.i[i]=pointPool.newElement(),i+=1},ShapePath.prototype.setLength=function(s){for(;this._maxLength<s;)this.doubleArrayLength();this._length=s},ShapePath.prototype.doubleArrayLength=function(){this.v=this.v.concat(createSizedArray(this._maxLength)),this.i=this.i.concat(createSizedArray(this._maxLength)),this.o=this.o.concat(createSizedArray(this._maxLength)),this._maxLength*=2},ShapePath.prototype.setXYAt=function(s,e,i,a,o){var c;switch(this._length=Math.max(this._length,a+1),this._length>=this._maxLength&&this.doubleArrayLength(),i){case"v":c=this.v;break;case"i":c=this.i;break;case"o":c=this.o;break;default:c=[];break}(!c[a]||c[a]&&!o)&&(c[a]=pointPool.newElement()),c[a][0]=s,c[a][1]=e},ShapePath.prototype.setTripleAt=function(s,e,i,a,o,c,d,g){this.setXYAt(s,e,"v",d,g),this.setXYAt(i,a,"o",d,g),this.setXYAt(o,c,"i",d,g)},ShapePath.prototype.reverse=function(){var s=new ShapePath;s.setPathData(this.c,this._length);var e=this.v,i=this.o,a=this.i,o=0;this.c&&(s.setTripleAt(e[0][0],e[0][1],a[0][0],a[0][1],i[0][0],i[0][1],0,!1),o=1);var c=this._length-1,d=this._length,g;for(g=o;g<d;g+=1)s.setTripleAt(e[c][0],e[c][1],a[c][0],a[c][1],i[c][0],i[c][1],g,!1),c-=1;return s},ShapePath.prototype.length=function(){return this._length};var shapePool=function(){function s(){return new ShapePath}function e(o){var c=o._length,d;for(d=0;d<c;d+=1)pointPool.release(o.v[d]),pointPool.release(o.i[d]),pointPool.release(o.o[d]),o.v[d]=null,o.i[d]=null,o.o[d]=null;o._length=0,o.c=!1}function i(o){var c=a.newElement(),d,g=o._length===void 0?o.v.length:o._length;for(c.setLength(g),c.c=o.c,d=0;d<g;d+=1)c.setTripleAt(o.v[d][0],o.v[d][1],o.o[d][0],o.o[d][1],o.i[d][0],o.i[d][1],d);return c}var a=poolFactory(4,s,e);return a.clone=i,a}();function ShapeCollection(){this._length=0,this._maxLength=4,this.shapes=createSizedArray(this._maxLength)}ShapeCollection.prototype.addShape=function(s){this._length===this._maxLength&&(this.shapes=this.shapes.concat(createSizedArray(this._maxLength)),this._maxLength*=2),this.shapes[this._length]=s,this._length+=1},ShapeCollection.prototype.releaseShapes=function(){var s;for(s=0;s<this._length;s+=1)shapePool.release(this.shapes[s]);this._length=0};var shapeCollectionPool=function(){var s={newShapeCollection:o,release:c},e=0,i=4,a=createSizedArray(i);function o(){var d;return e?(e-=1,d=a[e]):d=new ShapeCollection,d}function c(d){var g,b=d._length;for(g=0;g<b;g+=1)shapePool.release(d.shapes[g]);d._length=0,e===i&&(a=pooling.double(a),i*=2),a[e]=d,e+=1}return s}(),ShapePropertyFactory=function(){var s=-999999;function e(rt,nt,it){var ot=it.lastIndex,lt,ct,ht,dt,gt,vt,St,Tt,Ct,Rt=this.keyframes;if(rt<Rt[0].t-this.offsetTime)lt=Rt[0].s[0],ht=!0,ot=0;else if(rt>=Rt[Rt.length-1].t-this.offsetTime)lt=Rt[Rt.length-1].s?Rt[Rt.length-1].s[0]:Rt[Rt.length-2].e[0],ht=!0;else{for(var bt=ot,pt=Rt.length-1,yt=!0,ut,ft,xt;yt&&(ut=Rt[bt],ft=Rt[bt+1],!(ft.t-this.offsetTime>rt));)bt<pt-1?bt+=1:yt=!1;if(xt=this.keyframesMetadata[bt]||{},ht=ut.h===1,ot=bt,!ht){if(rt>=ft.t-this.offsetTime)Tt=1;else if(rt<ut.t-this.offsetTime)Tt=0;else{var mt;xt.__fnct?mt=xt.__fnct:(mt=BezierFactory.getBezierEasing(ut.o.x,ut.o.y,ut.i.x,ut.i.y).get,xt.__fnct=mt),Tt=mt((rt-(ut.t-this.offsetTime))/(ft.t-this.offsetTime-(ut.t-this.offsetTime)))}ct=ft.s?ft.s[0]:ut.e[0]}lt=ut.s[0]}for(vt=nt._length,St=lt.i[0].length,it.lastIndex=ot,dt=0;dt<vt;dt+=1)for(gt=0;gt<St;gt+=1)Ct=ht?lt.i[dt][gt]:lt.i[dt][gt]+(ct.i[dt][gt]-lt.i[dt][gt])*Tt,nt.i[dt][gt]=Ct,Ct=ht?lt.o[dt][gt]:lt.o[dt][gt]+(ct.o[dt][gt]-lt.o[dt][gt])*Tt,nt.o[dt][gt]=Ct,Ct=ht?lt.v[dt][gt]:lt.v[dt][gt]+(ct.v[dt][gt]-lt.v[dt][gt])*Tt,nt.v[dt][gt]=Ct}function i(){var rt=this.comp.renderedFrame-this.offsetTime,nt=this.keyframes[0].t-this.offsetTime,it=this.keyframes[this.keyframes.length-1].t-this.offsetTime,ot=this._caching.lastFrame;return ot!==s&&(ot<nt&&rt<nt||ot>it&&rt>it)||(this._caching.lastIndex=ot<rt?this._caching.lastIndex:0,this.interpolateShape(rt,this.pv,this._caching)),this._caching.lastFrame=rt,this.pv}function a(){this.paths=this.localShapeCollection}function o(rt,nt){if(rt._length!==nt._length||rt.c!==nt.c)return!1;var it,ot=rt._length;for(it=0;it<ot;it+=1)if(rt.v[it][0]!==nt.v[it][0]||rt.v[it][1]!==nt.v[it][1]||rt.o[it][0]!==nt.o[it][0]||rt.o[it][1]!==nt.o[it][1]||rt.i[it][0]!==nt.i[it][0]||rt.i[it][1]!==nt.i[it][1])return!1;return!0}function c(rt){o(this.v,rt)||(this.v=shapePool.clone(rt),this.localShapeCollection.releaseShapes(),this.localShapeCollection.addShape(this.v),this._mdf=!0,this.paths=this.localShapeCollection)}function d(){if(this.elem.globalData.frameId!==this.frameId){if(!this.effectsSequence.length){this._mdf=!1;return}if(this.lock){this.setVValue(this.pv);return}this.lock=!0,this._mdf=!1;var rt;this.kf?rt=this.pv:this.data.ks?rt=this.data.ks.k:rt=this.data.pt.k;var nt,it=this.effectsSequence.length;for(nt=0;nt<it;nt+=1)rt=this.effectsSequence[nt](rt);this.setVValue(rt),this.lock=!1,this.frameId=this.elem.globalData.frameId}}function g(rt,nt,it){this.propType="shape",this.comp=rt.comp,this.container=rt,this.elem=rt,this.data=nt,this.k=!1,this.kf=!1,this._mdf=!1;var ot=it===3?nt.pt.k:nt.ks.k;this.v=shapePool.clone(ot),this.pv=shapePool.clone(this.v),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.paths=this.localShapeCollection,this.paths.addShape(this.v),this.reset=a,this.effectsSequence=[]}function b(rt){this.effectsSequence.push(rt),this.container.addDynamicProperty(this)}g.prototype.interpolateShape=e,g.prototype.getValue=d,g.prototype.setVValue=c,g.prototype.addEffect=b;function _(rt,nt,it){this.propType="shape",this.comp=rt.comp,this.elem=rt,this.container=rt,this.offsetTime=rt.data.st,this.keyframes=it===3?nt.pt.k:nt.ks.k,this.keyframesMetadata=[],this.k=!0,this.kf=!0;var ot=this.keyframes[0].s[0].i.length;this.v=shapePool.newElement(),this.v.setPathData(this.keyframes[0].s[0].c,ot),this.pv=shapePool.clone(this.v),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.paths=this.localShapeCollection,this.paths.addShape(this.v),this.lastFrame=s,this.reset=a,this._caching={lastFrame:s,lastIndex:0},this.effectsSequence=[i.bind(this)]}_.prototype.getValue=d,_.prototype.interpolateShape=e,_.prototype.setVValue=c,_.prototype.addEffect=b;var j=function(){var rt=roundCorner;function nt(it,ot){this.v=shapePool.newElement(),this.v.setPathData(!0,4),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.paths=this.localShapeCollection,this.localShapeCollection.addShape(this.v),this.d=ot.d,this.elem=it,this.comp=it.comp,this.frameId=-1,this.initDynamicPropertyContainer(it),this.p=PropertyFactory.getProp(it,ot.p,1,0,this),this.s=PropertyFactory.getProp(it,ot.s,1,0,this),this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertEllToPath())}return nt.prototype={reset:a,getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertEllToPath())},convertEllToPath:function(){var ot=this.p.v[0],lt=this.p.v[1],ct=this.s.v[0]/2,ht=this.s.v[1]/2,dt=this.d!==3,gt=this.v;gt.v[0][0]=ot,gt.v[0][1]=lt-ht,gt.v[1][0]=dt?ot+ct:ot-ct,gt.v[1][1]=lt,gt.v[2][0]=ot,gt.v[2][1]=lt+ht,gt.v[3][0]=dt?ot-ct:ot+ct,gt.v[3][1]=lt,gt.i[0][0]=dt?ot-ct*rt:ot+ct*rt,gt.i[0][1]=lt-ht,gt.i[1][0]=dt?ot+ct:ot-ct,gt.i[1][1]=lt-ht*rt,gt.i[2][0]=dt?ot+ct*rt:ot-ct*rt,gt.i[2][1]=lt+ht,gt.i[3][0]=dt?ot-ct:ot+ct,gt.i[3][1]=lt+ht*rt,gt.o[0][0]=dt?ot+ct*rt:ot-ct*rt,gt.o[0][1]=lt-ht,gt.o[1][0]=dt?ot+ct:ot-ct,gt.o[1][1]=lt+ht*rt,gt.o[2][0]=dt?ot-ct*rt:ot+ct*rt,gt.o[2][1]=lt+ht,gt.o[3][0]=dt?ot-ct:ot+ct,gt.o[3][1]=lt-ht*rt}},extendPrototype([DynamicPropertyContainer],nt),nt}(),$=function(){function rt(nt,it){this.v=shapePool.newElement(),this.v.setPathData(!0,0),this.elem=nt,this.comp=nt.comp,this.data=it,this.frameId=-1,this.d=it.d,this.initDynamicPropertyContainer(nt),it.sy===1?(this.ir=PropertyFactory.getProp(nt,it.ir,0,0,this),this.is=PropertyFactory.getProp(nt,it.is,0,.01,this),this.convertToPath=this.convertStarToPath):this.convertToPath=this.convertPolygonToPath,this.pt=PropertyFactory.getProp(nt,it.pt,0,0,this),this.p=PropertyFactory.getProp(nt,it.p,1,0,this),this.r=PropertyFactory.getProp(nt,it.r,0,degToRads,this),this.or=PropertyFactory.getProp(nt,it.or,0,0,this),this.os=PropertyFactory.getProp(nt,it.os,0,.01,this),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.localShapeCollection.addShape(this.v),this.paths=this.localShapeCollection,this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertToPath())}return rt.prototype={reset:a,getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertToPath())},convertStarToPath:function(){var it=Math.floor(this.pt.v)*2,ot=Math.PI*2/it,lt=!0,ct=this.or.v,ht=this.ir.v,dt=this.os.v,gt=this.is.v,vt=2*Math.PI*ct/(it*2),St=2*Math.PI*ht/(it*2),Tt,Ct,Rt,bt,pt=-Math.PI/2;pt+=this.r.v;var yt=this.data.d===3?-1:1;for(this.v._length=0,Tt=0;Tt<it;Tt+=1){Ct=lt?ct:ht,Rt=lt?dt:gt,bt=lt?vt:St;var ut=Ct*Math.cos(pt),ft=Ct*Math.sin(pt),xt=ut===0&&ft===0?0:ft/Math.sqrt(ut*ut+ft*ft),mt=ut===0&&ft===0?0:-ut/Math.sqrt(ut*ut+ft*ft);ut+=+this.p.v[0],ft+=+this.p.v[1],this.v.setTripleAt(ut,ft,ut-xt*bt*Rt*yt,ft-mt*bt*Rt*yt,ut+xt*bt*Rt*yt,ft+mt*bt*Rt*yt,Tt,!0),lt=!lt,pt+=ot*yt}},convertPolygonToPath:function(){var it=Math.floor(this.pt.v),ot=Math.PI*2/it,lt=this.or.v,ct=this.os.v,ht=2*Math.PI*lt/(it*4),dt,gt=-Math.PI*.5,vt=this.data.d===3?-1:1;for(gt+=this.r.v,this.v._length=0,dt=0;dt<it;dt+=1){var St=lt*Math.cos(gt),Tt=lt*Math.sin(gt),Ct=St===0&&Tt===0?0:Tt/Math.sqrt(St*St+Tt*Tt),Rt=St===0&&Tt===0?0:-St/Math.sqrt(St*St+Tt*Tt);St+=+this.p.v[0],Tt+=+this.p.v[1],this.v.setTripleAt(St,Tt,St-Ct*ht*ct*vt,Tt-Rt*ht*ct*vt,St+Ct*ht*ct*vt,Tt+Rt*ht*ct*vt,dt,!0),gt+=ot*vt}this.paths.length=0,this.paths[0]=this.v}},extendPrototype([DynamicPropertyContainer],rt),rt}(),_e=function(){function rt(nt,it){this.v=shapePool.newElement(),this.v.c=!0,this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.localShapeCollection.addShape(this.v),this.paths=this.localShapeCollection,this.elem=nt,this.comp=nt.comp,this.frameId=-1,this.d=it.d,this.initDynamicPropertyContainer(nt),this.p=PropertyFactory.getProp(nt,it.p,1,0,this),this.s=PropertyFactory.getProp(nt,it.s,1,0,this),this.r=PropertyFactory.getProp(nt,it.r,0,0,this),this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertRectToPath())}return rt.prototype={convertRectToPath:function(){var it=this.p.v[0],ot=this.p.v[1],lt=this.s.v[0]/2,ct=this.s.v[1]/2,ht=bmMin(lt,ct,this.r.v),dt=ht*(1-roundCorner);this.v._length=0,this.d===2||this.d===1?(this.v.setTripleAt(it+lt,ot-ct+ht,it+lt,ot-ct+ht,it+lt,ot-ct+dt,0,!0),this.v.setTripleAt(it+lt,ot+ct-ht,it+lt,ot+ct-dt,it+lt,ot+ct-ht,1,!0),ht!==0?(this.v.setTripleAt(it+lt-ht,ot+ct,it+lt-ht,ot+ct,it+lt-dt,ot+ct,2,!0),this.v.setTripleAt(it-lt+ht,ot+ct,it-lt+dt,ot+ct,it-lt+ht,ot+ct,3,!0),this.v.setTripleAt(it-lt,ot+ct-ht,it-lt,ot+ct-ht,it-lt,ot+ct-dt,4,!0),this.v.setTripleAt(it-lt,ot-ct+ht,it-lt,ot-ct+dt,it-lt,ot-ct+ht,5,!0),this.v.setTripleAt(it-lt+ht,ot-ct,it-lt+ht,ot-ct,it-lt+dt,ot-ct,6,!0),this.v.setTripleAt(it+lt-ht,ot-ct,it+lt-dt,ot-ct,it+lt-ht,ot-ct,7,!0)):(this.v.setTripleAt(it-lt,ot+ct,it-lt+dt,ot+ct,it-lt,ot+ct,2),this.v.setTripleAt(it-lt,ot-ct,it-lt,ot-ct+dt,it-lt,ot-ct,3))):(this.v.setTripleAt(it+lt,ot-ct+ht,it+lt,ot-ct+dt,it+lt,ot-ct+ht,0,!0),ht!==0?(this.v.setTripleAt(it+lt-ht,ot-ct,it+lt-ht,ot-ct,it+lt-dt,ot-ct,1,!0),this.v.setTripleAt(it-lt+ht,ot-ct,it-lt+dt,ot-ct,it-lt+ht,ot-ct,2,!0),this.v.setTripleAt(it-lt,ot-ct+ht,it-lt,ot-ct+ht,it-lt,ot-ct+dt,3,!0),this.v.setTripleAt(it-lt,ot+ct-ht,it-lt,ot+ct-dt,it-lt,ot+ct-ht,4,!0),this.v.setTripleAt(it-lt+ht,ot+ct,it-lt+ht,ot+ct,it-lt+dt,ot+ct,5,!0),this.v.setTripleAt(it+lt-ht,ot+ct,it+lt-dt,ot+ct,it+lt-ht,ot+ct,6,!0),this.v.setTripleAt(it+lt,ot+ct-ht,it+lt,ot+ct-ht,it+lt,ot+ct-dt,7,!0)):(this.v.setTripleAt(it-lt,ot-ct,it-lt+dt,ot-ct,it-lt,ot-ct,1,!0),this.v.setTripleAt(it-lt,ot+ct,it-lt,ot+ct-dt,it-lt,ot+ct,2,!0),this.v.setTripleAt(it+lt,ot+ct,it+lt-dt,ot+ct,it+lt,ot+ct,3,!0)))},getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertRectToPath())},reset:a},extendPrototype([DynamicPropertyContainer],rt),rt}();function tt(rt,nt,it){var ot;if(it===3||it===4){var lt=it===3?nt.pt:nt.ks,ct=lt.k;ct.length?ot=new _(rt,nt,it):ot=new g(rt,nt,it)}else it===5?ot=new _e(rt,nt):it===6?ot=new j(rt,nt):it===7&&(ot=new $(rt,nt));return ot.k&&rt.addDynamicProperty(ot),ot}function et(){return g}function st(){return _}var at={};return at.getShapeProp=tt,at.getConstructorFunction=et,at.getKeyframedConstructorFunction=st,at}();/*!
 Transformation Matrix v2.0
 (c) Epistemex 2014-2015
 www.epistemex.com
 By Ken Fyrstenberg
 Contributions by leeoniya.
 License: MIT, header required.
 */var Matrix=function(){var s=Math.cos,e=Math.sin,i=Math.tan,a=Math.round;function o(){return this.props[0]=1,this.props[1]=0,this.props[2]=0,this.props[3]=0,this.props[4]=0,this.props[5]=1,this.props[6]=0,this.props[7]=0,this.props[8]=0,this.props[9]=0,this.props[10]=1,this.props[11]=0,this.props[12]=0,this.props[13]=0,this.props[14]=0,this.props[15]=1,this}function c(ut){if(ut===0)return this;var ft=s(ut),xt=e(ut);return this._t(ft,-xt,0,0,xt,ft,0,0,0,0,1,0,0,0,0,1)}function d(ut){if(ut===0)return this;var ft=s(ut),xt=e(ut);return this._t(1,0,0,0,0,ft,-xt,0,0,xt,ft,0,0,0,0,1)}function g(ut){if(ut===0)return this;var ft=s(ut),xt=e(ut);return this._t(ft,0,xt,0,0,1,0,0,-xt,0,ft,0,0,0,0,1)}function b(ut){if(ut===0)return this;var ft=s(ut),xt=e(ut);return this._t(ft,-xt,0,0,xt,ft,0,0,0,0,1,0,0,0,0,1)}function _(ut,ft){return this._t(1,ft,ut,1,0,0)}function j(ut,ft){return this.shear(i(ut),i(ft))}function $(ut,ft){var xt=s(ft),mt=e(ft);return this._t(xt,mt,0,0,-mt,xt,0,0,0,0,1,0,0,0,0,1)._t(1,0,0,0,i(ut),1,0,0,0,0,1,0,0,0,0,1)._t(xt,-mt,0,0,mt,xt,0,0,0,0,1,0,0,0,0,1)}function _e(ut,ft,xt){return!xt&&xt!==0&&(xt=1),ut===1&&ft===1&&xt===1?this:this._t(ut,0,0,0,0,ft,0,0,0,0,xt,0,0,0,0,1)}function tt(ut,ft,xt,mt,Et,At,Pt,wt,It,Mt,Bt,Gt,Ft,Ut,Xt,kt){return this.props[0]=ut,this.props[1]=ft,this.props[2]=xt,this.props[3]=mt,this.props[4]=Et,this.props[5]=At,this.props[6]=Pt,this.props[7]=wt,this.props[8]=It,this.props[9]=Mt,this.props[10]=Bt,this.props[11]=Gt,this.props[12]=Ft,this.props[13]=Ut,this.props[14]=Xt,this.props[15]=kt,this}function et(ut,ft,xt){return xt=xt||0,ut!==0||ft!==0||xt!==0?this._t(1,0,0,0,0,1,0,0,0,0,1,0,ut,ft,xt,1):this}function st(ut,ft,xt,mt,Et,At,Pt,wt,It,Mt,Bt,Gt,Ft,Ut,Xt,kt){var Lt=this.props;if(ut===1&&ft===0&&xt===0&&mt===0&&Et===0&&At===1&&Pt===0&&wt===0&&It===0&&Mt===0&&Bt===1&&Gt===0)return Lt[12]=Lt[12]*ut+Lt[15]*Ft,Lt[13]=Lt[13]*At+Lt[15]*Ut,Lt[14]=Lt[14]*Bt+Lt[15]*Xt,Lt[15]*=kt,this._identityCalculated=!1,this;var Wt=Lt[0],Nt=Lt[1],Kt=Lt[2],Qt=Lt[3],tr=Lt[4],zt=Lt[5],Zt=Lt[6],_t=Lt[7],$t=Lt[8],Ht=Lt[9],Vt=Lt[10],jt=Lt[11],er=Lt[12],qt=Lt[13],sr=Lt[14],nr=Lt[15];return Lt[0]=Wt*ut+Nt*Et+Kt*It+Qt*Ft,Lt[1]=Wt*ft+Nt*At+Kt*Mt+Qt*Ut,Lt[2]=Wt*xt+Nt*Pt+Kt*Bt+Qt*Xt,Lt[3]=Wt*mt+Nt*wt+Kt*Gt+Qt*kt,Lt[4]=tr*ut+zt*Et+Zt*It+_t*Ft,Lt[5]=tr*ft+zt*At+Zt*Mt+_t*Ut,Lt[6]=tr*xt+zt*Pt+Zt*Bt+_t*Xt,Lt[7]=tr*mt+zt*wt+Zt*Gt+_t*kt,Lt[8]=$t*ut+Ht*Et+Vt*It+jt*Ft,Lt[9]=$t*ft+Ht*At+Vt*Mt+jt*Ut,Lt[10]=$t*xt+Ht*Pt+Vt*Bt+jt*Xt,Lt[11]=$t*mt+Ht*wt+Vt*Gt+jt*kt,Lt[12]=er*ut+qt*Et+sr*It+nr*Ft,Lt[13]=er*ft+qt*At+sr*Mt+nr*Ut,Lt[14]=er*xt+qt*Pt+sr*Bt+nr*Xt,Lt[15]=er*mt+qt*wt+sr*Gt+nr*kt,this._identityCalculated=!1,this}function at(ut){var ft=ut.props;return this.transform(ft[0],ft[1],ft[2],ft[3],ft[4],ft[5],ft[6],ft[7],ft[8],ft[9],ft[10],ft[11],ft[12],ft[13],ft[14],ft[15])}function rt(){return this._identityCalculated||(this._identity=!(this.props[0]!==1||this.props[1]!==0||this.props[2]!==0||this.props[3]!==0||this.props[4]!==0||this.props[5]!==1||this.props[6]!==0||this.props[7]!==0||this.props[8]!==0||this.props[9]!==0||this.props[10]!==1||this.props[11]!==0||this.props[12]!==0||this.props[13]!==0||this.props[14]!==0||this.props[15]!==1),this._identityCalculated=!0),this._identity}function nt(ut){for(var ft=0;ft<16;){if(ut.props[ft]!==this.props[ft])return!1;ft+=1}return!0}function it(ut){var ft;for(ft=0;ft<16;ft+=1)ut.props[ft]=this.props[ft];return ut}function ot(ut){var ft;for(ft=0;ft<16;ft+=1)this.props[ft]=ut[ft]}function lt(ut,ft,xt){return{x:ut*this.props[0]+ft*this.props[4]+xt*this.props[8]+this.props[12],y:ut*this.props[1]+ft*this.props[5]+xt*this.props[9]+this.props[13],z:ut*this.props[2]+ft*this.props[6]+xt*this.props[10]+this.props[14]}}function ct(ut,ft,xt){return ut*this.props[0]+ft*this.props[4]+xt*this.props[8]+this.props[12]}function ht(ut,ft,xt){return ut*this.props[1]+ft*this.props[5]+xt*this.props[9]+this.props[13]}function dt(ut,ft,xt){return ut*this.props[2]+ft*this.props[6]+xt*this.props[10]+this.props[14]}function gt(){var ut=this.props[0]*this.props[5]-this.props[1]*this.props[4],ft=this.props[5]/ut,xt=-this.props[1]/ut,mt=-this.props[4]/ut,Et=this.props[0]/ut,At=(this.props[4]*this.props[13]-this.props[5]*this.props[12])/ut,Pt=-(this.props[0]*this.props[13]-this.props[1]*this.props[12])/ut,wt=new Matrix;return wt.props[0]=ft,wt.props[1]=xt,wt.props[4]=mt,wt.props[5]=Et,wt.props[12]=At,wt.props[13]=Pt,wt}function vt(ut){var ft=this.getInverseMatrix();return ft.applyToPointArray(ut[0],ut[1],ut[2]||0)}function St(ut){var ft,xt=ut.length,mt=[];for(ft=0;ft<xt;ft+=1)mt[ft]=vt(ut[ft]);return mt}function Tt(ut,ft,xt){var mt=createTypedArray("float32",6);if(this.isIdentity())mt[0]=ut[0],mt[1]=ut[1],mt[2]=ft[0],mt[3]=ft[1],mt[4]=xt[0],mt[5]=xt[1];else{var Et=this.props[0],At=this.props[1],Pt=this.props[4],wt=this.props[5],It=this.props[12],Mt=this.props[13];mt[0]=ut[0]*Et+ut[1]*Pt+It,mt[1]=ut[0]*At+ut[1]*wt+Mt,mt[2]=ft[0]*Et+ft[1]*Pt+It,mt[3]=ft[0]*At+ft[1]*wt+Mt,mt[4]=xt[0]*Et+xt[1]*Pt+It,mt[5]=xt[0]*At+xt[1]*wt+Mt}return mt}function Ct(ut,ft,xt){var mt;return this.isIdentity()?mt=[ut,ft,xt]:mt=[ut*this.props[0]+ft*this.props[4]+xt*this.props[8]+this.props[12],ut*this.props[1]+ft*this.props[5]+xt*this.props[9]+this.props[13],ut*this.props[2]+ft*this.props[6]+xt*this.props[10]+this.props[14]],mt}function Rt(ut,ft){if(this.isIdentity())return ut+","+ft;var xt=this.props;return Math.round((ut*xt[0]+ft*xt[4]+xt[12])*100)/100+","+Math.round((ut*xt[1]+ft*xt[5]+xt[13])*100)/100}function bt(){for(var ut=0,ft=this.props,xt="matrix3d(",mt=1e4;ut<16;)xt+=a(ft[ut]*mt)/mt,xt+=ut===15?")":",",ut+=1;return xt}function pt(ut){var ft=1e4;return ut<1e-6&&ut>0||ut>-1e-6&&ut<0?a(ut*ft)/ft:ut}function yt(){var ut=this.props,ft=pt(ut[0]),xt=pt(ut[1]),mt=pt(ut[4]),Et=pt(ut[5]),At=pt(ut[12]),Pt=pt(ut[13]);return"matrix("+ft+","+xt+","+mt+","+Et+","+At+","+Pt+")"}return function(){this.reset=o,this.rotate=c,this.rotateX=d,this.rotateY=g,this.rotateZ=b,this.skew=j,this.skewFromAxis=$,this.shear=_,this.scale=_e,this.setTransform=tt,this.translate=et,this.transform=st,this.multiply=at,this.applyToPoint=lt,this.applyToX=ct,this.applyToY=ht,this.applyToZ=dt,this.applyToPointArray=Ct,this.applyToTriplePoints=Tt,this.applyToPointStringified=Rt,this.toCSS=bt,this.to2dCSS=yt,this.clone=it,this.cloneFromProps=ot,this.equals=nt,this.inversePoints=St,this.inversePoint=vt,this.getInverseMatrix=gt,this._t=this.transform,this.isIdentity=rt,this._identity=!0,this._identityCalculated=!1,this.props=createTypedArray("float32",16),this.reset()}}();function _typeof$3(s){"@babel/helpers - typeof";return _typeof$3=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof$3(s)}var lottie={};function setLocation(s){setLocationHref(s)}function searchAnimations(){animationManager.searchAnimations()}function setSubframeRendering(s){setSubframeEnabled(s)}function setPrefix(s){setIdPrefix(s)}function loadAnimation(s){return animationManager.loadAnimation(s)}function setQuality(s){if(typeof s=="string")switch(s){case"high":setDefaultCurveSegments(200);break;default:case"medium":setDefaultCurveSegments(50);break;case"low":setDefaultCurveSegments(10);break}else!isNaN(s)&&s>1&&setDefaultCurveSegments(s)}function inBrowser(){return typeof navigator<"u"}function installPlugin(s,e){s==="expressions"&&setExpressionsPlugin(e)}function getFactory(s){switch(s){case"propertyFactory":return PropertyFactory;case"shapePropertyFactory":return ShapePropertyFactory;case"matrix":return Matrix;default:return null}}lottie.play=animationManager.play,lottie.pause=animationManager.pause,lottie.setLocationHref=setLocation,lottie.togglePause=animationManager.togglePause,lottie.setSpeed=animationManager.setSpeed,lottie.setDirection=animationManager.setDirection,lottie.stop=animationManager.stop,lottie.searchAnimations=searchAnimations,lottie.registerAnimation=animationManager.registerAnimation,lottie.loadAnimation=loadAnimation,lottie.setSubframeRendering=setSubframeRendering,lottie.resize=animationManager.resize,lottie.goToAndStop=animationManager.goToAndStop,lottie.destroy=animationManager.destroy,lottie.setQuality=setQuality,lottie.inBrowser=inBrowser,lottie.installPlugin=installPlugin,lottie.freeze=animationManager.freeze,lottie.unfreeze=animationManager.unfreeze,lottie.setVolume=animationManager.setVolume,lottie.mute=animationManager.mute,lottie.unmute=animationManager.unmute,lottie.getRegisteredAnimations=animationManager.getRegisteredAnimations,lottie.useWebWorker=setWebWorker,lottie.setIDPrefix=setPrefix,lottie.__getFactory=getFactory,lottie.version="5.13.0";function checkReady(){document.readyState==="complete"&&(clearInterval(readyStateCheckInterval),searchAnimations())}function getQueryVariable(s){for(var e=queryString.split("&"),i=0;i<e.length;i+=1){var a=e[i].split("=");if(decodeURIComponent(a[0])==s)return decodeURIComponent(a[1])}return null}var queryString="";{var scripts=document.getElementsByTagName("script"),index=scripts.length-1,myScript=scripts[index]||{src:""};queryString=myScript.src?myScript.src.replace(/^[^\?]+\??/,""):"",getQueryVariable("renderer")}var readyStateCheckInterval=setInterval(checkReady,100);try{_typeof$3(exports)!=="object"&&(window.bodymovin=lottie)}catch(s){}var ShapeModifiers=function(){var s={},e={};s.registerModifier=i,s.getModifier=a;function i(o,c){e[o]||(e[o]=c)}function a(o,c,d){return new e[o](c,d)}return s}();function ShapeModifier(){}ShapeModifier.prototype.initModifierProperties=function(){},ShapeModifier.prototype.addShapeToModifier=function(){},ShapeModifier.prototype.addShape=function(s){if(!this.closed){s.sh.container.addDynamicProperty(s.sh);var e={shape:s.sh,data:s,localShapeCollection:shapeCollectionPool.newShapeCollection()};this.shapes.push(e),this.addShapeToModifier(e),this._isAnimated&&s.setAsAnimated()}},ShapeModifier.prototype.init=function(s,e){this.shapes=[],this.elem=s,this.initDynamicPropertyContainer(s),this.initModifierProperties(s,e),this.frameId=initialDefaultFrame,this.closed=!1,this.k=!1,this.dynamicProperties.length?this.k=!0:this.getValue(!0)},ShapeModifier.prototype.processKeys=function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties())},extendPrototype([DynamicPropertyContainer],ShapeModifier);function TrimModifier(){}extendPrototype([ShapeModifier],TrimModifier),TrimModifier.prototype.initModifierProperties=function(s,e){this.s=PropertyFactory.getProp(s,e.s,0,.01,this),this.e=PropertyFactory.getProp(s,e.e,0,.01,this),this.o=PropertyFactory.getProp(s,e.o,0,0,this),this.sValue=0,this.eValue=0,this.getValue=this.processKeys,this.m=e.m,this._isAnimated=!!this.s.effectsSequence.length||!!this.e.effectsSequence.length||!!this.o.effectsSequence.length},TrimModifier.prototype.addShapeToModifier=function(s){s.pathsData=[]},TrimModifier.prototype.calculateShapeEdges=function(s,e,i,a,o){var c=[];e<=1?c.push({s,e}):s>=1?c.push({s:s-1,e:e-1}):(c.push({s,e:1}),c.push({s:0,e:e-1}));var d=[],g,b=c.length,_;for(g=0;g<b;g+=1)if(_=c[g],!(_.e*o<a||_.s*o>a+i)){var j,$;_.s*o<=a?j=0:j=(_.s*o-a)/i,_.e*o>=a+i?$=1:$=(_.e*o-a)/i,d.push([j,$])}return d.length||d.push([0,0]),d},TrimModifier.prototype.releasePathsData=function(s){var e,i=s.length;for(e=0;e<i;e+=1)segmentsLengthPool.release(s[e]);return s.length=0,s},TrimModifier.prototype.processShapes=function(s){var e,i;if(this._mdf||s){var a=this.o.v%360/360;if(a<0&&(a+=1),this.s.v>1?e=1+a:this.s.v<0?e=0+a:e=this.s.v+a,this.e.v>1?i=1+a:this.e.v<0?i=0+a:i=this.e.v+a,e>i){var o=e;e=i,i=o}e=Math.round(e*1e4)*1e-4,i=Math.round(i*1e4)*1e-4,this.sValue=e,this.eValue=i}else e=this.sValue,i=this.eValue;var c,d,g=this.shapes.length,b,_,j,$,_e,tt=0;if(i===e)for(d=0;d<g;d+=1)this.shapes[d].localShapeCollection.releaseShapes(),this.shapes[d].shape._mdf=!0,this.shapes[d].shape.paths=this.shapes[d].localShapeCollection,this._mdf&&(this.shapes[d].pathsData.length=0);else if(i===1&&e===0||i===0&&e===1){if(this._mdf)for(d=0;d<g;d+=1)this.shapes[d].pathsData.length=0,this.shapes[d].shape._mdf=!0}else{var et=[],st,at;for(d=0;d<g;d+=1)if(st=this.shapes[d],!st.shape._mdf&&!this._mdf&&!s&&this.m!==2)st.shape.paths=st.localShapeCollection;else{if(c=st.shape.paths,_=c._length,_e=0,!st.shape._mdf&&st.pathsData.length)_e=st.totalShapeLength;else{for(j=this.releasePathsData(st.pathsData),b=0;b<_;b+=1)$=bez.getSegmentsLength(c.shapes[b]),j.push($),_e+=$.totalLength;st.totalShapeLength=_e,st.pathsData=j}tt+=_e,st.shape._mdf=!0}var rt=e,nt=i,it=0,ot;for(d=g-1;d>=0;d-=1)if(st=this.shapes[d],st.shape._mdf){for(at=st.localShapeCollection,at.releaseShapes(),this.m===2&&g>1?(ot=this.calculateShapeEdges(e,i,st.totalShapeLength,it,tt),it+=st.totalShapeLength):ot=[[rt,nt]],_=ot.length,b=0;b<_;b+=1){rt=ot[b][0],nt=ot[b][1],et.length=0,nt<=1?et.push({s:st.totalShapeLength*rt,e:st.totalShapeLength*nt}):rt>=1?et.push({s:st.totalShapeLength*(rt-1),e:st.totalShapeLength*(nt-1)}):(et.push({s:st.totalShapeLength*rt,e:st.totalShapeLength}),et.push({s:0,e:st.totalShapeLength*(nt-1)}));var lt=this.addShapes(st,et[0]);if(et[0].s!==et[0].e){if(et.length>1){var ct=st.shape.paths.shapes[st.shape.paths._length-1];if(ct.c){var ht=lt.pop();this.addPaths(lt,at),lt=this.addShapes(st,et[1],ht)}else this.addPaths(lt,at),lt=this.addShapes(st,et[1])}this.addPaths(lt,at)}}st.shape.paths=at}}},TrimModifier.prototype.addPaths=function(s,e){var i,a=s.length;for(i=0;i<a;i+=1)e.addShape(s[i])},TrimModifier.prototype.addSegment=function(s,e,i,a,o,c,d){o.setXYAt(e[0],e[1],"o",c),o.setXYAt(i[0],i[1],"i",c+1),d&&o.setXYAt(s[0],s[1],"v",c),o.setXYAt(a[0],a[1],"v",c+1)},TrimModifier.prototype.addSegmentFromArray=function(s,e,i,a){e.setXYAt(s[1],s[5],"o",i),e.setXYAt(s[2],s[6],"i",i+1),a&&e.setXYAt(s[0],s[4],"v",i),e.setXYAt(s[3],s[7],"v",i+1)},TrimModifier.prototype.addShapes=function(s,e,i){var a=s.pathsData,o=s.shape.paths.shapes,c,d=s.shape.paths._length,g,b,_=0,j,$,_e,tt,et=[],st,at=!0;for(i?($=i._length,st=i._length):(i=shapePool.newElement(),$=0,st=0),et.push(i),c=0;c<d;c+=1){for(_e=a[c].lengths,i.c=o[c].c,b=o[c].c?_e.length:_e.length+1,g=1;g<b;g+=1)if(j=_e[g-1],_+j.addedLength<e.s)_+=j.addedLength,i.c=!1;else if(_>e.e){i.c=!1;break}else e.s<=_&&e.e>=_+j.addedLength?(this.addSegment(o[c].v[g-1],o[c].o[g-1],o[c].i[g],o[c].v[g],i,$,at),at=!1):(tt=bez.getNewSegment(o[c].v[g-1],o[c].v[g],o[c].o[g-1],o[c].i[g],(e.s-_)/j.addedLength,(e.e-_)/j.addedLength,_e[g-1]),this.addSegmentFromArray(tt,i,$,at),at=!1,i.c=!1),_+=j.addedLength,$+=1;if(o[c].c&&_e.length){if(j=_e[g-1],_<=e.e){var rt=_e[g-1].addedLength;e.s<=_&&e.e>=_+rt?(this.addSegment(o[c].v[g-1],o[c].o[g-1],o[c].i[0],o[c].v[0],i,$,at),at=!1):(tt=bez.getNewSegment(o[c].v[g-1],o[c].v[0],o[c].o[g-1],o[c].i[0],(e.s-_)/rt,(e.e-_)/rt,_e[g-1]),this.addSegmentFromArray(tt,i,$,at),at=!1,i.c=!1)}else i.c=!1;_+=j.addedLength,$+=1}if(i._length&&(i.setXYAt(i.v[st][0],i.v[st][1],"i",st),i.setXYAt(i.v[i._length-1][0],i.v[i._length-1][1],"o",i._length-1)),_>e.e)break;c<d-1&&(i=shapePool.newElement(),at=!0,et.push(i),$=0)}return et};function PuckerAndBloatModifier(){}extendPrototype([ShapeModifier],PuckerAndBloatModifier),PuckerAndBloatModifier.prototype.initModifierProperties=function(s,e){this.getValue=this.processKeys,this.amount=PropertyFactory.getProp(s,e.a,0,null,this),this._isAnimated=!!this.amount.effectsSequence.length},PuckerAndBloatModifier.prototype.processPath=function(s,e){var i=e/100,a=[0,0],o=s._length,c=0;for(c=0;c<o;c+=1)a[0]+=s.v[c][0],a[1]+=s.v[c][1];a[0]/=o,a[1]/=o;var d=shapePool.newElement();d.c=s.c;var g,b,_,j,$,_e;for(c=0;c<o;c+=1)g=s.v[c][0]+(a[0]-s.v[c][0])*i,b=s.v[c][1]+(a[1]-s.v[c][1])*i,_=s.o[c][0]+(a[0]-s.o[c][0])*-i,j=s.o[c][1]+(a[1]-s.o[c][1])*-i,$=s.i[c][0]+(a[0]-s.i[c][0])*-i,_e=s.i[c][1]+(a[1]-s.i[c][1])*-i,d.setTripleAt(g,b,_,j,$,_e,c);return d},PuckerAndBloatModifier.prototype.processShapes=function(s){var e,i,a=this.shapes.length,o,c,d=this.amount.v;if(d!==0){var g,b;for(i=0;i<a;i+=1){if(g=this.shapes[i],b=g.localShapeCollection,!(!g.shape._mdf&&!this._mdf&&!s))for(b.releaseShapes(),g.shape._mdf=!0,e=g.shape.paths.shapes,c=g.shape.paths._length,o=0;o<c;o+=1)b.addShape(this.processPath(e[o],d));g.shape.paths=g.localShapeCollection}}this.dynamicProperties.length||(this._mdf=!1)};var TransformPropertyFactory=function(){var s=[0,0];function e(b){var _=this._mdf;this.iterateDynamicProperties(),this._mdf=this._mdf||_,this.a&&b.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.s&&b.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.sk&&b.skewFromAxis(-this.sk.v,this.sa.v),this.r?b.rotate(-this.r.v):b.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.data.p.s?this.data.p.z?b.translate(this.px.v,this.py.v,-this.pz.v):b.translate(this.px.v,this.py.v,0):b.translate(this.p.v[0],this.p.v[1],-this.p.v[2])}function i(b){if(this.elem.globalData.frameId!==this.frameId){if(this._isDirty&&(this.precalculateMatrix(),this._isDirty=!1),this.iterateDynamicProperties(),this._mdf||b){var _;if(this.v.cloneFromProps(this.pre.props),this.appliedTransformations<1&&this.v.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.appliedTransformations<2&&this.v.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.sk&&this.appliedTransformations<3&&this.v.skewFromAxis(-this.sk.v,this.sa.v),this.r&&this.appliedTransformations<4?this.v.rotate(-this.r.v):!this.r&&this.appliedTransformations<4&&this.v.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.autoOriented){var j,$;if(_=this.elem.globalData.frameRate,this.p&&this.p.keyframes&&this.p.getValueAtTime)this.p._caching.lastFrame+this.p.offsetTime<=this.p.keyframes[0].t?(j=this.p.getValueAtTime((this.p.keyframes[0].t+.01)/_,0),$=this.p.getValueAtTime(this.p.keyframes[0].t/_,0)):this.p._caching.lastFrame+this.p.offsetTime>=this.p.keyframes[this.p.keyframes.length-1].t?(j=this.p.getValueAtTime(this.p.keyframes[this.p.keyframes.length-1].t/_,0),$=this.p.getValueAtTime((this.p.keyframes[this.p.keyframes.length-1].t-.05)/_,0)):(j=this.p.pv,$=this.p.getValueAtTime((this.p._caching.lastFrame+this.p.offsetTime-.01)/_,this.p.offsetTime));else if(this.px&&this.px.keyframes&&this.py.keyframes&&this.px.getValueAtTime&&this.py.getValueAtTime){j=[],$=[];var _e=this.px,tt=this.py;_e._caching.lastFrame+_e.offsetTime<=_e.keyframes[0].t?(j[0]=_e.getValueAtTime((_e.keyframes[0].t+.01)/_,0),j[1]=tt.getValueAtTime((tt.keyframes[0].t+.01)/_,0),$[0]=_e.getValueAtTime(_e.keyframes[0].t/_,0),$[1]=tt.getValueAtTime(tt.keyframes[0].t/_,0)):_e._caching.lastFrame+_e.offsetTime>=_e.keyframes[_e.keyframes.length-1].t?(j[0]=_e.getValueAtTime(_e.keyframes[_e.keyframes.length-1].t/_,0),j[1]=tt.getValueAtTime(tt.keyframes[tt.keyframes.length-1].t/_,0),$[0]=_e.getValueAtTime((_e.keyframes[_e.keyframes.length-1].t-.01)/_,0),$[1]=tt.getValueAtTime((tt.keyframes[tt.keyframes.length-1].t-.01)/_,0)):(j=[_e.pv,tt.pv],$[0]=_e.getValueAtTime((_e._caching.lastFrame+_e.offsetTime-.01)/_,_e.offsetTime),$[1]=tt.getValueAtTime((tt._caching.lastFrame+tt.offsetTime-.01)/_,tt.offsetTime))}else $=s,j=$;this.v.rotate(-Math.atan2(j[1]-$[1],j[0]-$[0]))}this.data.p&&this.data.p.s?this.data.p.z?this.v.translate(this.px.v,this.py.v,-this.pz.v):this.v.translate(this.px.v,this.py.v,0):this.v.translate(this.p.v[0],this.p.v[1],-this.p.v[2])}this.frameId=this.elem.globalData.frameId}}function a(){if(this.appliedTransformations=0,this.pre.reset(),!this.a.effectsSequence.length)this.pre.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.appliedTransformations=1;else return;if(!this.s.effectsSequence.length)this.pre.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.appliedTransformations=2;else return;if(this.sk)if(!this.sk.effectsSequence.length&&!this.sa.effectsSequence.length)this.pre.skewFromAxis(-this.sk.v,this.sa.v),this.appliedTransformations=3;else return;this.r?this.r.effectsSequence.length||(this.pre.rotate(-this.r.v),this.appliedTransformations=4):!this.rz.effectsSequence.length&&!this.ry.effectsSequence.length&&!this.rx.effectsSequence.length&&!this.or.effectsSequence.length&&(this.pre.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.appliedTransformations=4)}function o(){}function c(b){this._addDynamicProperty(b),this.elem.addDynamicProperty(b),this._isDirty=!0}function d(b,_,j){if(this.elem=b,this.frameId=-1,this.propType="transform",this.data=_,this.v=new Matrix,this.pre=new Matrix,this.appliedTransformations=0,this.initDynamicPropertyContainer(j||b),_.p&&_.p.s?(this.px=PropertyFactory.getProp(b,_.p.x,0,0,this),this.py=PropertyFactory.getProp(b,_.p.y,0,0,this),_.p.z&&(this.pz=PropertyFactory.getProp(b,_.p.z,0,0,this))):this.p=PropertyFactory.getProp(b,_.p||{k:[0,0,0]},1,0,this),_.rx){if(this.rx=PropertyFactory.getProp(b,_.rx,0,degToRads,this),this.ry=PropertyFactory.getProp(b,_.ry,0,degToRads,this),this.rz=PropertyFactory.getProp(b,_.rz,0,degToRads,this),_.or.k[0].ti){var $,_e=_.or.k.length;for($=0;$<_e;$+=1)_.or.k[$].to=null,_.or.k[$].ti=null}this.or=PropertyFactory.getProp(b,_.or,1,degToRads,this),this.or.sh=!0}else this.r=PropertyFactory.getProp(b,_.r||{k:0},0,degToRads,this);_.sk&&(this.sk=PropertyFactory.getProp(b,_.sk,0,degToRads,this),this.sa=PropertyFactory.getProp(b,_.sa,0,degToRads,this)),this.a=PropertyFactory.getProp(b,_.a||{k:[0,0,0]},1,0,this),this.s=PropertyFactory.getProp(b,_.s||{k:[100,100,100]},1,.01,this),_.o?this.o=PropertyFactory.getProp(b,_.o,0,.01,b):this.o={_mdf:!1,v:1},this._isDirty=!0,this.dynamicProperties.length||this.getValue(!0)}d.prototype={applyToMatrix:e,getValue:i,precalculateMatrix:a,autoOrient:o},extendPrototype([DynamicPropertyContainer],d),d.prototype.addDynamicProperty=c,d.prototype._addDynamicProperty=DynamicPropertyContainer.prototype.addDynamicProperty;function g(b,_,j){return new d(b,_,j)}return{getTransformProperty:g}}();function RepeaterModifier(){}extendPrototype([ShapeModifier],RepeaterModifier),RepeaterModifier.prototype.initModifierProperties=function(s,e){this.getValue=this.processKeys,this.c=PropertyFactory.getProp(s,e.c,0,null,this),this.o=PropertyFactory.getProp(s,e.o,0,null,this),this.tr=TransformPropertyFactory.getTransformProperty(s,e.tr,this),this.so=PropertyFactory.getProp(s,e.tr.so,0,.01,this),this.eo=PropertyFactory.getProp(s,e.tr.eo,0,.01,this),this.data=e,this.dynamicProperties.length||this.getValue(!0),this._isAnimated=!!this.dynamicProperties.length,this.pMatrix=new Matrix,this.rMatrix=new Matrix,this.sMatrix=new Matrix,this.tMatrix=new Matrix,this.matrix=new Matrix},RepeaterModifier.prototype.applyTransforms=function(s,e,i,a,o,c){var d=c?-1:1,g=a.s.v[0]+(1-a.s.v[0])*(1-o),b=a.s.v[1]+(1-a.s.v[1])*(1-o);s.translate(a.p.v[0]*d*o,a.p.v[1]*d*o,a.p.v[2]),e.translate(-a.a.v[0],-a.a.v[1],a.a.v[2]),e.rotate(-a.r.v*d*o),e.translate(a.a.v[0],a.a.v[1],a.a.v[2]),i.translate(-a.a.v[0],-a.a.v[1],a.a.v[2]),i.scale(c?1/g:g,c?1/b:b),i.translate(a.a.v[0],a.a.v[1],a.a.v[2])},RepeaterModifier.prototype.init=function(s,e,i,a){for(this.elem=s,this.arr=e,this.pos=i,this.elemsData=a,this._currentCopies=0,this._elements=[],this._groups=[],this.frameId=-1,this.initDynamicPropertyContainer(s),this.initModifierProperties(s,e[i]);i>0;)i-=1,this._elements.unshift(e[i]);this.dynamicProperties.length?this.k=!0:this.getValue(!0)},RepeaterModifier.prototype.resetElements=function(s){var e,i=s.length;for(e=0;e<i;e+=1)s[e]._processed=!1,s[e].ty==="gr"&&this.resetElements(s[e].it)},RepeaterModifier.prototype.cloneElements=function(s){var e=JSON.parse(JSON.stringify(s));return this.resetElements(e),e},RepeaterModifier.prototype.changeGroupRender=function(s,e){var i,a=s.length;for(i=0;i<a;i+=1)s[i]._render=e,s[i].ty==="gr"&&this.changeGroupRender(s[i].it,e)},RepeaterModifier.prototype.processShapes=function(s){var e,i,a,o,c,d=!1;if(this._mdf||s){var g=Math.ceil(this.c.v);if(this._groups.length<g){for(;this._groups.length<g;){var b={it:this.cloneElements(this._elements),ty:"gr"};b.it.push({a:{a:0,ix:1,k:[0,0]},nm:"Transform",o:{a:0,ix:7,k:100},p:{a:0,ix:2,k:[0,0]},r:{a:1,ix:6,k:[{s:0,e:0,t:0},{s:0,e:0,t:1}]},s:{a:0,ix:3,k:[100,100]},sa:{a:0,ix:5,k:0},sk:{a:0,ix:4,k:0},ty:"tr"}),this.arr.splice(0,0,b),this._groups.splice(0,0,b),this._currentCopies+=1}this.elem.reloadShapes(),d=!0}c=0;var _;for(a=0;a<=this._groups.length-1;a+=1){if(_=c<g,this._groups[a]._render=_,this.changeGroupRender(this._groups[a].it,_),!_){var j=this.elemsData[a].it,$=j[j.length-1];$.transform.op.v!==0?($.transform.op._mdf=!0,$.transform.op.v=0):$.transform.op._mdf=!1}c+=1}this._currentCopies=g;var _e=this.o.v,tt=_e%1,et=_e>0?Math.floor(_e):Math.ceil(_e),st=this.pMatrix.props,at=this.rMatrix.props,rt=this.sMatrix.props;this.pMatrix.reset(),this.rMatrix.reset(),this.sMatrix.reset(),this.tMatrix.reset(),this.matrix.reset();var nt=0;if(_e>0){for(;nt<et;)this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!1),nt+=1;tt&&(this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,tt,!1),nt+=tt)}else if(_e<0){for(;nt>et;)this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!0),nt-=1;tt&&(this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,-tt,!0),nt-=tt)}a=this.data.m===1?0:this._currentCopies-1,o=this.data.m===1?1:-1,c=this._currentCopies;for(var it,ot;c;){if(e=this.elemsData[a].it,i=e[e.length-1].transform.mProps.v.props,ot=i.length,e[e.length-1].transform.mProps._mdf=!0,e[e.length-1].transform.op._mdf=!0,e[e.length-1].transform.op.v=this._currentCopies===1?this.so.v:this.so.v+(this.eo.v-this.so.v)*(a/(this._currentCopies-1)),nt!==0){for((a!==0&&o===1||a!==this._currentCopies-1&&o===-1)&&this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!1),this.matrix.transform(at[0],at[1],at[2],at[3],at[4],at[5],at[6],at[7],at[8],at[9],at[10],at[11],at[12],at[13],at[14],at[15]),this.matrix.transform(rt[0],rt[1],rt[2],rt[3],rt[4],rt[5],rt[6],rt[7],rt[8],rt[9],rt[10],rt[11],rt[12],rt[13],rt[14],rt[15]),this.matrix.transform(st[0],st[1],st[2],st[3],st[4],st[5],st[6],st[7],st[8],st[9],st[10],st[11],st[12],st[13],st[14],st[15]),it=0;it<ot;it+=1)i[it]=this.matrix.props[it];this.matrix.reset()}else for(this.matrix.reset(),it=0;it<ot;it+=1)i[it]=this.matrix.props[it];nt+=1,c-=1,a+=o}}else for(c=this._currentCopies,a=0,o=1;c;)e=this.elemsData[a].it,i=e[e.length-1].transform.mProps.v.props,e[e.length-1].transform.mProps._mdf=!1,e[e.length-1].transform.op._mdf=!1,c-=1,a+=o;return d},RepeaterModifier.prototype.addShape=function(){};function RoundCornersModifier(){}extendPrototype([ShapeModifier],RoundCornersModifier),RoundCornersModifier.prototype.initModifierProperties=function(s,e){this.getValue=this.processKeys,this.rd=PropertyFactory.getProp(s,e.r,0,null,this),this._isAnimated=!!this.rd.effectsSequence.length},RoundCornersModifier.prototype.processPath=function(s,e){var i=shapePool.newElement();i.c=s.c;var a,o=s._length,c,d,g,b,_,j,$=0,_e,tt,et,st,at,rt;for(a=0;a<o;a+=1)c=s.v[a],g=s.o[a],d=s.i[a],c[0]===g[0]&&c[1]===g[1]&&c[0]===d[0]&&c[1]===d[1]?(a===0||a===o-1)&&!s.c?(i.setTripleAt(c[0],c[1],g[0],g[1],d[0],d[1],$),$+=1):(a===0?b=s.v[o-1]:b=s.v[a-1],_=Math.sqrt(Math.pow(c[0]-b[0],2)+Math.pow(c[1]-b[1],2)),j=_?Math.min(_/2,e)/_:0,at=c[0]+(b[0]-c[0])*j,_e=at,rt=c[1]-(c[1]-b[1])*j,tt=rt,et=_e-(_e-c[0])*roundCorner,st=tt-(tt-c[1])*roundCorner,i.setTripleAt(_e,tt,et,st,at,rt,$),$+=1,a===o-1?b=s.v[0]:b=s.v[a+1],_=Math.sqrt(Math.pow(c[0]-b[0],2)+Math.pow(c[1]-b[1],2)),j=_?Math.min(_/2,e)/_:0,et=c[0]+(b[0]-c[0])*j,_e=et,st=c[1]+(b[1]-c[1])*j,tt=st,at=_e-(_e-c[0])*roundCorner,rt=tt-(tt-c[1])*roundCorner,i.setTripleAt(_e,tt,et,st,at,rt,$),$+=1):(i.setTripleAt(s.v[a][0],s.v[a][1],s.o[a][0],s.o[a][1],s.i[a][0],s.i[a][1],$),$+=1);return i},RoundCornersModifier.prototype.processShapes=function(s){var e,i,a=this.shapes.length,o,c,d=this.rd.v;if(d!==0){var g,b;for(i=0;i<a;i+=1){if(g=this.shapes[i],b=g.localShapeCollection,!(!g.shape._mdf&&!this._mdf&&!s))for(b.releaseShapes(),g.shape._mdf=!0,e=g.shape.paths.shapes,c=g.shape.paths._length,o=0;o<c;o+=1)b.addShape(this.processPath(e[o],d));g.shape.paths=g.localShapeCollection}}this.dynamicProperties.length||(this._mdf=!1)};function floatEqual(s,e){return Math.abs(s-e)*1e5<=Math.min(Math.abs(s),Math.abs(e))}function floatZero(s){return Math.abs(s)<=1e-5}function lerp(s,e,i){return s*(1-i)+e*i}function lerpPoint(s,e,i){return[lerp(s[0],e[0],i),lerp(s[1],e[1],i)]}function quadRoots(s,e,i){if(s===0)return[];var a=e*e-4*s*i;if(a<0)return[];var o=-e/(2*s);if(a===0)return[o];var c=Math.sqrt(a)/(2*s);return[o-c,o+c]}function polynomialCoefficients(s,e,i,a){return[-s+3*e-3*i+a,3*s-6*e+3*i,-3*s+3*e,s]}function singlePoint(s){return new PolynomialBezier(s,s,s,s,!1)}function PolynomialBezier(s,e,i,a,o){o&&pointEqual(s,e)&&(e=lerpPoint(s,a,1/3)),o&&pointEqual(i,a)&&(i=lerpPoint(s,a,2/3));var c=polynomialCoefficients(s[0],e[0],i[0],a[0]),d=polynomialCoefficients(s[1],e[1],i[1],a[1]);this.a=[c[0],d[0]],this.b=[c[1],d[1]],this.c=[c[2],d[2]],this.d=[c[3],d[3]],this.points=[s,e,i,a]}PolynomialBezier.prototype.point=function(s){return[((this.a[0]*s+this.b[0])*s+this.c[0])*s+this.d[0],((this.a[1]*s+this.b[1])*s+this.c[1])*s+this.d[1]]},PolynomialBezier.prototype.derivative=function(s){return[(3*s*this.a[0]+2*this.b[0])*s+this.c[0],(3*s*this.a[1]+2*this.b[1])*s+this.c[1]]},PolynomialBezier.prototype.tangentAngle=function(s){var e=this.derivative(s);return Math.atan2(e[1],e[0])},PolynomialBezier.prototype.normalAngle=function(s){var e=this.derivative(s);return Math.atan2(e[0],e[1])},PolynomialBezier.prototype.inflectionPoints=function(){var s=this.a[1]*this.b[0]-this.a[0]*this.b[1];if(floatZero(s))return[];var e=-.5*(this.a[1]*this.c[0]-this.a[0]*this.c[1])/s,i=e*e-1/3*(this.b[1]*this.c[0]-this.b[0]*this.c[1])/s;if(i<0)return[];var a=Math.sqrt(i);return floatZero(a)?a>0&&a<1?[e]:[]:[e-a,e+a].filter(function(o){return o>0&&o<1})},PolynomialBezier.prototype.split=function(s){if(s<=0)return[singlePoint(this.points[0]),this];if(s>=1)return[this,singlePoint(this.points[this.points.length-1])];var e=lerpPoint(this.points[0],this.points[1],s),i=lerpPoint(this.points[1],this.points[2],s),a=lerpPoint(this.points[2],this.points[3],s),o=lerpPoint(e,i,s),c=lerpPoint(i,a,s),d=lerpPoint(o,c,s);return[new PolynomialBezier(this.points[0],e,o,d,!0),new PolynomialBezier(d,c,a,this.points[3],!0)]};function extrema(s,e){var i=s.points[0][e],a=s.points[s.points.length-1][e];if(i>a){var o=a;a=i,i=o}for(var c=quadRoots(3*s.a[e],2*s.b[e],s.c[e]),d=0;d<c.length;d+=1)if(c[d]>0&&c[d]<1){var g=s.point(c[d])[e];g<i?i=g:g>a&&(a=g)}return{min:i,max:a}}PolynomialBezier.prototype.bounds=function(){return{x:extrema(this,0),y:extrema(this,1)}},PolynomialBezier.prototype.boundingBox=function(){var s=this.bounds();return{left:s.x.min,right:s.x.max,top:s.y.min,bottom:s.y.max,width:s.x.max-s.x.min,height:s.y.max-s.y.min,cx:(s.x.max+s.x.min)/2,cy:(s.y.max+s.y.min)/2}};function intersectData(s,e,i){var a=s.boundingBox();return{cx:a.cx,cy:a.cy,width:a.width,height:a.height,bez:s,t:(e+i)/2,t1:e,t2:i}}function splitData(s){var e=s.bez.split(.5);return[intersectData(e[0],s.t1,s.t),intersectData(e[1],s.t,s.t2)]}function boxIntersect(s,e){return Math.abs(s.cx-e.cx)*2<s.width+e.width&&Math.abs(s.cy-e.cy)*2<s.height+e.height}function intersectsImpl(s,e,i,a,o,c){if(boxIntersect(s,e)){if(i>=c||s.width<=a&&s.height<=a&&e.width<=a&&e.height<=a){o.push([s.t,e.t]);return}var d=splitData(s),g=splitData(e);intersectsImpl(d[0],g[0],i+1,a,o,c),intersectsImpl(d[0],g[1],i+1,a,o,c),intersectsImpl(d[1],g[0],i+1,a,o,c),intersectsImpl(d[1],g[1],i+1,a,o,c)}}PolynomialBezier.prototype.intersections=function(s,e,i){e===void 0&&(e=2),i===void 0&&(i=7);var a=[];return intersectsImpl(intersectData(this,0,1),intersectData(s,0,1),0,e,a,i),a},PolynomialBezier.shapeSegment=function(s,e){var i=(e+1)%s.length();return new PolynomialBezier(s.v[e],s.o[e],s.i[i],s.v[i],!0)},PolynomialBezier.shapeSegmentInverted=function(s,e){var i=(e+1)%s.length();return new PolynomialBezier(s.v[i],s.i[i],s.o[e],s.v[e],!0)};function crossProduct(s,e){return[s[1]*e[2]-s[2]*e[1],s[2]*e[0]-s[0]*e[2],s[0]*e[1]-s[1]*e[0]]}function lineIntersection(s,e,i,a){var o=[s[0],s[1],1],c=[e[0],e[1],1],d=[i[0],i[1],1],g=[a[0],a[1],1],b=crossProduct(crossProduct(o,c),crossProduct(d,g));return floatZero(b[2])?null:[b[0]/b[2],b[1]/b[2]]}function polarOffset(s,e,i){return[s[0]+Math.cos(e)*i,s[1]-Math.sin(e)*i]}function pointDistance(s,e){return Math.hypot(s[0]-e[0],s[1]-e[1])}function pointEqual(s,e){return floatEqual(s[0],e[0])&&floatEqual(s[1],e[1])}function ZigZagModifier(){}extendPrototype([ShapeModifier],ZigZagModifier),ZigZagModifier.prototype.initModifierProperties=function(s,e){this.getValue=this.processKeys,this.amplitude=PropertyFactory.getProp(s,e.s,0,null,this),this.frequency=PropertyFactory.getProp(s,e.r,0,null,this),this.pointsType=PropertyFactory.getProp(s,e.pt,0,null,this),this._isAnimated=this.amplitude.effectsSequence.length!==0||this.frequency.effectsSequence.length!==0||this.pointsType.effectsSequence.length!==0};function setPoint(s,e,i,a,o,c,d){var g=i-Math.PI/2,b=i+Math.PI/2,_=e[0]+Math.cos(i)*a*o,j=e[1]-Math.sin(i)*a*o;s.setTripleAt(_,j,_+Math.cos(g)*c,j-Math.sin(g)*c,_+Math.cos(b)*d,j-Math.sin(b)*d,s.length())}function getPerpendicularVector(s,e){var i=[e[0]-s[0],e[1]-s[1]],a=-Math.PI*.5,o=[Math.cos(a)*i[0]-Math.sin(a)*i[1],Math.sin(a)*i[0]+Math.cos(a)*i[1]];return o}function getProjectingAngle(s,e){var i=e===0?s.length()-1:e-1,a=(e+1)%s.length(),o=s.v[i],c=s.v[a],d=getPerpendicularVector(o,c);return Math.atan2(0,1)-Math.atan2(d[1],d[0])}function zigZagCorner(s,e,i,a,o,c,d){var g=getProjectingAngle(e,i),b=e.v[i%e._length],_=e.v[i===0?e._length-1:i-1],j=e.v[(i+1)%e._length],$=c===2?Math.sqrt(Math.pow(b[0]-_[0],2)+Math.pow(b[1]-_[1],2)):0,_e=c===2?Math.sqrt(Math.pow(b[0]-j[0],2)+Math.pow(b[1]-j[1],2)):0;setPoint(s,e.v[i%e._length],g,d,a,_e/((o+1)*2),$/((o+1)*2))}function zigZagSegment(s,e,i,a,o,c){for(var d=0;d<a;d+=1){var g=(d+1)/(a+1),b=o===2?Math.sqrt(Math.pow(e.points[3][0]-e.points[0][0],2)+Math.pow(e.points[3][1]-e.points[0][1],2)):0,_=e.normalAngle(g),j=e.point(g);setPoint(s,j,_,c,i,b/((a+1)*2),b/((a+1)*2)),c=-c}return c}ZigZagModifier.prototype.processPath=function(s,e,i,a){var o=s._length,c=shapePool.newElement();if(c.c=s.c,s.c||(o-=1),o===0)return c;var d=-1,g=PolynomialBezier.shapeSegment(s,0);zigZagCorner(c,s,0,e,i,a,d);for(var b=0;b<o;b+=1)d=zigZagSegment(c,g,e,i,a,-d),b===o-1&&!s.c?g=null:g=PolynomialBezier.shapeSegment(s,(b+1)%o),zigZagCorner(c,s,b+1,e,i,a,d);return c},ZigZagModifier.prototype.processShapes=function(s){var e,i,a=this.shapes.length,o,c,d=this.amplitude.v,g=Math.max(0,Math.round(this.frequency.v)),b=this.pointsType.v;if(d!==0){var _,j;for(i=0;i<a;i+=1){if(_=this.shapes[i],j=_.localShapeCollection,!(!_.shape._mdf&&!this._mdf&&!s))for(j.releaseShapes(),_.shape._mdf=!0,e=_.shape.paths.shapes,c=_.shape.paths._length,o=0;o<c;o+=1)j.addShape(this.processPath(e[o],d,g,b));_.shape.paths=_.localShapeCollection}}this.dynamicProperties.length||(this._mdf=!1)};function linearOffset(s,e,i){var a=Math.atan2(e[0]-s[0],e[1]-s[1]);return[polarOffset(s,a,i),polarOffset(e,a,i)]}function offsetSegment(s,e){var i,a,o,c,d,g,b;b=linearOffset(s.points[0],s.points[1],e),i=b[0],a=b[1],b=linearOffset(s.points[1],s.points[2],e),o=b[0],c=b[1],b=linearOffset(s.points[2],s.points[3],e),d=b[0],g=b[1];var _=lineIntersection(i,a,o,c);_===null&&(_=a);var j=lineIntersection(d,g,o,c);return j===null&&(j=d),new PolynomialBezier(i,_,j,g)}function joinLines(s,e,i,a,o){var c=e.points[3],d=i.points[0];if(a===3||pointEqual(c,d))return c;if(a===2){var g=-e.tangentAngle(1),b=-i.tangentAngle(0)+Math.PI,_=lineIntersection(c,polarOffset(c,g+Math.PI/2,100),d,polarOffset(d,g+Math.PI/2,100)),j=_?pointDistance(_,c):pointDistance(c,d)/2,$=polarOffset(c,g,2*j*roundCorner);return s.setXYAt($[0],$[1],"o",s.length()-1),$=polarOffset(d,b,2*j*roundCorner),s.setTripleAt(d[0],d[1],d[0],d[1],$[0],$[1],s.length()),d}var _e=pointEqual(c,e.points[2])?e.points[0]:e.points[2],tt=pointEqual(d,i.points[1])?i.points[3]:i.points[1],et=lineIntersection(_e,c,d,tt);return et&&pointDistance(et,c)<o?(s.setTripleAt(et[0],et[1],et[0],et[1],et[0],et[1],s.length()),et):c}function getIntersection(s,e){var i=s.intersections(e);return i.length&&floatEqual(i[0][0],1)&&i.shift(),i.length?i[0]:null}function pruneSegmentIntersection(s,e){var i=s.slice(),a=e.slice(),o=getIntersection(s[s.length-1],e[0]);return o&&(i[s.length-1]=s[s.length-1].split(o[0])[0],a[0]=e[0].split(o[1])[1]),s.length>1&&e.length>1&&(o=getIntersection(s[0],e[e.length-1]),o)?[[s[0].split(o[0])[0]],[e[e.length-1].split(o[1])[1]]]:[i,a]}function pruneIntersections(s){for(var e,i=1;i<s.length;i+=1)e=pruneSegmentIntersection(s[i-1],s[i]),s[i-1]=e[0],s[i]=e[1];return s.length>1&&(e=pruneSegmentIntersection(s[s.length-1],s[0]),s[s.length-1]=e[0],s[0]=e[1]),s}function offsetSegmentSplit(s,e){var i=s.inflectionPoints(),a,o,c,d;if(i.length===0)return[offsetSegment(s,e)];if(i.length===1||floatEqual(i[1],1))return c=s.split(i[0]),a=c[0],o=c[1],[offsetSegment(a,e),offsetSegment(o,e)];c=s.split(i[0]),a=c[0];var g=(i[1]-i[0])/(1-i[0]);return c=c[1].split(g),d=c[0],o=c[1],[offsetSegment(a,e),offsetSegment(d,e),offsetSegment(o,e)]}function OffsetPathModifier(){}extendPrototype([ShapeModifier],OffsetPathModifier),OffsetPathModifier.prototype.initModifierProperties=function(s,e){this.getValue=this.processKeys,this.amount=PropertyFactory.getProp(s,e.a,0,null,this),this.miterLimit=PropertyFactory.getProp(s,e.ml,0,null,this),this.lineJoin=e.lj,this._isAnimated=this.amount.effectsSequence.length!==0},OffsetPathModifier.prototype.processPath=function(s,e,i,a){var o=shapePool.newElement();o.c=s.c;var c=s.length();s.c||(c-=1);var d,g,b,_=[];for(d=0;d<c;d+=1)b=PolynomialBezier.shapeSegment(s,d),_.push(offsetSegmentSplit(b,e));if(!s.c)for(d=c-1;d>=0;d-=1)b=PolynomialBezier.shapeSegmentInverted(s,d),_.push(offsetSegmentSplit(b,e));_=pruneIntersections(_);var j=null,$=null;for(d=0;d<_.length;d+=1){var _e=_[d];for($&&(j=joinLines(o,$,_e[0],i,a)),$=_e[_e.length-1],g=0;g<_e.length;g+=1)b=_e[g],j&&pointEqual(b.points[0],j)?o.setXYAt(b.points[1][0],b.points[1][1],"o",o.length()-1):o.setTripleAt(b.points[0][0],b.points[0][1],b.points[1][0],b.points[1][1],b.points[0][0],b.points[0][1],o.length()),o.setTripleAt(b.points[3][0],b.points[3][1],b.points[3][0],b.points[3][1],b.points[2][0],b.points[2][1],o.length()),j=b.points[3]}return _.length&&joinLines(o,$,_[0][0],i,a),o},OffsetPathModifier.prototype.processShapes=function(s){var e,i,a=this.shapes.length,o,c,d=this.amount.v,g=this.miterLimit.v,b=this.lineJoin;if(d!==0){var _,j;for(i=0;i<a;i+=1){if(_=this.shapes[i],j=_.localShapeCollection,!(!_.shape._mdf&&!this._mdf&&!s))for(j.releaseShapes(),_.shape._mdf=!0,e=_.shape.paths.shapes,c=_.shape.paths._length,o=0;o<c;o+=1)j.addShape(this.processPath(e[o],d,b,g));_.shape.paths=_.localShapeCollection}}this.dynamicProperties.length||(this._mdf=!1)};function getFontProperties(s){for(var e=s.fStyle?s.fStyle.split(" "):[],i="normal",a="normal",o=e.length,c,d=0;d<o;d+=1)switch(c=e[d].toLowerCase(),c){case"italic":a="italic";break;case"bold":i="700";break;case"black":i="900";break;case"medium":i="500";break;case"regular":case"normal":i="400";break;case"light":case"thin":i="200";break}return{style:a,weight:s.fWeight||i}}var FontManager=function(){var s=5e3,e={w:0,size:0,shapes:[],data:{shapes:[]}},i=[];i=i.concat([2304,2305,2306,2307,2362,2363,2364,2364,2366,2367,2368,2369,2370,2371,2372,2373,2374,2375,2376,2377,2378,2379,2380,2381,2382,2383,2387,2388,2389,2390,2391,2402,2403]);var a=127988,o=917631,c=917601,d=917626,g=65039,b=8205,_=127462,j=127487,$=["d83cdffb","d83cdffc","d83cdffd","d83cdffe","d83cdfff"];function _e(pt){var yt=pt.split(","),ut,ft=yt.length,xt=[];for(ut=0;ut<ft;ut+=1)yt[ut]!=="sans-serif"&&yt[ut]!=="monospace"&&xt.push(yt[ut]);return xt.join(",")}function tt(pt,yt){var ut=createTag("span");ut.setAttribute("aria-hidden",!0),ut.style.fontFamily=yt;var ft=createTag("span");ft.innerText="giItT1WQy@!-/#",ut.style.position="absolute",ut.style.left="-10000px",ut.style.top="-10000px",ut.style.fontSize="300px",ut.style.fontVariant="normal",ut.style.fontStyle="normal",ut.style.fontWeight="normal",ut.style.letterSpacing="0",ut.appendChild(ft),document.body.appendChild(ut);var xt=ft.offsetWidth;return ft.style.fontFamily=_e(pt)+", "+yt,{node:ft,w:xt,parent:ut}}function et(){var pt,yt=this.fonts.length,ut,ft,xt=yt;for(pt=0;pt<yt;pt+=1)this.fonts[pt].loaded?xt-=1:this.fonts[pt].fOrigin==="n"||this.fonts[pt].origin===0?this.fonts[pt].loaded=!0:(ut=this.fonts[pt].monoCase.node,ft=this.fonts[pt].monoCase.w,ut.offsetWidth!==ft?(xt-=1,this.fonts[pt].loaded=!0):(ut=this.fonts[pt].sansCase.node,ft=this.fonts[pt].sansCase.w,ut.offsetWidth!==ft&&(xt-=1,this.fonts[pt].loaded=!0)),this.fonts[pt].loaded&&(this.fonts[pt].sansCase.parent.parentNode.removeChild(this.fonts[pt].sansCase.parent),this.fonts[pt].monoCase.parent.parentNode.removeChild(this.fonts[pt].monoCase.parent)));xt!==0&&Date.now()-this.initTime<s?setTimeout(this.checkLoadedFontsBinded,20):setTimeout(this.setIsLoadedBinded,10)}function st(pt,yt){var ut=document.body&&yt?"svg":"canvas",ft,xt=getFontProperties(pt);if(ut==="svg"){var mt=createNS("text");mt.style.fontSize="100px",mt.setAttribute("font-family",pt.fFamily),mt.setAttribute("font-style",xt.style),mt.setAttribute("font-weight",xt.weight),mt.textContent="1",pt.fClass?(mt.style.fontFamily="inherit",mt.setAttribute("class",pt.fClass)):mt.style.fontFamily=pt.fFamily,yt.appendChild(mt),ft=mt}else{var Et=new OffscreenCanvas(500,500).getContext("2d");Et.font=xt.style+" "+xt.weight+" 100px "+pt.fFamily,ft=Et}function At(Pt){return ut==="svg"?(ft.textContent=Pt,ft.getComputedTextLength()):ft.measureText(Pt).width}return{measureText:At}}function at(pt,yt){if(!pt){this.isLoaded=!0;return}if(this.chars){this.isLoaded=!0,this.fonts=pt.list;return}if(!document.body){this.isLoaded=!0,pt.list.forEach(function(Bt){Bt.helper=st(Bt),Bt.cache={}}),this.fonts=pt.list;return}var ut=pt.list,ft,xt=ut.length,mt=xt;for(ft=0;ft<xt;ft+=1){var Et=!0,At,Pt;if(ut[ft].loaded=!1,ut[ft].monoCase=tt(ut[ft].fFamily,"monospace"),ut[ft].sansCase=tt(ut[ft].fFamily,"sans-serif"),!ut[ft].fPath)ut[ft].loaded=!0,mt-=1;else if(ut[ft].fOrigin==="p"||ut[ft].origin===3){if(At=document.querySelectorAll('style[f-forigin="p"][f-family="'+ut[ft].fFamily+'"], style[f-origin="3"][f-family="'+ut[ft].fFamily+'"]'),At.length>0&&(Et=!1),Et){var wt=createTag("style");wt.setAttribute("f-forigin",ut[ft].fOrigin),wt.setAttribute("f-origin",ut[ft].origin),wt.setAttribute("f-family",ut[ft].fFamily),wt.type="text/css",wt.innerText="@font-face {font-family: "+ut[ft].fFamily+"; font-style: normal; src: url('"+ut[ft].fPath+"');}",yt.appendChild(wt)}}else if(ut[ft].fOrigin==="g"||ut[ft].origin===1){for(At=document.querySelectorAll('link[f-forigin="g"], link[f-origin="1"]'),Pt=0;Pt<At.length;Pt+=1)At[Pt].href.indexOf(ut[ft].fPath)!==-1&&(Et=!1);if(Et){var It=createTag("link");It.setAttribute("f-forigin",ut[ft].fOrigin),It.setAttribute("f-origin",ut[ft].origin),It.type="text/css",It.rel="stylesheet",It.href=ut[ft].fPath,document.body.appendChild(It)}}else if(ut[ft].fOrigin==="t"||ut[ft].origin===2){for(At=document.querySelectorAll('script[f-forigin="t"], script[f-origin="2"]'),Pt=0;Pt<At.length;Pt+=1)ut[ft].fPath===At[Pt].src&&(Et=!1);if(Et){var Mt=createTag("link");Mt.setAttribute("f-forigin",ut[ft].fOrigin),Mt.setAttribute("f-origin",ut[ft].origin),Mt.setAttribute("rel","stylesheet"),Mt.setAttribute("href",ut[ft].fPath),yt.appendChild(Mt)}}ut[ft].helper=st(ut[ft],yt),ut[ft].cache={},this.fonts.push(ut[ft])}mt===0?this.isLoaded=!0:setTimeout(this.checkLoadedFonts.bind(this),100)}function rt(pt){if(pt){this.chars||(this.chars=[]);var yt,ut=pt.length,ft,xt=this.chars.length,mt;for(yt=0;yt<ut;yt+=1){for(ft=0,mt=!1;ft<xt;)this.chars[ft].style===pt[yt].style&&this.chars[ft].fFamily===pt[yt].fFamily&&this.chars[ft].ch===pt[yt].ch&&(mt=!0),ft+=1;mt||(this.chars.push(pt[yt]),xt+=1)}}}function nt(pt,yt,ut){for(var ft=0,xt=this.chars.length;ft<xt;){if(this.chars[ft].ch===pt&&this.chars[ft].style===yt&&this.chars[ft].fFamily===ut)return this.chars[ft];ft+=1}return(typeof pt=="string"&&pt.charCodeAt(0)!==13||!pt)&&console&&console.warn&&!this._warned&&(this._warned=!0,console.warn("Missing character from exported characters list: ",pt,yt,ut)),e}function it(pt,yt,ut){var ft=this.getFontByName(yt),xt=pt;if(!ft.cache[xt]){var mt=ft.helper;if(pt===" "){var Et=mt.measureText("|"+pt+"|"),At=mt.measureText("||");ft.cache[xt]=(Et-At)/100}else ft.cache[xt]=mt.measureText(pt)/100}return ft.cache[xt]*ut}function ot(pt){for(var yt=0,ut=this.fonts.length;yt<ut;){if(this.fonts[yt].fName===pt)return this.fonts[yt];yt+=1}return this.fonts[0]}function lt(pt){var yt=0,ut=pt.charCodeAt(0);if(ut>=55296&&ut<=56319){var ft=pt.charCodeAt(1);ft>=56320&&ft<=57343&&(yt=(ut-55296)*1024+ft-56320+65536)}return yt}function ct(pt,yt){var ut=pt.toString(16)+yt.toString(16);return $.indexOf(ut)!==-1}function ht(pt){return pt===b}function dt(pt){return pt===g}function gt(pt){var yt=lt(pt);return yt>=_&&yt<=j}function vt(pt){return gt(pt.substr(0,2))&&gt(pt.substr(2,2))}function St(pt){return i.indexOf(pt)!==-1}function Tt(pt,yt){var ut=lt(pt.substr(yt,2));if(ut!==a)return!1;var ft=0;for(yt+=2;ft<5;){if(ut=lt(pt.substr(yt,2)),ut<c||ut>d)return!1;ft+=1,yt+=2}return lt(pt.substr(yt,2))===o}function Ct(){this.isLoaded=!0}var Rt=function(){this.fonts=[],this.chars=null,this.typekitLoaded=0,this.isLoaded=!1,this._warned=!1,this.initTime=Date.now(),this.setIsLoadedBinded=this.setIsLoaded.bind(this),this.checkLoadedFontsBinded=this.checkLoadedFonts.bind(this)};Rt.isModifier=ct,Rt.isZeroWidthJoiner=ht,Rt.isFlagEmoji=vt,Rt.isRegionalCode=gt,Rt.isCombinedCharacter=St,Rt.isRegionalFlag=Tt,Rt.isVariationSelector=dt,Rt.BLACK_FLAG_CODE_POINT=a;var bt={addChars:rt,addFonts:at,getCharData:nt,getFontByName:ot,measureText:it,checkLoadedFonts:et,setIsLoaded:Ct};return Rt.prototype=bt,Rt}();function SlotManager(s){this.animationData=s}SlotManager.prototype.getProp=function(s){return this.animationData.slots&&this.animationData.slots[s.sid]?Object.assign(s,this.animationData.slots[s.sid].p):s};function slotFactory(s){return new SlotManager(s)}function RenderableElement(){}RenderableElement.prototype={initRenderable:function(){this.isInRange=!1,this.hidden=!1,this.isTransparent=!1,this.renderableComponents=[]},addRenderableComponent:function(e){this.renderableComponents.indexOf(e)===-1&&this.renderableComponents.push(e)},removeRenderableComponent:function(e){this.renderableComponents.indexOf(e)!==-1&&this.renderableComponents.splice(this.renderableComponents.indexOf(e),1)},prepareRenderableFrame:function(e){this.checkLayerLimits(e)},checkTransparency:function(){this.finalTransform.mProp.o.v<=0?!this.isTransparent&&this.globalData.renderConfig.hideOnTransparent&&(this.isTransparent=!0,this.hide()):this.isTransparent&&(this.isTransparent=!1,this.show())},checkLayerLimits:function(e){this.data.ip-this.data.st<=e&&this.data.op-this.data.st>e?this.isInRange!==!0&&(this.globalData._mdf=!0,this._mdf=!0,this.isInRange=!0,this.show()):this.isInRange!==!1&&(this.globalData._mdf=!0,this.isInRange=!1,this.hide())},renderRenderable:function(){var e,i=this.renderableComponents.length;for(e=0;e<i;e+=1)this.renderableComponents[e].renderFrame(this._isFirstFrame)},sourceRectAtTime:function(){return{top:0,left:0,width:100,height:100}},getLayerSize:function(){return this.data.ty===5?{w:this.data.textData.width,h:this.data.textData.height}:{w:this.data.width,h:this.data.height}}};var getBlendMode=function(){var s={0:"source-over",1:"multiply",2:"screen",3:"overlay",4:"darken",5:"lighten",6:"color-dodge",7:"color-burn",8:"hard-light",9:"soft-light",10:"difference",11:"exclusion",12:"hue",13:"saturation",14:"color",15:"luminosity"};return function(e){return s[e]||""}}();function SliderEffect(s,e,i){this.p=PropertyFactory.getProp(e,s.v,0,0,i)}function AngleEffect(s,e,i){this.p=PropertyFactory.getProp(e,s.v,0,0,i)}function ColorEffect(s,e,i){this.p=PropertyFactory.getProp(e,s.v,1,0,i)}function PointEffect(s,e,i){this.p=PropertyFactory.getProp(e,s.v,1,0,i)}function LayerIndexEffect(s,e,i){this.p=PropertyFactory.getProp(e,s.v,0,0,i)}function MaskIndexEffect(s,e,i){this.p=PropertyFactory.getProp(e,s.v,0,0,i)}function CheckboxEffect(s,e,i){this.p=PropertyFactory.getProp(e,s.v,0,0,i)}function NoValueEffect(){this.p={}}function EffectsManager(s,e){var i=s.ef||[];this.effectElements=[];var a,o=i.length,c;for(a=0;a<o;a+=1)c=new GroupEffect(i[a],e),this.effectElements.push(c)}function GroupEffect(s,e){this.init(s,e)}extendPrototype([DynamicPropertyContainer],GroupEffect),GroupEffect.prototype.getValue=GroupEffect.prototype.iterateDynamicProperties,GroupEffect.prototype.init=function(s,e){this.data=s,this.effectElements=[],this.initDynamicPropertyContainer(e);var i,a=this.data.ef.length,o,c=this.data.ef;for(i=0;i<a;i+=1){switch(o=null,c[i].ty){case 0:o=new SliderEffect(c[i],e,this);break;case 1:o=new AngleEffect(c[i],e,this);break;case 2:o=new ColorEffect(c[i],e,this);break;case 3:o=new PointEffect(c[i],e,this);break;case 4:case 7:o=new CheckboxEffect(c[i],e,this);break;case 10:o=new LayerIndexEffect(c[i],e,this);break;case 11:o=new MaskIndexEffect(c[i],e,this);break;case 5:o=new EffectsManager(c[i],e);break;default:o=new NoValueEffect(c[i]);break}o&&this.effectElements.push(o)}};function BaseElement(){}BaseElement.prototype={checkMasks:function(){if(!this.data.hasMask)return!1;for(var e=0,i=this.data.masksProperties.length;e<i;){if(this.data.masksProperties[e].mode!=="n"&&this.data.masksProperties[e].cl!==!1)return!0;e+=1}return!1},initExpressions:function(){var e=getExpressionInterfaces();if(e){var i=e("layer"),a=e("effects"),o=e("shape"),c=e("text"),d=e("comp");this.layerInterface=i(this),this.data.hasMask&&this.maskManager&&this.layerInterface.registerMaskInterface(this.maskManager);var g=a.createEffectsInterface(this,this.layerInterface);this.layerInterface.registerEffectsInterface(g),this.data.ty===0||this.data.xt?this.compInterface=d(this):this.data.ty===4?(this.layerInterface.shapeInterface=o(this.shapesData,this.itemsData,this.layerInterface),this.layerInterface.content=this.layerInterface.shapeInterface):this.data.ty===5&&(this.layerInterface.textInterface=c(this),this.layerInterface.text=this.layerInterface.textInterface)}},setBlendMode:function(){var e=getBlendMode(this.data.bm),i=this.baseElement||this.layerElement;i.style["mix-blend-mode"]=e},initBaseData:function(e,i,a){this.globalData=i,this.comp=a,this.data=e,this.layerId=createElementID(),this.data.sr||(this.data.sr=1),this.effectsManager=new EffectsManager(this.data,this,this.dynamicProperties)},getType:function(){return this.type},sourceRectAtTime:function(){}};function FrameElement(){}FrameElement.prototype={initFrame:function(){this._isFirstFrame=!1,this.dynamicProperties=[],this._mdf=!1},prepareProperties:function(e,i){var a,o=this.dynamicProperties.length;for(a=0;a<o;a+=1)(i||this._isParent&&this.dynamicProperties[a].propType==="transform")&&(this.dynamicProperties[a].getValue(),this.dynamicProperties[a]._mdf&&(this.globalData._mdf=!0,this._mdf=!0))},addDynamicProperty:function(e){this.dynamicProperties.indexOf(e)===-1&&this.dynamicProperties.push(e)}};function FootageElement(s,e,i){this.initFrame(),this.initRenderable(),this.assetData=e.getAssetData(s.refId),this.footageData=e.imageLoader.getAsset(this.assetData),this.initBaseData(s,e,i)}FootageElement.prototype.prepareFrame=function(){},extendPrototype([RenderableElement,BaseElement,FrameElement],FootageElement),FootageElement.prototype.getBaseElement=function(){return null},FootageElement.prototype.renderFrame=function(){},FootageElement.prototype.destroy=function(){},FootageElement.prototype.initExpressions=function(){var s=getExpressionInterfaces();if(s){var e=s("footage");this.layerInterface=e(this)}},FootageElement.prototype.getFootageData=function(){return this.footageData};function AudioElement(s,e,i){this.initFrame(),this.initRenderable(),this.assetData=e.getAssetData(s.refId),this.initBaseData(s,e,i),this._isPlaying=!1,this._canPlay=!1;var a=this.globalData.getAssetsPath(this.assetData);this.audio=this.globalData.audioController.createAudio(a),this._currentTime=0,this.globalData.audioController.addAudio(this),this._volumeMultiplier=1,this._volume=1,this._previousVolume=null,this.tm=s.tm?PropertyFactory.getProp(this,s.tm,0,e.frameRate,this):{_placeholder:!0},this.lv=PropertyFactory.getProp(this,s.au&&s.au.lv?s.au.lv:{k:[100]},1,.01,this)}AudioElement.prototype.prepareFrame=function(s){if(this.prepareRenderableFrame(s,!0),this.prepareProperties(s,!0),this.tm._placeholder)this._currentTime=s/this.data.sr;else{var e=this.tm.v;this._currentTime=e}this._volume=this.lv.v[0];var i=this._volume*this._volumeMultiplier;this._previousVolume!==i&&(this._previousVolume=i,this.audio.volume(i))},extendPrototype([RenderableElement,BaseElement,FrameElement],AudioElement),AudioElement.prototype.renderFrame=function(){this.isInRange&&this._canPlay&&(this._isPlaying?(!this.audio.playing()||Math.abs(this._currentTime/this.globalData.frameRate-this.audio.seek())>.1)&&this.audio.seek(this._currentTime/this.globalData.frameRate):(this.audio.play(),this.audio.seek(this._currentTime/this.globalData.frameRate),this._isPlaying=!0))},AudioElement.prototype.show=function(){},AudioElement.prototype.hide=function(){this.audio.pause(),this._isPlaying=!1},AudioElement.prototype.pause=function(){this.audio.pause(),this._isPlaying=!1,this._canPlay=!1},AudioElement.prototype.resume=function(){this._canPlay=!0},AudioElement.prototype.setRate=function(s){this.audio.rate(s)},AudioElement.prototype.volume=function(s){this._volumeMultiplier=s,this._previousVolume=s*this._volume,this.audio.volume(this._previousVolume)},AudioElement.prototype.getBaseElement=function(){return null},AudioElement.prototype.destroy=function(){},AudioElement.prototype.sourceRectAtTime=function(){},AudioElement.prototype.initExpressions=function(){};function BaseRenderer(){}BaseRenderer.prototype.checkLayers=function(s){var e,i=this.layers.length,a;for(this.completeLayers=!0,e=i-1;e>=0;e-=1)this.elements[e]||(a=this.layers[e],a.ip-a.st<=s-this.layers[e].st&&a.op-a.st>s-this.layers[e].st&&this.buildItem(e)),this.completeLayers=this.elements[e]?this.completeLayers:!1;this.checkPendingElements()},BaseRenderer.prototype.createItem=function(s){switch(s.ty){case 2:return this.createImage(s);case 0:return this.createComp(s);case 1:return this.createSolid(s);case 3:return this.createNull(s);case 4:return this.createShape(s);case 5:return this.createText(s);case 6:return this.createAudio(s);case 13:return this.createCamera(s);case 15:return this.createFootage(s);default:return this.createNull(s)}},BaseRenderer.prototype.createCamera=function(){throw new Error("You're using a 3d camera. Try the html renderer.")},BaseRenderer.prototype.createAudio=function(s){return new AudioElement(s,this.globalData,this)},BaseRenderer.prototype.createFootage=function(s){return new FootageElement(s,this.globalData,this)},BaseRenderer.prototype.buildAllItems=function(){var s,e=this.layers.length;for(s=0;s<e;s+=1)this.buildItem(s);this.checkPendingElements()},BaseRenderer.prototype.includeLayers=function(s){this.completeLayers=!1;var e,i=s.length,a,o=this.layers.length;for(e=0;e<i;e+=1)for(a=0;a<o;){if(this.layers[a].id===s[e].id){this.layers[a]=s[e];break}a+=1}},BaseRenderer.prototype.setProjectInterface=function(s){this.globalData.projectInterface=s},BaseRenderer.prototype.initItems=function(){this.globalData.progressiveLoad||this.buildAllItems()},BaseRenderer.prototype.buildElementParenting=function(s,e,i){for(var a=this.elements,o=this.layers,c=0,d=o.length;c<d;)o[c].ind==e&&(!a[c]||a[c]===!0?(this.buildItem(c),this.addPendingElement(s)):(i.push(a[c]),a[c].setAsParent(),o[c].parent!==void 0?this.buildElementParenting(s,o[c].parent,i):s.setHierarchy(i))),c+=1},BaseRenderer.prototype.addPendingElement=function(s){this.pendingElements.push(s)},BaseRenderer.prototype.searchExtraCompositions=function(s){var e,i=s.length;for(e=0;e<i;e+=1)if(s[e].xt){var a=this.createComp(s[e]);a.initExpressions(),this.globalData.projectInterface.registerComposition(a)}},BaseRenderer.prototype.getElementById=function(s){var e,i=this.elements.length;for(e=0;e<i;e+=1)if(this.elements[e].data.ind===s)return this.elements[e];return null},BaseRenderer.prototype.getElementByPath=function(s){var e=s.shift(),i;if(typeof e=="number")i=this.elements[e];else{var a,o=this.elements.length;for(a=0;a<o;a+=1)if(this.elements[a].data.nm===e){i=this.elements[a];break}}return s.length===0?i:i.getElementByPath(s)},BaseRenderer.prototype.setupGlobalData=function(s,e){this.globalData.fontManager=new FontManager,this.globalData.slotManager=slotFactory(s),this.globalData.fontManager.addChars(s.chars),this.globalData.fontManager.addFonts(s.fonts,e),this.globalData.getAssetData=this.animationItem.getAssetData.bind(this.animationItem),this.globalData.getAssetsPath=this.animationItem.getAssetsPath.bind(this.animationItem),this.globalData.imageLoader=this.animationItem.imagePreloader,this.globalData.audioController=this.animationItem.audioController,this.globalData.frameId=0,this.globalData.frameRate=s.fr,this.globalData.nm=s.nm,this.globalData.compSize={w:s.w,h:s.h}};var effectTypes={TRANSFORM_EFFECT:"transformEFfect"};function TransformElement(){}TransformElement.prototype={initTransform:function(){var e=new Matrix;this.finalTransform={mProp:this.data.ks?TransformPropertyFactory.getTransformProperty(this,this.data.ks,this):{o:0},_matMdf:!1,_localMatMdf:!1,_opMdf:!1,mat:e,localMat:e,localOpacity:1},this.data.ao&&(this.finalTransform.mProp.autoOriented=!0),this.data.ty},renderTransform:function(){if(this.finalTransform._opMdf=this.finalTransform.mProp.o._mdf||this._isFirstFrame,this.finalTransform._matMdf=this.finalTransform.mProp._mdf||this._isFirstFrame,this.hierarchy){var e,i=this.finalTransform.mat,a=0,o=this.hierarchy.length;if(!this.finalTransform._matMdf)for(;a<o;){if(this.hierarchy[a].finalTransform.mProp._mdf){this.finalTransform._matMdf=!0;break}a+=1}if(this.finalTransform._matMdf)for(e=this.finalTransform.mProp.v.props,i.cloneFromProps(e),a=0;a<o;a+=1)i.multiply(this.hierarchy[a].finalTransform.mProp.v)}(!this.localTransforms||this.finalTransform._matMdf)&&(this.finalTransform._localMatMdf=this.finalTransform._matMdf),this.finalTransform._opMdf&&(this.finalTransform.localOpacity=this.finalTransform.mProp.o.v)},renderLocalTransform:function(){if(this.localTransforms){var e=0,i=this.localTransforms.length;if(this.finalTransform._localMatMdf=this.finalTransform._matMdf,!this.finalTransform._localMatMdf||!this.finalTransform._opMdf)for(;e<i;)this.localTransforms[e]._mdf&&(this.finalTransform._localMatMdf=!0),this.localTransforms[e]._opMdf&&!this.finalTransform._opMdf&&(this.finalTransform.localOpacity=this.finalTransform.mProp.o.v,this.finalTransform._opMdf=!0),e+=1;if(this.finalTransform._localMatMdf){var a=this.finalTransform.localMat;for(this.localTransforms[0].matrix.clone(a),e=1;e<i;e+=1){var o=this.localTransforms[e].matrix;a.multiply(o)}a.multiply(this.finalTransform.mat)}if(this.finalTransform._opMdf){var c=this.finalTransform.localOpacity;for(e=0;e<i;e+=1)c*=this.localTransforms[e].opacity*.01;this.finalTransform.localOpacity=c}}},searchEffectTransforms:function(){if(this.renderableEffectsManager){var e=this.renderableEffectsManager.getEffects(effectTypes.TRANSFORM_EFFECT);if(e.length){this.localTransforms=[],this.finalTransform.localMat=new Matrix;var i=0,a=e.length;for(i=0;i<a;i+=1)this.localTransforms.push(e[i])}}},globalToLocal:function(e){var i=[];i.push(this.finalTransform);for(var a=!0,o=this.comp;a;)o.finalTransform?(o.data.hasMask&&i.splice(0,0,o.finalTransform),o=o.comp):a=!1;var c,d=i.length,g;for(c=0;c<d;c+=1)g=i[c].mat.applyToPointArray(0,0,0),e=[e[0]-g[0],e[1]-g[1],0];return e},mHelper:new Matrix};function MaskElement(s,e,i){this.data=s,this.element=e,this.globalData=i,this.storedData=[],this.masksProperties=this.data.masksProperties||[],this.maskElement=null;var a=this.globalData.defs,o,c=this.masksProperties?this.masksProperties.length:0;this.viewData=createSizedArray(c),this.solidPath="";var d,g=this.masksProperties,b=0,_=[],j,$,_e=createElementID(),tt,et,st,at,rt="clipPath",nt="clip-path";for(o=0;o<c;o+=1)if((g[o].mode!=="a"&&g[o].mode!=="n"||g[o].inv||g[o].o.k!==100||g[o].o.x)&&(rt="mask",nt="mask"),(g[o].mode==="s"||g[o].mode==="i")&&b===0?(tt=createNS("rect"),tt.setAttribute("fill","#ffffff"),tt.setAttribute("width",this.element.comp.data.w||0),tt.setAttribute("height",this.element.comp.data.h||0),_.push(tt)):tt=null,d=createNS("path"),g[o].mode==="n")this.viewData[o]={op:PropertyFactory.getProp(this.element,g[o].o,0,.01,this.element),prop:ShapePropertyFactory.getShapeProp(this.element,g[o],3),elem:d,lastPath:""},a.appendChild(d);else{b+=1,d.setAttribute("fill",g[o].mode==="s"?"#000000":"#ffffff"),d.setAttribute("clip-rule","nonzero");var it;if(g[o].x.k!==0?(rt="mask",nt="mask",at=PropertyFactory.getProp(this.element,g[o].x,0,null,this.element),it=createElementID(),et=createNS("filter"),et.setAttribute("id",it),st=createNS("feMorphology"),st.setAttribute("operator","erode"),st.setAttribute("in","SourceGraphic"),st.setAttribute("radius","0"),et.appendChild(st),a.appendChild(et),d.setAttribute("stroke",g[o].mode==="s"?"#000000":"#ffffff")):(st=null,at=null),this.storedData[o]={elem:d,x:at,expan:st,lastPath:"",lastOperator:"",filterId:it,lastRadius:0},g[o].mode==="i"){$=_.length;var ot=createNS("g");for(j=0;j<$;j+=1)ot.appendChild(_[j]);var lt=createNS("mask");lt.setAttribute("mask-type","alpha"),lt.setAttribute("id",_e+"_"+b),lt.appendChild(d),a.appendChild(lt),ot.setAttribute("mask","url("+getLocationHref()+"#"+_e+"_"+b+")"),_.length=0,_.push(ot)}else _.push(d);g[o].inv&&!this.solidPath&&(this.solidPath=this.createLayerSolidPath()),this.viewData[o]={elem:d,lastPath:"",op:PropertyFactory.getProp(this.element,g[o].o,0,.01,this.element),prop:ShapePropertyFactory.getShapeProp(this.element,g[o],3),invRect:tt},this.viewData[o].prop.k||this.drawPath(g[o],this.viewData[o].prop.v,this.viewData[o])}for(this.maskElement=createNS(rt),c=_.length,o=0;o<c;o+=1)this.maskElement.appendChild(_[o]);b>0&&(this.maskElement.setAttribute("id",_e),this.element.maskedElement.setAttribute(nt,"url("+getLocationHref()+"#"+_e+")"),a.appendChild(this.maskElement)),this.viewData.length&&this.element.addRenderableComponent(this)}MaskElement.prototype.getMaskProperty=function(s){return this.viewData[s].prop},MaskElement.prototype.renderFrame=function(s){var e=this.element.finalTransform.mat,i,a=this.masksProperties.length;for(i=0;i<a;i+=1)if((this.viewData[i].prop._mdf||s)&&this.drawPath(this.masksProperties[i],this.viewData[i].prop.v,this.viewData[i]),(this.viewData[i].op._mdf||s)&&this.viewData[i].elem.setAttribute("fill-opacity",this.viewData[i].op.v),this.masksProperties[i].mode!=="n"&&(this.viewData[i].invRect&&(this.element.finalTransform.mProp._mdf||s)&&this.viewData[i].invRect.setAttribute("transform",e.getInverseMatrix().to2dCSS()),this.storedData[i].x&&(this.storedData[i].x._mdf||s))){var o=this.storedData[i].expan;this.storedData[i].x.v<0?(this.storedData[i].lastOperator!=="erode"&&(this.storedData[i].lastOperator="erode",this.storedData[i].elem.setAttribute("filter","url("+getLocationHref()+"#"+this.storedData[i].filterId+")")),o.setAttribute("radius",-this.storedData[i].x.v)):(this.storedData[i].lastOperator!=="dilate"&&(this.storedData[i].lastOperator="dilate",this.storedData[i].elem.setAttribute("filter",null)),this.storedData[i].elem.setAttribute("stroke-width",this.storedData[i].x.v*2))}},MaskElement.prototype.getMaskelement=function(){return this.maskElement},MaskElement.prototype.createLayerSolidPath=function(){var s="M0,0 ";return s+=" h"+this.globalData.compSize.w,s+=" v"+this.globalData.compSize.h,s+=" h-"+this.globalData.compSize.w,s+=" v-"+this.globalData.compSize.h+" ",s},MaskElement.prototype.drawPath=function(s,e,i){var a=" M"+e.v[0][0]+","+e.v[0][1],o,c;for(c=e._length,o=1;o<c;o+=1)a+=" C"+e.o[o-1][0]+","+e.o[o-1][1]+" "+e.i[o][0]+","+e.i[o][1]+" "+e.v[o][0]+","+e.v[o][1];if(e.c&&c>1&&(a+=" C"+e.o[o-1][0]+","+e.o[o-1][1]+" "+e.i[0][0]+","+e.i[0][1]+" "+e.v[0][0]+","+e.v[0][1]),i.lastPath!==a){var d="";i.elem&&(e.c&&(d=s.inv?this.solidPath+a:a),i.elem.setAttribute("d",d)),i.lastPath=a}},MaskElement.prototype.destroy=function(){this.element=null,this.globalData=null,this.maskElement=null,this.data=null,this.masksProperties=null};var filtersFactory=function(){var s={};s.createFilter=e,s.createAlphaToLuminanceFilter=i;function e(a,o){var c=createNS("filter");return c.setAttribute("id",a),o!==!0&&(c.setAttribute("filterUnits","objectBoundingBox"),c.setAttribute("x","0%"),c.setAttribute("y","0%"),c.setAttribute("width","100%"),c.setAttribute("height","100%")),c}function i(){var a=createNS("feColorMatrix");return a.setAttribute("type","matrix"),a.setAttribute("color-interpolation-filters","sRGB"),a.setAttribute("values","0 0 0 1 0  0 0 0 1 0  0 0 0 1 0  0 0 0 1 1"),a}return s}(),featureSupport=function(){var s={maskType:!0,svgLumaHidden:!0,offscreenCanvas:typeof OffscreenCanvas<"u"};return(/MSIE 10/i.test(navigator.userAgent)||/MSIE 9/i.test(navigator.userAgent)||/rv:11.0/i.test(navigator.userAgent)||/Edge\/\d./i.test(navigator.userAgent))&&(s.maskType=!1),/firefox/i.test(navigator.userAgent)&&(s.svgLumaHidden=!1),s}(),registeredEffects$1={},idPrefix="filter_result_";function SVGEffects(s){var e,i="SourceGraphic",a=s.data.ef?s.data.ef.length:0,o=createElementID(),c=filtersFactory.createFilter(o,!0),d=0;this.filters=[];var g;for(e=0;e<a;e+=1){g=null;var b=s.data.ef[e].ty;if(registeredEffects$1[b]){var _=registeredEffects$1[b].effect;g=new _(c,s.effectsManager.effectElements[e],s,idPrefix+d,i),i=idPrefix+d,registeredEffects$1[b].countsAsEffect&&(d+=1)}g&&this.filters.push(g)}d&&(s.globalData.defs.appendChild(c),s.layerElement.setAttribute("filter","url("+getLocationHref()+"#"+o+")")),this.filters.length&&s.addRenderableComponent(this)}SVGEffects.prototype.renderFrame=function(s){var e,i=this.filters.length;for(e=0;e<i;e+=1)this.filters[e].renderFrame(s)},SVGEffects.prototype.getEffects=function(s){var e,i=this.filters.length,a=[];for(e=0;e<i;e+=1)this.filters[e].type===s&&a.push(this.filters[e]);return a};function registerEffect$1(s,e,i){registeredEffects$1[s]={effect:e,countsAsEffect:i}}function SVGBaseElement(){}SVGBaseElement.prototype={initRendererElement:function(){this.layerElement=createNS("g")},createContainerElements:function(){this.matteElement=createNS("g"),this.transformedElement=this.layerElement,this.maskedElement=this.layerElement,this._sizeChanged=!1;var e=null;if(this.data.td){this.matteMasks={};var i=createNS("g");i.setAttribute("id",this.layerId),i.appendChild(this.layerElement),e=i,this.globalData.defs.appendChild(i)}else this.data.tt?(this.matteElement.appendChild(this.layerElement),e=this.matteElement,this.baseElement=this.matteElement):this.baseElement=this.layerElement;if(this.data.ln&&this.layerElement.setAttribute("id",this.data.ln),this.data.cl&&this.layerElement.setAttribute("class",this.data.cl),this.data.ty===0&&!this.data.hd){var a=createNS("clipPath"),o=createNS("path");o.setAttribute("d","M0,0 L"+this.data.w+",0 L"+this.data.w+","+this.data.h+" L0,"+this.data.h+"z");var c=createElementID();if(a.setAttribute("id",c),a.appendChild(o),this.globalData.defs.appendChild(a),this.checkMasks()){var d=createNS("g");d.setAttribute("clip-path","url("+getLocationHref()+"#"+c+")"),d.appendChild(this.layerElement),this.transformedElement=d,e?e.appendChild(this.transformedElement):this.baseElement=this.transformedElement}else this.layerElement.setAttribute("clip-path","url("+getLocationHref()+"#"+c+")")}this.data.bm!==0&&this.setBlendMode()},renderElement:function(){this.finalTransform._localMatMdf&&this.transformedElement.setAttribute("transform",this.finalTransform.localMat.to2dCSS()),this.finalTransform._opMdf&&this.transformedElement.setAttribute("opacity",this.finalTransform.localOpacity)},destroyBaseElement:function(){this.layerElement=null,this.matteElement=null,this.maskManager.destroy()},getBaseElement:function(){return this.data.hd?null:this.baseElement},createRenderableComponents:function(){this.maskManager=new MaskElement(this.data,this,this.globalData),this.renderableEffectsManager=new SVGEffects(this),this.searchEffectTransforms()},getMatte:function(e){if(this.matteMasks||(this.matteMasks={}),!this.matteMasks[e]){var i=this.layerId+"_"+e,a,o,c,d;if(e===1||e===3){var g=createNS("mask");g.setAttribute("id",i),g.setAttribute("mask-type",e===3?"luminance":"alpha"),c=createNS("use"),c.setAttributeNS("http://www.w3.org/1999/xlink","href","#"+this.layerId),g.appendChild(c),this.globalData.defs.appendChild(g),!featureSupport.maskType&&e===1&&(g.setAttribute("mask-type","luminance"),a=createElementID(),o=filtersFactory.createFilter(a),this.globalData.defs.appendChild(o),o.appendChild(filtersFactory.createAlphaToLuminanceFilter()),d=createNS("g"),d.appendChild(c),g.appendChild(d),d.setAttribute("filter","url("+getLocationHref()+"#"+a+")"))}else if(e===2){var b=createNS("mask");b.setAttribute("id",i),b.setAttribute("mask-type","alpha");var _=createNS("g");b.appendChild(_),a=createElementID(),o=filtersFactory.createFilter(a);var j=createNS("feComponentTransfer");j.setAttribute("in","SourceGraphic"),o.appendChild(j);var $=createNS("feFuncA");$.setAttribute("type","table"),$.setAttribute("tableValues","1.0 0.0"),j.appendChild($),this.globalData.defs.appendChild(o);var _e=createNS("rect");_e.setAttribute("width",this.comp.data.w),_e.setAttribute("height",this.comp.data.h),_e.setAttribute("x","0"),_e.setAttribute("y","0"),_e.setAttribute("fill","#ffffff"),_e.setAttribute("opacity","0"),_.setAttribute("filter","url("+getLocationHref()+"#"+a+")"),_.appendChild(_e),c=createNS("use"),c.setAttributeNS("http://www.w3.org/1999/xlink","href","#"+this.layerId),_.appendChild(c),featureSupport.maskType||(b.setAttribute("mask-type","luminance"),o.appendChild(filtersFactory.createAlphaToLuminanceFilter()),d=createNS("g"),_.appendChild(_e),d.appendChild(this.layerElement),_.appendChild(d)),this.globalData.defs.appendChild(b)}this.matteMasks[e]=i}return this.matteMasks[e]},setMatte:function(e){this.matteElement&&this.matteElement.setAttribute("mask","url("+getLocationHref()+"#"+e+")")}};function HierarchyElement(){}HierarchyElement.prototype={initHierarchy:function(){this.hierarchy=[],this._isParent=!1,this.checkParenting()},setHierarchy:function(e){this.hierarchy=e},setAsParent:function(){this._isParent=!0},checkParenting:function(){this.data.parent!==void 0&&this.comp.buildElementParenting(this,this.data.parent,[])}};function RenderableDOMElement(){}(function(){var s={initElement:function(i,a,o){this.initFrame(),this.initBaseData(i,a,o),this.initTransform(i,a,o),this.initHierarchy(),this.initRenderable(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),this.createContent(),this.hide()},hide:function(){if(!this.hidden&&(!this.isInRange||this.isTransparent)){var i=this.baseElement||this.layerElement;i.style.display="none",this.hidden=!0}},show:function(){if(this.isInRange&&!this.isTransparent){if(!this.data.hd){var i=this.baseElement||this.layerElement;i.style.display="block"}this.hidden=!1,this._isFirstFrame=!0}},renderFrame:function(){this.data.hd||this.hidden||(this.renderTransform(),this.renderRenderable(),this.renderLocalTransform(),this.renderElement(),this.renderInnerContent(),this._isFirstFrame&&(this._isFirstFrame=!1))},renderInnerContent:function(){},prepareFrame:function(i){this._mdf=!1,this.prepareRenderableFrame(i),this.prepareProperties(i,this.isInRange),this.checkTransparency()},destroy:function(){this.innerElem=null,this.destroyBaseElement()}};extendPrototype([RenderableElement,createProxyFunction(s)],RenderableDOMElement)})();function IImageElement(s,e,i){this.assetData=e.getAssetData(s.refId),this.assetData&&this.assetData.sid&&(this.assetData=e.slotManager.getProp(this.assetData)),this.initElement(s,e,i),this.sourceRect={top:0,left:0,width:this.assetData.w,height:this.assetData.h}}extendPrototype([BaseElement,TransformElement,SVGBaseElement,HierarchyElement,FrameElement,RenderableDOMElement],IImageElement),IImageElement.prototype.createContent=function(){var s=this.globalData.getAssetsPath(this.assetData);this.innerElem=createNS("image"),this.innerElem.setAttribute("width",this.assetData.w+"px"),this.innerElem.setAttribute("height",this.assetData.h+"px"),this.innerElem.setAttribute("preserveAspectRatio",this.assetData.pr||this.globalData.renderConfig.imagePreserveAspectRatio),this.innerElem.setAttributeNS("http://www.w3.org/1999/xlink","href",s),this.layerElement.appendChild(this.innerElem)},IImageElement.prototype.sourceRectAtTime=function(){return this.sourceRect};function ProcessedElement(s,e){this.elem=s,this.pos=e}function IShapeElement(){}IShapeElement.prototype={addShapeToModifiers:function(e){var i,a=this.shapeModifiers.length;for(i=0;i<a;i+=1)this.shapeModifiers[i].addShape(e)},isShapeInAnimatedModifiers:function(e){for(var i=0,a=this.shapeModifiers.length;i<a;)if(this.shapeModifiers[i].isAnimatedWithShape(e))return!0;return!1},renderModifiers:function(){if(this.shapeModifiers.length){var e,i=this.shapes.length;for(e=0;e<i;e+=1)this.shapes[e].sh.reset();i=this.shapeModifiers.length;var a;for(e=i-1;e>=0&&(a=this.shapeModifiers[e].processShapes(this._isFirstFrame),!a);e-=1);}},searchProcessedElement:function(e){for(var i=this.processedElements,a=0,o=i.length;a<o;){if(i[a].elem===e)return i[a].pos;a+=1}return 0},addProcessedElement:function(e,i){for(var a=this.processedElements,o=a.length;o;)if(o-=1,a[o].elem===e){a[o].pos=i;return}a.push(new ProcessedElement(e,i))},prepareFrame:function(e){this.prepareRenderableFrame(e),this.prepareProperties(e,this.isInRange)}};var lineCapEnum={1:"butt",2:"round",3:"square"},lineJoinEnum={1:"miter",2:"round",3:"bevel"};function SVGShapeData(s,e,i){this.caches=[],this.styles=[],this.transformers=s,this.lStr="",this.sh=i,this.lvl=e,this._isAnimated=!!i.k;for(var a=0,o=s.length;a<o;){if(s[a].mProps.dynamicProperties.length){this._isAnimated=!0;break}a+=1}}SVGShapeData.prototype.setAsAnimated=function(){this._isAnimated=!0};function SVGStyleData(s,e){this.data=s,this.type=s.ty,this.d="",this.lvl=e,this._mdf=!1,this.closed=s.hd===!0,this.pElem=createNS("path"),this.msElem=null}SVGStyleData.prototype.reset=function(){this.d="",this._mdf=!1};function DashProperty(s,e,i,a){this.elem=s,this.frameId=-1,this.dataProps=createSizedArray(e.length),this.renderer=i,this.k=!1,this.dashStr="",this.dashArray=createTypedArray("float32",e.length?e.length-1:0),this.dashoffset=createTypedArray("float32",1),this.initDynamicPropertyContainer(a);var o,c=e.length||0,d;for(o=0;o<c;o+=1)d=PropertyFactory.getProp(s,e[o].v,0,0,this),this.k=d.k||this.k,this.dataProps[o]={n:e[o].n,p:d};this.k||this.getValue(!0),this._isAnimated=this.k}DashProperty.prototype.getValue=function(s){if(!(this.elem.globalData.frameId===this.frameId&&!s)&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf=this._mdf||s,this._mdf)){var e=0,i=this.dataProps.length;for(this.renderer==="svg"&&(this.dashStr=""),e=0;e<i;e+=1)this.dataProps[e].n!=="o"?this.renderer==="svg"?this.dashStr+=" "+this.dataProps[e].p.v:this.dashArray[e]=this.dataProps[e].p.v:this.dashoffset[0]=this.dataProps[e].p.v}},extendPrototype([DynamicPropertyContainer],DashProperty);function SVGStrokeStyleData(s,e,i){this.initDynamicPropertyContainer(s),this.getValue=this.iterateDynamicProperties,this.o=PropertyFactory.getProp(s,e.o,0,.01,this),this.w=PropertyFactory.getProp(s,e.w,0,null,this),this.d=new DashProperty(s,e.d||{},"svg",this),this.c=PropertyFactory.getProp(s,e.c,1,255,this),this.style=i,this._isAnimated=!!this._isAnimated}extendPrototype([DynamicPropertyContainer],SVGStrokeStyleData);function SVGFillStyleData(s,e,i){this.initDynamicPropertyContainer(s),this.getValue=this.iterateDynamicProperties,this.o=PropertyFactory.getProp(s,e.o,0,.01,this),this.c=PropertyFactory.getProp(s,e.c,1,255,this),this.style=i}extendPrototype([DynamicPropertyContainer],SVGFillStyleData);function SVGNoStyleData(s,e,i){this.initDynamicPropertyContainer(s),this.getValue=this.iterateDynamicProperties,this.style=i}extendPrototype([DynamicPropertyContainer],SVGNoStyleData);function GradientProperty(s,e,i){this.data=e,this.c=createTypedArray("uint8c",e.p*4);var a=e.k.k[0].s?e.k.k[0].s.length-e.p*4:e.k.k.length-e.p*4;this.o=createTypedArray("float32",a),this._cmdf=!1,this._omdf=!1,this._collapsable=this.checkCollapsable(),this._hasOpacity=a,this.initDynamicPropertyContainer(i),this.prop=PropertyFactory.getProp(s,e.k,1,null,this),this.k=this.prop.k,this.getValue(!0)}GradientProperty.prototype.comparePoints=function(s,e){for(var i=0,a=this.o.length/2,o;i<a;){if(o=Math.abs(s[i*4]-s[e*4+i*2]),o>.01)return!1;i+=1}return!0},GradientProperty.prototype.checkCollapsable=function(){if(this.o.length/2!==this.c.length/4)return!1;if(this.data.k.k[0].s)for(var s=0,e=this.data.k.k.length;s<e;){if(!this.comparePoints(this.data.k.k[s].s,this.data.p))return!1;s+=1}else if(!this.comparePoints(this.data.k.k,this.data.p))return!1;return!0},GradientProperty.prototype.getValue=function(s){if(this.prop.getValue(),this._mdf=!1,this._cmdf=!1,this._omdf=!1,this.prop._mdf||s){var e,i=this.data.p*4,a,o;for(e=0;e<i;e+=1)a=e%4===0?100:255,o=Math.round(this.prop.v[e]*a),this.c[e]!==o&&(this.c[e]=o,this._cmdf=!s);if(this.o.length)for(i=this.prop.v.length,e=this.data.p*4;e<i;e+=1)a=e%2===0?100:1,o=e%2===0?Math.round(this.prop.v[e]*100):this.prop.v[e],this.o[e-this.data.p*4]!==o&&(this.o[e-this.data.p*4]=o,this._omdf=!s);this._mdf=!s}},extendPrototype([DynamicPropertyContainer],GradientProperty);function SVGGradientFillStyleData(s,e,i){this.initDynamicPropertyContainer(s),this.getValue=this.iterateDynamicProperties,this.initGradientData(s,e,i)}SVGGradientFillStyleData.prototype.initGradientData=function(s,e,i){this.o=PropertyFactory.getProp(s,e.o,0,.01,this),this.s=PropertyFactory.getProp(s,e.s,1,null,this),this.e=PropertyFactory.getProp(s,e.e,1,null,this),this.h=PropertyFactory.getProp(s,e.h||{k:0},0,.01,this),this.a=PropertyFactory.getProp(s,e.a||{k:0},0,degToRads,this),this.g=new GradientProperty(s,e.g,this),this.style=i,this.stops=[],this.setGradientData(i.pElem,e),this.setGradientOpacity(e,i),this._isAnimated=!!this._isAnimated},SVGGradientFillStyleData.prototype.setGradientData=function(s,e){var i=createElementID(),a=createNS(e.t===1?"linearGradient":"radialGradient");a.setAttribute("id",i),a.setAttribute("spreadMethod","pad"),a.setAttribute("gradientUnits","userSpaceOnUse");var o=[],c,d,g;for(g=e.g.p*4,d=0;d<g;d+=4)c=createNS("stop"),a.appendChild(c),o.push(c);s.setAttribute(e.ty==="gf"?"fill":"stroke","url("+getLocationHref()+"#"+i+")"),this.gf=a,this.cst=o},SVGGradientFillStyleData.prototype.setGradientOpacity=function(s,e){if(this.g._hasOpacity&&!this.g._collapsable){var i,a,o,c=createNS("mask"),d=createNS("path");c.appendChild(d);var g=createElementID(),b=createElementID();c.setAttribute("id",b);var _=createNS(s.t===1?"linearGradient":"radialGradient");_.setAttribute("id",g),_.setAttribute("spreadMethod","pad"),_.setAttribute("gradientUnits","userSpaceOnUse"),o=s.g.k.k[0].s?s.g.k.k[0].s.length:s.g.k.k.length;var j=this.stops;for(a=s.g.p*4;a<o;a+=2)i=createNS("stop"),i.setAttribute("stop-color","rgb(255,255,255)"),_.appendChild(i),j.push(i);d.setAttribute(s.ty==="gf"?"fill":"stroke","url("+getLocationHref()+"#"+g+")"),s.ty==="gs"&&(d.setAttribute("stroke-linecap",lineCapEnum[s.lc||2]),d.setAttribute("stroke-linejoin",lineJoinEnum[s.lj||2]),s.lj===1&&d.setAttribute("stroke-miterlimit",s.ml)),this.of=_,this.ms=c,this.ost=j,this.maskId=b,e.msElem=d}},extendPrototype([DynamicPropertyContainer],SVGGradientFillStyleData);function SVGGradientStrokeStyleData(s,e,i){this.initDynamicPropertyContainer(s),this.getValue=this.iterateDynamicProperties,this.w=PropertyFactory.getProp(s,e.w,0,null,this),this.d=new DashProperty(s,e.d||{},"svg",this),this.initGradientData(s,e,i),this._isAnimated=!!this._isAnimated}extendPrototype([SVGGradientFillStyleData,DynamicPropertyContainer],SVGGradientStrokeStyleData);function ShapeGroupData(){this.it=[],this.prevViewData=[],this.gr=createNS("g")}function SVGTransformData(s,e,i){this.transform={mProps:s,op:e,container:i},this.elements=[],this._isAnimated=this.transform.mProps.dynamicProperties.length||this.transform.op.effectsSequence.length}var buildShapeString=function(e,i,a,o){if(i===0)return"";var c=e.o,d=e.i,g=e.v,b,_=" M"+o.applyToPointStringified(g[0][0],g[0][1]);for(b=1;b<i;b+=1)_+=" C"+o.applyToPointStringified(c[b-1][0],c[b-1][1])+" "+o.applyToPointStringified(d[b][0],d[b][1])+" "+o.applyToPointStringified(g[b][0],g[b][1]);return a&&i&&(_+=" C"+o.applyToPointStringified(c[b-1][0],c[b-1][1])+" "+o.applyToPointStringified(d[0][0],d[0][1])+" "+o.applyToPointStringified(g[0][0],g[0][1]),_+="z"),_},SVGElementsRenderer=function(){var s=new Matrix,e=new Matrix,i={createRenderFunction:a};function a($){switch($.ty){case"fl":return g;case"gf":return _;case"gs":return b;case"st":return j;case"sh":case"el":case"rc":case"sr":return d;case"tr":return o;case"no":return c;default:return null}}function o($,_e,tt){(tt||_e.transform.op._mdf)&&_e.transform.container.setAttribute("opacity",_e.transform.op.v),(tt||_e.transform.mProps._mdf)&&_e.transform.container.setAttribute("transform",_e.transform.mProps.v.to2dCSS())}function c(){}function d($,_e,tt){var et,st,at,rt,nt,it,ot=_e.styles.length,lt=_e.lvl,ct,ht,dt,gt;for(it=0;it<ot;it+=1){if(rt=_e.sh._mdf||tt,_e.styles[it].lvl<lt){for(ht=e.reset(),dt=lt-_e.styles[it].lvl,gt=_e.transformers.length-1;!rt&&dt>0;)rt=_e.transformers[gt].mProps._mdf||rt,dt-=1,gt-=1;if(rt)for(dt=lt-_e.styles[it].lvl,gt=_e.transformers.length-1;dt>0;)ht.multiply(_e.transformers[gt].mProps.v),dt-=1,gt-=1}else ht=s;if(ct=_e.sh.paths,st=ct._length,rt){for(at="",et=0;et<st;et+=1)nt=ct.shapes[et],nt&&nt._length&&(at+=buildShapeString(nt,nt._length,nt.c,ht));_e.caches[it]=at}else at=_e.caches[it];_e.styles[it].d+=$.hd===!0?"":at,_e.styles[it]._mdf=rt||_e.styles[it]._mdf}}function g($,_e,tt){var et=_e.style;(_e.c._mdf||tt)&&et.pElem.setAttribute("fill","rgb("+bmFloor(_e.c.v[0])+","+bmFloor(_e.c.v[1])+","+bmFloor(_e.c.v[2])+")"),(_e.o._mdf||tt)&&et.pElem.setAttribute("fill-opacity",_e.o.v)}function b($,_e,tt){_($,_e,tt),j($,_e,tt)}function _($,_e,tt){var et=_e.gf,st=_e.g._hasOpacity,at=_e.s.v,rt=_e.e.v;if(_e.o._mdf||tt){var nt=$.ty==="gf"?"fill-opacity":"stroke-opacity";_e.style.pElem.setAttribute(nt,_e.o.v)}if(_e.s._mdf||tt){var it=$.t===1?"x1":"cx",ot=it==="x1"?"y1":"cy";et.setAttribute(it,at[0]),et.setAttribute(ot,at[1]),st&&!_e.g._collapsable&&(_e.of.setAttribute(it,at[0]),_e.of.setAttribute(ot,at[1]))}var lt,ct,ht,dt;if(_e.g._cmdf||tt){lt=_e.cst;var gt=_e.g.c;for(ht=lt.length,ct=0;ct<ht;ct+=1)dt=lt[ct],dt.setAttribute("offset",gt[ct*4]+"%"),dt.setAttribute("stop-color","rgb("+gt[ct*4+1]+","+gt[ct*4+2]+","+gt[ct*4+3]+")")}if(st&&(_e.g._omdf||tt)){var vt=_e.g.o;for(_e.g._collapsable?lt=_e.cst:lt=_e.ost,ht=lt.length,ct=0;ct<ht;ct+=1)dt=lt[ct],_e.g._collapsable||dt.setAttribute("offset",vt[ct*2]+"%"),dt.setAttribute("stop-opacity",vt[ct*2+1])}if($.t===1)(_e.e._mdf||tt)&&(et.setAttribute("x2",rt[0]),et.setAttribute("y2",rt[1]),st&&!_e.g._collapsable&&(_e.of.setAttribute("x2",rt[0]),_e.of.setAttribute("y2",rt[1])));else{var St;if((_e.s._mdf||_e.e._mdf||tt)&&(St=Math.sqrt(Math.pow(at[0]-rt[0],2)+Math.pow(at[1]-rt[1],2)),et.setAttribute("r",St),st&&!_e.g._collapsable&&_e.of.setAttribute("r",St)),_e.s._mdf||_e.e._mdf||_e.h._mdf||_e.a._mdf||tt){St||(St=Math.sqrt(Math.pow(at[0]-rt[0],2)+Math.pow(at[1]-rt[1],2)));var Tt=Math.atan2(rt[1]-at[1],rt[0]-at[0]),Ct=_e.h.v;Ct>=1?Ct=.99:Ct<=-1&&(Ct=-.99);var Rt=St*Ct,bt=Math.cos(Tt+_e.a.v)*Rt+at[0],pt=Math.sin(Tt+_e.a.v)*Rt+at[1];et.setAttribute("fx",bt),et.setAttribute("fy",pt),st&&!_e.g._collapsable&&(_e.of.setAttribute("fx",bt),_e.of.setAttribute("fy",pt))}}}function j($,_e,tt){var et=_e.style,st=_e.d;st&&(st._mdf||tt)&&st.dashStr&&(et.pElem.setAttribute("stroke-dasharray",st.dashStr),et.pElem.setAttribute("stroke-dashoffset",st.dashoffset[0])),_e.c&&(_e.c._mdf||tt)&&et.pElem.setAttribute("stroke","rgb("+bmFloor(_e.c.v[0])+","+bmFloor(_e.c.v[1])+","+bmFloor(_e.c.v[2])+")"),(_e.o._mdf||tt)&&et.pElem.setAttribute("stroke-opacity",_e.o.v),(_e.w._mdf||tt)&&(et.pElem.setAttribute("stroke-width",_e.w.v),et.msElem&&et.msElem.setAttribute("stroke-width",_e.w.v))}return i}();function SVGShapeElement(s,e,i){this.shapes=[],this.shapesData=s.shapes,this.stylesList=[],this.shapeModifiers=[],this.itemsData=[],this.processedElements=[],this.animatedContents=[],this.initElement(s,e,i),this.prevViewData=[]}extendPrototype([BaseElement,TransformElement,SVGBaseElement,IShapeElement,HierarchyElement,FrameElement,RenderableDOMElement],SVGShapeElement),SVGShapeElement.prototype.initSecondaryElement=function(){},SVGShapeElement.prototype.identityMatrix=new Matrix,SVGShapeElement.prototype.buildExpressionInterface=function(){},SVGShapeElement.prototype.createContent=function(){this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.layerElement,0,[],!0),this.filterUniqueShapes()},SVGShapeElement.prototype.filterUniqueShapes=function(){var s,e=this.shapes.length,i,a,o=this.stylesList.length,c,d=[],g=!1;for(a=0;a<o;a+=1){for(c=this.stylesList[a],g=!1,d.length=0,s=0;s<e;s+=1)i=this.shapes[s],i.styles.indexOf(c)!==-1&&(d.push(i),g=i._isAnimated||g);d.length>1&&g&&this.setShapesAsAnimated(d)}},SVGShapeElement.prototype.setShapesAsAnimated=function(s){var e,i=s.length;for(e=0;e<i;e+=1)s[e].setAsAnimated()},SVGShapeElement.prototype.createStyleElement=function(s,e){var i,a=new SVGStyleData(s,e),o=a.pElem;if(s.ty==="st")i=new SVGStrokeStyleData(this,s,a);else if(s.ty==="fl")i=new SVGFillStyleData(this,s,a);else if(s.ty==="gf"||s.ty==="gs"){var c=s.ty==="gf"?SVGGradientFillStyleData:SVGGradientStrokeStyleData;i=new c(this,s,a),this.globalData.defs.appendChild(i.gf),i.maskId&&(this.globalData.defs.appendChild(i.ms),this.globalData.defs.appendChild(i.of),o.setAttribute("mask","url("+getLocationHref()+"#"+i.maskId+")"))}else s.ty==="no"&&(i=new SVGNoStyleData(this,s,a));return(s.ty==="st"||s.ty==="gs")&&(o.setAttribute("stroke-linecap",lineCapEnum[s.lc||2]),o.setAttribute("stroke-linejoin",lineJoinEnum[s.lj||2]),o.setAttribute("fill-opacity","0"),s.lj===1&&o.setAttribute("stroke-miterlimit",s.ml)),s.r===2&&o.setAttribute("fill-rule","evenodd"),s.ln&&o.setAttribute("id",s.ln),s.cl&&o.setAttribute("class",s.cl),s.bm&&(o.style["mix-blend-mode"]=getBlendMode(s.bm)),this.stylesList.push(a),this.addToAnimatedContents(s,i),i},SVGShapeElement.prototype.createGroupElement=function(s){var e=new ShapeGroupData;return s.ln&&e.gr.setAttribute("id",s.ln),s.cl&&e.gr.setAttribute("class",s.cl),s.bm&&(e.gr.style["mix-blend-mode"]=getBlendMode(s.bm)),e},SVGShapeElement.prototype.createTransformElement=function(s,e){var i=TransformPropertyFactory.getTransformProperty(this,s,this),a=new SVGTransformData(i,i.o,e);return this.addToAnimatedContents(s,a),a},SVGShapeElement.prototype.createShapeElement=function(s,e,i){var a=4;s.ty==="rc"?a=5:s.ty==="el"?a=6:s.ty==="sr"&&(a=7);var o=ShapePropertyFactory.getShapeProp(this,s,a,this),c=new SVGShapeData(e,i,o);return this.shapes.push(c),this.addShapeToModifiers(c),this.addToAnimatedContents(s,c),c},SVGShapeElement.prototype.addToAnimatedContents=function(s,e){for(var i=0,a=this.animatedContents.length;i<a;){if(this.animatedContents[i].element===e)return;i+=1}this.animatedContents.push({fn:SVGElementsRenderer.createRenderFunction(s),element:e,data:s})},SVGShapeElement.prototype.setElementStyles=function(s){var e=s.styles,i,a=this.stylesList.length;for(i=0;i<a;i+=1)e.indexOf(this.stylesList[i])===-1&&!this.stylesList[i].closed&&e.push(this.stylesList[i])},SVGShapeElement.prototype.reloadShapes=function(){this._isFirstFrame=!0;var s,e=this.itemsData.length;for(s=0;s<e;s+=1)this.prevViewData[s]=this.itemsData[s];for(this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.layerElement,0,[],!0),this.filterUniqueShapes(),e=this.dynamicProperties.length,s=0;s<e;s+=1)this.dynamicProperties[s].getValue();this.renderModifiers()},SVGShapeElement.prototype.searchShapes=function(s,e,i,a,o,c,d){var g=[].concat(c),b,_=s.length-1,j,$,_e=[],tt=[],et,st,at;for(b=_;b>=0;b-=1){if(at=this.searchProcessedElement(s[b]),at?e[b]=i[at-1]:s[b]._render=d,s[b].ty==="fl"||s[b].ty==="st"||s[b].ty==="gf"||s[b].ty==="gs"||s[b].ty==="no")at?e[b].style.closed=s[b].hd:e[b]=this.createStyleElement(s[b],o),s[b]._render&&e[b].style.pElem.parentNode!==a&&a.appendChild(e[b].style.pElem),_e.push(e[b].style);else if(s[b].ty==="gr"){if(!at)e[b]=this.createGroupElement(s[b]);else for($=e[b].it.length,j=0;j<$;j+=1)e[b].prevViewData[j]=e[b].it[j];this.searchShapes(s[b].it,e[b].it,e[b].prevViewData,e[b].gr,o+1,g,d),s[b]._render&&e[b].gr.parentNode!==a&&a.appendChild(e[b].gr)}else s[b].ty==="tr"?(at||(e[b]=this.createTransformElement(s[b],a)),et=e[b].transform,g.push(et)):s[b].ty==="sh"||s[b].ty==="rc"||s[b].ty==="el"||s[b].ty==="sr"?(at||(e[b]=this.createShapeElement(s[b],g,o)),this.setElementStyles(e[b])):s[b].ty==="tm"||s[b].ty==="rd"||s[b].ty==="ms"||s[b].ty==="pb"||s[b].ty==="zz"||s[b].ty==="op"?(at?(st=e[b],st.closed=!1):(st=ShapeModifiers.getModifier(s[b].ty),st.init(this,s[b]),e[b]=st,this.shapeModifiers.push(st)),tt.push(st)):s[b].ty==="rp"&&(at?(st=e[b],st.closed=!0):(st=ShapeModifiers.getModifier(s[b].ty),e[b]=st,st.init(this,s,b,e),this.shapeModifiers.push(st),d=!1),tt.push(st));this.addProcessedElement(s[b],b+1)}for(_=_e.length,b=0;b<_;b+=1)_e[b].closed=!0;for(_=tt.length,b=0;b<_;b+=1)tt[b].closed=!0},SVGShapeElement.prototype.renderInnerContent=function(){this.renderModifiers();var s,e=this.stylesList.length;for(s=0;s<e;s+=1)this.stylesList[s].reset();for(this.renderShape(),s=0;s<e;s+=1)(this.stylesList[s]._mdf||this._isFirstFrame)&&(this.stylesList[s].msElem&&(this.stylesList[s].msElem.setAttribute("d",this.stylesList[s].d),this.stylesList[s].d="M0 0"+this.stylesList[s].d),this.stylesList[s].pElem.setAttribute("d",this.stylesList[s].d||"M0 0"))},SVGShapeElement.prototype.renderShape=function(){var s,e=this.animatedContents.length,i;for(s=0;s<e;s+=1)i=this.animatedContents[s],(this._isFirstFrame||i.element._isAnimated)&&i.data!==!0&&i.fn(i.data,i.element,this._isFirstFrame)},SVGShapeElement.prototype.destroy=function(){this.destroyBaseElement(),this.shapesData=null,this.itemsData=null};function LetterProps(s,e,i,a,o,c){this.o=s,this.sw=e,this.sc=i,this.fc=a,this.m=o,this.p=c,this._mdf={o:!0,sw:!!e,sc:!!i,fc:!!a,m:!0,p:!0}}LetterProps.prototype.update=function(s,e,i,a,o,c){this._mdf.o=!1,this._mdf.sw=!1,this._mdf.sc=!1,this._mdf.fc=!1,this._mdf.m=!1,this._mdf.p=!1;var d=!1;return this.o!==s&&(this.o=s,this._mdf.o=!0,d=!0),this.sw!==e&&(this.sw=e,this._mdf.sw=!0,d=!0),this.sc!==i&&(this.sc=i,this._mdf.sc=!0,d=!0),this.fc!==a&&(this.fc=a,this._mdf.fc=!0,d=!0),this.m!==o&&(this.m=o,this._mdf.m=!0,d=!0),c.length&&(this.p[0]!==c[0]||this.p[1]!==c[1]||this.p[4]!==c[4]||this.p[5]!==c[5]||this.p[12]!==c[12]||this.p[13]!==c[13])&&(this.p=c,this._mdf.p=!0,d=!0),d};function TextProperty(s,e){this._frameId=initialDefaultFrame,this.pv="",this.v="",this.kf=!1,this._isFirstFrame=!0,this._mdf=!1,e.d&&e.d.sid&&(e.d=s.globalData.slotManager.getProp(e.d)),this.data=e,this.elem=s,this.comp=this.elem.comp,this.keysIndex=0,this.canResize=!1,this.minimumFontSize=1,this.effectsSequence=[],this.currentData={ascent:0,boxWidth:this.defaultBoxWidth,f:"",fStyle:"",fWeight:"",fc:"",j:"",justifyOffset:"",l:[],lh:0,lineWidths:[],ls:"",of:"",s:"",sc:"",sw:0,t:0,tr:0,sz:0,ps:null,fillColorAnim:!1,strokeColorAnim:!1,strokeWidthAnim:!1,yOffset:0,finalSize:0,finalText:[],finalLineHeight:0,__complete:!1},this.copyData(this.currentData,this.data.d.k[0].s),this.searchProperty()||this.completeTextData(this.currentData)}TextProperty.prototype.defaultBoxWidth=[0,0],TextProperty.prototype.copyData=function(s,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(s[i]=e[i]);return s},TextProperty.prototype.setCurrentData=function(s){s.__complete||this.completeTextData(s),this.currentData=s,this.currentData.boxWidth=this.currentData.boxWidth||this.defaultBoxWidth,this._mdf=!0},TextProperty.prototype.searchProperty=function(){return this.searchKeyframes()},TextProperty.prototype.searchKeyframes=function(){return this.kf=this.data.d.k.length>1,this.kf&&this.addEffect(this.getKeyframeValue.bind(this)),this.kf},TextProperty.prototype.addEffect=function(s){this.effectsSequence.push(s),this.elem.addDynamicProperty(this)},TextProperty.prototype.getValue=function(s){if(!((this.elem.globalData.frameId===this.frameId||!this.effectsSequence.length)&&!s)){this.currentData.t=this.data.d.k[this.keysIndex].s.t;var e=this.currentData,i=this.keysIndex;if(this.lock){this.setCurrentData(this.currentData);return}this.lock=!0,this._mdf=!1;var a,o=this.effectsSequence.length,c=s||this.data.d.k[this.keysIndex].s;for(a=0;a<o;a+=1)i!==this.keysIndex?c=this.effectsSequence[a](c,c.t):c=this.effectsSequence[a](this.currentData,c.t);e!==c&&this.setCurrentData(c),this.v=this.currentData,this.pv=this.v,this.lock=!1,this.frameId=this.elem.globalData.frameId}},TextProperty.prototype.getKeyframeValue=function(){for(var s=this.data.d.k,e=this.elem.comp.renderedFrame,i=0,a=s.length;i<=a-1&&!(i===a-1||s[i+1].t>e);)i+=1;return this.keysIndex!==i&&(this.keysIndex=i),this.data.d.k[this.keysIndex].s},TextProperty.prototype.buildFinalText=function(s){for(var e=[],i=0,a=s.length,o,c,d=!1,g=!1,b="";i<a;)d=g,g=!1,o=s.charCodeAt(i),b=s.charAt(i),FontManager.isCombinedCharacter(o)?d=!0:o>=55296&&o<=56319?FontManager.isRegionalFlag(s,i)?b=s.substr(i,14):(c=s.charCodeAt(i+1),c>=56320&&c<=57343&&(FontManager.isModifier(o,c)?(b=s.substr(i,2),d=!0):FontManager.isFlagEmoji(s.substr(i,4))?b=s.substr(i,4):b=s.substr(i,2))):o>56319?(c=s.charCodeAt(i+1),FontManager.isVariationSelector(o)&&(d=!0)):FontManager.isZeroWidthJoiner(o)&&(d=!0,g=!0),d?(e[e.length-1]+=b,d=!1):e.push(b),i+=b.length;return e},TextProperty.prototype.completeTextData=function(s){s.__complete=!0;var e=this.elem.globalData.fontManager,i=this.data,a=[],o,c,d,g=0,b,_=i.m.g,j=0,$=0,_e=0,tt=[],et=0,st=0,at,rt,nt=e.getFontByName(s.f),it,ot=0,lt=getFontProperties(nt);s.fWeight=lt.weight,s.fStyle=lt.style,s.finalSize=s.s,s.finalText=this.buildFinalText(s.t),c=s.finalText.length,s.finalLineHeight=s.lh;var ct=s.tr/1e3*s.finalSize,ht;if(s.sz)for(var dt=!0,gt=s.sz[0],vt=s.sz[1],St,Tt;dt;){Tt=this.buildFinalText(s.t),St=0,et=0,c=Tt.length,ct=s.tr/1e3*s.finalSize;var Ct=-1;for(o=0;o<c;o+=1)ht=Tt[o].charCodeAt(0),d=!1,Tt[o]===" "?Ct=o:(ht===13||ht===3)&&(et=0,d=!0,St+=s.finalLineHeight||s.finalSize*1.2),e.chars?(it=e.getCharData(Tt[o],nt.fStyle,nt.fFamily),ot=d?0:it.w*s.finalSize/100):ot=e.measureText(Tt[o],s.f,s.finalSize),et+ot>gt&&Tt[o]!==" "?(Ct===-1?c+=1:o=Ct,St+=s.finalLineHeight||s.finalSize*1.2,Tt.splice(o,Ct===o?1:0,"\r"),Ct=-1,et=0):(et+=ot,et+=ct);St+=nt.ascent*s.finalSize/100,this.canResize&&s.finalSize>this.minimumFontSize&&vt<St?(s.finalSize-=1,s.finalLineHeight=s.finalSize*s.lh/s.s):(s.finalText=Tt,c=s.finalText.length,dt=!1)}et=-ct,ot=0;var Rt=0,bt;for(o=0;o<c;o+=1)if(d=!1,bt=s.finalText[o],ht=bt.charCodeAt(0),ht===13||ht===3?(Rt=0,tt.push(et),st=et>st?et:st,et=-2*ct,b="",d=!0,_e+=1):b=bt,e.chars?(it=e.getCharData(bt,nt.fStyle,e.getFontByName(s.f).fFamily),ot=d?0:it.w*s.finalSize/100):ot=e.measureText(b,s.f,s.finalSize),bt===" "?Rt+=ot+ct:(et+=ot+ct+Rt,Rt=0),a.push({l:ot,an:ot,add:j,n:d,anIndexes:[],val:b,line:_e,animatorJustifyOffset:0}),_==2){if(j+=ot,b===""||b===" "||o===c-1){for((b===""||b===" ")&&(j-=ot);$<=o;)a[$].an=j,a[$].ind=g,a[$].extra=ot,$+=1;g+=1,j=0}}else if(_==3){if(j+=ot,b===""||o===c-1){for(b===""&&(j-=ot);$<=o;)a[$].an=j,a[$].ind=g,a[$].extra=ot,$+=1;j=0,g+=1}}else a[g].ind=g,a[g].extra=0,g+=1;if(s.l=a,st=et>st?et:st,tt.push(et),s.sz)s.boxWidth=s.sz[0],s.justifyOffset=0;else switch(s.boxWidth=st,s.j){case 1:s.justifyOffset=-s.boxWidth;break;case 2:s.justifyOffset=-s.boxWidth/2;break;default:s.justifyOffset=0}s.lineWidths=tt;var pt=i.a,yt,ut;rt=pt.length;var ft,xt,mt=[];for(at=0;at<rt;at+=1){for(yt=pt[at],yt.a.sc&&(s.strokeColorAnim=!0),yt.a.sw&&(s.strokeWidthAnim=!0),(yt.a.fc||yt.a.fh||yt.a.fs||yt.a.fb)&&(s.fillColorAnim=!0),xt=0,ft=yt.s.b,o=0;o<c;o+=1)ut=a[o],ut.anIndexes[at]=xt,(ft==1&&ut.val!==""||ft==2&&ut.val!==""&&ut.val!==" "||ft==3&&(ut.n||ut.val==" "||o==c-1)||ft==4&&(ut.n||o==c-1))&&(yt.s.rn===1&&mt.push(xt),xt+=1);i.a[at].s.totalChars=xt;var Et=-1,At;if(yt.s.rn===1)for(o=0;o<c;o+=1)ut=a[o],Et!=ut.anIndexes[at]&&(Et=ut.anIndexes[at],At=mt.splice(Math.floor(Math.random()*mt.length),1)[0]),ut.anIndexes[at]=At}s.yOffset=s.finalLineHeight||s.finalSize*1.2,s.ls=s.ls||0,s.ascent=nt.ascent*s.finalSize/100},TextProperty.prototype.updateDocumentData=function(s,e){e=e===void 0?this.keysIndex:e;var i=this.copyData({},this.data.d.k[e].s);i=this.copyData(i,s),this.data.d.k[e].s=i,this.recalculate(e),this.setCurrentData(i),this.elem.addDynamicProperty(this)},TextProperty.prototype.recalculate=function(s){var e=this.data.d.k[s].s;e.__complete=!1,this.keysIndex=0,this._isFirstFrame=!0,this.getValue(e)},TextProperty.prototype.canResizeFont=function(s){this.canResize=s,this.recalculate(this.keysIndex),this.elem.addDynamicProperty(this)},TextProperty.prototype.setMinimumFontSize=function(s){this.minimumFontSize=Math.floor(s)||1,this.recalculate(this.keysIndex),this.elem.addDynamicProperty(this)};var TextSelectorProp=function(){var s=Math.max,e=Math.min,i=Math.floor;function a(c,d){this._currentTextLength=-1,this.k=!1,this.data=d,this.elem=c,this.comp=c.comp,this.finalS=0,this.finalE=0,this.initDynamicPropertyContainer(c),this.s=PropertyFactory.getProp(c,d.s||{k:0},0,0,this),"e"in d?this.e=PropertyFactory.getProp(c,d.e,0,0,this):this.e={v:100},this.o=PropertyFactory.getProp(c,d.o||{k:0},0,0,this),this.xe=PropertyFactory.getProp(c,d.xe||{k:0},0,0,this),this.ne=PropertyFactory.getProp(c,d.ne||{k:0},0,0,this),this.sm=PropertyFactory.getProp(c,d.sm||{k:100},0,0,this),this.a=PropertyFactory.getProp(c,d.a,0,.01,this),this.dynamicProperties.length||this.getValue()}a.prototype={getMult:function(d){this._currentTextLength!==this.elem.textProperty.currentData.l.length&&this.getValue();var g=0,b=0,_=1,j=1;this.ne.v>0?g=this.ne.v/100:b=-this.ne.v/100,this.xe.v>0?_=1-this.xe.v/100:j=1+this.xe.v/100;var $=BezierFactory.getBezierEasing(g,b,_,j).get,_e=0,tt=this.finalS,et=this.finalE,st=this.data.sh;if(st===2)et===tt?_e=d>=et?1:0:_e=s(0,e(.5/(et-tt)+(d-tt)/(et-tt),1)),_e=$(_e);else if(st===3)et===tt?_e=d>=et?0:1:_e=1-s(0,e(.5/(et-tt)+(d-tt)/(et-tt),1)),_e=$(_e);else if(st===4)et===tt?_e=0:(_e=s(0,e(.5/(et-tt)+(d-tt)/(et-tt),1)),_e<.5?_e*=2:_e=1-2*(_e-.5)),_e=$(_e);else if(st===5){if(et===tt)_e=0;else{var at=et-tt;d=e(s(0,d+.5-tt),et-tt);var rt=-at/2+d,nt=at/2;_e=Math.sqrt(1-rt*rt/(nt*nt))}_e=$(_e)}else st===6?(et===tt?_e=0:(d=e(s(0,d+.5-tt),et-tt),_e=(1+Math.cos(Math.PI+Math.PI*2*d/(et-tt)))/2),_e=$(_e)):(d>=i(tt)&&(d-tt<0?_e=s(0,e(e(et,1)-(tt-d),1)):_e=s(0,e(et-d,1))),_e=$(_e));if(this.sm.v!==100){var it=this.sm.v*.01;it===0&&(it=1e-8);var ot=.5-it*.5;_e<ot?_e=0:(_e=(_e-ot)/it,_e>1&&(_e=1))}return _e*this.a.v},getValue:function(d){this.iterateDynamicProperties(),this._mdf=d||this._mdf,this._currentTextLength=this.elem.textProperty.currentData.l.length||0,d&&this.data.r===2&&(this.e.v=this._currentTextLength);var g=this.data.r===2?1:100/this.data.totalChars,b=this.o.v/g,_=this.s.v/g+b,j=this.e.v/g+b;if(_>j){var $=_;_=j,j=$}this.finalS=_,this.finalE=j}},extendPrototype([DynamicPropertyContainer],a);function o(c,d,g){return new a(c,d)}return{getTextSelectorProp:o}}();function TextAnimatorDataProperty(s,e,i){var a={propType:!1},o=PropertyFactory.getProp,c=e.a;this.a={r:c.r?o(s,c.r,0,degToRads,i):a,rx:c.rx?o(s,c.rx,0,degToRads,i):a,ry:c.ry?o(s,c.ry,0,degToRads,i):a,sk:c.sk?o(s,c.sk,0,degToRads,i):a,sa:c.sa?o(s,c.sa,0,degToRads,i):a,s:c.s?o(s,c.s,1,.01,i):a,a:c.a?o(s,c.a,1,0,i):a,o:c.o?o(s,c.o,0,.01,i):a,p:c.p?o(s,c.p,1,0,i):a,sw:c.sw?o(s,c.sw,0,0,i):a,sc:c.sc?o(s,c.sc,1,0,i):a,fc:c.fc?o(s,c.fc,1,0,i):a,fh:c.fh?o(s,c.fh,0,0,i):a,fs:c.fs?o(s,c.fs,0,.01,i):a,fb:c.fb?o(s,c.fb,0,.01,i):a,t:c.t?o(s,c.t,0,0,i):a},this.s=TextSelectorProp.getTextSelectorProp(s,e.s,i),this.s.t=e.s.t}function TextAnimatorProperty(s,e,i){this._isFirstFrame=!0,this._hasMaskedPath=!1,this._frameId=-1,this._textData=s,this._renderType=e,this._elem=i,this._animatorsData=createSizedArray(this._textData.a.length),this._pathData={},this._moreOptions={alignment:{}},this.renderedLetters=[],this.lettersChangedFlag=!1,this.initDynamicPropertyContainer(i)}TextAnimatorProperty.prototype.searchProperties=function(){var s,e=this._textData.a.length,i,a=PropertyFactory.getProp;for(s=0;s<e;s+=1)i=this._textData.a[s],this._animatorsData[s]=new TextAnimatorDataProperty(this._elem,i,this);this._textData.p&&"m"in this._textData.p?(this._pathData={a:a(this._elem,this._textData.p.a,0,0,this),f:a(this._elem,this._textData.p.f,0,0,this),l:a(this._elem,this._textData.p.l,0,0,this),r:a(this._elem,this._textData.p.r,0,0,this),p:a(this._elem,this._textData.p.p,0,0,this),m:this._elem.maskManager.getMaskProperty(this._textData.p.m)},this._hasMaskedPath=!0):this._hasMaskedPath=!1,this._moreOptions.alignment=a(this._elem,this._textData.m.a,1,0,this)},TextAnimatorProperty.prototype.getMeasures=function(s,e){if(this.lettersChangedFlag=e,!(!this._mdf&&!this._isFirstFrame&&!e&&(!this._hasMaskedPath||!this._pathData.m._mdf))){this._isFirstFrame=!1;var i=this._moreOptions.alignment.v,a=this._animatorsData,o=this._textData,c=this.mHelper,d=this._renderType,g=this.renderedLetters.length,b,_,j,$,_e=s.l,tt,et,st,at,rt,nt,it,ot,lt,ct,ht,dt,gt,vt,St;if(this._hasMaskedPath){if(St=this._pathData.m,!this._pathData.n||this._pathData._mdf){var Tt=St.v;this._pathData.r.v&&(Tt=Tt.reverse()),tt={tLength:0,segments:[]},$=Tt._length-1;var Ct;for(dt=0,j=0;j<$;j+=1)Ct=bez.buildBezierData(Tt.v[j],Tt.v[j+1],[Tt.o[j][0]-Tt.v[j][0],Tt.o[j][1]-Tt.v[j][1]],[Tt.i[j+1][0]-Tt.v[j+1][0],Tt.i[j+1][1]-Tt.v[j+1][1]]),tt.tLength+=Ct.segmentLength,tt.segments.push(Ct),dt+=Ct.segmentLength;j=$,St.v.c&&(Ct=bez.buildBezierData(Tt.v[j],Tt.v[0],[Tt.o[j][0]-Tt.v[j][0],Tt.o[j][1]-Tt.v[j][1]],[Tt.i[0][0]-Tt.v[0][0],Tt.i[0][1]-Tt.v[0][1]]),tt.tLength+=Ct.segmentLength,tt.segments.push(Ct),dt+=Ct.segmentLength),this._pathData.pi=tt}if(tt=this._pathData.pi,et=this._pathData.f.v,it=0,nt=1,at=0,rt=!0,ct=tt.segments,et<0&&St.v.c)for(tt.tLength<Math.abs(et)&&(et=-Math.abs(et)%tt.tLength),it=ct.length-1,lt=ct[it].points,nt=lt.length-1;et<0;)et+=lt[nt].partialLength,nt-=1,nt<0&&(it-=1,lt=ct[it].points,nt=lt.length-1);lt=ct[it].points,ot=lt[nt-1],st=lt[nt],ht=st.partialLength}$=_e.length,b=0,_=0;var Rt=s.finalSize*1.2*.714,bt=!0,pt,yt,ut,ft,xt;ft=a.length;var mt,Et=-1,At,Pt,wt,It=et,Mt=it,Bt=nt,Gt=-1,Ft,Ut,Xt,kt,Lt,Wt,Nt,Kt,Qt="",tr=this.defaultPropsArray,zt;if(s.j===2||s.j===1){var Zt=0,_t=0,$t=s.j===2?-.5:-1,Ht=0,Vt=!0;for(j=0;j<$;j+=1)if(_e[j].n){for(Zt&&(Zt+=_t);Ht<j;)_e[Ht].animatorJustifyOffset=Zt,Ht+=1;Zt=0,Vt=!0}else{for(ut=0;ut<ft;ut+=1)pt=a[ut].a,pt.t.propType&&(Vt&&s.j===2&&(_t+=pt.t.v*$t),yt=a[ut].s,mt=yt.getMult(_e[j].anIndexes[ut],o.a[ut].s.totalChars),mt.length?Zt+=pt.t.v*mt[0]*$t:Zt+=pt.t.v*mt*$t);Vt=!1}for(Zt&&(Zt+=_t);Ht<j;)_e[Ht].animatorJustifyOffset=Zt,Ht+=1}for(j=0;j<$;j+=1){if(c.reset(),Ft=1,_e[j].n)b=0,_+=s.yOffset,_+=bt?1:0,et=It,bt=!1,this._hasMaskedPath&&(it=Mt,nt=Bt,lt=ct[it].points,ot=lt[nt-1],st=lt[nt],ht=st.partialLength,at=0),Qt="",Kt="",Wt="",zt="",tr=this.defaultPropsArray;else{if(this._hasMaskedPath){if(Gt!==_e[j].line){switch(s.j){case 1:et+=dt-s.lineWidths[_e[j].line];break;case 2:et+=(dt-s.lineWidths[_e[j].line])/2;break}Gt=_e[j].line}Et!==_e[j].ind&&(_e[Et]&&(et+=_e[Et].extra),et+=_e[j].an/2,Et=_e[j].ind),et+=i[0]*_e[j].an*.005;var jt=0;for(ut=0;ut<ft;ut+=1)pt=a[ut].a,pt.p.propType&&(yt=a[ut].s,mt=yt.getMult(_e[j].anIndexes[ut],o.a[ut].s.totalChars),mt.length?jt+=pt.p.v[0]*mt[0]:jt+=pt.p.v[0]*mt),pt.a.propType&&(yt=a[ut].s,mt=yt.getMult(_e[j].anIndexes[ut],o.a[ut].s.totalChars),mt.length?jt+=pt.a.v[0]*mt[0]:jt+=pt.a.v[0]*mt);for(rt=!0,this._pathData.a.v&&(et=_e[0].an*.5+(dt-this._pathData.f.v-_e[0].an*.5-_e[_e.length-1].an*.5)*Et/($-1),et+=this._pathData.f.v);rt;)at+ht>=et+jt||!lt?(gt=(et+jt-at)/st.partialLength,Pt=ot.point[0]+(st.point[0]-ot.point[0])*gt,wt=ot.point[1]+(st.point[1]-ot.point[1])*gt,c.translate(-i[0]*_e[j].an*.005,-(i[1]*Rt)*.01),rt=!1):lt&&(at+=st.partialLength,nt+=1,nt>=lt.length&&(nt=0,it+=1,ct[it]?lt=ct[it].points:St.v.c?(nt=0,it=0,lt=ct[it].points):(at-=st.partialLength,lt=null)),lt&&(ot=st,st=lt[nt],ht=st.partialLength));At=_e[j].an/2-_e[j].add,c.translate(-At,0,0)}else At=_e[j].an/2-_e[j].add,c.translate(-At,0,0),c.translate(-i[0]*_e[j].an*.005,-i[1]*Rt*.01,0);for(ut=0;ut<ft;ut+=1)pt=a[ut].a,pt.t.propType&&(yt=a[ut].s,mt=yt.getMult(_e[j].anIndexes[ut],o.a[ut].s.totalChars),(b!==0||s.j!==0)&&(this._hasMaskedPath?mt.length?et+=pt.t.v*mt[0]:et+=pt.t.v*mt:mt.length?b+=pt.t.v*mt[0]:b+=pt.t.v*mt));for(s.strokeWidthAnim&&(Xt=s.sw||0),s.strokeColorAnim&&(s.sc?Ut=[s.sc[0],s.sc[1],s.sc[2]]:Ut=[0,0,0]),s.fillColorAnim&&s.fc&&(kt=[s.fc[0],s.fc[1],s.fc[2]]),ut=0;ut<ft;ut+=1)pt=a[ut].a,pt.a.propType&&(yt=a[ut].s,mt=yt.getMult(_e[j].anIndexes[ut],o.a[ut].s.totalChars),mt.length?c.translate(-pt.a.v[0]*mt[0],-pt.a.v[1]*mt[1],pt.a.v[2]*mt[2]):c.translate(-pt.a.v[0]*mt,-pt.a.v[1]*mt,pt.a.v[2]*mt));for(ut=0;ut<ft;ut+=1)pt=a[ut].a,pt.s.propType&&(yt=a[ut].s,mt=yt.getMult(_e[j].anIndexes[ut],o.a[ut].s.totalChars),mt.length?c.scale(1+(pt.s.v[0]-1)*mt[0],1+(pt.s.v[1]-1)*mt[1],1):c.scale(1+(pt.s.v[0]-1)*mt,1+(pt.s.v[1]-1)*mt,1));for(ut=0;ut<ft;ut+=1){if(pt=a[ut].a,yt=a[ut].s,mt=yt.getMult(_e[j].anIndexes[ut],o.a[ut].s.totalChars),pt.sk.propType&&(mt.length?c.skewFromAxis(-pt.sk.v*mt[0],pt.sa.v*mt[1]):c.skewFromAxis(-pt.sk.v*mt,pt.sa.v*mt)),pt.r.propType&&(mt.length?c.rotateZ(-pt.r.v*mt[2]):c.rotateZ(-pt.r.v*mt)),pt.ry.propType&&(mt.length?c.rotateY(pt.ry.v*mt[1]):c.rotateY(pt.ry.v*mt)),pt.rx.propType&&(mt.length?c.rotateX(pt.rx.v*mt[0]):c.rotateX(pt.rx.v*mt)),pt.o.propType&&(mt.length?Ft+=(pt.o.v*mt[0]-Ft)*mt[0]:Ft+=(pt.o.v*mt-Ft)*mt),s.strokeWidthAnim&&pt.sw.propType&&(mt.length?Xt+=pt.sw.v*mt[0]:Xt+=pt.sw.v*mt),s.strokeColorAnim&&pt.sc.propType)for(Lt=0;Lt<3;Lt+=1)mt.length?Ut[Lt]+=(pt.sc.v[Lt]-Ut[Lt])*mt[0]:Ut[Lt]+=(pt.sc.v[Lt]-Ut[Lt])*mt;if(s.fillColorAnim&&s.fc){if(pt.fc.propType)for(Lt=0;Lt<3;Lt+=1)mt.length?kt[Lt]+=(pt.fc.v[Lt]-kt[Lt])*mt[0]:kt[Lt]+=(pt.fc.v[Lt]-kt[Lt])*mt;pt.fh.propType&&(mt.length?kt=addHueToRGB(kt,pt.fh.v*mt[0]):kt=addHueToRGB(kt,pt.fh.v*mt)),pt.fs.propType&&(mt.length?kt=addSaturationToRGB(kt,pt.fs.v*mt[0]):kt=addSaturationToRGB(kt,pt.fs.v*mt)),pt.fb.propType&&(mt.length?kt=addBrightnessToRGB(kt,pt.fb.v*mt[0]):kt=addBrightnessToRGB(kt,pt.fb.v*mt))}}for(ut=0;ut<ft;ut+=1)pt=a[ut].a,pt.p.propType&&(yt=a[ut].s,mt=yt.getMult(_e[j].anIndexes[ut],o.a[ut].s.totalChars),this._hasMaskedPath?mt.length?c.translate(0,pt.p.v[1]*mt[0],-pt.p.v[2]*mt[1]):c.translate(0,pt.p.v[1]*mt,-pt.p.v[2]*mt):mt.length?c.translate(pt.p.v[0]*mt[0],pt.p.v[1]*mt[1],-pt.p.v[2]*mt[2]):c.translate(pt.p.v[0]*mt,pt.p.v[1]*mt,-pt.p.v[2]*mt));if(s.strokeWidthAnim&&(Wt=Xt<0?0:Xt),s.strokeColorAnim&&(Nt="rgb("+Math.round(Ut[0]*255)+","+Math.round(Ut[1]*255)+","+Math.round(Ut[2]*255)+")"),s.fillColorAnim&&s.fc&&(Kt="rgb("+Math.round(kt[0]*255)+","+Math.round(kt[1]*255)+","+Math.round(kt[2]*255)+")"),this._hasMaskedPath){if(c.translate(0,-s.ls),c.translate(0,i[1]*Rt*.01+_,0),this._pathData.p.v){vt=(st.point[1]-ot.point[1])/(st.point[0]-ot.point[0]);var er=Math.atan(vt)*180/Math.PI;st.point[0]<ot.point[0]&&(er+=180),c.rotate(-er*Math.PI/180)}c.translate(Pt,wt,0),et-=i[0]*_e[j].an*.005,_e[j+1]&&Et!==_e[j+1].ind&&(et+=_e[j].an/2,et+=s.tr*.001*s.finalSize)}else{switch(c.translate(b,_,0),s.ps&&c.translate(s.ps[0],s.ps[1]+s.ascent,0),s.j){case 1:c.translate(_e[j].animatorJustifyOffset+s.justifyOffset+(s.boxWidth-s.lineWidths[_e[j].line]),0,0);break;case 2:c.translate(_e[j].animatorJustifyOffset+s.justifyOffset+(s.boxWidth-s.lineWidths[_e[j].line])/2,0,0);break}c.translate(0,-s.ls),c.translate(At,0,0),c.translate(i[0]*_e[j].an*.005,i[1]*Rt*.01,0),b+=_e[j].l+s.tr*.001*s.finalSize}d==="html"?Qt=c.toCSS():d==="svg"?Qt=c.to2dCSS():tr=[c.props[0],c.props[1],c.props[2],c.props[3],c.props[4],c.props[5],c.props[6],c.props[7],c.props[8],c.props[9],c.props[10],c.props[11],c.props[12],c.props[13],c.props[14],c.props[15]],zt=Ft}g<=j?(xt=new LetterProps(zt,Wt,Nt,Kt,Qt,tr),this.renderedLetters.push(xt),g+=1,this.lettersChangedFlag=!0):(xt=this.renderedLetters[j],this.lettersChangedFlag=xt.update(zt,Wt,Nt,Kt,Qt,tr)||this.lettersChangedFlag)}}},TextAnimatorProperty.prototype.getValue=function(){this._elem.globalData.frameId!==this._frameId&&(this._frameId=this._elem.globalData.frameId,this.iterateDynamicProperties())},TextAnimatorProperty.prototype.mHelper=new Matrix,TextAnimatorProperty.prototype.defaultPropsArray=[],extendPrototype([DynamicPropertyContainer],TextAnimatorProperty);function ITextElement(){}ITextElement.prototype.initElement=function(s,e,i){this.lettersChangedFlag=!0,this.initFrame(),this.initBaseData(s,e,i),this.textProperty=new TextProperty(this,s.t,this.dynamicProperties),this.textAnimator=new TextAnimatorProperty(s.t,this.renderType,this),this.initTransform(s,e,i),this.initHierarchy(),this.initRenderable(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),this.createContent(),this.hide(),this.textAnimator.searchProperties(this.dynamicProperties)},ITextElement.prototype.prepareFrame=function(s){this._mdf=!1,this.prepareRenderableFrame(s),this.prepareProperties(s,this.isInRange)},ITextElement.prototype.createPathShape=function(s,e){var i,a=e.length,o,c="";for(i=0;i<a;i+=1)e[i].ty==="sh"&&(o=e[i].ks.k,c+=buildShapeString(o,o.i.length,!0,s));return c},ITextElement.prototype.updateDocumentData=function(s,e){this.textProperty.updateDocumentData(s,e)},ITextElement.prototype.canResizeFont=function(s){this.textProperty.canResizeFont(s)},ITextElement.prototype.setMinimumFontSize=function(s){this.textProperty.setMinimumFontSize(s)},ITextElement.prototype.applyTextPropertiesToMatrix=function(s,e,i,a,o){switch(s.ps&&e.translate(s.ps[0],s.ps[1]+s.ascent,0),e.translate(0,-s.ls,0),s.j){case 1:e.translate(s.justifyOffset+(s.boxWidth-s.lineWidths[i]),0,0);break;case 2:e.translate(s.justifyOffset+(s.boxWidth-s.lineWidths[i])/2,0,0);break}e.translate(a,o,0)},ITextElement.prototype.buildColor=function(s){return"rgb("+Math.round(s[0]*255)+","+Math.round(s[1]*255)+","+Math.round(s[2]*255)+")"},ITextElement.prototype.emptyProp=new LetterProps,ITextElement.prototype.destroy=function(){},ITextElement.prototype.validateText=function(){(this.textProperty._mdf||this.textProperty._isFirstFrame)&&(this.buildNewText(),this.textProperty._isFirstFrame=!1,this.textProperty._mdf=!1)};var emptyShapeData={shapes:[]};function SVGTextLottieElement(s,e,i){this.textSpans=[],this.renderType="svg",this.initElement(s,e,i)}extendPrototype([BaseElement,TransformElement,SVGBaseElement,HierarchyElement,FrameElement,RenderableDOMElement,ITextElement],SVGTextLottieElement),SVGTextLottieElement.prototype.createContent=function(){this.data.singleShape&&!this.globalData.fontManager.chars&&(this.textContainer=createNS("text"))},SVGTextLottieElement.prototype.buildTextContents=function(s){for(var e=0,i=s.length,a=[],o="";e<i;)s[e]==="\r"||s[e]===""?(a.push(o),o=""):o+=s[e],e+=1;return a.push(o),a},SVGTextLottieElement.prototype.buildShapeData=function(s,e){if(s.shapes&&s.shapes.length){var i=s.shapes[0];if(i.it){var a=i.it[i.it.length-1];a.s&&(a.s.k[0]=e,a.s.k[1]=e)}}return s},SVGTextLottieElement.prototype.buildNewText=function(){this.addDynamicProperty(this);var s,e,i=this.textProperty.currentData;this.renderedLetters=createSizedArray(i?i.l.length:0),i.fc?this.layerElement.setAttribute("fill",this.buildColor(i.fc)):this.layerElement.setAttribute("fill","rgba(0,0,0,0)"),i.sc&&(this.layerElement.setAttribute("stroke",this.buildColor(i.sc)),this.layerElement.setAttribute("stroke-width",i.sw)),this.layerElement.setAttribute("font-size",i.finalSize);var a=this.globalData.fontManager.getFontByName(i.f);if(a.fClass)this.layerElement.setAttribute("class",a.fClass);else{this.layerElement.setAttribute("font-family",a.fFamily);var o=i.fWeight,c=i.fStyle;this.layerElement.setAttribute("font-style",c),this.layerElement.setAttribute("font-weight",o)}this.layerElement.setAttribute("aria-label",i.t);var d=i.l||[],g=!!this.globalData.fontManager.chars;e=d.length;var b,_=this.mHelper,j="",$=this.data.singleShape,_e=0,tt=0,et=!0,st=i.tr*.001*i.finalSize;if($&&!g&&!i.sz){var at=this.textContainer,rt="start";switch(i.j){case 1:rt="end";break;case 2:rt="middle";break;default:rt="start";break}at.setAttribute("text-anchor",rt),at.setAttribute("letter-spacing",st);var nt=this.buildTextContents(i.finalText);for(e=nt.length,tt=i.ps?i.ps[1]+i.ascent:0,s=0;s<e;s+=1)b=this.textSpans[s].span||createNS("tspan"),b.textContent=nt[s],b.setAttribute("x",0),b.setAttribute("y",tt),b.style.display="inherit",at.appendChild(b),this.textSpans[s]||(this.textSpans[s]={span:null,glyph:null}),this.textSpans[s].span=b,tt+=i.finalLineHeight;this.layerElement.appendChild(at)}else{var it=this.textSpans.length,ot;for(s=0;s<e;s+=1){if(this.textSpans[s]||(this.textSpans[s]={span:null,childSpan:null,glyph:null}),!g||!$||s===0){if(b=it>s?this.textSpans[s].span:createNS(g?"g":"text"),it<=s){if(b.setAttribute("stroke-linecap","butt"),b.setAttribute("stroke-linejoin","round"),b.setAttribute("stroke-miterlimit","4"),this.textSpans[s].span=b,g){var lt=createNS("g");b.appendChild(lt),this.textSpans[s].childSpan=lt}this.textSpans[s].span=b,this.layerElement.appendChild(b)}b.style.display="inherit"}if(_.reset(),$&&(d[s].n&&(_e=-st,tt+=i.yOffset,tt+=et?1:0,et=!1),this.applyTextPropertiesToMatrix(i,_,d[s].line,_e,tt),_e+=d[s].l||0,_e+=st),g){ot=this.globalData.fontManager.getCharData(i.finalText[s],a.fStyle,this.globalData.fontManager.getFontByName(i.f).fFamily);var ct;if(ot.t===1)ct=new SVGCompElement(ot.data,this.globalData,this);else{var ht=emptyShapeData;ot.data&&ot.data.shapes&&(ht=this.buildShapeData(ot.data,i.finalSize)),ct=new SVGShapeElement(ht,this.globalData,this)}if(this.textSpans[s].glyph){var dt=this.textSpans[s].glyph;this.textSpans[s].childSpan.removeChild(dt.layerElement),dt.destroy()}this.textSpans[s].glyph=ct,ct._debug=!0,ct.prepareFrame(0),ct.renderFrame(),this.textSpans[s].childSpan.appendChild(ct.layerElement),ot.t===1&&this.textSpans[s].childSpan.setAttribute("transform","scale("+i.finalSize/100+","+i.finalSize/100+")")}else $&&b.setAttribute("transform","translate("+_.props[12]+","+_.props[13]+")"),b.textContent=d[s].val,b.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve")}$&&b&&b.setAttribute("d",j)}for(;s<this.textSpans.length;)this.textSpans[s].span.style.display="none",s+=1;this._sizeChanged=!0},SVGTextLottieElement.prototype.sourceRectAtTime=function(){if(this.prepareFrame(this.comp.renderedFrame-this.data.st),this.renderInnerContent(),this._sizeChanged){this._sizeChanged=!1;var s=this.layerElement.getBBox();this.bbox={top:s.y,left:s.x,width:s.width,height:s.height}}return this.bbox},SVGTextLottieElement.prototype.getValue=function(){var s,e=this.textSpans.length,i;for(this.renderedFrame=this.comp.renderedFrame,s=0;s<e;s+=1)i=this.textSpans[s].glyph,i&&(i.prepareFrame(this.comp.renderedFrame-this.data.st),i._mdf&&(this._mdf=!0))},SVGTextLottieElement.prototype.renderInnerContent=function(){if(this.validateText(),(!this.data.singleShape||this._mdf)&&(this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag),this.lettersChangedFlag||this.textAnimator.lettersChangedFlag)){this._sizeChanged=!0;var s,e,i=this.textAnimator.renderedLetters,a=this.textProperty.currentData.l;e=a.length;var o,c,d;for(s=0;s<e;s+=1)a[s].n||(o=i[s],c=this.textSpans[s].span,d=this.textSpans[s].glyph,d&&d.renderFrame(),o._mdf.m&&c.setAttribute("transform",o.m),o._mdf.o&&c.setAttribute("opacity",o.o),o._mdf.sw&&c.setAttribute("stroke-width",o.sw),o._mdf.sc&&c.setAttribute("stroke",o.sc),o._mdf.fc&&c.setAttribute("fill",o.fc))}};function ISolidElement(s,e,i){this.initElement(s,e,i)}extendPrototype([IImageElement],ISolidElement),ISolidElement.prototype.createContent=function(){var s=createNS("rect");s.setAttribute("width",this.data.sw),s.setAttribute("height",this.data.sh),s.setAttribute("fill",this.data.sc),this.layerElement.appendChild(s)};function NullElement(s,e,i){this.initFrame(),this.initBaseData(s,e,i),this.initFrame(),this.initTransform(s,e,i),this.initHierarchy()}NullElement.prototype.prepareFrame=function(s){this.prepareProperties(s,!0)},NullElement.prototype.renderFrame=function(){},NullElement.prototype.getBaseElement=function(){return null},NullElement.prototype.destroy=function(){},NullElement.prototype.sourceRectAtTime=function(){},NullElement.prototype.hide=function(){},extendPrototype([BaseElement,TransformElement,HierarchyElement,FrameElement],NullElement);function SVGRendererBase(){}extendPrototype([BaseRenderer],SVGRendererBase),SVGRendererBase.prototype.createNull=function(s){return new NullElement(s,this.globalData,this)},SVGRendererBase.prototype.createShape=function(s){return new SVGShapeElement(s,this.globalData,this)},SVGRendererBase.prototype.createText=function(s){return new SVGTextLottieElement(s,this.globalData,this)},SVGRendererBase.prototype.createImage=function(s){return new IImageElement(s,this.globalData,this)},SVGRendererBase.prototype.createSolid=function(s){return new ISolidElement(s,this.globalData,this)},SVGRendererBase.prototype.configAnimation=function(s){this.svgElement.setAttribute("xmlns","http://www.w3.org/2000/svg"),this.svgElement.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),this.renderConfig.viewBoxSize?this.svgElement.setAttribute("viewBox",this.renderConfig.viewBoxSize):this.svgElement.setAttribute("viewBox","0 0 "+s.w+" "+s.h),this.renderConfig.viewBoxOnly||(this.svgElement.setAttribute("width",s.w),this.svgElement.setAttribute("height",s.h),this.svgElement.style.width="100%",this.svgElement.style.height="100%",this.svgElement.style.transform="translate3d(0,0,0)",this.svgElement.style.contentVisibility=this.renderConfig.contentVisibility),this.renderConfig.width&&this.svgElement.setAttribute("width",this.renderConfig.width),this.renderConfig.height&&this.svgElement.setAttribute("height",this.renderConfig.height),this.renderConfig.className&&this.svgElement.setAttribute("class",this.renderConfig.className),this.renderConfig.id&&this.svgElement.setAttribute("id",this.renderConfig.id),this.renderConfig.focusable!==void 0&&this.svgElement.setAttribute("focusable",this.renderConfig.focusable),this.svgElement.setAttribute("preserveAspectRatio",this.renderConfig.preserveAspectRatio),this.animationItem.wrapper.appendChild(this.svgElement);var e=this.globalData.defs;this.setupGlobalData(s,e),this.globalData.progressiveLoad=this.renderConfig.progressiveLoad,this.data=s;var i=createNS("clipPath"),a=createNS("rect");a.setAttribute("width",s.w),a.setAttribute("height",s.h),a.setAttribute("x",0),a.setAttribute("y",0);var o=createElementID();i.setAttribute("id",o),i.appendChild(a),this.layerElement.setAttribute("clip-path","url("+getLocationHref()+"#"+o+")"),e.appendChild(i),this.layers=s.layers,this.elements=createSizedArray(s.layers.length)},SVGRendererBase.prototype.destroy=function(){this.animationItem.wrapper&&(this.animationItem.wrapper.innerText=""),this.layerElement=null,this.globalData.defs=null;var s,e=this.layers?this.layers.length:0;for(s=0;s<e;s+=1)this.elements[s]&&this.elements[s].destroy&&this.elements[s].destroy();this.elements.length=0,this.destroyed=!0,this.animationItem=null},SVGRendererBase.prototype.updateContainerSize=function(){},SVGRendererBase.prototype.findIndexByInd=function(s){var e=0,i=this.layers.length;for(e=0;e<i;e+=1)if(this.layers[e].ind===s)return e;return-1},SVGRendererBase.prototype.buildItem=function(s){var e=this.elements;if(!(e[s]||this.layers[s].ty===99)){e[s]=!0;var i=this.createItem(this.layers[s]);if(e[s]=i,getExpressionsPlugin()&&(this.layers[s].ty===0&&this.globalData.projectInterface.registerComposition(i),i.initExpressions()),this.appendElementInPos(i,s),this.layers[s].tt){var a="tp"in this.layers[s]?this.findIndexByInd(this.layers[s].tp):s-1;if(a===-1)return;if(!this.elements[a]||this.elements[a]===!0)this.buildItem(a),this.addPendingElement(i);else{var o=e[a],c=o.getMatte(this.layers[s].tt);i.setMatte(c)}}}},SVGRendererBase.prototype.checkPendingElements=function(){for(;this.pendingElements.length;){var s=this.pendingElements.pop();if(s.checkParenting(),s.data.tt)for(var e=0,i=this.elements.length;e<i;){if(this.elements[e]===s){var a="tp"in s.data?this.findIndexByInd(s.data.tp):e-1,o=this.elements[a],c=o.getMatte(this.layers[e].tt);s.setMatte(c);break}e+=1}}},SVGRendererBase.prototype.renderFrame=function(s){if(!(this.renderedFrame===s||this.destroyed)){s===null?s=this.renderedFrame:this.renderedFrame=s,this.globalData.frameNum=s,this.globalData.frameId+=1,this.globalData.projectInterface.currentFrame=s,this.globalData._mdf=!1;var e,i=this.layers.length;for(this.completeLayers||this.checkLayers(s),e=i-1;e>=0;e-=1)(this.completeLayers||this.elements[e])&&this.elements[e].prepareFrame(s-this.layers[e].st);if(this.globalData._mdf)for(e=0;e<i;e+=1)(this.completeLayers||this.elements[e])&&this.elements[e].renderFrame()}},SVGRendererBase.prototype.appendElementInPos=function(s,e){var i=s.getBaseElement();if(i){for(var a=0,o;a<e;)this.elements[a]&&this.elements[a]!==!0&&this.elements[a].getBaseElement()&&(o=this.elements[a].getBaseElement()),a+=1;o?this.layerElement.insertBefore(i,o):this.layerElement.appendChild(i)}},SVGRendererBase.prototype.hide=function(){this.layerElement.style.display="none"},SVGRendererBase.prototype.show=function(){this.layerElement.style.display="block"};function ICompElement(){}extendPrototype([BaseElement,TransformElement,HierarchyElement,FrameElement,RenderableDOMElement],ICompElement),ICompElement.prototype.initElement=function(s,e,i){this.initFrame(),this.initBaseData(s,e,i),this.initTransform(s,e,i),this.initRenderable(),this.initHierarchy(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),(this.data.xt||!e.progressiveLoad)&&this.buildAllItems(),this.hide()},ICompElement.prototype.prepareFrame=function(s){if(this._mdf=!1,this.prepareRenderableFrame(s),this.prepareProperties(s,this.isInRange),!(!this.isInRange&&!this.data.xt)){if(this.tm._placeholder)this.renderedFrame=s/this.data.sr;else{var e=this.tm.v;e===this.data.op&&(e=this.data.op-1),this.renderedFrame=e}var i,a=this.elements.length;for(this.completeLayers||this.checkLayers(this.renderedFrame),i=a-1;i>=0;i-=1)(this.completeLayers||this.elements[i])&&(this.elements[i].prepareFrame(this.renderedFrame-this.layers[i].st),this.elements[i]._mdf&&(this._mdf=!0))}},ICompElement.prototype.renderInnerContent=function(){var s,e=this.layers.length;for(s=0;s<e;s+=1)(this.completeLayers||this.elements[s])&&this.elements[s].renderFrame()},ICompElement.prototype.setElements=function(s){this.elements=s},ICompElement.prototype.getElements=function(){return this.elements},ICompElement.prototype.destroyElements=function(){var s,e=this.layers.length;for(s=0;s<e;s+=1)this.elements[s]&&this.elements[s].destroy()},ICompElement.prototype.destroy=function(){this.destroyElements(),this.destroyBaseElement()};function SVGCompElement(s,e,i){this.layers=s.layers,this.supports3d=!0,this.completeLayers=!1,this.pendingElements=[],this.elements=this.layers?createSizedArray(this.layers.length):[],this.initElement(s,e,i),this.tm=s.tm?PropertyFactory.getProp(this,s.tm,0,e.frameRate,this):{_placeholder:!0}}extendPrototype([SVGRendererBase,ICompElement,SVGBaseElement],SVGCompElement),SVGCompElement.prototype.createComp=function(s){return new SVGCompElement(s,this.globalData,this)};function SVGRenderer(s,e){this.animationItem=s,this.layers=null,this.renderedFrame=-1,this.svgElement=createNS("svg");var i="";if(e&&e.title){var a=createNS("title"),o=createElementID();a.setAttribute("id",o),a.textContent=e.title,this.svgElement.appendChild(a),i+=o}if(e&&e.description){var c=createNS("desc"),d=createElementID();c.setAttribute("id",d),c.textContent=e.description,this.svgElement.appendChild(c),i+=" "+d}i&&this.svgElement.setAttribute("aria-labelledby",i);var g=createNS("defs");this.svgElement.appendChild(g);var b=createNS("g");this.svgElement.appendChild(b),this.layerElement=b,this.renderConfig={preserveAspectRatio:e&&e.preserveAspectRatio||"xMidYMid meet",imagePreserveAspectRatio:e&&e.imagePreserveAspectRatio||"xMidYMid slice",contentVisibility:e&&e.contentVisibility||"visible",progressiveLoad:e&&e.progressiveLoad||!1,hideOnTransparent:!(e&&e.hideOnTransparent===!1),viewBoxOnly:e&&e.viewBoxOnly||!1,viewBoxSize:e&&e.viewBoxSize||!1,className:e&&e.className||"",id:e&&e.id||"",focusable:e&&e.focusable,filterSize:{width:e&&e.filterSize&&e.filterSize.width||"100%",height:e&&e.filterSize&&e.filterSize.height||"100%",x:e&&e.filterSize&&e.filterSize.x||"0%",y:e&&e.filterSize&&e.filterSize.y||"0%"},width:e&&e.width,height:e&&e.height,runExpressions:!e||e.runExpressions===void 0||e.runExpressions},this.globalData={_mdf:!1,frameNum:-1,defs:g,renderConfig:this.renderConfig},this.elements=[],this.pendingElements=[],this.destroyed=!1,this.rendererType="svg"}extendPrototype([SVGRendererBase],SVGRenderer),SVGRenderer.prototype.createComp=function(s){return new SVGCompElement(s,this.globalData,this)};function ShapeTransformManager(){this.sequences={},this.sequenceList=[],this.transform_key_count=0}ShapeTransformManager.prototype={addTransformSequence:function(e){var i,a=e.length,o="_";for(i=0;i<a;i+=1)o+=e[i].transform.key+"_";var c=this.sequences[o];return c||(c={transforms:[].concat(e),finalTransform:new Matrix,_mdf:!1},this.sequences[o]=c,this.sequenceList.push(c)),c},processSequence:function(e,i){for(var a=0,o=e.transforms.length,c=i;a<o&&!i;){if(e.transforms[a].transform.mProps._mdf){c=!0;break}a+=1}if(c)for(e.finalTransform.reset(),a=o-1;a>=0;a-=1)e.finalTransform.multiply(e.transforms[a].transform.mProps.v);e._mdf=c},processSequences:function(e){var i,a=this.sequenceList.length;for(i=0;i<a;i+=1)this.processSequence(this.sequenceList[i],e)},getNewKey:function(){return this.transform_key_count+=1,"_"+this.transform_key_count}};var lumaLoader=function(){var e="__lottie_element_luma_buffer",i=null,a=null,o=null;function c(){var b=createNS("svg"),_=createNS("filter"),j=createNS("feColorMatrix");return _.setAttribute("id",e),j.setAttribute("type","matrix"),j.setAttribute("color-interpolation-filters","sRGB"),j.setAttribute("values","0.3, 0.3, 0.3, 0, 0, 0.3, 0.3, 0.3, 0, 0, 0.3, 0.3, 0.3, 0, 0, 0.3, 0.3, 0.3, 0, 0"),_.appendChild(j),b.appendChild(_),b.setAttribute("id",e+"_svg"),featureSupport.svgLumaHidden&&(b.style.display="none"),b}function d(){i||(o=c(),document.body.appendChild(o),i=createTag("canvas"),a=i.getContext("2d"),a.filter="url(#"+e+")",a.fillStyle="rgba(0,0,0,0)",a.fillRect(0,0,1,1))}function g(b){return i||d(),i.width=b.width,i.height=b.height,a.filter="url(#"+e+")",i}return{load:d,get:g}};function createCanvas(s,e){if(featureSupport.offscreenCanvas)return new OffscreenCanvas(s,e);var i=createTag("canvas");return i.width=s,i.height=e,i}var assetLoader=function(){return{loadLumaCanvas:lumaLoader.load,getLumaCanvas:lumaLoader.get,createCanvas}}(),registeredEffects={};function CVEffects(s){var e,i=s.data.ef?s.data.ef.length:0;this.filters=[];var a;for(e=0;e<i;e+=1){a=null;var o=s.data.ef[e].ty;if(registeredEffects[o]){var c=registeredEffects[o].effect;a=new c(s.effectsManager.effectElements[e],s)}a&&this.filters.push(a)}this.filters.length&&s.addRenderableComponent(this)}CVEffects.prototype.renderFrame=function(s){var e,i=this.filters.length;for(e=0;e<i;e+=1)this.filters[e].renderFrame(s)},CVEffects.prototype.getEffects=function(s){var e,i=this.filters.length,a=[];for(e=0;e<i;e+=1)this.filters[e].type===s&&a.push(this.filters[e]);return a};function registerEffect(s,e){registeredEffects[s]={effect:e}}function CVMaskElement(s,e){this.data=s,this.element=e,this.masksProperties=this.data.masksProperties||[],this.viewData=createSizedArray(this.masksProperties.length);var i,a=this.masksProperties.length,o=!1;for(i=0;i<a;i+=1)this.masksProperties[i].mode!=="n"&&(o=!0),this.viewData[i]=ShapePropertyFactory.getShapeProp(this.element,this.masksProperties[i],3);this.hasMasks=o,o&&this.element.addRenderableComponent(this)}CVMaskElement.prototype.renderFrame=function(){if(this.hasMasks){var s=this.element.finalTransform.mat,e=this.element.canvasContext,i,a=this.masksProperties.length,o,c,d;for(e.beginPath(),i=0;i<a;i+=1)if(this.masksProperties[i].mode!=="n"){this.masksProperties[i].inv&&(e.moveTo(0,0),e.lineTo(this.element.globalData.compSize.w,0),e.lineTo(this.element.globalData.compSize.w,this.element.globalData.compSize.h),e.lineTo(0,this.element.globalData.compSize.h),e.lineTo(0,0)),d=this.viewData[i].v,o=s.applyToPointArray(d.v[0][0],d.v[0][1],0),e.moveTo(o[0],o[1]);var g,b=d._length;for(g=1;g<b;g+=1)c=s.applyToTriplePoints(d.o[g-1],d.i[g],d.v[g]),e.bezierCurveTo(c[0],c[1],c[2],c[3],c[4],c[5]);c=s.applyToTriplePoints(d.o[g-1],d.i[0],d.v[0]),e.bezierCurveTo(c[0],c[1],c[2],c[3],c[4],c[5])}this.element.globalData.renderer.save(!0),e.clip()}},CVMaskElement.prototype.getMaskProperty=MaskElement.prototype.getMaskProperty,CVMaskElement.prototype.destroy=function(){this.element=null};function CVBaseElement(){}var operationsMap={1:"source-in",2:"source-out",3:"source-in",4:"source-out"};CVBaseElement.prototype={createElements:function(){},initRendererElement:function(){},createContainerElements:function(){if(this.data.tt>=1){this.buffers=[];var e=this.globalData.canvasContext,i=assetLoader.createCanvas(e.canvas.width,e.canvas.height);this.buffers.push(i);var a=assetLoader.createCanvas(e.canvas.width,e.canvas.height);this.buffers.push(a),this.data.tt>=3&&!document._isProxy&&assetLoader.loadLumaCanvas()}this.canvasContext=this.globalData.canvasContext,this.transformCanvas=this.globalData.transformCanvas,this.renderableEffectsManager=new CVEffects(this),this.searchEffectTransforms()},createContent:function(){},setBlendMode:function(){var e=this.globalData;if(e.blendMode!==this.data.bm){e.blendMode=this.data.bm;var i=getBlendMode(this.data.bm);e.canvasContext.globalCompositeOperation=i}},createRenderableComponents:function(){this.maskManager=new CVMaskElement(this.data,this),this.transformEffects=this.renderableEffectsManager.getEffects(effectTypes.TRANSFORM_EFFECT)},hideElement:function(){!this.hidden&&(!this.isInRange||this.isTransparent)&&(this.hidden=!0)},showElement:function(){this.isInRange&&!this.isTransparent&&(this.hidden=!1,this._isFirstFrame=!0,this.maskManager._isFirstFrame=!0)},clearCanvas:function(e){e.clearRect(this.transformCanvas.tx,this.transformCanvas.ty,this.transformCanvas.w*this.transformCanvas.sx,this.transformCanvas.h*this.transformCanvas.sy)},prepareLayer:function(){if(this.data.tt>=1){var e=this.buffers[0],i=e.getContext("2d");this.clearCanvas(i),i.drawImage(this.canvasContext.canvas,0,0),this.currentTransform=this.canvasContext.getTransform(),this.canvasContext.setTransform(1,0,0,1,0,0),this.clearCanvas(this.canvasContext),this.canvasContext.setTransform(this.currentTransform)}},exitLayer:function(){if(this.data.tt>=1){var e=this.buffers[1],i=e.getContext("2d");this.clearCanvas(i),i.drawImage(this.canvasContext.canvas,0,0),this.canvasContext.setTransform(1,0,0,1,0,0),this.clearCanvas(this.canvasContext),this.canvasContext.setTransform(this.currentTransform);var a=this.comp.getElementById("tp"in this.data?this.data.tp:this.data.ind-1);if(a.renderFrame(!0),this.canvasContext.setTransform(1,0,0,1,0,0),this.data.tt>=3&&!document._isProxy){var o=assetLoader.getLumaCanvas(this.canvasContext.canvas),c=o.getContext("2d");c.drawImage(this.canvasContext.canvas,0,0),this.clearCanvas(this.canvasContext),this.canvasContext.drawImage(o,0,0)}this.canvasContext.globalCompositeOperation=operationsMap[this.data.tt],this.canvasContext.drawImage(e,0,0),this.canvasContext.globalCompositeOperation="destination-over",this.canvasContext.drawImage(this.buffers[0],0,0),this.canvasContext.setTransform(this.currentTransform),this.canvasContext.globalCompositeOperation="source-over"}},renderFrame:function(e){if(!(this.hidden||this.data.hd)&&!(this.data.td===1&&!e)){this.renderTransform(),this.renderRenderable(),this.renderLocalTransform(),this.setBlendMode();var i=this.data.ty===0;this.prepareLayer(),this.globalData.renderer.save(i),this.globalData.renderer.ctxTransform(this.finalTransform.localMat.props),this.globalData.renderer.ctxOpacity(this.finalTransform.localOpacity),this.renderInnerContent(),this.globalData.renderer.restore(i),this.exitLayer(),this.maskManager.hasMasks&&this.globalData.renderer.restore(!0),this._isFirstFrame&&(this._isFirstFrame=!1)}},destroy:function(){this.canvasContext=null,this.data=null,this.globalData=null,this.maskManager.destroy()},mHelper:new Matrix},CVBaseElement.prototype.hide=CVBaseElement.prototype.hideElement,CVBaseElement.prototype.show=CVBaseElement.prototype.showElement;function CVShapeData(s,e,i,a){this.styledShapes=[],this.tr=[0,0,0,0,0,0];var o=4;e.ty==="rc"?o=5:e.ty==="el"?o=6:e.ty==="sr"&&(o=7),this.sh=ShapePropertyFactory.getShapeProp(s,e,o,s);var c,d=i.length,g;for(c=0;c<d;c+=1)i[c].closed||(g={transforms:a.addTransformSequence(i[c].transforms),trNodes:[]},this.styledShapes.push(g),i[c].elements.push(g))}CVShapeData.prototype.setAsAnimated=SVGShapeData.prototype.setAsAnimated;function CVShapeElement(s,e,i){this.shapes=[],this.shapesData=s.shapes,this.stylesList=[],this.itemsData=[],this.prevViewData=[],this.shapeModifiers=[],this.processedElements=[],this.transformsManager=new ShapeTransformManager,this.initElement(s,e,i)}extendPrototype([BaseElement,TransformElement,CVBaseElement,IShapeElement,HierarchyElement,FrameElement,RenderableElement],CVShapeElement),CVShapeElement.prototype.initElement=RenderableDOMElement.prototype.initElement,CVShapeElement.prototype.transformHelper={opacity:1,_opMdf:!1},CVShapeElement.prototype.dashResetter=[],CVShapeElement.prototype.createContent=function(){this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,!0,[])},CVShapeElement.prototype.createStyleElement=function(s,e){var i={data:s,type:s.ty,preTransforms:this.transformsManager.addTransformSequence(e),transforms:[],elements:[],closed:s.hd===!0},a={};if(s.ty==="fl"||s.ty==="st"?(a.c=PropertyFactory.getProp(this,s.c,1,255,this),a.c.k||(i.co="rgb("+bmFloor(a.c.v[0])+","+bmFloor(a.c.v[1])+","+bmFloor(a.c.v[2])+")")):(s.ty==="gf"||s.ty==="gs")&&(a.s=PropertyFactory.getProp(this,s.s,1,null,this),a.e=PropertyFactory.getProp(this,s.e,1,null,this),a.h=PropertyFactory.getProp(this,s.h||{k:0},0,.01,this),a.a=PropertyFactory.getProp(this,s.a||{k:0},0,degToRads,this),a.g=new GradientProperty(this,s.g,this)),a.o=PropertyFactory.getProp(this,s.o,0,.01,this),s.ty==="st"||s.ty==="gs"){if(i.lc=lineCapEnum[s.lc||2],i.lj=lineJoinEnum[s.lj||2],s.lj==1&&(i.ml=s.ml),a.w=PropertyFactory.getProp(this,s.w,0,null,this),a.w.k||(i.wi=a.w.v),s.d){var o=new DashProperty(this,s.d,"canvas",this);a.d=o,a.d.k||(i.da=a.d.dashArray,i.do=a.d.dashoffset[0])}}else i.r=s.r===2?"evenodd":"nonzero";return this.stylesList.push(i),a.style=i,a},CVShapeElement.prototype.createGroupElement=function(){var s={it:[],prevViewData:[]};return s},CVShapeElement.prototype.createTransformElement=function(s){var e={transform:{opacity:1,_opMdf:!1,key:this.transformsManager.getNewKey(),op:PropertyFactory.getProp(this,s.o,0,.01,this),mProps:TransformPropertyFactory.getTransformProperty(this,s,this)}};return e},CVShapeElement.prototype.createShapeElement=function(s){var e=new CVShapeData(this,s,this.stylesList,this.transformsManager);return this.shapes.push(e),this.addShapeToModifiers(e),e},CVShapeElement.prototype.reloadShapes=function(){this._isFirstFrame=!0;var s,e=this.itemsData.length;for(s=0;s<e;s+=1)this.prevViewData[s]=this.itemsData[s];for(this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,!0,[]),e=this.dynamicProperties.length,s=0;s<e;s+=1)this.dynamicProperties[s].getValue();this.renderModifiers(),this.transformsManager.processSequences(this._isFirstFrame)},CVShapeElement.prototype.addTransformToStyleList=function(s){var e,i=this.stylesList.length;for(e=0;e<i;e+=1)this.stylesList[e].closed||this.stylesList[e].transforms.push(s)},CVShapeElement.prototype.removeTransformFromStyleList=function(){var s,e=this.stylesList.length;for(s=0;s<e;s+=1)this.stylesList[s].closed||this.stylesList[s].transforms.pop()},CVShapeElement.prototype.closeStyles=function(s){var e,i=s.length;for(e=0;e<i;e+=1)s[e].closed=!0},CVShapeElement.prototype.searchShapes=function(s,e,i,a,o){var c,d=s.length-1,g,b,_=[],j=[],$,_e,tt,et=[].concat(o);for(c=d;c>=0;c-=1){if($=this.searchProcessedElement(s[c]),$?e[c]=i[$-1]:s[c]._shouldRender=a,s[c].ty==="fl"||s[c].ty==="st"||s[c].ty==="gf"||s[c].ty==="gs")$?e[c].style.closed=!1:e[c]=this.createStyleElement(s[c],et),_.push(e[c].style);else if(s[c].ty==="gr"){if(!$)e[c]=this.createGroupElement(s[c]);else for(b=e[c].it.length,g=0;g<b;g+=1)e[c].prevViewData[g]=e[c].it[g];this.searchShapes(s[c].it,e[c].it,e[c].prevViewData,a,et)}else s[c].ty==="tr"?($||(tt=this.createTransformElement(s[c]),e[c]=tt),et.push(e[c]),this.addTransformToStyleList(e[c])):s[c].ty==="sh"||s[c].ty==="rc"||s[c].ty==="el"||s[c].ty==="sr"?$||(e[c]=this.createShapeElement(s[c])):s[c].ty==="tm"||s[c].ty==="rd"||s[c].ty==="pb"||s[c].ty==="zz"||s[c].ty==="op"?($?(_e=e[c],_e.closed=!1):(_e=ShapeModifiers.getModifier(s[c].ty),_e.init(this,s[c]),e[c]=_e,this.shapeModifiers.push(_e)),j.push(_e)):s[c].ty==="rp"&&($?(_e=e[c],_e.closed=!0):(_e=ShapeModifiers.getModifier(s[c].ty),e[c]=_e,_e.init(this,s,c,e),this.shapeModifiers.push(_e),a=!1),j.push(_e));this.addProcessedElement(s[c],c+1)}for(this.removeTransformFromStyleList(),this.closeStyles(_),d=j.length,c=0;c<d;c+=1)j[c].closed=!0},CVShapeElement.prototype.renderInnerContent=function(){this.transformHelper.opacity=1,this.transformHelper._opMdf=!1,this.renderModifiers(),this.transformsManager.processSequences(this._isFirstFrame),this.renderShape(this.transformHelper,this.shapesData,this.itemsData,!0)},CVShapeElement.prototype.renderShapeTransform=function(s,e){(s._opMdf||e.op._mdf||this._isFirstFrame)&&(e.opacity=s.opacity,e.opacity*=e.op.v,e._opMdf=!0)},CVShapeElement.prototype.drawLayer=function(){var s,e=this.stylesList.length,i,a,o,c,d,g,b=this.globalData.renderer,_=this.globalData.canvasContext,j,$;for(s=0;s<e;s+=1)if($=this.stylesList[s],j=$.type,!((j==="st"||j==="gs")&&$.wi===0||!$.data._shouldRender||$.coOp===0||this.globalData.currentGlobalAlpha===0)){for(b.save(),d=$.elements,j==="st"||j==="gs"?(b.ctxStrokeStyle(j==="st"?$.co:$.grd),b.ctxLineWidth($.wi),b.ctxLineCap($.lc),b.ctxLineJoin($.lj),b.ctxMiterLimit($.ml||0)):b.ctxFillStyle(j==="fl"?$.co:$.grd),b.ctxOpacity($.coOp),j!=="st"&&j!=="gs"&&_.beginPath(),b.ctxTransform($.preTransforms.finalTransform.props),a=d.length,i=0;i<a;i+=1){for((j==="st"||j==="gs")&&(_.beginPath(),$.da&&(_.setLineDash($.da),_.lineDashOffset=$.do)),g=d[i].trNodes,c=g.length,o=0;o<c;o+=1)g[o].t==="m"?_.moveTo(g[o].p[0],g[o].p[1]):g[o].t==="c"?_.bezierCurveTo(g[o].pts[0],g[o].pts[1],g[o].pts[2],g[o].pts[3],g[o].pts[4],g[o].pts[5]):_.closePath();(j==="st"||j==="gs")&&(b.ctxStroke(),$.da&&_.setLineDash(this.dashResetter))}j!=="st"&&j!=="gs"&&this.globalData.renderer.ctxFill($.r),b.restore()}},CVShapeElement.prototype.renderShape=function(s,e,i,a){var o,c=e.length-1,d;for(d=s,o=c;o>=0;o-=1)e[o].ty==="tr"?(d=i[o].transform,this.renderShapeTransform(s,d)):e[o].ty==="sh"||e[o].ty==="el"||e[o].ty==="rc"||e[o].ty==="sr"?this.renderPath(e[o],i[o]):e[o].ty==="fl"?this.renderFill(e[o],i[o],d):e[o].ty==="st"?this.renderStroke(e[o],i[o],d):e[o].ty==="gf"||e[o].ty==="gs"?this.renderGradientFill(e[o],i[o],d):e[o].ty==="gr"?this.renderShape(d,e[o].it,i[o].it):e[o].ty;a&&this.drawLayer()},CVShapeElement.prototype.renderStyledShape=function(s,e){if(this._isFirstFrame||e._mdf||s.transforms._mdf){var i=s.trNodes,a=e.paths,o,c,d,g=a._length;i.length=0;var b=s.transforms.finalTransform;for(d=0;d<g;d+=1){var _=a.shapes[d];if(_&&_.v){for(c=_._length,o=1;o<c;o+=1)o===1&&i.push({t:"m",p:b.applyToPointArray(_.v[0][0],_.v[0][1],0)}),i.push({t:"c",pts:b.applyToTriplePoints(_.o[o-1],_.i[o],_.v[o])});c===1&&i.push({t:"m",p:b.applyToPointArray(_.v[0][0],_.v[0][1],0)}),_.c&&c&&(i.push({t:"c",pts:b.applyToTriplePoints(_.o[o-1],_.i[0],_.v[0])}),i.push({t:"z"}))}}s.trNodes=i}},CVShapeElement.prototype.renderPath=function(s,e){if(s.hd!==!0&&s._shouldRender){var i,a=e.styledShapes.length;for(i=0;i<a;i+=1)this.renderStyledShape(e.styledShapes[i],e.sh)}},CVShapeElement.prototype.renderFill=function(s,e,i){var a=e.style;(e.c._mdf||this._isFirstFrame)&&(a.co="rgb("+bmFloor(e.c.v[0])+","+bmFloor(e.c.v[1])+","+bmFloor(e.c.v[2])+")"),(e.o._mdf||i._opMdf||this._isFirstFrame)&&(a.coOp=e.o.v*i.opacity)},CVShapeElement.prototype.renderGradientFill=function(s,e,i){var a=e.style,o;if(!a.grd||e.g._mdf||e.s._mdf||e.e._mdf||s.t!==1&&(e.h._mdf||e.a._mdf)){var c=this.globalData.canvasContext,d=e.s.v,g=e.e.v;if(s.t===1)o=c.createLinearGradient(d[0],d[1],g[0],g[1]);else{var b=Math.sqrt(Math.pow(d[0]-g[0],2)+Math.pow(d[1]-g[1],2)),_=Math.atan2(g[1]-d[1],g[0]-d[0]),j=e.h.v;j>=1?j=.99:j<=-1&&(j=-.99);var $=b*j,_e=Math.cos(_+e.a.v)*$+d[0],tt=Math.sin(_+e.a.v)*$+d[1];o=c.createRadialGradient(_e,tt,0,d[0],d[1],b)}var et,st=s.g.p,at=e.g.c,rt=1;for(et=0;et<st;et+=1)e.g._hasOpacity&&e.g._collapsable&&(rt=e.g.o[et*2+1]),o.addColorStop(at[et*4]/100,"rgba("+at[et*4+1]+","+at[et*4+2]+","+at[et*4+3]+","+rt+")");a.grd=o}a.coOp=e.o.v*i.opacity},CVShapeElement.prototype.renderStroke=function(s,e,i){var a=e.style,o=e.d;o&&(o._mdf||this._isFirstFrame)&&(a.da=o.dashArray,a.do=o.dashoffset[0]),(e.c._mdf||this._isFirstFrame)&&(a.co="rgb("+bmFloor(e.c.v[0])+","+bmFloor(e.c.v[1])+","+bmFloor(e.c.v[2])+")"),(e.o._mdf||i._opMdf||this._isFirstFrame)&&(a.coOp=e.o.v*i.opacity),(e.w._mdf||this._isFirstFrame)&&(a.wi=e.w.v)},CVShapeElement.prototype.destroy=function(){this.shapesData=null,this.globalData=null,this.canvasContext=null,this.stylesList.length=0,this.itemsData.length=0};function CVTextElement(s,e,i){this.textSpans=[],this.yOffset=0,this.fillColorAnim=!1,this.strokeColorAnim=!1,this.strokeWidthAnim=!1,this.stroke=!1,this.fill=!1,this.justifyOffset=0,this.currentRender=null,this.renderType="canvas",this.values={fill:"rgba(0,0,0,0)",stroke:"rgba(0,0,0,0)",sWidth:0,fValue:""},this.initElement(s,e,i)}extendPrototype([BaseElement,TransformElement,CVBaseElement,HierarchyElement,FrameElement,RenderableElement,ITextElement],CVTextElement),CVTextElement.prototype.tHelper=createTag("canvas").getContext("2d"),CVTextElement.prototype.buildNewText=function(){var s=this.textProperty.currentData;this.renderedLetters=createSizedArray(s.l?s.l.length:0);var e=!1;s.fc?(e=!0,this.values.fill=this.buildColor(s.fc)):this.values.fill="rgba(0,0,0,0)",this.fill=e;var i=!1;s.sc&&(i=!0,this.values.stroke=this.buildColor(s.sc),this.values.sWidth=s.sw);var a=this.globalData.fontManager.getFontByName(s.f),o,c,d=s.l,g=this.mHelper;this.stroke=i,this.values.fValue=s.finalSize+"px "+this.globalData.fontManager.getFontByName(s.f).fFamily,c=s.finalText.length;var b,_,j,$,_e,tt,et,st,at,rt,nt=this.data.singleShape,it=s.tr*.001*s.finalSize,ot=0,lt=0,ct=!0,ht=0;for(o=0;o<c;o+=1){b=this.globalData.fontManager.getCharData(s.finalText[o],a.fStyle,this.globalData.fontManager.getFontByName(s.f).fFamily),_=b&&b.data||{},g.reset(),nt&&d[o].n&&(ot=-it,lt+=s.yOffset,lt+=ct?1:0,ct=!1),_e=_.shapes?_.shapes[0].it:[],et=_e.length,g.scale(s.finalSize/100,s.finalSize/100),nt&&this.applyTextPropertiesToMatrix(s,g,d[o].line,ot,lt),at=createSizedArray(et-1);var dt=0;for(tt=0;tt<et;tt+=1)if(_e[tt].ty==="sh"){for($=_e[tt].ks.k.i.length,st=_e[tt].ks.k,rt=[],j=1;j<$;j+=1)j===1&&rt.push(g.applyToX(st.v[0][0],st.v[0][1],0),g.applyToY(st.v[0][0],st.v[0][1],0)),rt.push(g.applyToX(st.o[j-1][0],st.o[j-1][1],0),g.applyToY(st.o[j-1][0],st.o[j-1][1],0),g.applyToX(st.i[j][0],st.i[j][1],0),g.applyToY(st.i[j][0],st.i[j][1],0),g.applyToX(st.v[j][0],st.v[j][1],0),g.applyToY(st.v[j][0],st.v[j][1],0));rt.push(g.applyToX(st.o[j-1][0],st.o[j-1][1],0),g.applyToY(st.o[j-1][0],st.o[j-1][1],0),g.applyToX(st.i[0][0],st.i[0][1],0),g.applyToY(st.i[0][0],st.i[0][1],0),g.applyToX(st.v[0][0],st.v[0][1],0),g.applyToY(st.v[0][0],st.v[0][1],0)),at[dt]=rt,dt+=1}nt&&(ot+=d[o].l,ot+=it),this.textSpans[ht]?this.textSpans[ht].elem=at:this.textSpans[ht]={elem:at},ht+=1}},CVTextElement.prototype.renderInnerContent=function(){this.validateText();var s=this.canvasContext;s.font=this.values.fValue,this.globalData.renderer.ctxLineCap("butt"),this.globalData.renderer.ctxLineJoin("miter"),this.globalData.renderer.ctxMiterLimit(4),this.data.singleShape||this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag);var e,i,a,o,c,d,g=this.textAnimator.renderedLetters,b=this.textProperty.currentData.l;i=b.length;var _,j=null,$=null,_e=null,tt,et,st=this.globalData.renderer;for(e=0;e<i;e+=1)if(!b[e].n){if(_=g[e],_&&(st.save(),st.ctxTransform(_.p),st.ctxOpacity(_.o)),this.fill){for(_&&_.fc?j!==_.fc&&(st.ctxFillStyle(_.fc),j=_.fc):j!==this.values.fill&&(j=this.values.fill,st.ctxFillStyle(this.values.fill)),tt=this.textSpans[e].elem,o=tt.length,this.globalData.canvasContext.beginPath(),a=0;a<o;a+=1)for(et=tt[a],d=et.length,this.globalData.canvasContext.moveTo(et[0],et[1]),c=2;c<d;c+=6)this.globalData.canvasContext.bezierCurveTo(et[c],et[c+1],et[c+2],et[c+3],et[c+4],et[c+5]);this.globalData.canvasContext.closePath(),st.ctxFill()}if(this.stroke){for(_&&_.sw?_e!==_.sw&&(_e=_.sw,st.ctxLineWidth(_.sw)):_e!==this.values.sWidth&&(_e=this.values.sWidth,st.ctxLineWidth(this.values.sWidth)),_&&_.sc?$!==_.sc&&($=_.sc,st.ctxStrokeStyle(_.sc)):$!==this.values.stroke&&($=this.values.stroke,st.ctxStrokeStyle(this.values.stroke)),tt=this.textSpans[e].elem,o=tt.length,this.globalData.canvasContext.beginPath(),a=0;a<o;a+=1)for(et=tt[a],d=et.length,this.globalData.canvasContext.moveTo(et[0],et[1]),c=2;c<d;c+=6)this.globalData.canvasContext.bezierCurveTo(et[c],et[c+1],et[c+2],et[c+3],et[c+4],et[c+5]);this.globalData.canvasContext.closePath(),st.ctxStroke()}_&&this.globalData.renderer.restore()}};function CVImageElement(s,e,i){this.assetData=e.getAssetData(s.refId),this.img=e.imageLoader.getAsset(this.assetData),this.initElement(s,e,i)}extendPrototype([BaseElement,TransformElement,CVBaseElement,HierarchyElement,FrameElement,RenderableElement],CVImageElement),CVImageElement.prototype.initElement=SVGShapeElement.prototype.initElement,CVImageElement.prototype.prepareFrame=IImageElement.prototype.prepareFrame,CVImageElement.prototype.createContent=function(){if(this.img.width&&(this.assetData.w!==this.img.width||this.assetData.h!==this.img.height)){var s=createTag("canvas");s.width=this.assetData.w,s.height=this.assetData.h;var e=s.getContext("2d"),i=this.img.width,a=this.img.height,o=i/a,c=this.assetData.w/this.assetData.h,d,g,b=this.assetData.pr||this.globalData.renderConfig.imagePreserveAspectRatio;o>c&&b==="xMidYMid slice"||o<c&&b!=="xMidYMid slice"?(g=a,d=g*c):(d=i,g=d/c),e.drawImage(this.img,(i-d)/2,(a-g)/2,d,g,0,0,this.assetData.w,this.assetData.h),this.img=s}},CVImageElement.prototype.renderInnerContent=function(){this.canvasContext.drawImage(this.img,0,0)},CVImageElement.prototype.destroy=function(){this.img=null};function CVSolidElement(s,e,i){this.initElement(s,e,i)}extendPrototype([BaseElement,TransformElement,CVBaseElement,HierarchyElement,FrameElement,RenderableElement],CVSolidElement),CVSolidElement.prototype.initElement=SVGShapeElement.prototype.initElement,CVSolidElement.prototype.prepareFrame=IImageElement.prototype.prepareFrame,CVSolidElement.prototype.renderInnerContent=function(){this.globalData.renderer.ctxFillStyle(this.data.sc),this.globalData.renderer.ctxFillRect(0,0,this.data.sw,this.data.sh)};function CanvasRendererBase(){}extendPrototype([BaseRenderer],CanvasRendererBase),CanvasRendererBase.prototype.createShape=function(s){return new CVShapeElement(s,this.globalData,this)},CanvasRendererBase.prototype.createText=function(s){return new CVTextElement(s,this.globalData,this)},CanvasRendererBase.prototype.createImage=function(s){return new CVImageElement(s,this.globalData,this)},CanvasRendererBase.prototype.createSolid=function(s){return new CVSolidElement(s,this.globalData,this)},CanvasRendererBase.prototype.createNull=SVGRenderer.prototype.createNull,CanvasRendererBase.prototype.ctxTransform=function(s){s[0]===1&&s[1]===0&&s[4]===0&&s[5]===1&&s[12]===0&&s[13]===0||this.canvasContext.transform(s[0],s[1],s[4],s[5],s[12],s[13])},CanvasRendererBase.prototype.ctxOpacity=function(s){this.canvasContext.globalAlpha*=s<0?0:s},CanvasRendererBase.prototype.ctxFillStyle=function(s){this.canvasContext.fillStyle=s},CanvasRendererBase.prototype.ctxStrokeStyle=function(s){this.canvasContext.strokeStyle=s},CanvasRendererBase.prototype.ctxLineWidth=function(s){this.canvasContext.lineWidth=s},CanvasRendererBase.prototype.ctxLineCap=function(s){this.canvasContext.lineCap=s},CanvasRendererBase.prototype.ctxLineJoin=function(s){this.canvasContext.lineJoin=s},CanvasRendererBase.prototype.ctxMiterLimit=function(s){this.canvasContext.miterLimit=s},CanvasRendererBase.prototype.ctxFill=function(s){this.canvasContext.fill(s)},CanvasRendererBase.prototype.ctxFillRect=function(s,e,i,a){this.canvasContext.fillRect(s,e,i,a)},CanvasRendererBase.prototype.ctxStroke=function(){this.canvasContext.stroke()},CanvasRendererBase.prototype.reset=function(){if(!this.renderConfig.clearCanvas){this.canvasContext.restore();return}this.contextData.reset()},CanvasRendererBase.prototype.save=function(){this.canvasContext.save()},CanvasRendererBase.prototype.restore=function(s){if(!this.renderConfig.clearCanvas){this.canvasContext.restore();return}s&&(this.globalData.blendMode="source-over"),this.contextData.restore(s)},CanvasRendererBase.prototype.configAnimation=function(s){if(this.animationItem.wrapper){this.animationItem.container=createTag("canvas");var e=this.animationItem.container.style;e.width="100%",e.height="100%";var i="0px 0px 0px";e.transformOrigin=i,e.mozTransformOrigin=i,e.webkitTransformOrigin=i,e["-webkit-transform"]=i,e.contentVisibility=this.renderConfig.contentVisibility,this.animationItem.wrapper.appendChild(this.animationItem.container),this.canvasContext=this.animationItem.container.getContext("2d"),this.renderConfig.className&&this.animationItem.container.setAttribute("class",this.renderConfig.className),this.renderConfig.id&&this.animationItem.container.setAttribute("id",this.renderConfig.id)}else this.canvasContext=this.renderConfig.context;this.contextData.setContext(this.canvasContext),this.data=s,this.layers=s.layers,this.transformCanvas={w:s.w,h:s.h,sx:0,sy:0,tx:0,ty:0},this.setupGlobalData(s,document.body),this.globalData.canvasContext=this.canvasContext,this.globalData.renderer=this,this.globalData.isDashed=!1,this.globalData.progressiveLoad=this.renderConfig.progressiveLoad,this.globalData.transformCanvas=this.transformCanvas,this.elements=createSizedArray(s.layers.length),this.updateContainerSize()},CanvasRendererBase.prototype.updateContainerSize=function(s,e){this.reset();var i,a;s?(i=s,a=e,this.canvasContext.canvas.width=i,this.canvasContext.canvas.height=a):(this.animationItem.wrapper&&this.animationItem.container?(i=this.animationItem.wrapper.offsetWidth,a=this.animationItem.wrapper.offsetHeight):(i=this.canvasContext.canvas.width,a=this.canvasContext.canvas.height),this.canvasContext.canvas.width=i*this.renderConfig.dpr,this.canvasContext.canvas.height=a*this.renderConfig.dpr);var o,c;if(this.renderConfig.preserveAspectRatio.indexOf("meet")!==-1||this.renderConfig.preserveAspectRatio.indexOf("slice")!==-1){var d=this.renderConfig.preserveAspectRatio.split(" "),g=d[1]||"meet",b=d[0]||"xMidYMid",_=b.substr(0,4),j=b.substr(4);o=i/a,c=this.transformCanvas.w/this.transformCanvas.h,c>o&&g==="meet"||c<o&&g==="slice"?(this.transformCanvas.sx=i/(this.transformCanvas.w/this.renderConfig.dpr),this.transformCanvas.sy=i/(this.transformCanvas.w/this.renderConfig.dpr)):(this.transformCanvas.sx=a/(this.transformCanvas.h/this.renderConfig.dpr),this.transformCanvas.sy=a/(this.transformCanvas.h/this.renderConfig.dpr)),_==="xMid"&&(c<o&&g==="meet"||c>o&&g==="slice")?this.transformCanvas.tx=(i-this.transformCanvas.w*(a/this.transformCanvas.h))/2*this.renderConfig.dpr:_==="xMax"&&(c<o&&g==="meet"||c>o&&g==="slice")?this.transformCanvas.tx=(i-this.transformCanvas.w*(a/this.transformCanvas.h))*this.renderConfig.dpr:this.transformCanvas.tx=0,j==="YMid"&&(c>o&&g==="meet"||c<o&&g==="slice")?this.transformCanvas.ty=(a-this.transformCanvas.h*(i/this.transformCanvas.w))/2*this.renderConfig.dpr:j==="YMax"&&(c>o&&g==="meet"||c<o&&g==="slice")?this.transformCanvas.ty=(a-this.transformCanvas.h*(i/this.transformCanvas.w))*this.renderConfig.dpr:this.transformCanvas.ty=0}else this.renderConfig.preserveAspectRatio==="none"?(this.transformCanvas.sx=i/(this.transformCanvas.w/this.renderConfig.dpr),this.transformCanvas.sy=a/(this.transformCanvas.h/this.renderConfig.dpr),this.transformCanvas.tx=0,this.transformCanvas.ty=0):(this.transformCanvas.sx=this.renderConfig.dpr,this.transformCanvas.sy=this.renderConfig.dpr,this.transformCanvas.tx=0,this.transformCanvas.ty=0);this.transformCanvas.props=[this.transformCanvas.sx,0,0,0,0,this.transformCanvas.sy,0,0,0,0,1,0,this.transformCanvas.tx,this.transformCanvas.ty,0,1],this.ctxTransform(this.transformCanvas.props),this.canvasContext.beginPath(),this.canvasContext.rect(0,0,this.transformCanvas.w,this.transformCanvas.h),this.canvasContext.closePath(),this.canvasContext.clip(),this.renderFrame(this.renderedFrame,!0)},CanvasRendererBase.prototype.destroy=function(){this.renderConfig.clearCanvas&&this.animationItem.wrapper&&(this.animationItem.wrapper.innerText="");var s,e=this.layers?this.layers.length:0;for(s=e-1;s>=0;s-=1)this.elements[s]&&this.elements[s].destroy&&this.elements[s].destroy();this.elements.length=0,this.globalData.canvasContext=null,this.animationItem.container=null,this.destroyed=!0},CanvasRendererBase.prototype.renderFrame=function(s,e){if(!(this.renderedFrame===s&&this.renderConfig.clearCanvas===!0&&!e||this.destroyed||s===-1)){this.renderedFrame=s,this.globalData.frameNum=s-this.animationItem._isFirstFrame,this.globalData.frameId+=1,this.globalData._mdf=!this.renderConfig.clearCanvas||e,this.globalData.projectInterface.currentFrame=s;var i,a=this.layers.length;for(this.completeLayers||this.checkLayers(s),i=a-1;i>=0;i-=1)(this.completeLayers||this.elements[i])&&this.elements[i].prepareFrame(s-this.layers[i].st);if(this.globalData._mdf){for(this.renderConfig.clearCanvas===!0?this.canvasContext.clearRect(0,0,this.transformCanvas.w,this.transformCanvas.h):this.save(),i=a-1;i>=0;i-=1)(this.completeLayers||this.elements[i])&&this.elements[i].renderFrame();this.renderConfig.clearCanvas!==!0&&this.restore()}}},CanvasRendererBase.prototype.buildItem=function(s){var e=this.elements;if(!(e[s]||this.layers[s].ty===99)){var i=this.createItem(this.layers[s],this,this.globalData);e[s]=i,i.initExpressions()}},CanvasRendererBase.prototype.checkPendingElements=function(){for(;this.pendingElements.length;){var s=this.pendingElements.pop();s.checkParenting()}},CanvasRendererBase.prototype.hide=function(){this.animationItem.container.style.display="none"},CanvasRendererBase.prototype.show=function(){this.animationItem.container.style.display="block"};function CanvasContext(){this.opacity=-1,this.transform=createTypedArray("float32",16),this.fillStyle="",this.strokeStyle="",this.lineWidth="",this.lineCap="",this.lineJoin="",this.miterLimit="",this.id=Math.random()}function CVContextData(){this.stack=[],this.cArrPos=0,this.cTr=new Matrix;var s,e=15;for(s=0;s<e;s+=1){var i=new CanvasContext;this.stack[s]=i}this._length=e,this.nativeContext=null,this.transformMat=new Matrix,this.currentOpacity=1,this.currentFillStyle="",this.appliedFillStyle="",this.currentStrokeStyle="",this.appliedStrokeStyle="",this.currentLineWidth="",this.appliedLineWidth="",this.currentLineCap="",this.appliedLineCap="",this.currentLineJoin="",this.appliedLineJoin="",this.appliedMiterLimit="",this.currentMiterLimit=""}CVContextData.prototype.duplicate=function(){var s=this._length*2,e=0;for(e=this._length;e<s;e+=1)this.stack[e]=new CanvasContext;this._length=s},CVContextData.prototype.reset=function(){this.cArrPos=0,this.cTr.reset(),this.stack[this.cArrPos].opacity=1},CVContextData.prototype.restore=function(s){this.cArrPos-=1;var e=this.stack[this.cArrPos],i=e.transform,a,o=this.cTr.props;for(a=0;a<16;a+=1)o[a]=i[a];if(s){this.nativeContext.restore();var c=this.stack[this.cArrPos+1];this.appliedFillStyle=c.fillStyle,this.appliedStrokeStyle=c.strokeStyle,this.appliedLineWidth=c.lineWidth,this.appliedLineCap=c.lineCap,this.appliedLineJoin=c.lineJoin,this.appliedMiterLimit=c.miterLimit}this.nativeContext.setTransform(i[0],i[1],i[4],i[5],i[12],i[13]),(s||e.opacity!==-1&&this.currentOpacity!==e.opacity)&&(this.nativeContext.globalAlpha=e.opacity,this.currentOpacity=e.opacity),this.currentFillStyle=e.fillStyle,this.currentStrokeStyle=e.strokeStyle,this.currentLineWidth=e.lineWidth,this.currentLineCap=e.lineCap,this.currentLineJoin=e.lineJoin,this.currentMiterLimit=e.miterLimit},CVContextData.prototype.save=function(s){s&&this.nativeContext.save();var e=this.cTr.props;this._length<=this.cArrPos&&this.duplicate();var i=this.stack[this.cArrPos],a;for(a=0;a<16;a+=1)i.transform[a]=e[a];this.cArrPos+=1;var o=this.stack[this.cArrPos];o.opacity=i.opacity,o.fillStyle=i.fillStyle,o.strokeStyle=i.strokeStyle,o.lineWidth=i.lineWidth,o.lineCap=i.lineCap,o.lineJoin=i.lineJoin,o.miterLimit=i.miterLimit},CVContextData.prototype.setOpacity=function(s){this.stack[this.cArrPos].opacity=s},CVContextData.prototype.setContext=function(s){this.nativeContext=s},CVContextData.prototype.fillStyle=function(s){this.stack[this.cArrPos].fillStyle!==s&&(this.currentFillStyle=s,this.stack[this.cArrPos].fillStyle=s)},CVContextData.prototype.strokeStyle=function(s){this.stack[this.cArrPos].strokeStyle!==s&&(this.currentStrokeStyle=s,this.stack[this.cArrPos].strokeStyle=s)},CVContextData.prototype.lineWidth=function(s){this.stack[this.cArrPos].lineWidth!==s&&(this.currentLineWidth=s,this.stack[this.cArrPos].lineWidth=s)},CVContextData.prototype.lineCap=function(s){this.stack[this.cArrPos].lineCap!==s&&(this.currentLineCap=s,this.stack[this.cArrPos].lineCap=s)},CVContextData.prototype.lineJoin=function(s){this.stack[this.cArrPos].lineJoin!==s&&(this.currentLineJoin=s,this.stack[this.cArrPos].lineJoin=s)},CVContextData.prototype.miterLimit=function(s){this.stack[this.cArrPos].miterLimit!==s&&(this.currentMiterLimit=s,this.stack[this.cArrPos].miterLimit=s)},CVContextData.prototype.transform=function(s){this.transformMat.cloneFromProps(s);var e=this.cTr;this.transformMat.multiply(e),e.cloneFromProps(this.transformMat.props);var i=e.props;this.nativeContext.setTransform(i[0],i[1],i[4],i[5],i[12],i[13])},CVContextData.prototype.opacity=function(s){var e=this.stack[this.cArrPos].opacity;e*=s<0?0:s,this.stack[this.cArrPos].opacity!==e&&(this.currentOpacity!==s&&(this.nativeContext.globalAlpha=s,this.currentOpacity=s),this.stack[this.cArrPos].opacity=e)},CVContextData.prototype.fill=function(s){this.appliedFillStyle!==this.currentFillStyle&&(this.appliedFillStyle=this.currentFillStyle,this.nativeContext.fillStyle=this.appliedFillStyle),this.nativeContext.fill(s)},CVContextData.prototype.fillRect=function(s,e,i,a){this.appliedFillStyle!==this.currentFillStyle&&(this.appliedFillStyle=this.currentFillStyle,this.nativeContext.fillStyle=this.appliedFillStyle),this.nativeContext.fillRect(s,e,i,a)},CVContextData.prototype.stroke=function(){this.appliedStrokeStyle!==this.currentStrokeStyle&&(this.appliedStrokeStyle=this.currentStrokeStyle,this.nativeContext.strokeStyle=this.appliedStrokeStyle),this.appliedLineWidth!==this.currentLineWidth&&(this.appliedLineWidth=this.currentLineWidth,this.nativeContext.lineWidth=this.appliedLineWidth),this.appliedLineCap!==this.currentLineCap&&(this.appliedLineCap=this.currentLineCap,this.nativeContext.lineCap=this.appliedLineCap),this.appliedLineJoin!==this.currentLineJoin&&(this.appliedLineJoin=this.currentLineJoin,this.nativeContext.lineJoin=this.appliedLineJoin),this.appliedMiterLimit!==this.currentMiterLimit&&(this.appliedMiterLimit=this.currentMiterLimit,this.nativeContext.miterLimit=this.appliedMiterLimit),this.nativeContext.stroke()};function CVCompElement(s,e,i){this.completeLayers=!1,this.layers=s.layers,this.pendingElements=[],this.elements=createSizedArray(this.layers.length),this.initElement(s,e,i),this.tm=s.tm?PropertyFactory.getProp(this,s.tm,0,e.frameRate,this):{_placeholder:!0}}extendPrototype([CanvasRendererBase,ICompElement,CVBaseElement],CVCompElement),CVCompElement.prototype.renderInnerContent=function(){var s=this.canvasContext;s.beginPath(),s.moveTo(0,0),s.lineTo(this.data.w,0),s.lineTo(this.data.w,this.data.h),s.lineTo(0,this.data.h),s.lineTo(0,0),s.clip();var e,i=this.layers.length;for(e=i-1;e>=0;e-=1)(this.completeLayers||this.elements[e])&&this.elements[e].renderFrame()},CVCompElement.prototype.destroy=function(){var s,e=this.layers.length;for(s=e-1;s>=0;s-=1)this.elements[s]&&this.elements[s].destroy();this.layers=null,this.elements=null},CVCompElement.prototype.createComp=function(s){return new CVCompElement(s,this.globalData,this)};function CanvasRenderer(s,e){this.animationItem=s,this.renderConfig={clearCanvas:e&&e.clearCanvas!==void 0?e.clearCanvas:!0,context:e&&e.context||null,progressiveLoad:e&&e.progressiveLoad||!1,preserveAspectRatio:e&&e.preserveAspectRatio||"xMidYMid meet",imagePreserveAspectRatio:e&&e.imagePreserveAspectRatio||"xMidYMid slice",contentVisibility:e&&e.contentVisibility||"visible",className:e&&e.className||"",id:e&&e.id||"",runExpressions:!e||e.runExpressions===void 0||e.runExpressions},this.renderConfig.dpr=e&&e.dpr||1,this.animationItem.wrapper&&(this.renderConfig.dpr=e&&e.dpr||window.devicePixelRatio||1),this.renderedFrame=-1,this.globalData={frameNum:-1,_mdf:!1,renderConfig:this.renderConfig,currentGlobalAlpha:-1},this.contextData=new CVContextData,this.elements=[],this.pendingElements=[],this.transformMat=new Matrix,this.completeLayers=!1,this.rendererType="canvas",this.renderConfig.clearCanvas&&(this.ctxTransform=this.contextData.transform.bind(this.contextData),this.ctxOpacity=this.contextData.opacity.bind(this.contextData),this.ctxFillStyle=this.contextData.fillStyle.bind(this.contextData),this.ctxStrokeStyle=this.contextData.strokeStyle.bind(this.contextData),this.ctxLineWidth=this.contextData.lineWidth.bind(this.contextData),this.ctxLineCap=this.contextData.lineCap.bind(this.contextData),this.ctxLineJoin=this.contextData.lineJoin.bind(this.contextData),this.ctxMiterLimit=this.contextData.miterLimit.bind(this.contextData),this.ctxFill=this.contextData.fill.bind(this.contextData),this.ctxFillRect=this.contextData.fillRect.bind(this.contextData),this.ctxStroke=this.contextData.stroke.bind(this.contextData),this.save=this.contextData.save.bind(this.contextData))}extendPrototype([CanvasRendererBase],CanvasRenderer),CanvasRenderer.prototype.createComp=function(s){return new CVCompElement(s,this.globalData,this)};function HBaseElement(){}HBaseElement.prototype={checkBlendMode:function(){},initRendererElement:function(){this.baseElement=createTag(this.data.tg||"div"),this.data.hasMask?(this.svgElement=createNS("svg"),this.layerElement=createNS("g"),this.maskedElement=this.layerElement,this.svgElement.appendChild(this.layerElement),this.baseElement.appendChild(this.svgElement)):this.layerElement=this.baseElement,styleDiv(this.baseElement)},createContainerElements:function(){this.renderableEffectsManager=new CVEffects(this),this.transformedElement=this.baseElement,this.maskedElement=this.layerElement,this.data.ln&&this.layerElement.setAttribute("id",this.data.ln),this.data.cl&&this.layerElement.setAttribute("class",this.data.cl),this.data.bm!==0&&this.setBlendMode()},renderElement:function(){var e=this.transformedElement?this.transformedElement.style:{};if(this.finalTransform._matMdf){var i=this.finalTransform.mat.toCSS();e.transform=i,e.webkitTransform=i}this.finalTransform._opMdf&&(e.opacity=this.finalTransform.mProp.o.v)},renderFrame:function(){this.data.hd||this.hidden||(this.renderTransform(),this.renderRenderable(),this.renderElement(),this.renderInnerContent(),this._isFirstFrame&&(this._isFirstFrame=!1))},destroy:function(){this.layerElement=null,this.transformedElement=null,this.matteElement&&(this.matteElement=null),this.maskManager&&(this.maskManager.destroy(),this.maskManager=null)},createRenderableComponents:function(){this.maskManager=new MaskElement(this.data,this,this.globalData)},addEffects:function(){},setMatte:function(){}},HBaseElement.prototype.getBaseElement=SVGBaseElement.prototype.getBaseElement,HBaseElement.prototype.destroyBaseElement=HBaseElement.prototype.destroy,HBaseElement.prototype.buildElementParenting=BaseRenderer.prototype.buildElementParenting;function HSolidElement(s,e,i){this.initElement(s,e,i)}extendPrototype([BaseElement,TransformElement,HBaseElement,HierarchyElement,FrameElement,RenderableDOMElement],HSolidElement),HSolidElement.prototype.createContent=function(){var s;this.data.hasMask?(s=createNS("rect"),s.setAttribute("width",this.data.sw),s.setAttribute("height",this.data.sh),s.setAttribute("fill",this.data.sc),this.svgElement.setAttribute("width",this.data.sw),this.svgElement.setAttribute("height",this.data.sh)):(s=createTag("div"),s.style.width=this.data.sw+"px",s.style.height=this.data.sh+"px",s.style.backgroundColor=this.data.sc),this.layerElement.appendChild(s)};function HShapeElement(s,e,i){this.shapes=[],this.shapesData=s.shapes,this.stylesList=[],this.shapeModifiers=[],this.itemsData=[],this.processedElements=[],this.animatedContents=[],this.shapesContainer=createNS("g"),this.initElement(s,e,i),this.prevViewData=[],this.currentBBox={x:999999,y:-999999,h:0,w:0}}extendPrototype([BaseElement,TransformElement,HSolidElement,SVGShapeElement,HBaseElement,HierarchyElement,FrameElement,RenderableElement],HShapeElement),HShapeElement.prototype._renderShapeFrame=HShapeElement.prototype.renderInnerContent,HShapeElement.prototype.createContent=function(){var s;if(this.baseElement.style.fontSize=0,this.data.hasMask)this.layerElement.appendChild(this.shapesContainer),s=this.svgElement;else{s=createNS("svg");var e=this.comp.data?this.comp.data:this.globalData.compSize;s.setAttribute("width",e.w),s.setAttribute("height",e.h),s.appendChild(this.shapesContainer),this.layerElement.appendChild(s)}this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.shapesContainer,0,[],!0),this.filterUniqueShapes(),this.shapeCont=s},HShapeElement.prototype.getTransformedPoint=function(s,e){var i,a=s.length;for(i=0;i<a;i+=1)e=s[i].mProps.v.applyToPointArray(e[0],e[1],0);return e},HShapeElement.prototype.calculateShapeBoundingBox=function(s,e){var i=s.sh.v,a=s.transformers,o,c=i._length,d,g,b,_;if(!(c<=1)){for(o=0;o<c-1;o+=1)d=this.getTransformedPoint(a,i.v[o]),g=this.getTransformedPoint(a,i.o[o]),b=this.getTransformedPoint(a,i.i[o+1]),_=this.getTransformedPoint(a,i.v[o+1]),this.checkBounds(d,g,b,_,e);i.c&&(d=this.getTransformedPoint(a,i.v[o]),g=this.getTransformedPoint(a,i.o[o]),b=this.getTransformedPoint(a,i.i[0]),_=this.getTransformedPoint(a,i.v[0]),this.checkBounds(d,g,b,_,e))}},HShapeElement.prototype.checkBounds=function(s,e,i,a,o){this.getBoundsOfCurve(s,e,i,a);var c=this.shapeBoundingBox;o.x=bmMin(c.left,o.x),o.xMax=bmMax(c.right,o.xMax),o.y=bmMin(c.top,o.y),o.yMax=bmMax(c.bottom,o.yMax)},HShapeElement.prototype.shapeBoundingBox={left:0,right:0,top:0,bottom:0},HShapeElement.prototype.tempBoundingBox={x:0,xMax:0,y:0,yMax:0,width:0,height:0},HShapeElement.prototype.getBoundsOfCurve=function(s,e,i,a){for(var o=[[s[0],a[0]],[s[1],a[1]]],c,d,g,b,_,j,$,_e=0;_e<2;++_e)d=6*s[_e]-12*e[_e]+6*i[_e],c=-3*s[_e]+9*e[_e]-9*i[_e]+3*a[_e],g=3*e[_e]-3*s[_e],d|=0,c|=0,g|=0,c===0&&d===0||(c===0?(b=-g/d,b>0&&b<1&&o[_e].push(this.calculateF(b,s,e,i,a,_e))):(_=d*d-4*g*c,_>=0&&(j=(-d+bmSqrt(_))/(2*c),j>0&&j<1&&o[_e].push(this.calculateF(j,s,e,i,a,_e)),$=(-d-bmSqrt(_))/(2*c),$>0&&$<1&&o[_e].push(this.calculateF($,s,e,i,a,_e)))));this.shapeBoundingBox.left=bmMin.apply(null,o[0]),this.shapeBoundingBox.top=bmMin.apply(null,o[1]),this.shapeBoundingBox.right=bmMax.apply(null,o[0]),this.shapeBoundingBox.bottom=bmMax.apply(null,o[1])},HShapeElement.prototype.calculateF=function(s,e,i,a,o,c){return bmPow(1-s,3)*e[c]+3*bmPow(1-s,2)*s*i[c]+3*(1-s)*bmPow(s,2)*a[c]+bmPow(s,3)*o[c]},HShapeElement.prototype.calculateBoundingBox=function(s,e){var i,a=s.length;for(i=0;i<a;i+=1)s[i]&&s[i].sh?this.calculateShapeBoundingBox(s[i],e):s[i]&&s[i].it?this.calculateBoundingBox(s[i].it,e):s[i]&&s[i].style&&s[i].w&&this.expandStrokeBoundingBox(s[i].w,e)},HShapeElement.prototype.expandStrokeBoundingBox=function(s,e){var i=0;if(s.keyframes){for(var a=0;a<s.keyframes.length;a+=1){var o=s.keyframes[a].s;o>i&&(i=o)}i*=s.mult}else i=s.v*s.mult;e.x-=i,e.xMax+=i,e.y-=i,e.yMax+=i},HShapeElement.prototype.currentBoxContains=function(s){return this.currentBBox.x<=s.x&&this.currentBBox.y<=s.y&&this.currentBBox.width+this.currentBBox.x>=s.x+s.width&&this.currentBBox.height+this.currentBBox.y>=s.y+s.height},HShapeElement.prototype.renderInnerContent=function(){if(this._renderShapeFrame(),!this.hidden&&(this._isFirstFrame||this._mdf)){var s=this.tempBoundingBox,e=999999;if(s.x=e,s.xMax=-e,s.y=e,s.yMax=-e,this.calculateBoundingBox(this.itemsData,s),s.width=s.xMax<s.x?0:s.xMax-s.x,s.height=s.yMax<s.y?0:s.yMax-s.y,this.currentBoxContains(s))return;var i=!1;if(this.currentBBox.w!==s.width&&(this.currentBBox.w=s.width,this.shapeCont.setAttribute("width",s.width),i=!0),this.currentBBox.h!==s.height&&(this.currentBBox.h=s.height,this.shapeCont.setAttribute("height",s.height),i=!0),i||this.currentBBox.x!==s.x||this.currentBBox.y!==s.y){this.currentBBox.w=s.width,this.currentBBox.h=s.height,this.currentBBox.x=s.x,this.currentBBox.y=s.y,this.shapeCont.setAttribute("viewBox",this.currentBBox.x+" "+this.currentBBox.y+" "+this.currentBBox.w+" "+this.currentBBox.h);var a=this.shapeCont.style,o="translate("+this.currentBBox.x+"px,"+this.currentBBox.y+"px)";a.transform=o,a.webkitTransform=o}}};function HTextElement(s,e,i){this.textSpans=[],this.textPaths=[],this.currentBBox={x:999999,y:-999999,h:0,w:0},this.renderType="svg",this.isMasked=!1,this.initElement(s,e,i)}extendPrototype([BaseElement,TransformElement,HBaseElement,HierarchyElement,FrameElement,RenderableDOMElement,ITextElement],HTextElement),HTextElement.prototype.createContent=function(){if(this.isMasked=this.checkMasks(),this.isMasked){this.renderType="svg",this.compW=this.comp.data.w,this.compH=this.comp.data.h,this.svgElement.setAttribute("width",this.compW),this.svgElement.setAttribute("height",this.compH);var s=createNS("g");this.maskedElement.appendChild(s),this.innerElem=s}else this.renderType="html",this.innerElem=this.layerElement;this.checkParenting()},HTextElement.prototype.buildNewText=function(){var s=this.textProperty.currentData;this.renderedLetters=createSizedArray(s.l?s.l.length:0);var e=this.innerElem.style,i=s.fc?this.buildColor(s.fc):"rgba(0,0,0,0)";e.fill=i,e.color=i,s.sc&&(e.stroke=this.buildColor(s.sc),e.strokeWidth=s.sw+"px");var a=this.globalData.fontManager.getFontByName(s.f);if(!this.globalData.fontManager.chars)if(e.fontSize=s.finalSize+"px",e.lineHeight=s.finalSize+"px",a.fClass)this.innerElem.className=a.fClass;else{e.fontFamily=a.fFamily;var o=s.fWeight,c=s.fStyle;e.fontStyle=c,e.fontWeight=o}var d,g,b=s.l;g=b.length;var _,j,$,_e=this.mHelper,tt,et="",st=0;for(d=0;d<g;d+=1){if(this.globalData.fontManager.chars?(this.textPaths[st]?_=this.textPaths[st]:(_=createNS("path"),_.setAttribute("stroke-linecap",lineCapEnum[1]),_.setAttribute("stroke-linejoin",lineJoinEnum[2]),_.setAttribute("stroke-miterlimit","4")),this.isMasked||(this.textSpans[st]?(j=this.textSpans[st],$=j.children[0]):(j=createTag("div"),j.style.lineHeight=0,$=createNS("svg"),$.appendChild(_),styleDiv(j)))):this.isMasked?_=this.textPaths[st]?this.textPaths[st]:createNS("text"):this.textSpans[st]?(j=this.textSpans[st],_=this.textPaths[st]):(j=createTag("span"),styleDiv(j),_=createTag("span"),styleDiv(_),j.appendChild(_)),this.globalData.fontManager.chars){var at=this.globalData.fontManager.getCharData(s.finalText[d],a.fStyle,this.globalData.fontManager.getFontByName(s.f).fFamily),rt;if(at?rt=at.data:rt=null,_e.reset(),rt&&rt.shapes&&rt.shapes.length&&(tt=rt.shapes[0].it,_e.scale(s.finalSize/100,s.finalSize/100),et=this.createPathShape(_e,tt),_.setAttribute("d",et)),this.isMasked)this.innerElem.appendChild(_);else{if(this.innerElem.appendChild(j),rt&&rt.shapes){document.body.appendChild($);var nt=$.getBBox();$.setAttribute("width",nt.width+2),$.setAttribute("height",nt.height+2),$.setAttribute("viewBox",nt.x-1+" "+(nt.y-1)+" "+(nt.width+2)+" "+(nt.height+2));var it=$.style,ot="translate("+(nt.x-1)+"px,"+(nt.y-1)+"px)";it.transform=ot,it.webkitTransform=ot,b[d].yOffset=nt.y-1}else $.setAttribute("width",1),$.setAttribute("height",1);j.appendChild($)}}else if(_.textContent=b[d].val,_.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),this.isMasked)this.innerElem.appendChild(_);else{this.innerElem.appendChild(j);var lt=_.style,ct="translate3d(0,"+-s.finalSize/1.2+"px,0)";lt.transform=ct,lt.webkitTransform=ct}this.isMasked?this.textSpans[st]=_:this.textSpans[st]=j,this.textSpans[st].style.display="block",this.textPaths[st]=_,st+=1}for(;st<this.textSpans.length;)this.textSpans[st].style.display="none",st+=1},HTextElement.prototype.renderInnerContent=function(){this.validateText();var s;if(this.data.singleShape){if(!this._isFirstFrame&&!this.lettersChangedFlag)return;if(this.isMasked&&this.finalTransform._matMdf){this.svgElement.setAttribute("viewBox",-this.finalTransform.mProp.p.v[0]+" "+-this.finalTransform.mProp.p.v[1]+" "+this.compW+" "+this.compH),s=this.svgElement.style;var e="translate("+-this.finalTransform.mProp.p.v[0]+"px,"+-this.finalTransform.mProp.p.v[1]+"px)";s.transform=e,s.webkitTransform=e}}if(this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag),!(!this.lettersChangedFlag&&!this.textAnimator.lettersChangedFlag)){var i,a,o=0,c=this.textAnimator.renderedLetters,d=this.textProperty.currentData.l;a=d.length;var g,b,_;for(i=0;i<a;i+=1)d[i].n?o+=1:(b=this.textSpans[i],_=this.textPaths[i],g=c[o],o+=1,g._mdf.m&&(this.isMasked?b.setAttribute("transform",g.m):(b.style.webkitTransform=g.m,b.style.transform=g.m)),b.style.opacity=g.o,g.sw&&g._mdf.sw&&_.setAttribute("stroke-width",g.sw),g.sc&&g._mdf.sc&&_.setAttribute("stroke",g.sc),g.fc&&g._mdf.fc&&(_.setAttribute("fill",g.fc),_.style.color=g.fc));if(this.innerElem.getBBox&&!this.hidden&&(this._isFirstFrame||this._mdf)){var j=this.innerElem.getBBox();this.currentBBox.w!==j.width&&(this.currentBBox.w=j.width,this.svgElement.setAttribute("width",j.width)),this.currentBBox.h!==j.height&&(this.currentBBox.h=j.height,this.svgElement.setAttribute("height",j.height));var $=1;if(this.currentBBox.w!==j.width+$*2||this.currentBBox.h!==j.height+$*2||this.currentBBox.x!==j.x-$||this.currentBBox.y!==j.y-$){this.currentBBox.w=j.width+$*2,this.currentBBox.h=j.height+$*2,this.currentBBox.x=j.x-$,this.currentBBox.y=j.y-$,this.svgElement.setAttribute("viewBox",this.currentBBox.x+" "+this.currentBBox.y+" "+this.currentBBox.w+" "+this.currentBBox.h),s=this.svgElement.style;var _e="translate("+this.currentBBox.x+"px,"+this.currentBBox.y+"px)";s.transform=_e,s.webkitTransform=_e}}}};function HCameraElement(s,e,i){this.initFrame(),this.initBaseData(s,e,i),this.initHierarchy();var a=PropertyFactory.getProp;if(this.pe=a(this,s.pe,0,0,this),s.ks.p.s?(this.px=a(this,s.ks.p.x,1,0,this),this.py=a(this,s.ks.p.y,1,0,this),this.pz=a(this,s.ks.p.z,1,0,this)):this.p=a(this,s.ks.p,1,0,this),s.ks.a&&(this.a=a(this,s.ks.a,1,0,this)),s.ks.or.k.length&&s.ks.or.k[0].to){var o,c=s.ks.or.k.length;for(o=0;o<c;o+=1)s.ks.or.k[o].to=null,s.ks.or.k[o].ti=null}this.or=a(this,s.ks.or,1,degToRads,this),this.or.sh=!0,this.rx=a(this,s.ks.rx,0,degToRads,this),this.ry=a(this,s.ks.ry,0,degToRads,this),this.rz=a(this,s.ks.rz,0,degToRads,this),this.mat=new Matrix,this._prevMat=new Matrix,this._isFirstFrame=!0,this.finalTransform={mProp:this}}extendPrototype([BaseElement,FrameElement,HierarchyElement],HCameraElement),HCameraElement.prototype.setup=function(){var s,e=this.comp.threeDElements.length,i,a,o;for(s=0;s<e;s+=1)if(i=this.comp.threeDElements[s],i.type==="3d"){a=i.perspectiveElem.style,o=i.container.style;var c=this.pe.v+"px",d="0px 0px 0px",g="matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)";a.perspective=c,a.webkitPerspective=c,o.transformOrigin=d,o.mozTransformOrigin=d,o.webkitTransformOrigin=d,a.transform=g,a.webkitTransform=g}},HCameraElement.prototype.createElements=function(){},HCameraElement.prototype.hide=function(){},HCameraElement.prototype.renderFrame=function(){var s=this._isFirstFrame,e,i;if(this.hierarchy)for(i=this.hierarchy.length,e=0;e<i;e+=1)s=this.hierarchy[e].finalTransform.mProp._mdf||s;if(s||this.pe._mdf||this.p&&this.p._mdf||this.px&&(this.px._mdf||this.py._mdf||this.pz._mdf)||this.rx._mdf||this.ry._mdf||this.rz._mdf||this.or._mdf||this.a&&this.a._mdf){if(this.mat.reset(),this.hierarchy)for(i=this.hierarchy.length-1,e=i;e>=0;e-=1){var a=this.hierarchy[e].finalTransform.mProp;this.mat.translate(-a.p.v[0],-a.p.v[1],a.p.v[2]),this.mat.rotateX(-a.or.v[0]).rotateY(-a.or.v[1]).rotateZ(a.or.v[2]),this.mat.rotateX(-a.rx.v).rotateY(-a.ry.v).rotateZ(a.rz.v),this.mat.scale(1/a.s.v[0],1/a.s.v[1],1/a.s.v[2]),this.mat.translate(a.a.v[0],a.a.v[1],a.a.v[2])}if(this.p?this.mat.translate(-this.p.v[0],-this.p.v[1],this.p.v[2]):this.mat.translate(-this.px.v,-this.py.v,this.pz.v),this.a){var o;this.p?o=[this.p.v[0]-this.a.v[0],this.p.v[1]-this.a.v[1],this.p.v[2]-this.a.v[2]]:o=[this.px.v-this.a.v[0],this.py.v-this.a.v[1],this.pz.v-this.a.v[2]];var c=Math.sqrt(Math.pow(o[0],2)+Math.pow(o[1],2)+Math.pow(o[2],2)),d=[o[0]/c,o[1]/c,o[2]/c],g=Math.sqrt(d[2]*d[2]+d[0]*d[0]),b=Math.atan2(d[1],g),_=Math.atan2(d[0],-d[2]);this.mat.rotateY(_).rotateX(-b)}this.mat.rotateX(-this.rx.v).rotateY(-this.ry.v).rotateZ(this.rz.v),this.mat.rotateX(-this.or.v[0]).rotateY(-this.or.v[1]).rotateZ(this.or.v[2]),this.mat.translate(this.globalData.compSize.w/2,this.globalData.compSize.h/2,0),this.mat.translate(0,0,this.pe.v);var j=!this._prevMat.equals(this.mat);if((j||this.pe._mdf)&&this.comp.threeDElements){i=this.comp.threeDElements.length;var $,_e,tt;for(e=0;e<i;e+=1)if($=this.comp.threeDElements[e],$.type==="3d"){if(j){var et=this.mat.toCSS();tt=$.container.style,tt.transform=et,tt.webkitTransform=et}this.pe._mdf&&(_e=$.perspectiveElem.style,_e.perspective=this.pe.v+"px",_e.webkitPerspective=this.pe.v+"px")}this.mat.clone(this._prevMat)}}this._isFirstFrame=!1},HCameraElement.prototype.prepareFrame=function(s){this.prepareProperties(s,!0)},HCameraElement.prototype.destroy=function(){},HCameraElement.prototype.getBaseElement=function(){return null};function HImageElement(s,e,i){this.assetData=e.getAssetData(s.refId),this.initElement(s,e,i)}extendPrototype([BaseElement,TransformElement,HBaseElement,HSolidElement,HierarchyElement,FrameElement,RenderableElement],HImageElement),HImageElement.prototype.createContent=function(){var s=this.globalData.getAssetsPath(this.assetData),e=new Image;this.data.hasMask?(this.imageElem=createNS("image"),this.imageElem.setAttribute("width",this.assetData.w+"px"),this.imageElem.setAttribute("height",this.assetData.h+"px"),this.imageElem.setAttributeNS("http://www.w3.org/1999/xlink","href",s),this.layerElement.appendChild(this.imageElem),this.baseElement.setAttribute("width",this.assetData.w),this.baseElement.setAttribute("height",this.assetData.h)):this.layerElement.appendChild(e),e.crossOrigin="anonymous",e.src=s,this.data.ln&&this.baseElement.setAttribute("id",this.data.ln)};function HybridRendererBase(s,e){this.animationItem=s,this.layers=null,this.renderedFrame=-1,this.renderConfig={className:e&&e.className||"",imagePreserveAspectRatio:e&&e.imagePreserveAspectRatio||"xMidYMid slice",hideOnTransparent:!(e&&e.hideOnTransparent===!1),filterSize:{width:e&&e.filterSize&&e.filterSize.width||"400%",height:e&&e.filterSize&&e.filterSize.height||"400%",x:e&&e.filterSize&&e.filterSize.x||"-100%",y:e&&e.filterSize&&e.filterSize.y||"-100%"}},this.globalData={_mdf:!1,frameNum:-1,renderConfig:this.renderConfig},this.pendingElements=[],this.elements=[],this.threeDElements=[],this.destroyed=!1,this.camera=null,this.supports3d=!0,this.rendererType="html"}extendPrototype([BaseRenderer],HybridRendererBase),HybridRendererBase.prototype.buildItem=SVGRenderer.prototype.buildItem,HybridRendererBase.prototype.checkPendingElements=function(){for(;this.pendingElements.length;){var s=this.pendingElements.pop();s.checkParenting()}},HybridRendererBase.prototype.appendElementInPos=function(s,e){var i=s.getBaseElement();if(i){var a=this.layers[e];if(!a.ddd||!this.supports3d)if(this.threeDElements)this.addTo3dContainer(i,e);else{for(var o=0,c,d,g;o<e;)this.elements[o]&&this.elements[o]!==!0&&this.elements[o].getBaseElement&&(d=this.elements[o],g=this.layers[o].ddd?this.getThreeDContainerByPos(o):d.getBaseElement(),c=g||c),o+=1;c?(!a.ddd||!this.supports3d)&&this.layerElement.insertBefore(i,c):(!a.ddd||!this.supports3d)&&this.layerElement.appendChild(i)}else this.addTo3dContainer(i,e)}},HybridRendererBase.prototype.createShape=function(s){return this.supports3d?new HShapeElement(s,this.globalData,this):new SVGShapeElement(s,this.globalData,this)},HybridRendererBase.prototype.createText=function(s){return this.supports3d?new HTextElement(s,this.globalData,this):new SVGTextLottieElement(s,this.globalData,this)},HybridRendererBase.prototype.createCamera=function(s){return this.camera=new HCameraElement(s,this.globalData,this),this.camera},HybridRendererBase.prototype.createImage=function(s){return this.supports3d?new HImageElement(s,this.globalData,this):new IImageElement(s,this.globalData,this)},HybridRendererBase.prototype.createSolid=function(s){return this.supports3d?new HSolidElement(s,this.globalData,this):new ISolidElement(s,this.globalData,this)},HybridRendererBase.prototype.createNull=SVGRenderer.prototype.createNull,HybridRendererBase.prototype.getThreeDContainerByPos=function(s){for(var e=0,i=this.threeDElements.length;e<i;){if(this.threeDElements[e].startPos<=s&&this.threeDElements[e].endPos>=s)return this.threeDElements[e].perspectiveElem;e+=1}return null},HybridRendererBase.prototype.createThreeDContainer=function(s,e){var i=createTag("div"),a,o;styleDiv(i);var c=createTag("div");if(styleDiv(c),e==="3d"){a=i.style,a.width=this.globalData.compSize.w+"px",a.height=this.globalData.compSize.h+"px";var d="50% 50%";a.webkitTransformOrigin=d,a.mozTransformOrigin=d,a.transformOrigin=d,o=c.style;var g="matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)";o.transform=g,o.webkitTransform=g}i.appendChild(c);var b={container:c,perspectiveElem:i,startPos:s,endPos:s,type:e};return this.threeDElements.push(b),b},HybridRendererBase.prototype.build3dContainers=function(){var s,e=this.layers.length,i,a="";for(s=0;s<e;s+=1)this.layers[s].ddd&&this.layers[s].ty!==3?(a!=="3d"&&(a="3d",i=this.createThreeDContainer(s,"3d")),i.endPos=Math.max(i.endPos,s)):(a!=="2d"&&(a="2d",i=this.createThreeDContainer(s,"2d")),i.endPos=Math.max(i.endPos,s));for(e=this.threeDElements.length,s=e-1;s>=0;s-=1)this.resizerElem.appendChild(this.threeDElements[s].perspectiveElem)},HybridRendererBase.prototype.addTo3dContainer=function(s,e){for(var i=0,a=this.threeDElements.length;i<a;){if(e<=this.threeDElements[i].endPos){for(var o=this.threeDElements[i].startPos,c;o<e;)this.elements[o]&&this.elements[o].getBaseElement&&(c=this.elements[o].getBaseElement()),o+=1;c?this.threeDElements[i].container.insertBefore(s,c):this.threeDElements[i].container.appendChild(s);break}i+=1}},HybridRendererBase.prototype.configAnimation=function(s){var e=createTag("div"),i=this.animationItem.wrapper,a=e.style;a.width=s.w+"px",a.height=s.h+"px",this.resizerElem=e,styleDiv(e),a.transformStyle="flat",a.mozTransformStyle="flat",a.webkitTransformStyle="flat",this.renderConfig.className&&e.setAttribute("class",this.renderConfig.className),i.appendChild(e),a.overflow="hidden";var o=createNS("svg");o.setAttribute("width","1"),o.setAttribute("height","1"),styleDiv(o),this.resizerElem.appendChild(o);var c=createNS("defs");o.appendChild(c),this.data=s,this.setupGlobalData(s,o),this.globalData.defs=c,this.layers=s.layers,this.layerElement=this.resizerElem,this.build3dContainers(),this.updateContainerSize()},HybridRendererBase.prototype.destroy=function(){this.animationItem.wrapper&&(this.animationItem.wrapper.innerText=""),this.animationItem.container=null,this.globalData.defs=null;var s,e=this.layers?this.layers.length:0;for(s=0;s<e;s+=1)this.elements[s]&&this.elements[s].destroy&&this.elements[s].destroy();this.elements.length=0,this.destroyed=!0,this.animationItem=null},HybridRendererBase.prototype.updateContainerSize=function(){var s=this.animationItem.wrapper.offsetWidth,e=this.animationItem.wrapper.offsetHeight,i=s/e,a=this.globalData.compSize.w/this.globalData.compSize.h,o,c,d,g;a>i?(o=s/this.globalData.compSize.w,c=s/this.globalData.compSize.w,d=0,g=(e-this.globalData.compSize.h*(s/this.globalData.compSize.w))/2):(o=e/this.globalData.compSize.h,c=e/this.globalData.compSize.h,d=(s-this.globalData.compSize.w*(e/this.globalData.compSize.h))/2,g=0);var b=this.resizerElem.style;b.webkitTransform="matrix3d("+o+",0,0,0,0,"+c+",0,0,0,0,1,0,"+d+","+g+",0,1)",b.transform=b.webkitTransform},HybridRendererBase.prototype.renderFrame=SVGRenderer.prototype.renderFrame,HybridRendererBase.prototype.hide=function(){this.resizerElem.style.display="none"},HybridRendererBase.prototype.show=function(){this.resizerElem.style.display="block"},HybridRendererBase.prototype.initItems=function(){if(this.buildAllItems(),this.camera)this.camera.setup();else{var s=this.globalData.compSize.w,e=this.globalData.compSize.h,i,a=this.threeDElements.length;for(i=0;i<a;i+=1){var o=this.threeDElements[i].perspectiveElem.style;o.webkitPerspective=Math.sqrt(Math.pow(s,2)+Math.pow(e,2))+"px",o.perspective=o.webkitPerspective}}},HybridRendererBase.prototype.searchExtraCompositions=function(s){var e,i=s.length,a=createTag("div");for(e=0;e<i;e+=1)if(s[e].xt){var o=this.createComp(s[e],a,this.globalData.comp,null);o.initExpressions(),this.globalData.projectInterface.registerComposition(o)}};function HCompElement(s,e,i){this.layers=s.layers,this.supports3d=!s.hasMask,this.completeLayers=!1,this.pendingElements=[],this.elements=this.layers?createSizedArray(this.layers.length):[],this.initElement(s,e,i),this.tm=s.tm?PropertyFactory.getProp(this,s.tm,0,e.frameRate,this):{_placeholder:!0}}extendPrototype([HybridRendererBase,ICompElement,HBaseElement],HCompElement),HCompElement.prototype._createBaseContainerElements=HCompElement.prototype.createContainerElements,HCompElement.prototype.createContainerElements=function(){this._createBaseContainerElements(),this.data.hasMask?(this.svgElement.setAttribute("width",this.data.w),this.svgElement.setAttribute("height",this.data.h),this.transformedElement=this.baseElement):this.transformedElement=this.layerElement},HCompElement.prototype.addTo3dContainer=function(s,e){for(var i=0,a;i<e;)this.elements[i]&&this.elements[i].getBaseElement&&(a=this.elements[i].getBaseElement()),i+=1;a?this.layerElement.insertBefore(s,a):this.layerElement.appendChild(s)},HCompElement.prototype.createComp=function(s){return this.supports3d?new HCompElement(s,this.globalData,this):new SVGCompElement(s,this.globalData,this)};function HybridRenderer(s,e){this.animationItem=s,this.layers=null,this.renderedFrame=-1,this.renderConfig={className:e&&e.className||"",imagePreserveAspectRatio:e&&e.imagePreserveAspectRatio||"xMidYMid slice",hideOnTransparent:!(e&&e.hideOnTransparent===!1),filterSize:{width:e&&e.filterSize&&e.filterSize.width||"400%",height:e&&e.filterSize&&e.filterSize.height||"400%",x:e&&e.filterSize&&e.filterSize.x||"-100%",y:e&&e.filterSize&&e.filterSize.y||"-100%"},runExpressions:!e||e.runExpressions===void 0||e.runExpressions},this.globalData={_mdf:!1,frameNum:-1,renderConfig:this.renderConfig},this.pendingElements=[],this.elements=[],this.threeDElements=[],this.destroyed=!1,this.camera=null,this.supports3d=!0,this.rendererType="html"}extendPrototype([HybridRendererBase],HybridRenderer),HybridRenderer.prototype.createComp=function(s){return this.supports3d?new HCompElement(s,this.globalData,this):new SVGCompElement(s,this.globalData,this)};var CompExpressionInterface=function(){return function(s){function e(i){for(var a=0,o=s.layers.length;a<o;){if(s.layers[a].nm===i||s.layers[a].ind===i)return s.elements[a].layerInterface;a+=1}return null}return Object.defineProperty(e,"_name",{value:s.data.nm}),e.layer=e,e.pixelAspect=1,e.height=s.data.h||s.globalData.compSize.h,e.width=s.data.w||s.globalData.compSize.w,e.pixelAspect=1,e.frameDuration=1/s.globalData.frameRate,e.displayStartTime=0,e.numLayers=s.layers.length,e}}();function _typeof$2(s){"@babel/helpers - typeof";return _typeof$2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof$2(s)}function seedRandom(s,e){var i=this,a=256,o=6,c=52,d="random",g=e.pow(a,o),b=e.pow(2,c),_=b*2,j=a-1,$;function _e(it,ot,lt){var ct=[];ot=ot===!0?{entropy:!0}:ot||{};var ht=at(st(ot.entropy?[it,nt(s)]:it===null?rt():it,3),ct),dt=new tt(ct),gt=function(){for(var St=dt.g(o),Tt=g,Ct=0;St<b;)St=(St+Ct)*a,Tt*=a,Ct=dt.g(1);for(;St>=_;)St/=2,Tt/=2,Ct>>>=1;return(St+Ct)/Tt};return gt.int32=function(){return dt.g(4)|0},gt.quick=function(){return dt.g(4)/4294967296},gt.double=gt,at(nt(dt.S),s),(ot.pass||lt||function(vt,St,Tt,Ct){return Ct&&(Ct.S&&et(Ct,dt),vt.state=function(){return et(dt,{})}),Tt?(e[d]=vt,St):vt})(gt,ht,"global"in ot?ot.global:this==e,ot.state)}e["seed"+d]=_e;function tt(it){var ot,lt=it.length,ct=this,ht=0,dt=ct.i=ct.j=0,gt=ct.S=[];for(lt||(it=[lt++]);ht<a;)gt[ht]=ht++;for(ht=0;ht<a;ht++)gt[ht]=gt[dt=j&dt+it[ht%lt]+(ot=gt[ht])],gt[dt]=ot;ct.g=function(vt){for(var St,Tt=0,Ct=ct.i,Rt=ct.j,bt=ct.S;vt--;)St=bt[Ct=j&Ct+1],Tt=Tt*a+bt[j&(bt[Ct]=bt[Rt=j&Rt+St])+(bt[Rt]=St)];return ct.i=Ct,ct.j=Rt,Tt}}function et(it,ot){return ot.i=it.i,ot.j=it.j,ot.S=it.S.slice(),ot}function st(it,ot){var lt=[],ct=_typeof$2(it),ht;if(ot&&ct=="object")for(ht in it)try{lt.push(st(it[ht],ot-1))}catch{}return lt.length?lt:ct=="string"?it:it+"\0"}function at(it,ot){for(var lt=it+"",ct,ht=0;ht<lt.length;)ot[j&ht]=j&(ct^=ot[j&ht]*19)+lt.charCodeAt(ht++);return nt(ot)}function rt(){try{var it=new Uint8Array(a);return(i.crypto||i.msCrypto).getRandomValues(it),nt(it)}catch{var ot=i.navigator,lt=ot&&ot.plugins;return[+new Date,i,lt,i.screen,nt(s)]}}function nt(it){return String.fromCharCode.apply(0,it)}at(e.random(),s)}function initialize$2(s){seedRandom([],s)}var propTypes={SHAPE:"shape"};function _typeof$1(s){"@babel/helpers - typeof";return _typeof$1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof$1(s)}var ExpressionManager=function(){var ob={},Math=BMMath,window=null,document=null,XMLHttpRequest=null,fetch=null,frames=null,_lottieGlobal={};initialize$2(BMMath);function resetFrame(){_lottieGlobal={}}function $bm_isInstanceOfArray(s){return s.constructor===Array||s.constructor===Float32Array}function isNumerable(s,e){return s==="number"||e instanceof Number||s==="boolean"||s==="string"}function $bm_neg(s){var e=_typeof$1(s);if(e==="number"||s instanceof Number||e==="boolean")return-s;if($bm_isInstanceOfArray(s)){var i,a=s.length,o=[];for(i=0;i<a;i+=1)o[i]=-s[i];return o}return s.propType?s.v:-s}var easeInBez=BezierFactory.getBezierEasing(.333,0,.833,.833,"easeIn").get,easeOutBez=BezierFactory.getBezierEasing(.167,.167,.667,1,"easeOut").get,easeInOutBez=BezierFactory.getBezierEasing(.33,0,.667,1,"easeInOut").get;function sum(s,e){var i=_typeof$1(s),a=_typeof$1(e);if(isNumerable(i,s)&&isNumerable(a,e)||i==="string"||a==="string")return s+e;if($bm_isInstanceOfArray(s)&&isNumerable(a,e))return s=s.slice(0),s[0]+=e,s;if(isNumerable(i,s)&&$bm_isInstanceOfArray(e))return e=e.slice(0),e[0]=s+e[0],e;if($bm_isInstanceOfArray(s)&&$bm_isInstanceOfArray(e)){for(var o=0,c=s.length,d=e.length,g=[];o<c||o<d;)(typeof s[o]=="number"||s[o]instanceof Number)&&(typeof e[o]=="number"||e[o]instanceof Number)?g[o]=s[o]+e[o]:g[o]=e[o]===void 0?s[o]:s[o]||e[o],o+=1;return g}return 0}var add=sum;function sub(s,e){var i=_typeof$1(s),a=_typeof$1(e);if(isNumerable(i,s)&&isNumerable(a,e))return i==="string"&&(s=parseInt(s,10)),a==="string"&&(e=parseInt(e,10)),s-e;if($bm_isInstanceOfArray(s)&&isNumerable(a,e))return s=s.slice(0),s[0]-=e,s;if(isNumerable(i,s)&&$bm_isInstanceOfArray(e))return e=e.slice(0),e[0]=s-e[0],e;if($bm_isInstanceOfArray(s)&&$bm_isInstanceOfArray(e)){for(var o=0,c=s.length,d=e.length,g=[];o<c||o<d;)(typeof s[o]=="number"||s[o]instanceof Number)&&(typeof e[o]=="number"||e[o]instanceof Number)?g[o]=s[o]-e[o]:g[o]=e[o]===void 0?s[o]:s[o]||e[o],o+=1;return g}return 0}function mul(s,e){var i=_typeof$1(s),a=_typeof$1(e),o;if(isNumerable(i,s)&&isNumerable(a,e))return s*e;var c,d;if($bm_isInstanceOfArray(s)&&isNumerable(a,e)){for(d=s.length,o=createTypedArray("float32",d),c=0;c<d;c+=1)o[c]=s[c]*e;return o}if(isNumerable(i,s)&&$bm_isInstanceOfArray(e)){for(d=e.length,o=createTypedArray("float32",d),c=0;c<d;c+=1)o[c]=s*e[c];return o}return 0}function div(s,e){var i=_typeof$1(s),a=_typeof$1(e),o;if(isNumerable(i,s)&&isNumerable(a,e))return s/e;var c,d;if($bm_isInstanceOfArray(s)&&isNumerable(a,e)){for(d=s.length,o=createTypedArray("float32",d),c=0;c<d;c+=1)o[c]=s[c]/e;return o}if(isNumerable(i,s)&&$bm_isInstanceOfArray(e)){for(d=e.length,o=createTypedArray("float32",d),c=0;c<d;c+=1)o[c]=s/e[c];return o}return 0}function mod(s,e){return typeof s=="string"&&(s=parseInt(s,10)),typeof e=="string"&&(e=parseInt(e,10)),s%e}var $bm_sum=sum,$bm_sub=sub,$bm_mul=mul,$bm_div=div,$bm_mod=mod;function clamp(s,e,i){if(e>i){var a=i;i=e,e=a}return Math.min(Math.max(s,e),i)}function radiansToDegrees(s){return s/degToRads}var radians_to_degrees=radiansToDegrees;function degreesToRadians(s){return s*degToRads}var degrees_to_radians=radiansToDegrees,helperLengthArray=[0,0,0,0,0,0];function length(s,e){if(typeof s=="number"||s instanceof Number)return e=e||0,Math.abs(s-e);e||(e=helperLengthArray);var i,a=Math.min(s.length,e.length),o=0;for(i=0;i<a;i+=1)o+=Math.pow(e[i]-s[i],2);return Math.sqrt(o)}function normalize(s){return div(s,length(s))}function rgbToHsl(s){var e=s[0],i=s[1],a=s[2],o=Math.max(e,i,a),c=Math.min(e,i,a),d,g,b=(o+c)/2;if(o===c)d=0,g=0;else{var _=o-c;switch(g=b>.5?_/(2-o-c):_/(o+c),o){case e:d=(i-a)/_+(i<a?6:0);break;case i:d=(a-e)/_+2;break;case a:d=(e-i)/_+4;break}d/=6}return[d,g,b,s[3]]}function hue2rgb(s,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?s+(e-s)*6*i:i<1/2?e:i<2/3?s+(e-s)*(2/3-i)*6:s}function hslToRgb(s){var e=s[0],i=s[1],a=s[2],o,c,d;if(i===0)o=a,d=a,c=a;else{var g=a<.5?a*(1+i):a+i-a*i,b=2*a-g;o=hue2rgb(b,g,e+1/3),c=hue2rgb(b,g,e),d=hue2rgb(b,g,e-1/3)}return[o,c,d,s[3]]}function linear(s,e,i,a,o){if((a===void 0||o===void 0)&&(a=e,o=i,e=0,i=1),i<e){var c=i;i=e,e=c}if(s<=e)return a;if(s>=i)return o;var d=i===e?0:(s-e)/(i-e);if(!a.length)return a+(o-a)*d;var g,b=a.length,_=createTypedArray("float32",b);for(g=0;g<b;g+=1)_[g]=a[g]+(o[g]-a[g])*d;return _}function random(s,e){if(e===void 0&&(s===void 0?(s=0,e=1):(e=s,s=void 0)),e.length){var i,a=e.length;s||(s=createTypedArray("float32",a));var o=createTypedArray("float32",a),c=BMMath.random();for(i=0;i<a;i+=1)o[i]=s[i]+c*(e[i]-s[i]);return o}s===void 0&&(s=0);var d=BMMath.random();return s+d*(e-s)}function createPath(s,e,i,a){var o,c=s.length,d=shapePool.newElement();d.setPathData(!!a,c);var g=[0,0],b,_;for(o=0;o<c;o+=1)b=e&&e[o]?e[o]:g,_=i&&i[o]?i[o]:g,d.setTripleAt(s[o][0],s[o][1],_[0]+s[o][0],_[1]+s[o][1],b[0]+s[o][0],b[1]+s[o][1],o,!0);return d}function initiateExpression(elem,data,property){function noOp(s){return s}if(!elem.globalData.renderConfig.runExpressions)return noOp;var val=data.x,needsVelocity=/velocity(?![\w\d])/.test(val),_needsRandom=val.indexOf("random")!==-1,elemType=elem.data.ty,transform,$bm_transform,content,effect,thisProperty=property;thisProperty._name=elem.data.nm,thisProperty.valueAtTime=thisProperty.getValueAtTime,Object.defineProperty(thisProperty,"value",{get:function(){return thisProperty.v}}),elem.comp.frameDuration=1/elem.comp.globalData.frameRate,elem.comp.displayStartTime=0;var inPoint=elem.data.ip/elem.comp.globalData.frameRate,outPoint=elem.data.op/elem.comp.globalData.frameRate,width=elem.data.sw?elem.data.sw:0,height=elem.data.sh?elem.data.sh:0,name=elem.data.nm,loopIn,loop_in,loopOut,loop_out,smooth,toWorld,fromWorld,fromComp,toComp,fromCompToSurface,position,rotation,anchorPoint,scale,thisLayer,thisComp,mask,valueAtTime,velocityAtTime,scoped_bm_rt,expression_function=eval("[function _expression_function(){"+val+";scoped_bm_rt=$bm_rt}]")[0],numKeys=property.kf?data.k.length:0,active=!this.data||this.data.hd!==!0,wiggle=(function s(e,i){var a,o,c=this.pv.length?this.pv.length:1,d=createTypedArray("float32",c);e=5;var g=Math.floor(time*e);for(a=0,o=0;a<g;){for(o=0;o<c;o+=1)d[o]+=-i+i*2*BMMath.random();a+=1}var b=time*e,_=b-Math.floor(b),j=createTypedArray("float32",c);if(c>1){for(o=0;o<c;o+=1)j[o]=this.pv[o]+d[o]+(-i+i*2*BMMath.random())*_;return j}return this.pv+d[0]+(-i+i*2*BMMath.random())*_}).bind(this);thisProperty.loopIn&&(loopIn=thisProperty.loopIn.bind(thisProperty),loop_in=loopIn),thisProperty.loopOut&&(loopOut=thisProperty.loopOut.bind(thisProperty),loop_out=loopOut),thisProperty.smooth&&(smooth=thisProperty.smooth.bind(thisProperty));function loopInDuration(s,e){return loopIn(s,e,!0)}function loopOutDuration(s,e){return loopOut(s,e,!0)}this.getValueAtTime&&(valueAtTime=this.getValueAtTime.bind(this)),this.getVelocityAtTime&&(velocityAtTime=this.getVelocityAtTime.bind(this));var comp=elem.comp.globalData.projectInterface.bind(elem.comp.globalData.projectInterface);function lookAt(s,e){var i=[e[0]-s[0],e[1]-s[1],e[2]-s[2]],a=Math.atan2(i[0],Math.sqrt(i[1]*i[1]+i[2]*i[2]))/degToRads,o=-Math.atan2(i[1],i[2])/degToRads;return[o,a,0]}function easeOut(s,e,i,a,o){return applyEase(easeOutBez,s,e,i,a,o)}function easeIn(s,e,i,a,o){return applyEase(easeInBez,s,e,i,a,o)}function ease(s,e,i,a,o){return applyEase(easeInOutBez,s,e,i,a,o)}function applyEase(s,e,i,a,o,c){o===void 0?(o=i,c=a):e=(e-i)/(a-i),e>1?e=1:e<0&&(e=0);var d=s(e);if($bm_isInstanceOfArray(o)){var g,b=o.length,_=createTypedArray("float32",b);for(g=0;g<b;g+=1)_[g]=(c[g]-o[g])*d+o[g];return _}return(c-o)*d+o}function nearestKey(s){var e,i=data.k.length,a,o;if(!data.k.length||typeof data.k[0]=="number")a=0,o=0;else if(a=-1,s*=elem.comp.globalData.frameRate,s<data.k[0].t)a=1,o=data.k[0].t;else{for(e=0;e<i-1;e+=1)if(s===data.k[e].t){a=e+1,o=data.k[e].t;break}else if(s>data.k[e].t&&s<data.k[e+1].t){s-data.k[e].t>data.k[e+1].t-s?(a=e+2,o=data.k[e+1].t):(a=e+1,o=data.k[e].t);break}a===-1&&(a=e+1,o=data.k[e].t)}var c={};return c.index=a,c.time=o/elem.comp.globalData.frameRate,c}function key(s){var e,i,a;if(!data.k.length||typeof data.k[0]=="number")throw new Error("The property has no keyframe at index "+s);s-=1,e={time:data.k[s].t/elem.comp.globalData.frameRate,value:[]};var o=Object.prototype.hasOwnProperty.call(data.k[s],"s")?data.k[s].s:data.k[s-1].e;for(a=o.length,i=0;i<a;i+=1)e[i]=o[i],e.value[i]=o[i];return e}function framesToTime(s,e){return e||(e=elem.comp.globalData.frameRate),s/e}function timeToFrames(s,e){return!s&&s!==0&&(s=time),e||(e=elem.comp.globalData.frameRate),s*e}function seedRandom(s){BMMath.seedrandom(randSeed+s)}function sourceRectAtTime(){return elem.sourceRectAtTime()}function substring(s,e){return typeof value=="string"?e===void 0?value.substring(s):value.substring(s,e):""}function substr(s,e){return typeof value=="string"?e===void 0?value.substr(s):value.substr(s,e):""}function posterizeTime(s){time=s===0?0:Math.floor(time*s)/s,value=valueAtTime(time)}var time,velocity,value,text,textIndex,textTotal,selectorValue,index=elem.data.ind,hasParent=!!(elem.hierarchy&&elem.hierarchy.length),parent,randSeed=Math.floor(Math.random()*1e6),globalData=elem.globalData;function executeExpression(s){return value=s,this.frameExpressionId===elem.globalData.frameId&&this.propType!=="textSelector"?value:(this.propType==="textSelector"&&(textIndex=this.textIndex,textTotal=this.textTotal,selectorValue=this.selectorValue),thisLayer||(text=elem.layerInterface.text,thisLayer=elem.layerInterface,thisComp=elem.comp.compInterface,toWorld=thisLayer.toWorld.bind(thisLayer),fromWorld=thisLayer.fromWorld.bind(thisLayer),fromComp=thisLayer.fromComp.bind(thisLayer),toComp=thisLayer.toComp.bind(thisLayer),mask=thisLayer.mask?thisLayer.mask.bind(thisLayer):null,fromCompToSurface=fromComp),transform||(transform=elem.layerInterface("ADBE Transform Group"),$bm_transform=transform,transform&&(anchorPoint=transform.anchorPoint)),elemType===4&&!content&&(content=thisLayer("ADBE Root Vectors Group")),effect||(effect=thisLayer(4)),hasParent=!!(elem.hierarchy&&elem.hierarchy.length),hasParent&&!parent&&(parent=elem.hierarchy[0].layerInterface),time=this.comp.renderedFrame/this.comp.globalData.frameRate,_needsRandom&&seedRandom(randSeed+time),needsVelocity&&(velocity=velocityAtTime(time)),expression_function(),this.frameExpressionId=elem.globalData.frameId,scoped_bm_rt=scoped_bm_rt.propType===propTypes.SHAPE?scoped_bm_rt.v:scoped_bm_rt,scoped_bm_rt)}return executeExpression.__preventDeadCodeRemoval=[$bm_transform,anchorPoint,time,velocity,inPoint,outPoint,width,height,name,loop_in,loop_out,smooth,toComp,fromCompToSurface,toWorld,fromWorld,mask,position,rotation,scale,thisComp,numKeys,active,wiggle,loopInDuration,loopOutDuration,comp,lookAt,easeOut,easeIn,ease,nearestKey,key,text,textIndex,textTotal,selectorValue,framesToTime,timeToFrames,sourceRectAtTime,substring,substr,posterizeTime,index,globalData],executeExpression}return ob.initiateExpression=initiateExpression,ob.__preventDeadCodeRemoval=[window,document,XMLHttpRequest,fetch,frames,$bm_neg,add,$bm_sum,$bm_sub,$bm_mul,$bm_div,$bm_mod,clamp,radians_to_degrees,degreesToRadians,degrees_to_radians,normalize,rgbToHsl,hslToRgb,linear,random,createPath,_lottieGlobal],ob.resetFrame=resetFrame,ob}(),Expressions=function(){var s={};s.initExpressions=e,s.resetFrame=ExpressionManager.resetFrame;function e(i){var a=0,o=[];function c(){a+=1}function d(){a-=1,a===0&&b()}function g(_){o.indexOf(_)===-1&&o.push(_)}function b(){var _,j=o.length;for(_=0;_<j;_+=1)o[_].release();o.length=0}i.renderer.compInterface=CompExpressionInterface(i.renderer),i.renderer.globalData.projectInterface.registerComposition(i.renderer),i.renderer.globalData.pushExpression=c,i.renderer.globalData.popExpression=d,i.renderer.globalData.registerExpressionProperty=g}return s}(),MaskManagerInterface=function(){function s(i,a){this._mask=i,this._data=a}Object.defineProperty(s.prototype,"maskPath",{get:function(){return this._mask.prop.k&&this._mask.prop.getValue(),this._mask.prop}}),Object.defineProperty(s.prototype,"maskOpacity",{get:function(){return this._mask.op.k&&this._mask.op.getValue(),this._mask.op.v*100}});var e=function(a){var o=createSizedArray(a.viewData.length),c,d=a.viewData.length;for(c=0;c<d;c+=1)o[c]=new s(a.viewData[c],a.masksProperties[c]);var g=function(_){for(c=0;c<d;){if(a.masksProperties[c].nm===_)return o[c];c+=1}return null};return g};return e}(),ExpressionPropertyInterface=function(){var s={pv:0,v:0,mult:1},e={pv:[0,0,0],v:[0,0,0],mult:1};function i(d,g,b){Object.defineProperty(d,"velocity",{get:function(){return g.getVelocityAtTime(g.comp.currentFrame)}}),d.numKeys=g.keyframes?g.keyframes.length:0,d.key=function(_){if(!d.numKeys)return 0;var j="";"s"in g.keyframes[_-1]?j=g.keyframes[_-1].s:"e"in g.keyframes[_-2]?j=g.keyframes[_-2].e:j=g.keyframes[_-2].s;var $=b==="unidimensional"?new Number(j):Object.assign({},j);return $.time=g.keyframes[_-1].t/g.elem.comp.globalData.frameRate,$.value=b==="unidimensional"?j[0]:j,$},d.valueAtTime=g.getValueAtTime,d.speedAtTime=g.getSpeedAtTime,d.velocityAtTime=g.getVelocityAtTime,d.propertyGroup=g.propertyGroup}function a(d){(!d||!("pv"in d))&&(d=s);var g=1/d.mult,b=d.pv*g,_=new Number(b);return _.value=b,i(_,d,"unidimensional"),function(){return d.k&&d.getValue(),b=d.v*g,_.value!==b&&(_=new Number(b),_.value=b,_[0]=b,i(_,d,"unidimensional")),_}}function o(d){(!d||!("pv"in d))&&(d=e);var g=1/d.mult,b=d.data&&d.data.l||d.pv.length,_=createTypedArray("float32",b),j=createTypedArray("float32",b);return _.value=j,i(_,d,"multidimensional"),function(){d.k&&d.getValue();for(var $=0;$<b;$+=1)j[$]=d.v[$]*g,_[$]=j[$];return _}}function c(){return s}return function(d){return d?d.propType==="unidimensional"?a(d):o(d):c}}(),TransformExpressionInterface=function(){return function(s){function e(d){switch(d){case"scale":case"Scale":case"ADBE Scale":case 6:return e.scale;case"rotation":case"Rotation":case"ADBE Rotation":case"ADBE Rotate Z":case 10:return e.rotation;case"ADBE Rotate X":return e.xRotation;case"ADBE Rotate Y":return e.yRotation;case"position":case"Position":case"ADBE Position":case 2:return e.position;case"ADBE Position_0":return e.xPosition;case"ADBE Position_1":return e.yPosition;case"ADBE Position_2":return e.zPosition;case"anchorPoint":case"AnchorPoint":case"Anchor Point":case"ADBE AnchorPoint":case 1:return e.anchorPoint;case"opacity":case"Opacity":case 11:return e.opacity;default:return null}}Object.defineProperty(e,"rotation",{get:ExpressionPropertyInterface(s.r||s.rz)}),Object.defineProperty(e,"zRotation",{get:ExpressionPropertyInterface(s.rz||s.r)}),Object.defineProperty(e,"xRotation",{get:ExpressionPropertyInterface(s.rx)}),Object.defineProperty(e,"yRotation",{get:ExpressionPropertyInterface(s.ry)}),Object.defineProperty(e,"scale",{get:ExpressionPropertyInterface(s.s)});var i,a,o,c;return s.p?c=ExpressionPropertyInterface(s.p):(i=ExpressionPropertyInterface(s.px),a=ExpressionPropertyInterface(s.py),s.pz&&(o=ExpressionPropertyInterface(s.pz))),Object.defineProperty(e,"position",{get:function(){return s.p?c():[i(),a(),o?o():0]}}),Object.defineProperty(e,"xPosition",{get:ExpressionPropertyInterface(s.px)}),Object.defineProperty(e,"yPosition",{get:ExpressionPropertyInterface(s.py)}),Object.defineProperty(e,"zPosition",{get:ExpressionPropertyInterface(s.pz)}),Object.defineProperty(e,"anchorPoint",{get:ExpressionPropertyInterface(s.a)}),Object.defineProperty(e,"opacity",{get:ExpressionPropertyInterface(s.o)}),Object.defineProperty(e,"skew",{get:ExpressionPropertyInterface(s.sk)}),Object.defineProperty(e,"skewAxis",{get:ExpressionPropertyInterface(s.sa)}),Object.defineProperty(e,"orientation",{get:ExpressionPropertyInterface(s.or)}),e}}(),LayerExpressionInterface=function(){function s(_){var j=new Matrix;if(_!==void 0){var $=this._elem.finalTransform.mProp.getValueAtTime(_);$.clone(j)}else{var _e=this._elem.finalTransform.mProp;_e.applyToMatrix(j)}return j}function e(_,j){var $=this.getMatrix(j);return $.props[12]=0,$.props[13]=0,$.props[14]=0,this.applyPoint($,_)}function i(_,j){var $=this.getMatrix(j);return this.applyPoint($,_)}function a(_,j){var $=this.getMatrix(j);return $.props[12]=0,$.props[13]=0,$.props[14]=0,this.invertPoint($,_)}function o(_,j){var $=this.getMatrix(j);return this.invertPoint($,_)}function c(_,j){if(this._elem.hierarchy&&this._elem.hierarchy.length){var $,_e=this._elem.hierarchy.length;for($=0;$<_e;$+=1)this._elem.hierarchy[$].finalTransform.mProp.applyToMatrix(_)}return _.applyToPointArray(j[0],j[1],j[2]||0)}function d(_,j){if(this._elem.hierarchy&&this._elem.hierarchy.length){var $,_e=this._elem.hierarchy.length;for($=0;$<_e;$+=1)this._elem.hierarchy[$].finalTransform.mProp.applyToMatrix(_)}return _.inversePoint(j)}function g(_){var j=new Matrix;if(j.reset(),this._elem.finalTransform.mProp.applyToMatrix(j),this._elem.hierarchy&&this._elem.hierarchy.length){var $,_e=this._elem.hierarchy.length;for($=0;$<_e;$+=1)this._elem.hierarchy[$].finalTransform.mProp.applyToMatrix(j);return j.inversePoint(_)}return j.inversePoint(_)}function b(){return[1,1,1,1]}return function(_){var j;function $(st){tt.mask=new MaskManagerInterface(st,_)}function _e(st){tt.effect=st}function tt(st){switch(st){case"ADBE Root Vectors Group":case"Contents":case 2:return tt.shapeInterface;case 1:case 6:case"Transform":case"transform":case"ADBE Transform Group":return j;case 4:case"ADBE Effect Parade":case"effects":case"Effects":return tt.effect;case"ADBE Text Properties":return tt.textInterface;default:return null}}tt.getMatrix=s,tt.invertPoint=d,tt.applyPoint=c,tt.toWorld=i,tt.toWorldVec=e,tt.fromWorld=o,tt.fromWorldVec=a,tt.toComp=i,tt.fromComp=g,tt.sampleImage=b,tt.sourceRectAtTime=_.sourceRectAtTime.bind(_),tt._elem=_,j=TransformExpressionInterface(_.finalTransform.mProp);var et=getDescriptor(j,"anchorPoint");return Object.defineProperties(tt,{hasParent:{get:function(){return _.hierarchy.length}},parent:{get:function(){return _.hierarchy[0].layerInterface}},rotation:getDescriptor(j,"rotation"),scale:getDescriptor(j,"scale"),position:getDescriptor(j,"position"),opacity:getDescriptor(j,"opacity"),anchorPoint:et,anchor_point:et,transform:{get:function(){return j}},active:{get:function(){return _.isInRange}}}),tt.startTime=_.data.st,tt.index=_.data.ind,tt.source=_.data.refId,tt.height=_.data.ty===0?_.data.h:100,tt.width=_.data.ty===0?_.data.w:100,tt.inPoint=_.data.ip/_.comp.globalData.frameRate,tt.outPoint=_.data.op/_.comp.globalData.frameRate,tt._name=_.data.nm,tt.registerMaskInterface=$,tt.registerEffectsInterface=_e,tt}}(),propertyGroupFactory=function(){return function(s,e){return function(i){return i=i===void 0?1:i,i<=0?s:e(i-1)}}}(),PropertyInterface=function(){return function(s,e){var i={_name:s};function a(o){return o=o===void 0?1:o,o<=0?i:e(o-1)}return a}}(),EffectsExpressionInterface=function(){var s={createEffectsInterface:e};function e(o,c){if(o.effectsManager){var d=[],g=o.data.ef,b,_=o.effectsManager.effectElements.length;for(b=0;b<_;b+=1)d.push(i(g[b],o.effectsManager.effectElements[b],c,o));var j=o.data.ef||[],$=function(tt){for(b=0,_=j.length;b<_;){if(tt===j[b].nm||tt===j[b].mn||tt===j[b].ix)return d[b];b+=1}return null};return Object.defineProperty($,"numProperties",{get:function(){return j.length}}),$}return null}function i(o,c,d,g){function b(tt){for(var et=o.ef,st=0,at=et.length;st<at;){if(tt===et[st].nm||tt===et[st].mn||tt===et[st].ix)return et[st].ty===5?j[st]:j[st]();st+=1}throw new Error}var _=propertyGroupFactory(b,d),j=[],$,_e=o.ef.length;for($=0;$<_e;$+=1)o.ef[$].ty===5?j.push(i(o.ef[$],c.effectElements[$],c.effectElements[$].propertyGroup,g)):j.push(a(c.effectElements[$],o.ef[$].ty,g,_));return o.mn==="ADBE Color Control"&&Object.defineProperty(b,"color",{get:function(){return j[0]()}}),Object.defineProperties(b,{numProperties:{get:function(){return o.np}},_name:{value:o.nm},propertyGroup:{value:_}}),b.enabled=o.en!==0,b.active=b.enabled,b}function a(o,c,d,g){var b=ExpressionPropertyInterface(o.p);function _(){return c===10?d.comp.compInterface(o.p.v):b()}return o.p.setGroupProperty&&o.p.setGroupProperty(PropertyInterface("",g)),_}return s}(),ShapePathInterface=function(){return function(e,i,a){var o=i.sh;function c(g){return g==="Shape"||g==="shape"||g==="Path"||g==="path"||g==="ADBE Vector Shape"||g===2?c.path:null}var d=propertyGroupFactory(c,a);return o.setGroupProperty(PropertyInterface("Path",d)),Object.defineProperties(c,{path:{get:function(){return o.k&&o.getValue(),o}},shape:{get:function(){return o.k&&o.getValue(),o}},_name:{value:e.nm},ix:{value:e.ix},propertyIndex:{value:e.ix},mn:{value:e.mn},propertyGroup:{value:a}}),c}}(),ShapeExpressionInterface=function(){function s(et,st,at){var rt=[],nt,it=et?et.length:0;for(nt=0;nt<it;nt+=1)et[nt].ty==="gr"?rt.push(i(et[nt],st[nt],at)):et[nt].ty==="fl"?rt.push(a(et[nt],st[nt],at)):et[nt].ty==="st"?rt.push(d(et[nt],st[nt],at)):et[nt].ty==="tm"?rt.push(g(et[nt],st[nt],at)):et[nt].ty==="tr"||(et[nt].ty==="el"?rt.push(_(et[nt],st[nt],at)):et[nt].ty==="sr"?rt.push(j(et[nt],st[nt],at)):et[nt].ty==="sh"?rt.push(ShapePathInterface(et[nt],st[nt],at)):et[nt].ty==="rc"?rt.push($(et[nt],st[nt],at)):et[nt].ty==="rd"?rt.push(_e(et[nt],st[nt],at)):et[nt].ty==="rp"?rt.push(tt(et[nt],st[nt],at)):et[nt].ty==="gf"?rt.push(o(et[nt],st[nt],at)):rt.push(c(et[nt],st[nt])));return rt}function e(et,st,at){var rt,nt=function(lt){for(var ct=0,ht=rt.length;ct<ht;){if(rt[ct]._name===lt||rt[ct].mn===lt||rt[ct].propertyIndex===lt||rt[ct].ix===lt||rt[ct].ind===lt)return rt[ct];ct+=1}return typeof lt=="number"?rt[lt-1]:null};nt.propertyGroup=propertyGroupFactory(nt,at),rt=s(et.it,st.it,nt.propertyGroup),nt.numProperties=rt.length;var it=b(et.it[et.it.length-1],st.it[st.it.length-1],nt.propertyGroup);return nt.transform=it,nt.propertyIndex=et.cix,nt._name=et.nm,nt}function i(et,st,at){var rt=function(lt){switch(lt){case"ADBE Vectors Group":case"Contents":case 2:return rt.content;default:return rt.transform}};rt.propertyGroup=propertyGroupFactory(rt,at);var nt=e(et,st,rt.propertyGroup),it=b(et.it[et.it.length-1],st.it[st.it.length-1],rt.propertyGroup);return rt.content=nt,rt.transform=it,Object.defineProperty(rt,"_name",{get:function(){return et.nm}}),rt.numProperties=et.np,rt.propertyIndex=et.ix,rt.nm=et.nm,rt.mn=et.mn,rt}function a(et,st,at){function rt(nt){return nt==="Color"||nt==="color"?rt.color:nt==="Opacity"||nt==="opacity"?rt.opacity:null}return Object.defineProperties(rt,{color:{get:ExpressionPropertyInterface(st.c)},opacity:{get:ExpressionPropertyInterface(st.o)},_name:{value:et.nm},mn:{value:et.mn}}),st.c.setGroupProperty(PropertyInterface("Color",at)),st.o.setGroupProperty(PropertyInterface("Opacity",at)),rt}function o(et,st,at){function rt(nt){return nt==="Start Point"||nt==="start point"?rt.startPoint:nt==="End Point"||nt==="end point"?rt.endPoint:nt==="Opacity"||nt==="opacity"?rt.opacity:null}return Object.defineProperties(rt,{startPoint:{get:ExpressionPropertyInterface(st.s)},endPoint:{get:ExpressionPropertyInterface(st.e)},opacity:{get:ExpressionPropertyInterface(st.o)},type:{get:function(){return"a"}},_name:{value:et.nm},mn:{value:et.mn}}),st.s.setGroupProperty(PropertyInterface("Start Point",at)),st.e.setGroupProperty(PropertyInterface("End Point",at)),st.o.setGroupProperty(PropertyInterface("Opacity",at)),rt}function c(){function et(){return null}return et}function d(et,st,at){var rt=propertyGroupFactory(ht,at),nt=propertyGroupFactory(ct,rt);function it(dt){Object.defineProperty(ct,et.d[dt].nm,{get:ExpressionPropertyInterface(st.d.dataProps[dt].p)})}var ot,lt=et.d?et.d.length:0,ct={};for(ot=0;ot<lt;ot+=1)it(ot),st.d.dataProps[ot].p.setGroupProperty(nt);function ht(dt){return dt==="Color"||dt==="color"?ht.color:dt==="Opacity"||dt==="opacity"?ht.opacity:dt==="Stroke Width"||dt==="stroke width"?ht.strokeWidth:null}return Object.defineProperties(ht,{color:{get:ExpressionPropertyInterface(st.c)},opacity:{get:ExpressionPropertyInterface(st.o)},strokeWidth:{get:ExpressionPropertyInterface(st.w)},dash:{get:function(){return ct}},_name:{value:et.nm},mn:{value:et.mn}}),st.c.setGroupProperty(PropertyInterface("Color",rt)),st.o.setGroupProperty(PropertyInterface("Opacity",rt)),st.w.setGroupProperty(PropertyInterface("Stroke Width",rt)),ht}function g(et,st,at){function rt(it){return it===et.e.ix||it==="End"||it==="end"?rt.end:it===et.s.ix?rt.start:it===et.o.ix?rt.offset:null}var nt=propertyGroupFactory(rt,at);return rt.propertyIndex=et.ix,st.s.setGroupProperty(PropertyInterface("Start",nt)),st.e.setGroupProperty(PropertyInterface("End",nt)),st.o.setGroupProperty(PropertyInterface("Offset",nt)),rt.propertyIndex=et.ix,rt.propertyGroup=at,Object.defineProperties(rt,{start:{get:ExpressionPropertyInterface(st.s)},end:{get:ExpressionPropertyInterface(st.e)},offset:{get:ExpressionPropertyInterface(st.o)},_name:{value:et.nm}}),rt.mn=et.mn,rt}function b(et,st,at){function rt(it){return et.a.ix===it||it==="Anchor Point"?rt.anchorPoint:et.o.ix===it||it==="Opacity"?rt.opacity:et.p.ix===it||it==="Position"?rt.position:et.r.ix===it||it==="Rotation"||it==="ADBE Vector Rotation"?rt.rotation:et.s.ix===it||it==="Scale"?rt.scale:et.sk&&et.sk.ix===it||it==="Skew"?rt.skew:et.sa&&et.sa.ix===it||it==="Skew Axis"?rt.skewAxis:null}var nt=propertyGroupFactory(rt,at);return st.transform.mProps.o.setGroupProperty(PropertyInterface("Opacity",nt)),st.transform.mProps.p.setGroupProperty(PropertyInterface("Position",nt)),st.transform.mProps.a.setGroupProperty(PropertyInterface("Anchor Point",nt)),st.transform.mProps.s.setGroupProperty(PropertyInterface("Scale",nt)),st.transform.mProps.r.setGroupProperty(PropertyInterface("Rotation",nt)),st.transform.mProps.sk&&(st.transform.mProps.sk.setGroupProperty(PropertyInterface("Skew",nt)),st.transform.mProps.sa.setGroupProperty(PropertyInterface("Skew Angle",nt))),st.transform.op.setGroupProperty(PropertyInterface("Opacity",nt)),Object.defineProperties(rt,{opacity:{get:ExpressionPropertyInterface(st.transform.mProps.o)},position:{get:ExpressionPropertyInterface(st.transform.mProps.p)},anchorPoint:{get:ExpressionPropertyInterface(st.transform.mProps.a)},scale:{get:ExpressionPropertyInterface(st.transform.mProps.s)},rotation:{get:ExpressionPropertyInterface(st.transform.mProps.r)},skew:{get:ExpressionPropertyInterface(st.transform.mProps.sk)},skewAxis:{get:ExpressionPropertyInterface(st.transform.mProps.sa)},_name:{value:et.nm}}),rt.ty="tr",rt.mn=et.mn,rt.propertyGroup=at,rt}function _(et,st,at){function rt(ot){return et.p.ix===ot?rt.position:et.s.ix===ot?rt.size:null}var nt=propertyGroupFactory(rt,at);rt.propertyIndex=et.ix;var it=st.sh.ty==="tm"?st.sh.prop:st.sh;return it.s.setGroupProperty(PropertyInterface("Size",nt)),it.p.setGroupProperty(PropertyInterface("Position",nt)),Object.defineProperties(rt,{size:{get:ExpressionPropertyInterface(it.s)},position:{get:ExpressionPropertyInterface(it.p)},_name:{value:et.nm}}),rt.mn=et.mn,rt}function j(et,st,at){function rt(ot){return et.p.ix===ot?rt.position:et.r.ix===ot?rt.rotation:et.pt.ix===ot?rt.points:et.or.ix===ot||ot==="ADBE Vector Star Outer Radius"?rt.outerRadius:et.os.ix===ot?rt.outerRoundness:et.ir&&(et.ir.ix===ot||ot==="ADBE Vector Star Inner Radius")?rt.innerRadius:et.is&&et.is.ix===ot?rt.innerRoundness:null}var nt=propertyGroupFactory(rt,at),it=st.sh.ty==="tm"?st.sh.prop:st.sh;return rt.propertyIndex=et.ix,it.or.setGroupProperty(PropertyInterface("Outer Radius",nt)),it.os.setGroupProperty(PropertyInterface("Outer Roundness",nt)),it.pt.setGroupProperty(PropertyInterface("Points",nt)),it.p.setGroupProperty(PropertyInterface("Position",nt)),it.r.setGroupProperty(PropertyInterface("Rotation",nt)),et.ir&&(it.ir.setGroupProperty(PropertyInterface("Inner Radius",nt)),it.is.setGroupProperty(PropertyInterface("Inner Roundness",nt))),Object.defineProperties(rt,{position:{get:ExpressionPropertyInterface(it.p)},rotation:{get:ExpressionPropertyInterface(it.r)},points:{get:ExpressionPropertyInterface(it.pt)},outerRadius:{get:ExpressionPropertyInterface(it.or)},outerRoundness:{get:ExpressionPropertyInterface(it.os)},innerRadius:{get:ExpressionPropertyInterface(it.ir)},innerRoundness:{get:ExpressionPropertyInterface(it.is)},_name:{value:et.nm}}),rt.mn=et.mn,rt}function $(et,st,at){function rt(ot){return et.p.ix===ot?rt.position:et.r.ix===ot?rt.roundness:et.s.ix===ot||ot==="Size"||ot==="ADBE Vector Rect Size"?rt.size:null}var nt=propertyGroupFactory(rt,at),it=st.sh.ty==="tm"?st.sh.prop:st.sh;return rt.propertyIndex=et.ix,it.p.setGroupProperty(PropertyInterface("Position",nt)),it.s.setGroupProperty(PropertyInterface("Size",nt)),it.r.setGroupProperty(PropertyInterface("Rotation",nt)),Object.defineProperties(rt,{position:{get:ExpressionPropertyInterface(it.p)},roundness:{get:ExpressionPropertyInterface(it.r)},size:{get:ExpressionPropertyInterface(it.s)},_name:{value:et.nm}}),rt.mn=et.mn,rt}function _e(et,st,at){function rt(ot){return et.r.ix===ot||ot==="Round Corners 1"?rt.radius:null}var nt=propertyGroupFactory(rt,at),it=st;return rt.propertyIndex=et.ix,it.rd.setGroupProperty(PropertyInterface("Radius",nt)),Object.defineProperties(rt,{radius:{get:ExpressionPropertyInterface(it.rd)},_name:{value:et.nm}}),rt.mn=et.mn,rt}function tt(et,st,at){function rt(ot){return et.c.ix===ot||ot==="Copies"?rt.copies:et.o.ix===ot||ot==="Offset"?rt.offset:null}var nt=propertyGroupFactory(rt,at),it=st;return rt.propertyIndex=et.ix,it.c.setGroupProperty(PropertyInterface("Copies",nt)),it.o.setGroupProperty(PropertyInterface("Offset",nt)),Object.defineProperties(rt,{copies:{get:ExpressionPropertyInterface(it.c)},offset:{get:ExpressionPropertyInterface(it.o)},_name:{value:et.nm}}),rt.mn=et.mn,rt}return function(et,st,at){var rt;function nt(ot){if(typeof ot=="number")return ot=ot===void 0?1:ot,ot===0?at:rt[ot-1];for(var lt=0,ct=rt.length;lt<ct;){if(rt[lt]._name===ot)return rt[lt];lt+=1}return null}function it(){return at}return nt.propertyGroup=propertyGroupFactory(nt,it),rt=s(et,st,nt.propertyGroup),nt.numProperties=rt.length,nt._name="Contents",nt}}(),TextExpressionInterface=function(){return function(s){var e;function i(a){switch(a){case"ADBE Text Document":return i.sourceText;default:return null}}return Object.defineProperty(i,"sourceText",{get:function(){s.textProperty.getValue();var o=s.textProperty.currentData.t;return(!e||o!==e.value)&&(e=new String(o),e.value=o||new String(o),Object.defineProperty(e,"style",{get:function(){return{fillColor:s.textProperty.currentData.fc}}})),e}}),i}}();function _typeof(s){"@babel/helpers - typeof";return _typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(s)}var FootageInterface=function(){var s=function(a){var o="",c=a.getFootageData();function d(){return o="",c=a.getFootageData(),g}function g(b){if(c[b])return o=b,c=c[b],_typeof(c)==="object"?g:c;var _=b.indexOf(o);if(_!==-1){var j=parseInt(b.substr(_+o.length),10);return c=c[j],_typeof(c)==="object"?g:c}return""}return d},e=function(a){function o(c){return c==="Outline"?o.outlineInterface():null}return o._name="Outline",o.outlineInterface=s(a),o};return function(i){function a(o){return o==="Data"?a.dataInterface:null}return a._name="Data",a.dataInterface=e(i),a}}(),interfaces={layer:LayerExpressionInterface,effects:EffectsExpressionInterface,comp:CompExpressionInterface,shape:ShapeExpressionInterface,text:TextExpressionInterface,footage:FootageInterface};function getInterface(s){return interfaces[s]||null}var expressionHelpers=function(){function s(d,g,b){g.x&&(b.k=!0,b.x=!0,b.initiateExpression=ExpressionManager.initiateExpression,b.effectsSequence.push(b.initiateExpression(d,g,b).bind(b)))}function e(d){return d*=this.elem.globalData.frameRate,d-=this.offsetTime,d!==this._cachingAtTime.lastFrame&&(this._cachingAtTime.lastIndex=this._cachingAtTime.lastFrame<d?this._cachingAtTime.lastIndex:0,this._cachingAtTime.value=this.interpolateValue(d,this._cachingAtTime),this._cachingAtTime.lastFrame=d),this._cachingAtTime.value}function i(d){var g=-.01,b=this.getValueAtTime(d),_=this.getValueAtTime(d+g),j=0;if(b.length){var $;for($=0;$<b.length;$+=1)j+=Math.pow(_[$]-b[$],2);j=Math.sqrt(j)*100}else j=0;return j}function a(d){if(this.vel!==void 0)return this.vel;var g=-.001,b=this.getValueAtTime(d),_=this.getValueAtTime(d+g),j;if(b.length){j=createTypedArray("float32",b.length);var $;for($=0;$<b.length;$+=1)j[$]=(_[$]-b[$])/g}else j=(_-b)/g;return j}function o(){return this.pv}function c(d){this.propertyGroup=d}return{searchExpressions:s,getSpeedAtTime:i,getVelocityAtTime:a,getValueAtTime:e,getStaticValueAtTime:o,setGroupProperty:c}}();function addPropertyDecorator(){function s(_e,tt,et){if(!this.k||!this.keyframes)return this.pv;_e=_e?_e.toLowerCase():"";var st=this.comp.renderedFrame,at=this.keyframes,rt=at[at.length-1].t;if(st<=rt)return this.pv;var nt,it;et?(tt?nt=Math.abs(rt-this.elem.comp.globalData.frameRate*tt):nt=Math.max(0,rt-this.elem.data.ip),it=rt-nt):((!tt||tt>at.length-1)&&(tt=at.length-1),it=at[at.length-1-tt].t,nt=rt-it);var ot,lt,ct;if(_e==="pingpong"){var ht=Math.floor((st-it)/nt);if(ht%2!==0)return this.getValueAtTime((nt-(st-it)%nt+it)/this.comp.globalData.frameRate,0)}else if(_e==="offset"){var dt=this.getValueAtTime(it/this.comp.globalData.frameRate,0),gt=this.getValueAtTime(rt/this.comp.globalData.frameRate,0),vt=this.getValueAtTime(((st-it)%nt+it)/this.comp.globalData.frameRate,0),St=Math.floor((st-it)/nt);if(this.pv.length){for(ct=new Array(dt.length),lt=ct.length,ot=0;ot<lt;ot+=1)ct[ot]=(gt[ot]-dt[ot])*St+vt[ot];return ct}return(gt-dt)*St+vt}else if(_e==="continue"){var Tt=this.getValueAtTime(rt/this.comp.globalData.frameRate,0),Ct=this.getValueAtTime((rt-.001)/this.comp.globalData.frameRate,0);if(this.pv.length){for(ct=new Array(Tt.length),lt=ct.length,ot=0;ot<lt;ot+=1)ct[ot]=Tt[ot]+(Tt[ot]-Ct[ot])*((st-rt)/this.comp.globalData.frameRate)/5e-4;return ct}return Tt+(Tt-Ct)*((st-rt)/.001)}return this.getValueAtTime(((st-it)%nt+it)/this.comp.globalData.frameRate,0)}function e(_e,tt,et){if(!this.k)return this.pv;_e=_e?_e.toLowerCase():"";var st=this.comp.renderedFrame,at=this.keyframes,rt=at[0].t;if(st>=rt)return this.pv;var nt,it;et?(tt?nt=Math.abs(this.elem.comp.globalData.frameRate*tt):nt=Math.max(0,this.elem.data.op-rt),it=rt+nt):((!tt||tt>at.length-1)&&(tt=at.length-1),it=at[tt].t,nt=it-rt);var ot,lt,ct;if(_e==="pingpong"){var ht=Math.floor((rt-st)/nt);if(ht%2===0)return this.getValueAtTime(((rt-st)%nt+rt)/this.comp.globalData.frameRate,0)}else if(_e==="offset"){var dt=this.getValueAtTime(rt/this.comp.globalData.frameRate,0),gt=this.getValueAtTime(it/this.comp.globalData.frameRate,0),vt=this.getValueAtTime((nt-(rt-st)%nt+rt)/this.comp.globalData.frameRate,0),St=Math.floor((rt-st)/nt)+1;if(this.pv.length){for(ct=new Array(dt.length),lt=ct.length,ot=0;ot<lt;ot+=1)ct[ot]=vt[ot]-(gt[ot]-dt[ot])*St;return ct}return vt-(gt-dt)*St}else if(_e==="continue"){var Tt=this.getValueAtTime(rt/this.comp.globalData.frameRate,0),Ct=this.getValueAtTime((rt+.001)/this.comp.globalData.frameRate,0);if(this.pv.length){for(ct=new Array(Tt.length),lt=ct.length,ot=0;ot<lt;ot+=1)ct[ot]=Tt[ot]+(Tt[ot]-Ct[ot])*(rt-st)/.001;return ct}return Tt+(Tt-Ct)*(rt-st)/.001}return this.getValueAtTime((nt-((rt-st)%nt+rt))/this.comp.globalData.frameRate,0)}function i(_e,tt){if(!this.k)return this.pv;if(_e=(_e||.4)*.5,tt=Math.floor(tt||5),tt<=1)return this.pv;var et=this.comp.renderedFrame/this.comp.globalData.frameRate,st=et-_e,at=et+_e,rt=tt>1?(at-st)/(tt-1):1,nt=0,it=0,ot;this.pv.length?ot=createTypedArray("float32",this.pv.length):ot=0;for(var lt;nt<tt;){if(lt=this.getValueAtTime(st+nt*rt),this.pv.length)for(it=0;it<this.pv.length;it+=1)ot[it]+=lt[it];else ot+=lt;nt+=1}if(this.pv.length)for(it=0;it<this.pv.length;it+=1)ot[it]/=tt;else ot/=tt;return ot}function a(_e){this._transformCachingAtTime||(this._transformCachingAtTime={v:new Matrix});var tt=this._transformCachingAtTime.v;if(tt.cloneFromProps(this.pre.props),this.appliedTransformations<1){var et=this.a.getValueAtTime(_e);tt.translate(-et[0]*this.a.mult,-et[1]*this.a.mult,et[2]*this.a.mult)}if(this.appliedTransformations<2){var st=this.s.getValueAtTime(_e);tt.scale(st[0]*this.s.mult,st[1]*this.s.mult,st[2]*this.s.mult)}if(this.sk&&this.appliedTransformations<3){var at=this.sk.getValueAtTime(_e),rt=this.sa.getValueAtTime(_e);tt.skewFromAxis(-at*this.sk.mult,rt*this.sa.mult)}if(this.r&&this.appliedTransformations<4){var nt=this.r.getValueAtTime(_e);tt.rotate(-nt*this.r.mult)}else if(!this.r&&this.appliedTransformations<4){var it=this.rz.getValueAtTime(_e),ot=this.ry.getValueAtTime(_e),lt=this.rx.getValueAtTime(_e),ct=this.or.getValueAtTime(_e);tt.rotateZ(-it*this.rz.mult).rotateY(ot*this.ry.mult).rotateX(lt*this.rx.mult).rotateZ(-ct[2]*this.or.mult).rotateY(ct[1]*this.or.mult).rotateX(ct[0]*this.or.mult)}if(this.data.p&&this.data.p.s){var ht=this.px.getValueAtTime(_e),dt=this.py.getValueAtTime(_e);if(this.data.p.z){var gt=this.pz.getValueAtTime(_e);tt.translate(ht*this.px.mult,dt*this.py.mult,-gt*this.pz.mult)}else tt.translate(ht*this.px.mult,dt*this.py.mult,0)}else{var vt=this.p.getValueAtTime(_e);tt.translate(vt[0]*this.p.mult,vt[1]*this.p.mult,-vt[2]*this.p.mult)}return tt}function o(){return this.v.clone(new Matrix)}var c=TransformPropertyFactory.getTransformProperty;TransformPropertyFactory.getTransformProperty=function(_e,tt,et){var st=c(_e,tt,et);return st.dynamicProperties.length?st.getValueAtTime=a.bind(st):st.getValueAtTime=o.bind(st),st.setGroupProperty=expressionHelpers.setGroupProperty,st};var d=PropertyFactory.getProp;PropertyFactory.getProp=function(_e,tt,et,st,at){var rt=d(_e,tt,et,st,at);rt.kf?rt.getValueAtTime=expressionHelpers.getValueAtTime.bind(rt):rt.getValueAtTime=expressionHelpers.getStaticValueAtTime.bind(rt),rt.setGroupProperty=expressionHelpers.setGroupProperty,rt.loopOut=s,rt.loopIn=e,rt.smooth=i,rt.getVelocityAtTime=expressionHelpers.getVelocityAtTime.bind(rt),rt.getSpeedAtTime=expressionHelpers.getSpeedAtTime.bind(rt),rt.numKeys=tt.a===1?tt.k.length:0,rt.propertyIndex=tt.ix;var nt=0;return et!==0&&(nt=createTypedArray("float32",tt.a===1?tt.k[0].s.length:tt.k.length)),rt._cachingAtTime={lastFrame:initialDefaultFrame,lastIndex:0,value:nt},expressionHelpers.searchExpressions(_e,tt,rt),rt.k&&at.addDynamicProperty(rt),rt};function g(_e){return this._cachingAtTime||(this._cachingAtTime={shapeValue:shapePool.clone(this.pv),lastIndex:0,lastTime:initialDefaultFrame}),_e*=this.elem.globalData.frameRate,_e-=this.offsetTime,_e!==this._cachingAtTime.lastTime&&(this._cachingAtTime.lastIndex=this._cachingAtTime.lastTime<_e?this._caching.lastIndex:0,this._cachingAtTime.lastTime=_e,this.interpolateShape(_e,this._cachingAtTime.shapeValue,this._cachingAtTime)),this._cachingAtTime.shapeValue}var b=ShapePropertyFactory.getConstructorFunction(),_=ShapePropertyFactory.getKeyframedConstructorFunction();function j(){}j.prototype={vertices:function(tt,et){this.k&&this.getValue();var st=this.v;et!==void 0&&(st=this.getValueAtTime(et,0));var at,rt=st._length,nt=st[tt],it=st.v,ot=createSizedArray(rt);for(at=0;at<rt;at+=1)tt==="i"||tt==="o"?ot[at]=[nt[at][0]-it[at][0],nt[at][1]-it[at][1]]:ot[at]=[nt[at][0],nt[at][1]];return ot},points:function(tt){return this.vertices("v",tt)},inTangents:function(tt){return this.vertices("i",tt)},outTangents:function(tt){return this.vertices("o",tt)},isClosed:function(){return this.v.c},pointOnPath:function(tt,et){var st=this.v;et!==void 0&&(st=this.getValueAtTime(et,0)),this._segmentsLength||(this._segmentsLength=bez.getSegmentsLength(st));for(var at=this._segmentsLength,rt=at.lengths,nt=at.totalLength*tt,it=0,ot=rt.length,lt=0,ct;it<ot;){if(lt+rt[it].addedLength>nt){var ht=it,dt=st.c&&it===ot-1?0:it+1,gt=(nt-lt)/rt[it].addedLength;ct=bez.getPointInSegment(st.v[ht],st.v[dt],st.o[ht],st.i[dt],gt,rt[it]);break}else lt+=rt[it].addedLength;it+=1}return ct||(ct=st.c?[st.v[0][0],st.v[0][1]]:[st.v[st._length-1][0],st.v[st._length-1][1]]),ct},vectorOnPath:function(tt,et,st){tt==1?tt=this.v.c:tt==0&&(tt=.999);var at=this.pointOnPath(tt,et),rt=this.pointOnPath(tt+.001,et),nt=rt[0]-at[0],it=rt[1]-at[1],ot=Math.sqrt(Math.pow(nt,2)+Math.pow(it,2));if(ot===0)return[0,0];var lt=st==="tangent"?[nt/ot,it/ot]:[-it/ot,nt/ot];return lt},tangentOnPath:function(tt,et){return this.vectorOnPath(tt,et,"tangent")},normalOnPath:function(tt,et){return this.vectorOnPath(tt,et,"normal")},setGroupProperty:expressionHelpers.setGroupProperty,getValueAtTime:expressionHelpers.getStaticValueAtTime},extendPrototype([j],b),extendPrototype([j],_),_.prototype.getValueAtTime=g,_.prototype.initiateExpression=ExpressionManager.initiateExpression;var $=ShapePropertyFactory.getShapeProp;ShapePropertyFactory.getShapeProp=function(_e,tt,et,st,at){var rt=$(_e,tt,et,st,at);return rt.propertyIndex=tt.ix,rt.lock=!1,et===3?expressionHelpers.searchExpressions(_e,tt.pt,rt):et===4&&expressionHelpers.searchExpressions(_e,tt.ks,rt),rt.k&&_e.addDynamicProperty(rt),rt}}function initialize$1(){addPropertyDecorator()}function addDecorator(){function s(){return this.data.d.x?(this.calculateExpression=ExpressionManager.initiateExpression.bind(this)(this.elem,this.data.d,this),this.addEffect(this.getExpressionValue.bind(this)),!0):null}TextProperty.prototype.getExpressionValue=function(e,i){var a=this.calculateExpression(i);if(e.t!==a){var o={};return this.copyData(o,e),o.t=a.toString(),o.__complete=!1,o}return e},TextProperty.prototype.searchProperty=function(){var e=this.searchKeyframes(),i=this.searchExpressions();return this.kf=e||i,this.kf},TextProperty.prototype.searchExpressions=s}function initialize(){addDecorator()}function SVGComposableEffect(){}SVGComposableEffect.prototype={createMergeNode:function s(e,i){var a=createNS("feMerge");a.setAttribute("result",e);var o,c;for(c=0;c<i.length;c+=1)o=createNS("feMergeNode"),o.setAttribute("in",i[c]),a.appendChild(o),a.appendChild(o);return a}};var linearFilterValue="0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0";function SVGTintFilter(s,e,i,a,o){this.filterManager=e;var c=createNS("feColorMatrix");c.setAttribute("type","matrix"),c.setAttribute("color-interpolation-filters","linearRGB"),c.setAttribute("values",linearFilterValue+" 1 0"),this.linearFilter=c,c.setAttribute("result",a+"_tint_1"),s.appendChild(c),c=createNS("feColorMatrix"),c.setAttribute("type","matrix"),c.setAttribute("color-interpolation-filters","sRGB"),c.setAttribute("values","1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"),c.setAttribute("result",a+"_tint_2"),s.appendChild(c),this.matrixFilter=c;var d=this.createMergeNode(a,[o,a+"_tint_1",a+"_tint_2"]);s.appendChild(d)}extendPrototype([SVGComposableEffect],SVGTintFilter),SVGTintFilter.prototype.renderFrame=function(s){if(s||this.filterManager._mdf){var e=this.filterManager.effectElements[0].p.v,i=this.filterManager.effectElements[1].p.v,a=this.filterManager.effectElements[2].p.v/100;this.linearFilter.setAttribute("values",linearFilterValue+" "+a+" 0"),this.matrixFilter.setAttribute("values",i[0]-e[0]+" 0 0 0 "+e[0]+" "+(i[1]-e[1])+" 0 0 0 "+e[1]+" "+(i[2]-e[2])+" 0 0 0 "+e[2]+" 0 0 0 1 0")}};function SVGFillFilter(s,e,i,a){this.filterManager=e;var o=createNS("feColorMatrix");o.setAttribute("type","matrix"),o.setAttribute("color-interpolation-filters","sRGB"),o.setAttribute("values","1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"),o.setAttribute("result",a),s.appendChild(o),this.matrixFilter=o}SVGFillFilter.prototype.renderFrame=function(s){if(s||this.filterManager._mdf){var e=this.filterManager.effectElements[2].p.v,i=this.filterManager.effectElements[6].p.v;this.matrixFilter.setAttribute("values","0 0 0 0 "+e[0]+" 0 0 0 0 "+e[1]+" 0 0 0 0 "+e[2]+" 0 0 0 "+i+" 0")}};function SVGStrokeEffect(s,e,i){this.initialized=!1,this.filterManager=e,this.elem=i,this.paths=[]}SVGStrokeEffect.prototype.initialize=function(){var s=this.elem.layerElement.children||this.elem.layerElement.childNodes,e,i,a,o;for(this.filterManager.effectElements[1].p.v===1?(o=this.elem.maskManager.masksProperties.length,a=0):(a=this.filterManager.effectElements[0].p.v-1,o=a+1),i=createNS("g"),i.setAttribute("fill","none"),i.setAttribute("stroke-linecap","round"),i.setAttribute("stroke-dashoffset",1),a;a<o;a+=1)e=createNS("path"),i.appendChild(e),this.paths.push({p:e,m:a});if(this.filterManager.effectElements[10].p.v===3){var c=createNS("mask"),d=createElementID();c.setAttribute("id",d),c.setAttribute("mask-type","alpha"),c.appendChild(i),this.elem.globalData.defs.appendChild(c);var g=createNS("g");for(g.setAttribute("mask","url("+getLocationHref()+"#"+d+")");s[0];)g.appendChild(s[0]);this.elem.layerElement.appendChild(g),this.masker=c,i.setAttribute("stroke","#fff")}else if(this.filterManager.effectElements[10].p.v===1||this.filterManager.effectElements[10].p.v===2){if(this.filterManager.effectElements[10].p.v===2)for(s=this.elem.layerElement.children||this.elem.layerElement.childNodes;s.length;)this.elem.layerElement.removeChild(s[0]);this.elem.layerElement.appendChild(i),this.elem.layerElement.removeAttribute("mask"),i.setAttribute("stroke","#fff")}this.initialized=!0,this.pathMasker=i},SVGStrokeEffect.prototype.renderFrame=function(s){this.initialized||this.initialize();var e,i=this.paths.length,a,o;for(e=0;e<i;e+=1)if(this.paths[e].m!==-1&&(a=this.elem.maskManager.viewData[this.paths[e].m],o=this.paths[e].p,(s||this.filterManager._mdf||a.prop._mdf)&&o.setAttribute("d",a.lastPath),s||this.filterManager.effectElements[9].p._mdf||this.filterManager.effectElements[4].p._mdf||this.filterManager.effectElements[7].p._mdf||this.filterManager.effectElements[8].p._mdf||a.prop._mdf)){var c;if(this.filterManager.effectElements[7].p.v!==0||this.filterManager.effectElements[8].p.v!==100){var d=Math.min(this.filterManager.effectElements[7].p.v,this.filterManager.effectElements[8].p.v)*.01,g=Math.max(this.filterManager.effectElements[7].p.v,this.filterManager.effectElements[8].p.v)*.01,b=o.getTotalLength();c="0 0 0 "+b*d+" ";var _=b*(g-d),j=1+this.filterManager.effectElements[4].p.v*2*this.filterManager.effectElements[9].p.v*.01,$=Math.floor(_/j),_e;for(_e=0;_e<$;_e+=1)c+="1 "+this.filterManager.effectElements[4].p.v*2*this.filterManager.effectElements[9].p.v*.01+" ";c+="0 "+b*10+" 0 0"}else c="1 "+this.filterManager.effectElements[4].p.v*2*this.filterManager.effectElements[9].p.v*.01;o.setAttribute("stroke-dasharray",c)}if((s||this.filterManager.effectElements[4].p._mdf)&&this.pathMasker.setAttribute("stroke-width",this.filterManager.effectElements[4].p.v*2),(s||this.filterManager.effectElements[6].p._mdf)&&this.pathMasker.setAttribute("opacity",this.filterManager.effectElements[6].p.v),(this.filterManager.effectElements[10].p.v===1||this.filterManager.effectElements[10].p.v===2)&&(s||this.filterManager.effectElements[3].p._mdf)){var tt=this.filterManager.effectElements[3].p.v;this.pathMasker.setAttribute("stroke","rgb("+bmFloor(tt[0]*255)+","+bmFloor(tt[1]*255)+","+bmFloor(tt[2]*255)+")")}};function SVGTritoneFilter(s,e,i,a){this.filterManager=e;var o=createNS("feColorMatrix");o.setAttribute("type","matrix"),o.setAttribute("color-interpolation-filters","linearRGB"),o.setAttribute("values","0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0"),s.appendChild(o);var c=createNS("feComponentTransfer");c.setAttribute("color-interpolation-filters","sRGB"),c.setAttribute("result",a),this.matrixFilter=c;var d=createNS("feFuncR");d.setAttribute("type","table"),c.appendChild(d),this.feFuncR=d;var g=createNS("feFuncG");g.setAttribute("type","table"),c.appendChild(g),this.feFuncG=g;var b=createNS("feFuncB");b.setAttribute("type","table"),c.appendChild(b),this.feFuncB=b,s.appendChild(c)}SVGTritoneFilter.prototype.renderFrame=function(s){if(s||this.filterManager._mdf){var e=this.filterManager.effectElements[0].p.v,i=this.filterManager.effectElements[1].p.v,a=this.filterManager.effectElements[2].p.v,o=a[0]+" "+i[0]+" "+e[0],c=a[1]+" "+i[1]+" "+e[1],d=a[2]+" "+i[2]+" "+e[2];this.feFuncR.setAttribute("tableValues",o),this.feFuncG.setAttribute("tableValues",c),this.feFuncB.setAttribute("tableValues",d)}};function SVGProLevelsFilter(s,e,i,a){this.filterManager=e;var o=this.filterManager.effectElements,c=createNS("feComponentTransfer");(o[10].p.k||o[10].p.v!==0||o[11].p.k||o[11].p.v!==1||o[12].p.k||o[12].p.v!==1||o[13].p.k||o[13].p.v!==0||o[14].p.k||o[14].p.v!==1)&&(this.feFuncR=this.createFeFunc("feFuncR",c)),(o[17].p.k||o[17].p.v!==0||o[18].p.k||o[18].p.v!==1||o[19].p.k||o[19].p.v!==1||o[20].p.k||o[20].p.v!==0||o[21].p.k||o[21].p.v!==1)&&(this.feFuncG=this.createFeFunc("feFuncG",c)),(o[24].p.k||o[24].p.v!==0||o[25].p.k||o[25].p.v!==1||o[26].p.k||o[26].p.v!==1||o[27].p.k||o[27].p.v!==0||o[28].p.k||o[28].p.v!==1)&&(this.feFuncB=this.createFeFunc("feFuncB",c)),(o[31].p.k||o[31].p.v!==0||o[32].p.k||o[32].p.v!==1||o[33].p.k||o[33].p.v!==1||o[34].p.k||o[34].p.v!==0||o[35].p.k||o[35].p.v!==1)&&(this.feFuncA=this.createFeFunc("feFuncA",c)),(this.feFuncR||this.feFuncG||this.feFuncB||this.feFuncA)&&(c.setAttribute("color-interpolation-filters","sRGB"),s.appendChild(c)),(o[3].p.k||o[3].p.v!==0||o[4].p.k||o[4].p.v!==1||o[5].p.k||o[5].p.v!==1||o[6].p.k||o[6].p.v!==0||o[7].p.k||o[7].p.v!==1)&&(c=createNS("feComponentTransfer"),c.setAttribute("color-interpolation-filters","sRGB"),c.setAttribute("result",a),s.appendChild(c),this.feFuncRComposed=this.createFeFunc("feFuncR",c),this.feFuncGComposed=this.createFeFunc("feFuncG",c),this.feFuncBComposed=this.createFeFunc("feFuncB",c))}SVGProLevelsFilter.prototype.createFeFunc=function(s,e){var i=createNS(s);return i.setAttribute("type","table"),e.appendChild(i),i},SVGProLevelsFilter.prototype.getTableValue=function(s,e,i,a,o){for(var c=0,d=256,g,b=Math.min(s,e),_=Math.max(s,e),j=Array.call(null,{length:d}),$,_e=0,tt=o-a,et=e-s;c<=256;)g=c/256,g<=b?$=et<0?o:a:g>=_?$=et<0?a:o:$=a+tt*Math.pow((g-s)/et,1/i),j[_e]=$,_e+=1,c+=256/(d-1);return j.join(" ")},SVGProLevelsFilter.prototype.renderFrame=function(s){if(s||this.filterManager._mdf){var e,i=this.filterManager.effectElements;this.feFuncRComposed&&(s||i[3].p._mdf||i[4].p._mdf||i[5].p._mdf||i[6].p._mdf||i[7].p._mdf)&&(e=this.getTableValue(i[3].p.v,i[4].p.v,i[5].p.v,i[6].p.v,i[7].p.v),this.feFuncRComposed.setAttribute("tableValues",e),this.feFuncGComposed.setAttribute("tableValues",e),this.feFuncBComposed.setAttribute("tableValues",e)),this.feFuncR&&(s||i[10].p._mdf||i[11].p._mdf||i[12].p._mdf||i[13].p._mdf||i[14].p._mdf)&&(e=this.getTableValue(i[10].p.v,i[11].p.v,i[12].p.v,i[13].p.v,i[14].p.v),this.feFuncR.setAttribute("tableValues",e)),this.feFuncG&&(s||i[17].p._mdf||i[18].p._mdf||i[19].p._mdf||i[20].p._mdf||i[21].p._mdf)&&(e=this.getTableValue(i[17].p.v,i[18].p.v,i[19].p.v,i[20].p.v,i[21].p.v),this.feFuncG.setAttribute("tableValues",e)),this.feFuncB&&(s||i[24].p._mdf||i[25].p._mdf||i[26].p._mdf||i[27].p._mdf||i[28].p._mdf)&&(e=this.getTableValue(i[24].p.v,i[25].p.v,i[26].p.v,i[27].p.v,i[28].p.v),this.feFuncB.setAttribute("tableValues",e)),this.feFuncA&&(s||i[31].p._mdf||i[32].p._mdf||i[33].p._mdf||i[34].p._mdf||i[35].p._mdf)&&(e=this.getTableValue(i[31].p.v,i[32].p.v,i[33].p.v,i[34].p.v,i[35].p.v),this.feFuncA.setAttribute("tableValues",e))}};function SVGDropShadowEffect(s,e,i,a,o){var c=e.container.globalData.renderConfig.filterSize,d=e.data.fs||c;s.setAttribute("x",d.x||c.x),s.setAttribute("y",d.y||c.y),s.setAttribute("width",d.width||c.width),s.setAttribute("height",d.height||c.height),this.filterManager=e;var g=createNS("feGaussianBlur");g.setAttribute("in","SourceAlpha"),g.setAttribute("result",a+"_drop_shadow_1"),g.setAttribute("stdDeviation","0"),this.feGaussianBlur=g,s.appendChild(g);var b=createNS("feOffset");b.setAttribute("dx","25"),b.setAttribute("dy","0"),b.setAttribute("in",a+"_drop_shadow_1"),b.setAttribute("result",a+"_drop_shadow_2"),this.feOffset=b,s.appendChild(b);var _=createNS("feFlood");_.setAttribute("flood-color","#00ff00"),_.setAttribute("flood-opacity","1"),_.setAttribute("result",a+"_drop_shadow_3"),this.feFlood=_,s.appendChild(_);var j=createNS("feComposite");j.setAttribute("in",a+"_drop_shadow_3"),j.setAttribute("in2",a+"_drop_shadow_2"),j.setAttribute("operator","in"),j.setAttribute("result",a+"_drop_shadow_4"),s.appendChild(j);var $=this.createMergeNode(a,[a+"_drop_shadow_4",o]);s.appendChild($)}extendPrototype([SVGComposableEffect],SVGDropShadowEffect),SVGDropShadowEffect.prototype.renderFrame=function(s){if(s||this.filterManager._mdf){if((s||this.filterManager.effectElements[4].p._mdf)&&this.feGaussianBlur.setAttribute("stdDeviation",this.filterManager.effectElements[4].p.v/4),s||this.filterManager.effectElements[0].p._mdf){var e=this.filterManager.effectElements[0].p.v;this.feFlood.setAttribute("flood-color",rgbToHex(Math.round(e[0]*255),Math.round(e[1]*255),Math.round(e[2]*255)))}if((s||this.filterManager.effectElements[1].p._mdf)&&this.feFlood.setAttribute("flood-opacity",this.filterManager.effectElements[1].p.v/255),s||this.filterManager.effectElements[2].p._mdf||this.filterManager.effectElements[3].p._mdf){var i=this.filterManager.effectElements[3].p.v,a=(this.filterManager.effectElements[2].p.v-90)*degToRads,o=i*Math.cos(a),c=i*Math.sin(a);this.feOffset.setAttribute("dx",o),this.feOffset.setAttribute("dy",c)}}};var _svgMatteSymbols=[];function SVGMatte3Effect(s,e,i){this.initialized=!1,this.filterManager=e,this.filterElem=s,this.elem=i,i.matteElement=createNS("g"),i.matteElement.appendChild(i.layerElement),i.matteElement.appendChild(i.transformedElement),i.baseElement=i.matteElement}SVGMatte3Effect.prototype.findSymbol=function(s){for(var e=0,i=_svgMatteSymbols.length;e<i;){if(_svgMatteSymbols[e]===s)return _svgMatteSymbols[e];e+=1}return null},SVGMatte3Effect.prototype.replaceInParent=function(s,e){var i=s.layerElement.parentNode;if(i){for(var a=i.children,o=0,c=a.length;o<c&&a[o]!==s.layerElement;)o+=1;var d;o<=c-2&&(d=a[o+1]);var g=createNS("use");g.setAttribute("href","#"+e),d?i.insertBefore(g,d):i.appendChild(g)}},SVGMatte3Effect.prototype.setElementAsMask=function(s,e){if(!this.findSymbol(e)){var i=createElementID(),a=createNS("mask");a.setAttribute("id",e.layerId),a.setAttribute("mask-type","alpha"),_svgMatteSymbols.push(e);var o=s.globalData.defs;o.appendChild(a);var c=createNS("symbol");c.setAttribute("id",i),this.replaceInParent(e,i),c.appendChild(e.layerElement),o.appendChild(c);var d=createNS("use");d.setAttribute("href","#"+i),a.appendChild(d),e.data.hd=!1,e.show()}s.setMatte(e.layerId)},SVGMatte3Effect.prototype.initialize=function(){for(var s=this.filterManager.effectElements[0].p.v,e=this.elem.comp.elements,i=0,a=e.length;i<a;)e[i]&&e[i].data.ind===s&&this.setElementAsMask(this.elem,e[i]),i+=1;this.initialized=!0},SVGMatte3Effect.prototype.renderFrame=function(){this.initialized||this.initialize()};function SVGGaussianBlurEffect(s,e,i,a){s.setAttribute("x","-100%"),s.setAttribute("y","-100%"),s.setAttribute("width","300%"),s.setAttribute("height","300%"),this.filterManager=e;var o=createNS("feGaussianBlur");o.setAttribute("result",a),s.appendChild(o),this.feGaussianBlur=o}SVGGaussianBlurEffect.prototype.renderFrame=function(s){if(s||this.filterManager._mdf){var e=.3,i=this.filterManager.effectElements[0].p.v*e,a=this.filterManager.effectElements[1].p.v,o=a==3?0:i,c=a==2?0:i;this.feGaussianBlur.setAttribute("stdDeviation",o+" "+c);var d=this.filterManager.effectElements[2].p.v==1?"wrap":"duplicate";this.feGaussianBlur.setAttribute("edgeMode",d)}};function TransformEffect(){}TransformEffect.prototype.init=function(s){this.effectsManager=s,this.type=effectTypes.TRANSFORM_EFFECT,this.matrix=new Matrix,this.opacity=-1,this._mdf=!1,this._opMdf=!1},TransformEffect.prototype.renderFrame=function(s){if(this._opMdf=!1,this._mdf=!1,s||this.effectsManager._mdf){var e=this.effectsManager.effectElements,i=e[0].p.v,a=e[1].p.v,o=e[2].p.v===1,c=e[3].p.v,d=o?c:e[4].p.v,g=e[5].p.v,b=e[6].p.v,_=e[7].p.v;this.matrix.reset(),this.matrix.translate(-i[0],-i[1],i[2]),this.matrix.scale(d*.01,c*.01,1),this.matrix.rotate(-_*degToRads),this.matrix.skewFromAxis(-g*degToRads,(b+90)*degToRads),this.matrix.translate(a[0],a[1],0),this._mdf=!0,this.opacity!==e[8].p.v&&(this.opacity=e[8].p.v,this._opMdf=!0)}};function SVGTransformEffect(s,e){this.init(e)}extendPrototype([TransformEffect],SVGTransformEffect);function CVTransformEffect(s){this.init(s)}return extendPrototype([TransformEffect],CVTransformEffect),registerRenderer("canvas",CanvasRenderer),registerRenderer("html",HybridRenderer),registerRenderer("svg",SVGRenderer),ShapeModifiers.registerModifier("tm",TrimModifier),ShapeModifiers.registerModifier("pb",PuckerAndBloatModifier),ShapeModifiers.registerModifier("rp",RepeaterModifier),ShapeModifiers.registerModifier("rd",RoundCornersModifier),ShapeModifiers.registerModifier("zz",ZigZagModifier),ShapeModifiers.registerModifier("op",OffsetPathModifier),setExpressionsPlugin(Expressions),setExpressionInterfaces(getInterface),initialize$1(),initialize(),registerEffect$1(20,SVGTintFilter,!0),registerEffect$1(21,SVGFillFilter,!0),registerEffect$1(22,SVGStrokeEffect,!1),registerEffect$1(23,SVGTritoneFilter,!0),registerEffect$1(24,SVGProLevelsFilter,!0),registerEffect$1(25,SVGDropShadowEffect,!0),registerEffect$1(28,SVGMatte3Effect,!1),registerEffect$1(29,SVGGaussianBlurEffect,!0),registerEffect$1(35,SVGTransformEffect,!1),registerEffect(35,CVTransformEffect),lottie})})(lottie$1,lottie$1.exports);var lottieExports=lottie$1.exports;const lottie=getDefaultExportFromCjs$1(lottieExports);function _arrayLikeToArray(s,e){(e==null||e>s.length)&&(e=s.length);for(var i=0,a=Array(e);i<e;i++)a[i]=s[i];return a}function _arrayWithHoles(s){if(Array.isArray(s))return s}function _defineProperty$1(s,e,i){return(e=_toPropertyKey$1(e))in s?Object.defineProperty(s,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):s[e]=i,s}function _iterableToArrayLimit(s,e){var i=s==null?null:typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(i!=null){var a,o,c,d,g=[],b=!0,_=!1;try{if(c=(i=i.call(s)).next,e!==0)for(;!(b=(a=c.call(i)).done)&&(g.push(a.value),g.length!==e);b=!0);}catch(j){_=!0,o=j}finally{try{if(!b&&i.return!=null&&(d=i.return(),Object(d)!==d))return}finally{if(_)throw o}}return g}}function _nonIterableRest(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ownKeys$1(s,e){var i=Object.keys(s);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(s);e&&(a=a.filter(function(o){return Object.getOwnPropertyDescriptor(s,o).enumerable})),i.push.apply(i,a)}return i}function _objectSpread2$1(s){for(var e=1;e<arguments.length;e++){var i=arguments[e]!=null?arguments[e]:{};e%2?ownKeys$1(Object(i),!0).forEach(function(a){_defineProperty$1(s,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(i)):ownKeys$1(Object(i)).forEach(function(a){Object.defineProperty(s,a,Object.getOwnPropertyDescriptor(i,a))})}return s}function _objectWithoutProperties(s,e){if(s==null)return{};var i,a,o=_objectWithoutPropertiesLoose(s,e);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(s);for(a=0;a<c.length;a++)i=c[a],e.includes(i)||{}.propertyIsEnumerable.call(s,i)&&(o[i]=s[i])}return o}function _objectWithoutPropertiesLoose(s,e){if(s==null)return{};var i={};for(var a in s)if({}.hasOwnProperty.call(s,a)){if(e.includes(a))continue;i[a]=s[a]}return i}function _slicedToArray(s,e){return _arrayWithHoles(s)||_iterableToArrayLimit(s,e)||_unsupportedIterableToArray(s,e)||_nonIterableRest()}function _toPrimitive$1(s,e){if(typeof s!="object"||!s)return s;var i=s[Symbol.toPrimitive];if(i!==void 0){var a=i.call(s,e);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}function _toPropertyKey$1(s){var e=_toPrimitive$1(s,"string");return typeof e=="symbol"?e:e+""}function _unsupportedIterableToArray(s,e){if(s){if(typeof s=="string")return _arrayLikeToArray(s,e);var i={}.toString.call(s).slice(8,-1);return i==="Object"&&s.constructor&&(i=s.constructor.name),i==="Map"||i==="Set"?Array.from(s):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?_arrayLikeToArray(s,e):void 0}}var _excluded$1=["animationData","loop","autoplay","initialSegment","onComplete","onLoopComplete","onEnterFrame","onSegmentStart","onConfigReady","onDataReady","onDataFailed","onLoadedImages","onDOMLoaded","onDestroy","lottieRef","renderer","name","assetsPath","rendererSettings"],useLottie=function s(e,i){var a=e.animationData,o=e.loop,c=e.autoplay,d=e.initialSegment,g=e.onComplete,b=e.onLoopComplete,_=e.onEnterFrame,j=e.onSegmentStart,$=e.onConfigReady,_e=e.onDataReady,tt=e.onDataFailed,et=e.onLoadedImages,st=e.onDOMLoaded,at=e.onDestroy;e.lottieRef,e.renderer,e.name,e.assetsPath,e.rendererSettings;var rt=_objectWithoutProperties(e,_excluded$1),nt=reactExports.useState(!1),it=_slicedToArray(nt,2),ot=it[0],lt=it[1],ct=reactExports.useRef(),ht=reactExports.useRef(null),dt=function(){var Et;(Et=ct.current)===null||Et===void 0||Et.play()},gt=function(){var Et;(Et=ct.current)===null||Et===void 0||Et.stop()},vt=function(){var Et;(Et=ct.current)===null||Et===void 0||Et.pause()},St=function(Et){var At;(At=ct.current)===null||At===void 0||At.setSpeed(Et)},Tt=function(Et,At){var Pt;(Pt=ct.current)===null||Pt===void 0||Pt.goToAndPlay(Et,At)},Ct=function(Et,At){var Pt;(Pt=ct.current)===null||Pt===void 0||Pt.goToAndStop(Et,At)},Rt=function(Et){var At;(At=ct.current)===null||At===void 0||At.setDirection(Et)},bt=function(Et,At){var Pt;(Pt=ct.current)===null||Pt===void 0||Pt.playSegments(Et,At)},pt=function(Et){var At;(At=ct.current)===null||At===void 0||At.setSubframe(Et)},yt=function(Et){var At;return(At=ct.current)===null||At===void 0?void 0:At.getDuration(Et)},ut=function(){var Et;(Et=ct.current)===null||Et===void 0||Et.destroy(),ct.current=void 0},ft=function(){var Et=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},At;if(ht.current){(At=ct.current)===null||At===void 0||At.destroy();var Pt=_objectSpread2$1(_objectSpread2$1(_objectSpread2$1({},e),Et),{},{container:ht.current});return ct.current=lottie.loadAnimation(Pt),lt(!!ct.current),function(){var wt;(wt=ct.current)===null||wt===void 0||wt.destroy(),ct.current=void 0}}};reactExports.useEffect(function(){var mt=ft();return function(){return mt==null?void 0:mt()}},[a,o]),reactExports.useEffect(function(){ct.current&&(ct.current.autoplay=!!c)},[c]),reactExports.useEffect(function(){if(ct.current){if(!d){ct.current.resetSegments(!0);return}!Array.isArray(d)||!d.length||((ct.current.currentRawFrame<d[0]||ct.current.currentRawFrame>d[1])&&(ct.current.currentRawFrame=d[0]),ct.current.setSegment(d[0],d[1]))}},[d]),reactExports.useEffect(function(){var mt=[{name:"complete",handler:g},{name:"loopComplete",handler:b},{name:"enterFrame",handler:_},{name:"segmentStart",handler:j},{name:"config_ready",handler:$},{name:"data_ready",handler:_e},{name:"data_failed",handler:tt},{name:"loaded_images",handler:et},{name:"DOMLoaded",handler:st},{name:"destroy",handler:at}],Et=mt.filter(function(Pt){return Pt.handler!=null});if(Et.length){var At=Et.map(function(Pt){var wt;return(wt=ct.current)===null||wt===void 0||wt.addEventListener(Pt.name,Pt.handler),function(){var It;(It=ct.current)===null||It===void 0||It.removeEventListener(Pt.name,Pt.handler)}});return function(){At.forEach(function(Pt){return Pt()})}}},[g,b,_,j,$,_e,tt,et,st,at]);var xt=React.createElement("div",_objectSpread2$1({style:i,ref:ht},rt));return{View:xt,play:dt,stop:gt,pause:vt,setSpeed:St,goToAndStop:Ct,goToAndPlay:Tt,setDirection:Rt,playSegments:bt,setSubframe:pt,getDuration:yt,destroy:ut,animationContainerRef:ht,animationLoaded:ot,animationItem:ct.current}};function getContainerVisibility(s){var e=s.getBoundingClientRect(),i=e.top,a=e.height,o=window.innerHeight-i,c=window.innerHeight+a;return o/c}function getContainerCursorPosition(s,e,i){var a=s.getBoundingClientRect(),o=a.top,c=a.left,d=a.width,g=a.height,b=(e-c)/d,_=(i-o)/g;return{x:b,y:_}}var useInitInteractivity=function s(e){var i=e.wrapperRef,a=e.animationItem,o=e.mode,c=e.actions;reactExports.useEffect(function(){var d=i.current;if(!(!d||!a||!c.length)){a.stop();var g=function(){var j=null,$=function(){var tt=getContainerVisibility(d),et=c.find(function(at){var rt=at.visibility;return rt&&tt>=rt[0]&&tt<=rt[1]});if(et){if(et.type==="seek"&&et.visibility&&et.frames.length===2){var st=et.frames[0]+Math.ceil((tt-et.visibility[0])/(et.visibility[1]-et.visibility[0])*et.frames[1]);//! goToAndStop must be relative to the start of the current segment
a.goToAndStop(st-a.firstFrame-1,!0)}et.type==="loop"&&(j===null||j!==et.frames||a.isPaused)&&(a.playSegments(et.frames,!0),j=et.frames),et.type==="play"&&a.isPaused&&(a.resetSegments(!0),a.play()),et.type==="stop"&&a.goToAndStop(et.frames[0]-a.firstFrame-1,!0)}};return document.addEventListener("scroll",$),function(){document.removeEventListener("scroll",$)}},b=function(){var j=function(et,st){var at=et,rt=st;if(at!==-1&&rt!==-1){var nt=getContainerCursorPosition(d,at,rt);at=nt.x,rt=nt.y}var it=c.find(function(ct){var ht=ct.position;return ht&&Array.isArray(ht.x)&&Array.isArray(ht.y)?at>=ht.x[0]&&at<=ht.x[1]&&rt>=ht.y[0]&&rt<=ht.y[1]:ht&&!Number.isNaN(ht.x)&&!Number.isNaN(ht.y)?at===ht.x&&rt===ht.y:!1});if(it){if(it.type==="seek"&&it.position&&Array.isArray(it.position.x)&&Array.isArray(it.position.y)&&it.frames.length===2){var ot=(at-it.position.x[0])/(it.position.x[1]-it.position.x[0]),lt=(rt-it.position.y[0])/(it.position.y[1]-it.position.y[0]);a.playSegments(it.frames,!0),a.goToAndStop(Math.ceil((ot+lt)/2*(it.frames[1]-it.frames[0])),!0)}it.type==="loop"&&a.playSegments(it.frames,!0),it.type==="play"&&(a.isPaused&&a.resetSegments(!1),a.playSegments(it.frames)),it.type==="stop"&&a.goToAndStop(it.frames[0],!0)}},$=function(et){j(et.clientX,et.clientY)},_e=function(){j(-1,-1)};return d.addEventListener("mousemove",$),d.addEventListener("mouseout",_e),function(){d.removeEventListener("mousemove",$),d.removeEventListener("mouseout",_e)}};switch(o){case"scroll":return g();case"cursor":return b()}}},[o,a])},useLottieInteractivity=function s(e){var i=e.actions,a=e.mode,o=e.lottieObj,c=o.animationItem,d=o.View,g=o.animationContainerRef;return useInitInteractivity({actions:i,animationItem:c,mode:a,wrapperRef:g}),d},_excluded=["style","interactivity"],Lottie=function s(e){var i,a,o,c=e.style,d=e.interactivity,g=_objectWithoutProperties(e,_excluded),b=useLottie(g,c),_=b.View,j=b.play,$=b.stop,_e=b.pause,tt=b.setSpeed,et=b.goToAndStop,st=b.goToAndPlay,at=b.setDirection,rt=b.playSegments,nt=b.setSubframe,it=b.getDuration,ot=b.destroy,lt=b.animationContainerRef,ct=b.animationLoaded,ht=b.animationItem;return reactExports.useEffect(function(){e.lottieRef&&(e.lottieRef.current={play:j,stop:$,pause:_e,setSpeed:tt,goToAndPlay:st,goToAndStop:et,setDirection:at,playSegments:rt,setSubframe:nt,getDuration:it,destroy:ot,animationContainerRef:lt,animationLoaded:ct,animationItem:ht})},[(i=e.lottieRef)===null||i===void 0?void 0:i.current]),useLottieInteractivity({lottieObj:{View:_,play:j,stop:$,pause:_e,setSpeed:tt,goToAndStop:et,goToAndPlay:st,setDirection:at,playSegments:rt,setSubframe:nt,getDuration:it,destroy:ot,animationContainerRef:lt,animationLoaded:ct,animationItem:ht},actions:(a=d==null?void 0:d.actions)!==null&&a!==void 0?a:[],mode:(o=d==null?void 0:d.mode)!==null&&o!==void 0?o:"scroll"})};const nm="Comp 1",ddd=0,h=1060,w=800,meta={g:"@lottiefiles/toolkit-js 0.33.2"},layers=[{ty:3,nm:"Adjustment Layer 1",sr:1,st:0,op:48,ip:0,hd:!1,ddd:0,bm:0,hasMask:!0,ao:0,ks:{a:{a:0,k:[400,480,0],ix:1},s:{a:0,k:[100,110.42,100],ix:6},sk:{a:0,k:0},p:{a:0,k:[400,530,0],ix:2},r:{a:0,k:0,ix:10},sa:{a:0,k:0},o:{a:0,k:100,ix:11}},ef:[],masksProperties:[{nm:"Mask 1",inv:!1,mode:"a",x:{a:0,k:0,ix:4},o:{a:0,k:100,ix:3},pt:{a:0,k:{c:!0,i:[[184.675,-.246],[0,0],[0,-11.046],[0,0],[-18.877,0],[0,0],[0,182.122],[0,0]],o:[[0,0],[-179.877,0],[0,0],[-1.772,162.621],[0,0],[11.045,0],[0,0],[0,-11.046]],v:[[615.825,1.246],[185.877,1.482],[1.141,186.123],[2.772,769.879],[185.877,959.025],[615.825,958.756],[799.15,769.879],[797.15,186.123]]},ix:1}}],ind:1},{ty:0,nm:"Pre-comp 1",sr:1,st:0,op:48,ip:0,hd:!1,ddd:0,bm:0,hasMask:!0,ao:0,ks:{a:{a:0,k:[400,480,0],ix:1},s:{a:0,k:[100,110.42,100],ix:6},sk:{a:0,k:0},p:{a:0,k:[400,530,0],ix:2},r:{a:0,k:0,ix:10},sa:{a:0,k:0},o:{a:0,k:100,ix:11}},ef:[],masksProperties:[{nm:"Mask 1",inv:!1,mode:"a",x:{a:0,k:0,ix:4},o:{a:0,k:100,ix:3},pt:{a:0,k:{c:!0,i:[[184.675,-.246],[0,0],[0,-11.046],[0,0],[-18.877,0],[0,0],[0,182.122],[0,0]],o:[[0,0],[-179.877,0],[0,0],[-1.772,162.621],[0,0],[11.045,0],[0,0],[0,-11.046]],v:[[615.825,1.246],[185.877,1.482],[1.141,186.123],[2.772,769.879],[185.877,959.025],[615.825,958.756],[799.15,769.879],[797.15,186.123]]},ix:1}}],w:800,h:960,refId:"comp_0",ind:2}],v="5.7.8",fr=24,op=48,ip=0,assets=[{nm:"",id:"comp_0",layers:[{ty:1,nm:"White Solid 1",sr:1,st:0,op:48,ip:0,hd:!1,ddd:0,bm:0,hasMask:!1,ao:0,ks:{a:{a:0,k:[400,480,0],ix:1},s:{a:0,k:[39.042,152.486,100],ix:6},sk:{a:0,k:0},p:{a:1,k:[{o:{x:.333,y:0},i:{x:.667,y:1},s:[-294,-24,0],t:0,ti:[-213.333,-187.667,0],to:[213.333,187.667,0]},{s:[986,1102,0],t:20}],ix:2},r:{a:0,k:45,ix:10},sa:{a:0,k:0},o:{a:0,k:100,ix:11}},ef:[{ty:29,mn:"ADBE Gaussian Blur 2",nm:"Gaussian Blur",ix:1,en:1,ef:[{ty:0,mn:"ADBE Gaussian Blur 2-0001",nm:"Blurriness",ix:1,v:{a:0,k:815.4,ix:1}},{ty:7,mn:"ADBE Gaussian Blur 2-0002",nm:"Blur Dimensions",ix:2,v:{a:0,k:1,ix:2}},{ty:7,mn:"ADBE Gaussian Blur 2-0003",nm:"Repeat Edge Pixels",ix:3,v:{a:0,k:0,ix:3}}]}],sc:"#ffffff",sh:960,sw:800,ind:1},{ty:0,nm:"Gray Solid 1 Comp 1",sr:1,st:0,op:48,ip:0,hd:!1,ddd:0,bm:0,hasMask:!0,ao:0,ks:{a:{a:0,k:[400,480,0],ix:1},s:{a:0,k:[100,100,100],ix:6},sk:{a:0,k:0},p:{a:0,k:[398,480,0],ix:2},r:{a:0,k:0,ix:10},sa:{a:0,k:0},o:{a:0,k:100,ix:11}},ef:[{ty:21,mn:"ADBE Fill",nm:"Fill",ix:1,en:1,ef:[{ty:10,mn:"ADBE Fill-0001",nm:"Fill Mask",ix:1,v:{a:0,k:0,ix:1}},{ty:7,mn:"ADBE Fill-0007",nm:"All Masks",ix:2,v:{a:0,k:0,ix:2}},{ty:2,mn:"ADBE Fill-0002",nm:"Color",ix:3,v:{a:0,k:[.7569,.7569,.7569],ix:3}},{ty:7,mn:"ADBE Fill-0006",nm:"Invert",ix:4,v:{a:0,k:0,ix:4}},{ty:0,mn:"ADBE Fill-0003",nm:"Horizontal Feather",ix:5,v:{a:0,k:0,ix:5}},{ty:0,mn:"ADBE Fill-0004",nm:"Vertical Feather",ix:6,v:{a:0,k:0,ix:6}},{ty:0,mn:"ADBE Fill-0005",nm:"Opacity",ix:7,v:{a:0,k:1,ix:7}}]},{ty:5,mn:"CC Light Sweep",nm:"CC Light Sweep",ix:2,en:1,ef:[{ty:3,mn:"CC Light Sweep-0001",nm:"Center",ix:1,v:{a:1,k:[{o:{x:.333,y:0},i:{x:.667,y:1},s:[-136,-90],t:0},{s:[1015,1161],t:22.80078125}],ix:1}},{ty:0,mn:"CC Light Sweep-0002",nm:"Direction",ix:2,v:{a:0,k:27,ix:2}},{ty:7,mn:"CC Light Sweep-0003",nm:"Shape",ix:3,v:{a:0,k:2,ix:3}},{ty:0,mn:"CC Light Sweep-0004",nm:"Width",ix:4,v:{a:0,k:176,ix:4}},{ty:0,mn:"CC Light Sweep-0005",nm:"Sweep Intensity",ix:5,v:{a:0,k:18,ix:5}},{ty:0,mn:"CC Light Sweep-0006",nm:"Edge Intensity",ix:6,v:{a:0,k:0,ix:6}},{ty:0,mn:"CC Light Sweep-0007",nm:"Edge Thickness",ix:7,v:{a:0,k:.1,ix:7}},{ty:2,mn:"CC Light Sweep-0008",nm:"Light Color",ix:8,v:{a:0,k:[1,1,1],ix:8}},{ty:7,mn:"CC Light Sweep-0009",nm:"Light Reception",ix:9,v:{a:0,k:1,ix:9}}]}],masksProperties:[{nm:"Mask 1",inv:!1,mode:"a",x:{a:0,k:0,ix:4},o:{a:0,k:100,ix:3},pt:{a:0,k:{c:!0,i:[[184.675,-.246],[0,0],[0,-11.046],[0,0],[-18.877,0],[0,0],[0,182.122],[0,0]],o:[[0,0],[-179.877,0],[0,0],[-1.772,162.621],[0,0],[11.045,0],[0,0],[0,-11.046]],v:[[615.825,1.246],[185.877,1.482],[1.141,186.123],[2.772,769.879],[185.877,959.025],[615.825,958.756],[799.15,769.879],[797.15,186.123]]},ix:1}}],w:800,h:960,refId:"comp_1",ind:2}]},{nm:"",id:"comp_1",layers:[{ty:1,nm:"Light Gray Solid 1",sr:1,st:0,op:48,ip:0,hd:!1,ddd:0,bm:0,hasMask:!1,ao:0,ks:{a:{a:0,k:[400,480,0],ix:1},s:{a:0,k:[100,100,100],ix:6},sk:{a:0,k:0},p:{a:0,k:[400,480,0],ix:2},r:{a:0,k:0,ix:10},sa:{a:0,k:0},o:{a:0,k:100,ix:11}},ef:[],sc:"#acacac",sh:960,sw:800,ind:1}]}],skeletonAnimation={nm,ddd,h,w,meta,layers,v,fr,op,ip,assets},TrendingMovies=({isActive:s,onNavigate:e})=>{const i=useNavigate(),[a,o]=reactExports.useState([]),[c,d]=reactExports.useState(!1),[g,b]=reactExports.useState(null),{selectedIndex:_,containerRef:j}=useDpadNavigation({totalItems:a.length,columns:a.length,enabled:s&&a.length>0,onEnter:tt=>{a[tt]&&_e(a[tt])},onDirectionChange:(tt,et)=>{et?tt==="ArrowLeft"&&_===0&&e(tt):e(tt)}}),$=reactExports.useCallback(async()=>{try{b(null),d(!0);const et=(await Movieapi.get("trendingmovies")).data;if(et.success!=="success")throw new Error(et.message||"Failed to fetch trending movies");const st=(et==null?void 0:et.trending_movie_details)||[];o(st)}catch(tt){b({status:"error",message:tt.message||"Failed to load trending movies."})}finally{d(!1)}},[]);console.log("trendingMoviesList:",a),reactExports.useEffect(()=>{$()},[$]);const _e=reactExports.useCallback(tt=>{i(`/movie/${tt.uuid}`)},[i]);return jsxRuntimeExports.jsxs("div",{className:"relative my-6",children:[jsxRuntimeExports.jsx("div",{}),jsxRuntimeExports.jsx("div",{className:"px-6 mb-3",children:jsxRuntimeExports.jsx(SectionHeading,{title:"Trending Movies"})}),c?jsxRuntimeExports.jsx("div",{className:"flex space-x-5 overflow-x-auto pl-6 pr-3 scrollbar-hide",children:[1,2,3,4,5,6,7].map(tt=>jsxRuntimeExports.jsx("div",{className:"w-[200px] h-[300px] bg-[#1a1a1a] overflow-hidden rounded-md flex-shrink-0",children:jsxRuntimeExports.jsx(Lottie,{animationData:skeletonAnimation,loop:!0})},tt))}):g?jsxRuntimeExports.jsx("div",{className:"px-6",children:jsxRuntimeExports.jsx(Errorpanelcardview,{errorMessages:g,retry:$})}):a.length===0?jsxRuntimeExports.jsx("div",{className:"flex justify-center items-center w-full h-52 bg-transparent mt-6 rounded-lg mx-6",children:jsxRuntimeExports.jsx("p",{className:"text-lg font-semibold text-white",children:"No Trending Movies Found."})}):jsxRuntimeExports.jsx("div",{ref:j,className:"flex space-x-5 overflow-x-auto pl-6 pr-3 scrollbar-hide pb-2",children:a.map((tt,et)=>jsxRuntimeExports.jsx(MovieThumbnail,{onClick:()=>_e(tt),source:tt.main_thumbnail,alt:tt.title,isFocused:s&&_===et},`trending-movie-${et}`))})]})},TrendingMovies$1=reactExports.memo(TrendingMovies),Latestrelease=({isActive:s,onNavigate:e})=>{const i=useNavigate(),[a,o]=reactExports.useState([]),[c,d]=reactExports.useState(!1),[g,b]=reactExports.useState(null),{selectedIndex:_,containerRef:j}=useDpadNavigation({totalItems:a.length,columns:a.length,enabled:s&&a.length>0,onEnter:tt=>{a[tt]&&_e(a[tt])},onDirectionChange:(tt,et)=>{et?tt==="ArrowLeft"&&_===0&&e(tt):e(tt)}}),$=reactExports.useCallback(async()=>{try{b(null),d(!0);const et=(await Movieapi.get("new-on-bookmytheatre-movies")).data;if(et.status==="error")throw new Error(et.message);const st=(et==null?void 0:et.new_on_bookmytheatre_details)||[];o(st)}catch(tt){b({status:"error",message:tt.message||"Failed to load latest releases."})}finally{d(!1)}},[]);reactExports.useEffect(()=>{$()},[$]);const _e=reactExports.useCallback(tt=>{i(`/movie/${tt.uuid}`)},[i]);return jsxRuntimeExports.jsxs("div",{className:"relative my-6",children:[jsxRuntimeExports.jsx("div",{className:"px-6 mb-3",children:jsxRuntimeExports.jsx(SectionHeading,{title:"Latest Release"})}),c?jsxRuntimeExports.jsx("div",{className:"flex space-x-5 overflow-x-auto pl-6 pr-3 scrollbar-hide",children:[1,2,3,4,5,6,7].map(tt=>jsxRuntimeExports.jsx("div",{className:"w-[200px] h-[300px] rounded-md overflow-hidden bg-[#1a1a1a] flex-shrink-0",children:jsxRuntimeExports.jsx(Lottie,{animationData:skeletonAnimation,loop:!0,autoplay:!0,className:"w-full h-full"})},tt))}):g?jsxRuntimeExports.jsx("div",{className:"px-6",children:jsxRuntimeExports.jsx(Errorpanelcardview,{errorMessages:g,retry:$})}):a.length===0?jsxRuntimeExports.jsx("div",{className:"flex justify-center items-center w-full h-[200px] mt-6 rounded-lg bg-transparent mx-6",children:jsxRuntimeExports.jsx("p",{className:"text-lg font-bold text-white",children:"No Latest Releases Found."})}):jsxRuntimeExports.jsx("div",{ref:j,className:"flex space-x-5 overflow-x-auto pl-6 pr-3 scrollbar-hide pb-2",children:a.map((tt,et)=>jsxRuntimeExports.jsx(MovieThumbnail,{onClick:()=>_e(tt),source:tt.main_thumbnail,alt:tt.title,isFocused:s&&_===et},`latest-movie-${et}`))})]})},LatestRelease=reactExports.memo(Latestrelease),Comingsoon=({isActive:s,onNavigate:e})=>{const i=useNavigate(),[a,o]=reactExports.useState([]),[c,d]=reactExports.useState(!1),[g,b]=reactExports.useState(null),{selectedIndex:_,containerRef:j}=useDpadNavigation({totalItems:a.length,columns:a.length,enabled:s&&a.length>0,onEnter:tt=>{a[tt]&&_e(a[tt])},onDirectionChange:(tt,et)=>{et?tt==="ArrowLeft"&&_===0&&e(tt):e(tt)}}),$=reactExports.useCallback(async()=>{try{b(null),d(!0);const et=(await Movieapi.get("coming-soon-movies")).data;if(et.status==="error")throw new Error(et.message);const st=(et==null?void 0:et.coming_soon_movies)||[];st.length===0?o([]):o(st)}catch(tt){b({status:"error",message:tt.message||"Failed to load coming soon movies."})}finally{d(!1)}},[]);reactExports.useEffect(()=>{$()},[$]);const _e=reactExports.useCallback(tt=>{console.log("Movie pressed:",tt.title),i(`/movie/${tt.uuid}`)},[i]);return jsxRuntimeExports.jsxs("div",{className:"relative my-8",children:[jsxRuntimeExports.jsx("div",{className:"px-6 mb-4",children:jsxRuntimeExports.jsx(SectionHeading,{title:"Coming Soon"})}),c?jsxRuntimeExports.jsx("div",{className:"flex space-x-5 overflow-x-auto pl-6 pr-3 scrollbar-hide",children:[1,2,3,4,5].map(tt=>jsxRuntimeExports.jsx("div",{className:"w-[200px] h-[300px] bg-[#1a1a1a] rounded-md overflow-hidden flex-shrink-0",children:jsxRuntimeExports.jsx(Lottie,{animationData:skeletonAnimation,loop:!0,autoplay:!0,className:"w-full h-full"})},tt))}):g?jsxRuntimeExports.jsx("div",{className:"px-6",children:jsxRuntimeExports.jsx(Errorpanelcardview,{errorMessages:g,retry:$})}):a.length===0?jsxRuntimeExports.jsx("div",{className:"flex justify-center items-center w-full h-[200px] bg-transparent mt-6 rounded-lg mx-6",children:jsxRuntimeExports.jsx("p",{className:"text-lg font-semibold text-white",children:"No Coming Soon Movies Found."})}):jsxRuntimeExports.jsx("div",{ref:j,className:"flex space-x-5 overflow-x-auto pl-6 pr-3 scrollbar-hide pb-2",children:a.map((tt,et)=>jsxRuntimeExports.jsx(MovieThumbnail,{onClick:()=>_e(tt),source:tt.main_thumbnail,alt:tt.title,isFocused:s&&_===et},`coming-soon-movie-${et}`))})]})},ComingSoon=reactExports.memo(Comingsoon),Moviestatapi=axios.create({baseURL:`${Config.api_url}/moviestat/`,withCredentials:!0,headers:{Accept:"application/json","Content-Type":"application/json"}}),Continuewatching=({isActive:s,onNavigate:e,onHasItems:i})=>{const a=useNavigate(),[o,c]=reactExports.useState(!1),[d,g]=reactExports.useState(null),[b,_]=reactExports.useState([]),[j,$]=reactExports.useState(null),_e=useUserdetails(lt=>lt.userInfo),tt=(_e==null?void 0:_e.id)||null,et=(_e==null?void 0:_e.uuid)||null,{selectedIndex:st,containerRef:at}=useDpadNavigation({totalItems:b.length,columns:b.length,enabled:s&&b.length>0,onEnter:lt=>{b[lt]&&nt(b[lt].movie_uid,b[lt].language_id)},onDirectionChange:(lt,ct)=>{ct?lt==="ArrowLeft"&&st===0&&e(lt):e(lt)}}),rt=reactExports.useCallback(async(lt,ct,ht)=>{try{await Moviestatapi.post("/addwatchhistory",{user_id:tt,movie_uid:ht,video_type:lt,watch_time:ct})}catch(dt){console.log("Watch history error:",dt.message)}},[tt]),nt=reactExports.useCallback(async(lt,ct)=>{try{$(null);const dt=(await Moviestatapi.post("/getmovie",{movie_uid:lt,user_id:tt})).data;if(dt.status==="error")throw new Error(dt.message);rt("Movie",dt.data.watch_time,lt),a("/player",{state:{movie_uid:lt,type:"Movie",user_uid:et,language_Id:ct,videoUrl:dt.data.movie_url,movieWatchTime:dt.data.watch_time,referenceUid:dt.data.reference_uid,user_id:tt}})}catch(ht){$({status:"error",message:ht.message||"Failed to play movie. Please try again."})}},[tt,et,a,rt]),it=reactExports.useCallback((lt,ct)=>{$(null),nt(lt,ct)},[nt]),ot=reactExports.useCallback(async()=>{try{c(!0),g(null);const ct=(await Movieapi.get("/continue-watching",{params:{user_id:tt}})).data;if(ct.status==="error")throw new Error(ct.message);_(ct.continue_movies||[])}catch(lt){g({status:"error",message:lt.message||"Failed to fetch continue watching movies."})}finally{c(!1)}},[tt]);return reactExports.useEffect(()=>{ot()},[ot]),reactExports.useEffect(()=>{i&&i(b.length>0)},[b,i]),!o&&b.length===0&&!d?null:jsxRuntimeExports.jsxs("div",{className:"",children:[jsxRuntimeExports.jsx("div",{className:"px-6 mb-3",children:jsxRuntimeExports.jsx(SectionHeading,{title:"Continue Watching"})}),o?jsxRuntimeExports.jsx("div",{className:"flex space-x-5 overflow-x-auto pl-6 pr-3 scrollbar-hide",children:[1,2,3,4,5,6].map(lt=>jsxRuntimeExports.jsx("div",{className:"w-[200px] h-[300px] rounded-md overflow-hidden bg-[#1a1a1a] shrink-0",children:jsxRuntimeExports.jsx(Lottie,{animationData:skeletonAnimation,loop:!0,autoplay:!0,className:"w-full h-full"})},lt))}):d?jsxRuntimeExports.jsx("div",{className:"px-6",children:jsxRuntimeExports.jsx(Errorpanelcardview,{errorMessages:d,retry:ot})}):b.length===0?jsxRuntimeExports.jsx("div",{className:"flex justify-center items-center w-full h-[200px] mt-6 rounded-lg bg-[#222]",children:jsxRuntimeExports.jsx("p",{className:"text-lg font-semibold text-white",children:"No Continue Watching Movies Found."})}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{ref:at,className:"flex space-x-5 overflow-x-auto pl-6 pr-3 scrollbar-hide pb-2",children:b.map((lt,ct)=>jsxRuntimeExports.jsx(MovieThumbnail,{isFocused:s&&st===ct,source:lt.thumbnail,alt:lt.title,onClick:()=>nt(lt.movie_uid,lt.language_id)},lt.movie_uid))}),j&&jsxRuntimeExports.jsx("div",{className:"mt-4 px-6",children:jsxRuntimeExports.jsx(Errorpanelcardview,{errorMessages:j,retry:it})})]})]})},ContinueWatching=reactExports.memo(Continuewatching),SECTIONS$1={SIDEBAR:"SIDEBAR",BROWSE:"BROWSE",CONTINUE_WATCHING:"CONTINUE_WATCHING",LATEST_RELEASE:"LATEST_RELEASE",TRENDING_MOVIES:"TRENDING_MOVIES",COMING_SOON:"COMING_SOON"},BrowsePage=()=>{const[s,e]=reactExports.useState(0),[i,a]=reactExports.useState(!0),[o,c]=reactExports.useState(null),[d,g]=reactExports.useState(SECTIONS$1.BROWSE),b=reactExports.useRef(null),_={[SECTIONS$1.BROWSE]:reactExports.useRef(null),[SECTIONS$1.CONTINUE_WATCHING]:reactExports.useRef(null),[SECTIONS$1.LATEST_RELEASE]:reactExports.useRef(null),[SECTIONS$1.TRENDING_MOVIES]:reactExports.useRef(null),[SECTIONS$1.COMING_SOON]:reactExports.useRef(null)},j=[SECTIONS$1.BROWSE,SECTIONS$1.CONTINUE_WATCHING,SECTIONS$1.LATEST_RELEASE,SECTIONS$1.TRENDING_MOVIES,...s>0?[SECTIONS$1.COMING_SOON]:[]],$=reactExports.useCallback((tt,et)=>{const st=j.indexOf(et);tt==="ArrowDown"&&st<j.length-1?g(j[st+1]):tt==="ArrowUp"&&st>0?g(j[st-1]):tt==="ArrowLeft"?g(SECTIONS$1.SIDEBAR):tt==="ArrowRight"&&et===SECTIONS$1.SIDEBAR&&g(j[0])},[j]),_e=async()=>{try{a(!0);const et=(await Movieapi.get("getscheduledmoviescount")).data;if(et.status==="error"){c(et.message),a(!1);return}e(et.scheduleMoviesCount||0),c(null),a(!1)}catch(tt){console.error("Error fetching scheduled movies:",tt),c("Something went wrong while fetching movies."),a(!1)}};return reactExports.useEffect(()=>{_e()},[]),reactExports.useEffect(()=>{var tt;if(d&&((tt=_[d])!=null&&tt.current)){const et=setTimeout(()=>{_[d].current.scrollIntoView({behavior:"smooth",block:"center"})},50);return()=>clearTimeout(et)}},[d]),jsxRuntimeExports.jsxs("div",{className:"flex h-screen bg-linear-to-b from-black to-[#5B0203] text-white",children:[jsxRuntimeExports.jsx(Sidebar,{isActive:d===SECTIONS$1.SIDEBAR,onNavigate:tt=>$(tt,SECTIONS$1.SIDEBAR)}),jsxRuntimeExports.jsxs("div",{ref:b,className:"flex-1 overflow-y-auto relative h-screen bg-linear-to-r from-black/95 via-black/55 to-transparent scrollbar-hide",children:[jsxRuntimeExports.jsx("div",{className:"absolute inset-0 pointer-events-none"}),jsxRuntimeExports.jsxs("div",{className:"relative z-10 flex flex-col gap-10 mb-10",children:[jsxRuntimeExports.jsx("div",{ref:_.BROWSE,children:jsxRuntimeExports.jsx(Browse,{isActive:d===SECTIONS$1.BROWSE,onNavigate:tt=>$(tt,SECTIONS$1.BROWSE)})}),jsxRuntimeExports.jsx("div",{ref:_.CONTINUE_WATCHING,children:jsxRuntimeExports.jsx(ContinueWatching,{isActive:d===SECTIONS$1.CONTINUE_WATCHING,onNavigate:tt=>$(tt,SECTIONS$1.CONTINUE_WATCHING)})}),jsxRuntimeExports.jsx("div",{ref:_.LATEST_RELEASE,children:jsxRuntimeExports.jsx(LatestRelease,{isActive:d===SECTIONS$1.LATEST_RELEASE,onNavigate:tt=>$(tt,SECTIONS$1.LATEST_RELEASE)})}),jsxRuntimeExports.jsx("div",{ref:_.TRENDING_MOVIES,children:jsxRuntimeExports.jsx(TrendingMovies$1,{isActive:d===SECTIONS$1.TRENDING_MOVIES,onNavigate:tt=>$(tt,SECTIONS$1.TRENDING_MOVIES)})}),s>0&&jsxRuntimeExports.jsx("div",{ref:_.COMING_SOON,children:jsxRuntimeExports.jsx(ComingSoon,{isActive:d===SECTIONS$1.COMING_SOON,onNavigate:tt=>$(tt,SECTIONS$1.COMING_SOON)})})]}),i&&jsxRuntimeExports.jsx("div",{className:"absolute inset-0 flex justify-center items-center bg-black/50",children:jsxRuntimeExports.jsx("p",{className:"text-gray-300 text-lg animate-pulse",children:"Loading movies..."})}),o&&!i&&jsxRuntimeExports.jsx("div",{className:"absolute inset-0 flex justify-center items-center bg-black/50",children:jsxRuntimeExports.jsx("p",{className:"text-red-500 text-lg",children:o})})]})]})},SearchMoviePage=()=>{const s=useNavigate(),[e,i]=reactExports.useState(""),[a,o]=reactExports.useState([]),[c,d]=reactExports.useState(1),[g,b]=reactExports.useState(!1),[_,j]=reactExports.useState(""),[$,_e]=reactExports.useState(!1),[tt,et]=reactExports.useState(!1),[st,at]=reactExports.useState(!1),rt=50,[nt,it]=reactExports.useState("KEYBOARD"),[ot,lt]=reactExports.useState({keyboard:{row:0,col:0},movies:0}),ct=reactExports.useRef([]),ht=reactExports.useRef([]),dt=reactExports.useRef(null),gt=[["1","2","3","4","5","6","7","8","9","0"],["q","w","e","r","t","y","u","i","o","p"],["a","s","d","f","g","h","j","k","l","@"],["$%^","","z","x","c","v","b","n","m",""],["Space"]],vt=[["!","@","#","$","%","^","&","*","(",")"],["-","_","=","+","[","]","{","}","|","\\"],[";",":","'",'"',",","<",".",">","/","?"],["$%^","","`","~","","","","","",""],["Space"]],St=()=>st?vt:gt,Tt=yt=>{switch(yt){case"":i(ut=>ut.slice(0,-1));break;case"Space":i(ut=>ut+" ");break;case"":et(!tt);break;case"$%^":at(!st);break;default:if(yt.length===1){const ut=tt&&!st?yt.toUpperCase():yt;i(ft=>ft+ut)}break}},Ct=async(yt=!1)=>{try{_e(!0);const ut=yt?c+1:1,ft=e.trim()===""?`getsearchmovies?page=${ut}&limit=${rt}&random=true`:`getsearchmovies?query=${encodeURIComponent(e)}&page=${ut}&limit=${rt}`,mt=(await Movieapi.get(ft)).data;if(mt.status==="success"){if(yt){const Et=mt.results.filter(At=>!a.find(Pt=>Pt.id===At.id));o(At=>[...At,...Et]),d(ut)}else o(mt.results),d(1),lt(Et=>({...Et,movies:0}));b(mt.totalcount>a.length)}else j("No results found"),o([]),b(!1)}catch{j("Error fetching movies")}finally{_e(!1)}};reactExports.useEffect(()=>{Ct(!1)},[e]);const Rt=yt=>{const{scrollTop:ut,clientHeight:ft,scrollHeight:xt}=yt.target;ut+ft>=xt-50&&g&&!$&&Ct(!0)},bt=reactExports.useCallback(yt=>{s(`/movie/${yt.uuid}`)},[s]);reactExports.useEffect(()=>{const yt=ut=>{var xt,mt;ut.preventDefault();const ft=St();switch(nt){case"SIDEBAR":ut.key==="ArrowRight"&&(it("INPUT"),(xt=dt.current)==null||xt.focus());break;case"INPUT":ut.key==="ArrowLeft"?it("SIDEBAR"):(ut.key==="ArrowRight"||ut.key==="Enter")&&it("KEYBOARD");break;case"KEYBOARD":const{row:Et,col:At}=ot.keyboard,Pt=ft[Et];if(ut.key==="ArrowUp")if(Et===0)it("INPUT"),(mt=dt.current)==null||mt.focus();else{const Mt=Et-1,Bt=Math.min(At,ft[Mt].length-1);lt(Gt=>({...Gt,keyboard:{row:Mt,col:Bt}}))}else if(ut.key==="ArrowDown")if(Et<ft.length-1){const Mt=Et+1,Bt=Math.min(At,ft[Mt].length-1);lt(Gt=>({...Gt,keyboard:{row:Mt,col:Bt}}))}else it("MOVIES");else if(ut.key==="ArrowLeft")At>0&&lt(Mt=>({...Mt,keyboard:{row:Et,col:At-1}}));else if(ut.key==="ArrowRight")At<Pt.length-1&&lt(Mt=>({...Mt,keyboard:{row:Et,col:At+1}}));else if(ut.key==="Enter"){const Mt=ft[Et][At];Mt&&Tt(Mt)}break;case"MOVIES":const wt=ot.movies,It=6;if(ut.key==="ArrowUp"){const Mt=wt-It;Mt<0?it("KEYBOARD"):lt(Bt=>({...Bt,movies:Mt}))}else if(ut.key==="ArrowDown"){const Mt=Math.min(a.length-1,wt+It);lt(Bt=>({...Bt,movies:Mt}))}else if(ut.key==="ArrowLeft")wt%It===0?it("SIDEBAR"):lt(Mt=>({...Mt,movies:Math.max(0,Mt.movies-1)}));else if(ut.key==="ArrowRight"){const Mt=Math.min(a.length-1,wt+1);lt(Bt=>({...Bt,movies:Mt}))}else if(ut.key==="Enter"){const Mt=a[wt];Mt&&bt(Mt)}break}};return window.addEventListener("keydown",yt),()=>window.removeEventListener("keydown",yt)},[nt,ot,a,st]),reactExports.useEffect(()=>{var yt,ut;if(nt==="INPUT")(yt=dt.current)==null||yt.focus();else if(nt==="KEYBOARD"){const{row:ft,col:xt}=ot.keyboard,mt=`${ft}-${xt}`,Et=ht.current[mt];Et==null||Et.focus()}else nt==="MOVIES"&&((ut=ct.current[ot.movies])==null||ut.focus())},[nt,ot]),reactExports.useEffect(()=>{var yt;nt==="MOVIES"&&((yt=ct.current[ot.movies])==null||yt.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"}))},[ot.movies,nt]),reactExports.useEffect(()=>{ct.current=[]},[a]);const pt=St();return jsxRuntimeExports.jsxs("div",{className:"flex flex-row gap-5 h-screen text-white bg-linear-to-b from-black to-[#5B0203]",children:[jsxRuntimeExports.jsx(Sidebar,{isActive:nt==="SIDEBAR"}),jsxRuntimeExports.jsxs("div",{className:"w-full",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-row gap-6 my-10 px-5 w-full",children:[jsxRuntimeExports.jsxs("div",{ref:dt,className:`relative w-[35%] h-16 text-xl px-6 py-4 rounded-lg border-2 bg-transparent text-white outline-none transition-all duration-200 flex items-center cursor-text ${nt==="INPUT"?"border-red-600 bg-white bg-opacity-10":"border-gray-600"}`,onFocus:()=>it("INPUT"),onClick:()=>it("INPUT"),tabIndex:"0",role:"textbox","aria-label":"Search movies",children:[e?jsxRuntimeExports.jsx("span",{className:"text-white",children:e}):jsxRuntimeExports.jsx("span",{className:"text-gray-400",children:"Search movies..."}),nt==="INPUT"&&jsxRuntimeExports.jsx("span",{className:"ml-1 animate-pulse text-white",children:"|"})]}),jsxRuntimeExports.jsx("div",{className:"w-[43%] p-5 bg-[#1d2228] rounded-lg",children:pt.map((yt,ut)=>jsxRuntimeExports.jsx("div",{className:"flex flex-row mb-2 justify-start gap-2",children:yt.map((ft,xt)=>{const mt=nt==="KEYBOARD"&&ot.keyboard.row===ut&&ot.keyboard.col===xt;let Et="key h-12 px-3 rounded text-lg font-medium transition-all duration-200 ";return["$%^","","","Space"].includes(ft)?Et+="bg-[#5B0203] text-[#fff] ":Et+="bg-[#2A3139] text-white ",mt&&(Et+="bg-white !text-[#000] transform scale-105 "),ft==="Space"?Et+="w-[100%] ":Et+="min-w-[63px] min-h-[65px] ",jsxRuntimeExports.jsx("button",{ref:At=>ht.current[`${ut}-${xt}`]=At,className:Et,tabIndex:"-1",onClick:()=>{Tt(ft),lt(At=>({...At,keyboard:{row:ut,col:xt}})),it("KEYBOARD")},children:ft===""&&tt?"":ft},xt)})},ut))})]}),jsxRuntimeExports.jsx("div",{className:"h-[calc(100vh-500px)] overflow-y-auto overflow-x-hidden",onScroll:Rt,children:$?jsxRuntimeExports.jsx("div",{className:"flex flex-row overflow-x-auto no-scrollbar",children:[1,2,3,4,5,6].map(yt=>jsxRuntimeExports.jsx("div",{className:"w-[200px] h-[300px] rounded-sm overflow-hidden mr-3 relative",children:jsxRuntimeExports.jsx("div",{className:"absolute inset-0 rounded-xl overflow-hidden",children:jsxRuntimeExports.jsx(Lottie,{animationData:skeletonAnimation,loop:!0,autoplay:!0,style:{width:"100%",height:"100%"}})})},yt))}):_?jsxRuntimeExports.jsx("div",{className:"px-6 w-full",children:jsxRuntimeExports.jsx(Errorpanelcardview,{errorMessages:_,retry:()=>Ct(!1)})}):a.length===0?jsxRuntimeExports.jsx("div",{className:"flex flex-row justify-center items-center h-[150px] bg-[#222] w-full",children:jsxRuntimeExports.jsx("p",{className:"text-white font-semibold text-xl",children:"No movies found"})}):jsxRuntimeExports.jsx("div",{className:"flex flex-row flex-wrap justify-start gap-y-4 gap-x-4 px-2",children:a.map((yt,ut)=>jsxRuntimeExports.jsx("div",{ref:ft=>ct.current[ut]=ft,className:"rounded-lg focus:outline-none",tabIndex:"-1",children:jsxRuntimeExports.jsx(MovieThumbnail,{source:yt.main_thumbnail,alt:yt.title,isFocused:nt==="MOVIES"&&ut===ot.movies,onClick:()=>bt(yt)})},yt.id))})})]})]})},laughterImg=""+new URL("laughter-BrN3syVl.png",import.meta.url).href,GradientCard=reactExports.forwardRef(({item:s,onFocus:e,onPress:i,isFocused:a},o)=>jsxRuntimeExports.jsx("div",{ref:o,onFocus:e,onClick:i,onMouseEnter:e,className:"group cursor-pointer outline-none",children:jsxRuntimeExports.jsx("div",{className:`h-[140px] w-80 mr-6 transition-all duration-200 ease-in-out border-2 
          ${a?"border-red-700":"border-transparent"}`,children:jsxRuntimeExports.jsxs("div",{className:"flex flex-row items-center p-1 gap-3.5 h-full w-full bg-linear-from-to-br from-[rgba(192,38,40,0.7)] to-[#282828]",children:[jsxRuntimeExports.jsx("img",{src:s.image,alt:s.name,className:`w-[55%] h-full object-cover transition-transform duration-200 ease-in-out ${a?"scale-105":"scale-100"}`}),jsxRuntimeExports.jsx("div",{className:"w-[45%] justify-center items-start",children:jsxRuntimeExports.jsx("p",{className:"text-white text-[26px] font-extrabold italic",children:s.name})})]})})})),angerImg=""+new URL("anger-r0cg4VrP.png",import.meta.url).href,courageImg=""+new URL("courage-BRoeQ4Pb.png",import.meta.url).href,disgustImg=""+new URL("disgust-CYiP0npm.png",import.meta.url).href,fearImg=""+new URL("fear-BuUO9euL.png",import.meta.url).href,loveImg=""+new URL("love-Df7lrRC9.png",import.meta.url).href,peaceImg=""+new URL("peace-BcOrx6Dz.png",import.meta.url).href,sarrowImg=""+new URL("sarrow-BYgYQSvh.png",import.meta.url).href,wonderImg=""+new URL("wonder-CedIV52k.png",import.meta.url).href,Skeletongradientcard=({isLastItem:s})=>jsxRuntimeExports.jsx("div",{className:`h-[140px] w-80 mr-6 rounded-xl overflow-hidden ${s?"mr-0":"mr-6"}`,children:jsxRuntimeExports.jsxs("div",{className:"h-full w-full flex flex-row items-center p-1 gap-3.5 rounded-xl overflow-hidden bg-linear-to-br from-[#3a3a3a] to-[#1e1e1e]",children:[jsxRuntimeExports.jsx("div",{className:"w-[55%] h-full rounded-lg overflow-hidden bg-[#222]"}),jsxRuntimeExports.jsx("div",{className:"w-[45%] h-[60%] justify-center rounded-lg overflow-hidden bg-[#333]"})]})}),categoryAssets={Laughter:{color:"rgba(192, 38, 40, 0.7)",image:laughterImg},Anger:{color:"rgba(40, 40, 40, 1)",image:angerImg},Courage:{color:"rgba(192, 38, 40, 0.7)",image:courageImg},Disgust:{color:"rgba(40, 40, 40, 1)",image:disgustImg},Fear:{color:"rgba(192, 38, 40, 0.7)",image:fearImg},Love:{color:"rgba(40, 40, 40, 1)",image:loveImg},Peace:{color:"rgba(192, 38, 40, 0.7)",image:peaceImg},Sorrow:{color:"rgba(40, 40, 40, 1)",image:sarrowImg},Wonder:{color:"rgba(192, 38, 40, 0.7)",image:wonderImg}},CategoriesPage=()=>{const[s,e]=reactExports.useState([]),[i,a]=reactExports.useState(!0),[o,c]=reactExports.useState(null),[d,g]=reactExports.useState(null),[b,_]=reactExports.useState("CATEGORIES"),[j,$]=reactExports.useState({categories:0,movies:0,allCatRow:0,allCatCol:0}),_e=reactExports.useRef([]),tt=reactExports.useRef([]),et=reactExports.useRef([]),st=useNavigate(),at=async()=>{var xt;try{a(!0),c(null);const mt=await Movieapi.get("/getallcategories");if(mt.data&&mt.data.status==="success"){const Et=mt.data.categories.map(At=>({...At,...categoryAssets[At.name]}));e(Et)}else c(((xt=mt.data)==null?void 0:xt.message)||"Failed to fetch categories.")}catch(mt){c(mt.message||"An unexpected error occurred.")}finally{a(!1)}},[rt,nt]=reactExports.useState(""),[it,ot]=reactExports.useState([]),[lt,ct]=reactExports.useState(""),[ht,dt]=reactExports.useState(1),[gt,vt]=reactExports.useState(!1),St=50,[Tt,Ct]=reactExports.useState(!1),[Rt,bt]=reactExports.useState(!1),pt=reactExports.useCallback(async(xt,mt=1,Et=!1)=>{Et?Ct(!0):(bt(!0),ot([]));try{const Pt=(await Movieapi.get("getindividualcategorymoviesfortv",{params:{category:xt,limit:St,page:mt},headers:{Accept:"application/json"}})).data;if(Pt.status==="success")ot(Et?wt=>{const It=new Set(wt.map(Bt=>Bt.id)),Mt=Pt.movies.filter(Bt=>!It.has(Bt.id));return[...wt,...Mt]}:Pt.movies||[]),dt(mt),vt(mt<Pt.totalPages),ct("");else if(Pt.status==="error"){let wt={message:Pt.message,server_res:Pt};ct(wt),Et||ot([])}}catch(At){let Pt;At.response!==void 0?Pt={message:At.message,server_res:At.response.data}:Pt={message:At.message,server_res:null},ct(Pt),Et||ot([])}finally{Et?Ct(!1):bt(!1)}},[St]),yt=xt=>{nt(xt),dt(1)};reactExports.useEffect(()=>{at()},[]),reactExports.useEffect(()=>{rt&&pt(rt,1,!1)},[rt,pt]),reactExports.useEffect(()=>{$(xt=>({...xt,movies:0,allCatRow:0,allCatCol:0})),et.current=[]},[it]),reactExports.useEffect(()=>{const xt=mt=>{var Et,At;switch(b){case"SIDEBAR":mt.key==="ArrowRight"&&(mt.preventDefault(),_("CATEGORIES"));break;case"CATEGORIES":if(mt.preventDefault(),mt.key==="ArrowLeft"){const Ft=j.categories;rt&&Ft===0||!rt&&Ft===0?_("SIDEBAR"):$(Ut=>({...Ut,categories:Math.max(0,Ut.categories-1)}))}else if(mt.key==="ArrowRight")$(Ft=>({...Ft,categories:Math.min(s.length-1,Ft.categories+1)}));else if(mt.key==="ArrowDown")_(rt?"MOVIES":"ALL_CATEGORIES_MOVIES");else if(mt.key==="Enter"){const Ft=s[j.categories];Ft&&yt(Ft.name)}break;case"MOVIES":mt.preventDefault();const Pt=7,wt=j.movies;if(mt.key==="ArrowUp"){const Ft=wt-Pt;Ft<0?_("CATEGORIES"):$(Ut=>({...Ut,movies:Ft}))}else if(mt.key==="ArrowDown"){const Ft=Math.min(it.length-1,wt+Pt);$(Ut=>({...Ut,movies:Ft}))}else if(mt.key==="ArrowLeft")wt%Pt===0?_("SIDEBAR"):$(Ft=>({...Ft,movies:Math.max(0,Ft.movies-1)}));else if(mt.key==="ArrowRight"){const Ft=Math.min(it.length-1,wt+1);$(Ut=>({...Ut,movies:Ft}))}else if(mt.key==="Enter"){const Ft=it[wt];Ft&&ft(Ft)}break;case"ALL_CATEGORIES_MOVIES":mt.preventDefault();const{allCatRow:It,allCatCol:Mt}=j,Bt=s[It],Gt=((Et=Bt==null?void 0:Bt.movies)==null?void 0:Et.length)||0;if(mt.key==="ArrowUp")It===0?_("CATEGORIES"):$(Ft=>({...Ft,allCatRow:Ft.allCatRow-1,allCatCol:0}));else if(mt.key==="ArrowDown")It<s.length-1&&$(Ft=>({...Ft,allCatRow:Ft.allCatRow+1,allCatCol:0}));else if(mt.key==="ArrowLeft")Mt===0?_("SIDEBAR"):$(Ft=>({...Ft,allCatCol:Ft.allCatCol-1}));else if(mt.key==="ArrowRight")Mt<Gt-1&&$(Ft=>({...Ft,allCatCol:Ft.allCatCol+1}));else if(mt.key==="Enter"){const Ft=(At=Bt==null?void 0:Bt.movies)==null?void 0:At[Mt];Ft&&ft(Ft)}break}};return window.addEventListener("keydown",xt),()=>window.removeEventListener("keydown",xt)},[b,j,s,it]),reactExports.useEffect(()=>{var xt,mt;if(b==="CATEGORIES")(xt=_e.current[j.categories])==null||xt.focus();else if(b==="MOVIES")(mt=et.current[j.movies])==null||mt.focus();else if(b==="ALL_CATEGORIES_MOVIES"){const Et=`${j.allCatRow}-${j.allCatCol}`,At=tt.current[Et];At==null||At.focus()}},[b,j]),reactExports.useEffect(()=>{var xt;if(b==="CATEGORIES"&&((xt=_e.current[j.categories])==null||xt.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})),b==="ALL_CATEGORIES_MOVIES"){const mt=`${j.allCatRow}-${j.allCatCol}`,Et=tt.current[mt];Et==null||Et.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})}},[j.categories,j.allCatCol,b]);const ut=xt=>{const{scrollTop:mt,scrollHeight:Et,clientHeight:At}=xt.currentTarget;mt+At>=Et-100&&gt&&!Tt&&!Rt&&rt&&pt(rt,ht+1,!0)},ft=xt=>{st(`/movie/${xt.uuid}`)};return o?jsxRuntimeExports.jsx("div",{className:"flex-1 justify-center items-center bg-linear-to-b from-black to-[#5B0203]",children:jsxRuntimeExports.jsxs("p",{className:"text-red-500 text-2xl",children:["Error: ",o]})}):jsxRuntimeExports.jsxs("div",{className:"flex flex-row h-screen bg-linear-to-b from-black to-[#5B0203]",children:[jsxRuntimeExports.jsx(Sidebar,{isActive:b==="SIDEBAR"}),jsxRuntimeExports.jsx("div",{className:"flex-1 overflow-x-hidden",children:jsxRuntimeExports.jsxs("div",{className:"h-full overflow-y-auto pb-5",onScroll:ut,children:[jsxRuntimeExports.jsx("h1",{className:"text-white text-3xl font-bold mb-4 mt-4 pl-4",children:"Categories"}),jsxRuntimeExports.jsx("div",{className:"flex flex-row overflow-x-auto! mb-3 ml-0 pl-4 no-scrollbar",children:i?jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:[1,2,3,4,5].map((xt,mt)=>jsxRuntimeExports.jsx(Skeletongradientcard,{isLastItem:mt===4},xt))}):s.map((xt,mt)=>jsxRuntimeExports.jsx(GradientCard,{ref:Et=>_e.current[mt]=Et,item:xt,isFocused:b==="CATEGORIES"&&j.categories===mt,onFocus:()=>_("CATEGORIES"),onPress:()=>yt(xt.name)},xt.id))}),i?jsxRuntimeExports.jsxs("div",{className:"mt-4 pl-6 w-full",children:[jsxRuntimeExports.jsx("div",{className:"h-8 w-48 bg-gray-700 rounded mb-4"}),jsxRuntimeExports.jsx("div",{className:"flex flex-row overflow-x-auto no-scrollbar",children:[1,2,3,4,5,6,7].map(xt=>jsxRuntimeExports.jsx("div",{className:"w-[200px] h-[300px] bg-[#1a1a1a] overflow-hidden rounded-md shrink-0",children:jsxRuntimeExports.jsx(Lottie,{animationData:skeletonAnimation,loop:!0})},xt))})]}):rt?jsxRuntimeExports.jsxs("div",{className:"mt-4 px-6 w-full",children:[jsxRuntimeExports.jsx(SectionHeading,{title:rt,styleclass:"ml-2"}),jsxRuntimeExports.jsx("div",{className:"flex flex-row flex-wrap justify-start gap-x-5 gap-y-4 mt-4",children:Rt?jsxRuntimeExports.jsx("div",{className:"flex flex-row overflow-x-auto no-scrollbar",children:[1,2,3,4,5,6].map(xt=>jsxRuntimeExports.jsx("div",{className:"w-[200px] h-[300px] bg-[#1a1a1a] overflow-hidden rounded-md shrink-0",children:jsxRuntimeExports.jsx(Lottie,{animationData:skeletonAnimation,loop:!0})},xt))}):lt?jsxRuntimeExports.jsx("div",{className:"px-6 w-full",children:jsxRuntimeExports.jsx(Errorpanelcardview,{errorMessages:lt,retry:()=>pt(rt,1,!1)})}):it.length===0?jsxRuntimeExports.jsx("div",{className:"flex flex-row justify-center items-center h-[150px] bg-[#222] w-full",children:jsxRuntimeExports.jsx("p",{className:"text-white font-semibold",children:"No movies found."})}):it.map((xt,mt)=>jsxRuntimeExports.jsx("div",{ref:Et=>et.current[mt]=Et,className:"rounded-lg focus:outline-none ml-2 mt-2",children:jsxRuntimeExports.jsx(MovieThumbnail,{source:xt.main_thumbnail,isFocused:b==="MOVIES"&&j.movies===mt,alt:xt.title,onPress:()=>ft(xt)},`${xt.id}-${mt}`)},`${xt.id}-${mt}`))}),Tt&&jsxRuntimeExports.jsxs("div",{className:"flex flex-col justify-center items-center mt-4 py-4",children:[jsxRuntimeExports.jsxs("svg",{className:"animate-spin h-8 w-8 text-red-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[jsxRuntimeExports.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),jsxRuntimeExports.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),jsxRuntimeExports.jsx("p",{className:"text-white mt-2",children:"Loading more movies..."})]})]}):s.map((xt,mt)=>{const Et=xt.movies;return jsxRuntimeExports.jsxs("div",{className:"mb-3 pl-4",children:[jsxRuntimeExports.jsx(SectionHeading,{title:xt.name,styleclass:"ml-2"}),jsxRuntimeExports.jsx("div",{className:"flex flex-row overflow-x-auto no-scrollbar overflow-y-hidden gap-5 mt-4",children:Et&&Et.length>0?Et.map((At,Pt)=>{const wt=b==="ALL_CATEGORIES_MOVIES"&&j.allCatRow===mt&&j.allCatCol===Pt;return jsxRuntimeExports.jsx("div",{ref:It=>tt.current[`${mt}-${Pt}`]=It,className:"focus:outline-none pl-2 pb-2",tabIndex:-1,children:jsxRuntimeExports.jsx(MovieThumbnail,{source:At.main_thumbnail,alt:`${At.title}-${xt.name}`,isFocused:wt,onPress:()=>ft(At)},Pt)})}):jsxRuntimeExports.jsx("div",{className:"flex flex-row justify-center items-center h-[150px] bg-[#222] w-full",children:jsxRuntimeExports.jsx("p",{className:"text-white font-semibold",children:"No movies in this category."})})})]},xt.id)})]})})]})},LayoutGroupContext=reactExports.createContext({});function useConstant(s){const e=reactExports.useRef(null);return e.current===null&&(e.current=s()),e.current}const isBrowser=typeof window<"u",useIsomorphicLayoutEffect=isBrowser?reactExports.useLayoutEffect:reactExports.useEffect,PresenceContext=reactExports.createContext(null);function addUniqueItem(s,e){s.indexOf(e)===-1&&s.push(e)}function removeItem(s,e){const i=s.indexOf(e);i>-1&&s.splice(i,1)}const clamp=(s,e,i)=>i>e?e:i<s?s:i;let invariant=()=>{};const MotionGlobalConfig={},isNumericalString=s=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(s);function isObject(s){return typeof s=="object"&&s!==null}const isZeroValueString=s=>/^0[^.\s]+$/u.test(s);function memo(s){let e;return()=>(e===void 0&&(e=s()),e)}const noop$1=s=>s,combineFunctions=(s,e)=>i=>e(s(i)),pipe=(...s)=>s.reduce(combineFunctions),progress=(s,e,i)=>{const a=e-s;return a===0?1:(i-s)/a};class SubscriptionManager{constructor(){this.subscriptions=[]}add(e){return addUniqueItem(this.subscriptions,e),()=>removeItem(this.subscriptions,e)}notify(e,i,a){const o=this.subscriptions.length;if(o)if(o===1)this.subscriptions[0](e,i,a);else for(let c=0;c<o;c++){const d=this.subscriptions[c];d&&d(e,i,a)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const secondsToMilliseconds=s=>s*1e3,millisecondsToSeconds=s=>s/1e3;function velocityPerSecond(s,e){return e?s*(1e3/e):0}const calcBezier=(s,e,i)=>(((1-3*i+3*e)*s+(3*i-6*e))*s+3*e)*s,subdivisionPrecision=1e-7,subdivisionMaxIterations=12;function binarySubdivide(s,e,i,a,o){let c,d,g=0;do d=e+(i-e)/2,c=calcBezier(d,a,o)-s,c>0?i=d:e=d;while(Math.abs(c)>subdivisionPrecision&&++g<subdivisionMaxIterations);return d}function cubicBezier(s,e,i,a){if(s===e&&i===a)return noop$1;const o=c=>binarySubdivide(c,0,1,s,i);return c=>c===0||c===1?c:calcBezier(o(c),e,a)}const mirrorEasing=s=>e=>e<=.5?s(2*e)/2:(2-s(2*(1-e)))/2,reverseEasing=s=>e=>1-s(1-e),backOut=cubicBezier(.33,1.53,.69,.99),backIn=reverseEasing(backOut),backInOut=mirrorEasing(backIn),anticipate=s=>(s*=2)<1?.5*backIn(s):.5*(2-Math.pow(2,-10*(s-1))),circIn=s=>1-Math.sin(Math.acos(s)),circOut=reverseEasing(circIn),circInOut=mirrorEasing(circIn),easeIn=cubicBezier(.42,0,1,1),easeOut=cubicBezier(0,0,.58,1),easeInOut=cubicBezier(.42,0,.58,1),isEasingArray=s=>Array.isArray(s)&&typeof s[0]!="number",isBezierDefinition=s=>Array.isArray(s)&&typeof s[0]=="number",easingLookup={linear:noop$1,easeIn,easeInOut,easeOut,circIn,circInOut,circOut,backIn,backInOut,backOut,anticipate},isValidEasing=s=>typeof s=="string",easingDefinitionToFunction=s=>{if(isBezierDefinition(s)){invariant(s.length===4);const[e,i,a,o]=s;return cubicBezier(e,i,a,o)}else if(isValidEasing(s))return easingLookup[s];return s},stepsOrder=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function createRenderStep(s,e){let i=new Set,a=new Set,o=!1,c=!1;const d=new WeakSet;let g={delta:0,timestamp:0,isProcessing:!1};function b(j){d.has(j)&&(_.schedule(j),s()),j(g)}const _={schedule:(j,$=!1,_e=!1)=>{const et=_e&&o?i:a;return $&&d.add(j),et.has(j)||et.add(j),j},cancel:j=>{a.delete(j),d.delete(j)},process:j=>{if(g=j,o){c=!0;return}o=!0,[i,a]=[a,i],i.forEach(b),i.clear(),o=!1,c&&(c=!1,_.process(j))}};return _}const maxElapsed=40;function createRenderBatcher(s,e){let i=!1,a=!0;const o={delta:0,timestamp:0,isProcessing:!1},c=()=>i=!0,d=stepsOrder.reduce((it,ot)=>(it[ot]=createRenderStep(c),it),{}),{setup:g,read:b,resolveKeyframes:_,preUpdate:j,update:$,preRender:_e,render:tt,postRender:et}=d,st=()=>{const it=MotionGlobalConfig.useManualTiming?o.timestamp:performance.now();i=!1,MotionGlobalConfig.useManualTiming||(o.delta=a?1e3/60:Math.max(Math.min(it-o.timestamp,maxElapsed),1)),o.timestamp=it,o.isProcessing=!0,g.process(o),b.process(o),_.process(o),j.process(o),$.process(o),_e.process(o),tt.process(o),et.process(o),o.isProcessing=!1,i&&e&&(a=!1,s(st))},at=()=>{i=!0,a=!0,o.isProcessing||s(st)};return{schedule:stepsOrder.reduce((it,ot)=>{const lt=d[ot];return it[ot]=(ct,ht=!1,dt=!1)=>(i||at(),lt.schedule(ct,ht,dt)),it},{}),cancel:it=>{for(let ot=0;ot<stepsOrder.length;ot++)d[stepsOrder[ot]].cancel(it)},state:o,steps:d}}const{schedule:frame,cancel:cancelFrame,state:frameData,steps:frameSteps}=createRenderBatcher(typeof requestAnimationFrame<"u"?requestAnimationFrame:noop$1,!0);let now$1;function clearTime(){now$1=void 0}const time={now:()=>(now$1===void 0&&time.set(frameData.isProcessing||MotionGlobalConfig.useManualTiming?frameData.timestamp:performance.now()),now$1),set:s=>{now$1=s,queueMicrotask(clearTime)}},checkStringStartsWith=s=>e=>typeof e=="string"&&e.startsWith(s),isCSSVariableName=checkStringStartsWith("--"),startsAsVariableToken=checkStringStartsWith("var(--"),isCSSVariableToken=s=>startsAsVariableToken(s)?singleCssVariableRegex.test(s.split("/*")[0].trim()):!1,singleCssVariableRegex=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,number={test:s=>typeof s=="number",parse:parseFloat,transform:s=>s},alpha={...number,transform:s=>clamp(0,1,s)},scale={...number,default:1},sanitize=s=>Math.round(s*1e5)/1e5,floatRegex=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function isNullish(s){return s==null}const singleColorRegex=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,isColorString=(s,e)=>i=>!!(typeof i=="string"&&singleColorRegex.test(i)&&i.startsWith(s)||e&&!isNullish(i)&&Object.prototype.hasOwnProperty.call(i,e)),splitColor=(s,e,i)=>a=>{if(typeof a!="string")return a;const[o,c,d,g]=a.match(floatRegex);return{[s]:parseFloat(o),[e]:parseFloat(c),[i]:parseFloat(d),alpha:g!==void 0?parseFloat(g):1}},clampRgbUnit=s=>clamp(0,255,s),rgbUnit={...number,transform:s=>Math.round(clampRgbUnit(s))},rgba={test:isColorString("rgb","red"),parse:splitColor("red","green","blue"),transform:({red:s,green:e,blue:i,alpha:a=1})=>"rgba("+rgbUnit.transform(s)+", "+rgbUnit.transform(e)+", "+rgbUnit.transform(i)+", "+sanitize(alpha.transform(a))+")"};function parseHex(s){let e="",i="",a="",o="";return s.length>5?(e=s.substring(1,3),i=s.substring(3,5),a=s.substring(5,7),o=s.substring(7,9)):(e=s.substring(1,2),i=s.substring(2,3),a=s.substring(3,4),o=s.substring(4,5),e+=e,i+=i,a+=a,o+=o),{red:parseInt(e,16),green:parseInt(i,16),blue:parseInt(a,16),alpha:o?parseInt(o,16)/255:1}}const hex={test:isColorString("#"),parse:parseHex,transform:rgba.transform},createUnitType=s=>({test:e=>typeof e=="string"&&e.endsWith(s)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${s}`}),degrees=createUnitType("deg"),percent=createUnitType("%"),px=createUnitType("px"),vh=createUnitType("vh"),vw=createUnitType("vw"),progressPercentage={...percent,parse:s=>percent.parse(s)/100,transform:s=>percent.transform(s*100)},hsla={test:isColorString("hsl","hue"),parse:splitColor("hue","saturation","lightness"),transform:({hue:s,saturation:e,lightness:i,alpha:a=1})=>"hsla("+Math.round(s)+", "+percent.transform(sanitize(e))+", "+percent.transform(sanitize(i))+", "+sanitize(alpha.transform(a))+")"},color={test:s=>rgba.test(s)||hex.test(s)||hsla.test(s),parse:s=>rgba.test(s)?rgba.parse(s):hsla.test(s)?hsla.parse(s):hex.parse(s),transform:s=>typeof s=="string"?s:s.hasOwnProperty("red")?rgba.transform(s):hsla.transform(s),getAnimatableNone:s=>{const e=color.parse(s);return e.alpha=0,color.transform(e)}},colorRegex=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function test(s){var e,i;return isNaN(s)&&typeof s=="string"&&(((e=s.match(floatRegex))==null?void 0:e.length)||0)+(((i=s.match(colorRegex))==null?void 0:i.length)||0)>0}const NUMBER_TOKEN="number",COLOR_TOKEN="color",VAR_TOKEN="var",VAR_FUNCTION_TOKEN="var(",SPLIT_TOKEN="${}",complexRegex=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function analyseComplexValue(s){const e=s.toString(),i=[],a={color:[],number:[],var:[]},o=[];let c=0;const g=e.replace(complexRegex,b=>(color.test(b)?(a.color.push(c),o.push(COLOR_TOKEN),i.push(color.parse(b))):b.startsWith(VAR_FUNCTION_TOKEN)?(a.var.push(c),o.push(VAR_TOKEN),i.push(b)):(a.number.push(c),o.push(NUMBER_TOKEN),i.push(parseFloat(b))),++c,SPLIT_TOKEN)).split(SPLIT_TOKEN);return{values:i,split:g,indexes:a,types:o}}function parseComplexValue(s){return analyseComplexValue(s).values}function createTransformer(s){const{split:e,types:i}=analyseComplexValue(s),a=e.length;return o=>{let c="";for(let d=0;d<a;d++)if(c+=e[d],o[d]!==void 0){const g=i[d];g===NUMBER_TOKEN?c+=sanitize(o[d]):g===COLOR_TOKEN?c+=color.transform(o[d]):c+=o[d]}return c}}const convertNumbersToZero=s=>typeof s=="number"?0:color.test(s)?color.getAnimatableNone(s):s;function getAnimatableNone$1(s){const e=parseComplexValue(s);return createTransformer(s)(e.map(convertNumbersToZero))}const complex={test,parse:parseComplexValue,createTransformer,getAnimatableNone:getAnimatableNone$1};function hueToRgb(s,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?s+(e-s)*6*i:i<1/2?e:i<2/3?s+(e-s)*(2/3-i)*6:s}function hslaToRgba({hue:s,saturation:e,lightness:i,alpha:a}){s/=360,e/=100,i/=100;let o=0,c=0,d=0;if(!e)o=c=d=i;else{const g=i<.5?i*(1+e):i+e-i*e,b=2*i-g;o=hueToRgb(b,g,s+1/3),c=hueToRgb(b,g,s),d=hueToRgb(b,g,s-1/3)}return{red:Math.round(o*255),green:Math.round(c*255),blue:Math.round(d*255),alpha:a}}function mixImmediate(s,e){return i=>i>0?e:s}const mixNumber$1=(s,e,i)=>s+(e-s)*i,mixLinearColor=(s,e,i)=>{const a=s*s,o=i*(e*e-a)+a;return o<0?0:Math.sqrt(o)},colorTypes=[hex,rgba,hsla],getColorType=s=>colorTypes.find(e=>e.test(s));function asRGBA(s){const e=getColorType(s);if(!e)return!1;let i=e.parse(s);return e===hsla&&(i=hslaToRgba(i)),i}const mixColor=(s,e)=>{const i=asRGBA(s),a=asRGBA(e);if(!i||!a)return mixImmediate(s,e);const o={...i};return c=>(o.red=mixLinearColor(i.red,a.red,c),o.green=mixLinearColor(i.green,a.green,c),o.blue=mixLinearColor(i.blue,a.blue,c),o.alpha=mixNumber$1(i.alpha,a.alpha,c),rgba.transform(o))},invisibleValues=new Set(["none","hidden"]);function mixVisibility(s,e){return invisibleValues.has(s)?i=>i<=0?s:e:i=>i>=1?e:s}function mixNumber(s,e){return i=>mixNumber$1(s,e,i)}function getMixer(s){return typeof s=="number"?mixNumber:typeof s=="string"?isCSSVariableToken(s)?mixImmediate:color.test(s)?mixColor:mixComplex:Array.isArray(s)?mixArray:typeof s=="object"?color.test(s)?mixColor:mixObject:mixImmediate}function mixArray(s,e){const i=[...s],a=i.length,o=s.map((c,d)=>getMixer(c)(c,e[d]));return c=>{for(let d=0;d<a;d++)i[d]=o[d](c);return i}}function mixObject(s,e){const i={...s,...e},a={};for(const o in i)s[o]!==void 0&&e[o]!==void 0&&(a[o]=getMixer(s[o])(s[o],e[o]));return o=>{for(const c in a)i[c]=a[c](o);return i}}function matchOrder(s,e){const i=[],a={color:0,var:0,number:0};for(let o=0;o<e.values.length;o++){const c=e.types[o],d=s.indexes[c][a[c]],g=s.values[d]??0;i[o]=g,a[c]++}return i}const mixComplex=(s,e)=>{const i=complex.createTransformer(e),a=analyseComplexValue(s),o=analyseComplexValue(e);return a.indexes.var.length===o.indexes.var.length&&a.indexes.color.length===o.indexes.color.length&&a.indexes.number.length>=o.indexes.number.length?invisibleValues.has(s)&&!o.values.length||invisibleValues.has(e)&&!a.values.length?mixVisibility(s,e):pipe(mixArray(matchOrder(a,o),o.values),i):mixImmediate(s,e)};function mix(s,e,i){return typeof s=="number"&&typeof e=="number"&&typeof i=="number"?mixNumber$1(s,e,i):getMixer(s)(s,e)}const frameloopDriver=s=>{const e=({timestamp:i})=>s(i);return{start:(i=!0)=>frame.update(e,i),stop:()=>cancelFrame(e),now:()=>frameData.isProcessing?frameData.timestamp:time.now()}},generateLinearEasing=(s,e,i=10)=>{let a="";const o=Math.max(Math.round(e/i),2);for(let c=0;c<o;c++)a+=Math.round(s(c/(o-1))*1e4)/1e4+", ";return`linear(${a.substring(0,a.length-2)})`},maxGeneratorDuration=2e4;function calcGeneratorDuration(s){let e=0;const i=50;let a=s.next(e);for(;!a.done&&e<maxGeneratorDuration;)e+=i,a=s.next(e);return e>=maxGeneratorDuration?1/0:e}function createGeneratorEasing(s,e=100,i){const a=i({...s,keyframes:[0,e]}),o=Math.min(calcGeneratorDuration(a),maxGeneratorDuration);return{type:"keyframes",ease:c=>a.next(o*c).value/e,duration:millisecondsToSeconds(o)}}const velocitySampleDuration=5;function calcGeneratorVelocity(s,e,i){const a=Math.max(e-velocitySampleDuration,0);return velocityPerSecond(i-s(a),e-a)}const springDefaults={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},safeMin=.001;function findSpring({duration:s=springDefaults.duration,bounce:e=springDefaults.bounce,velocity:i=springDefaults.velocity,mass:a=springDefaults.mass}){let o,c,d=1-e;d=clamp(springDefaults.minDamping,springDefaults.maxDamping,d),s=clamp(springDefaults.minDuration,springDefaults.maxDuration,millisecondsToSeconds(s)),d<1?(o=_=>{const j=_*d,$=j*s,_e=j-i,tt=calcAngularFreq(_,d),et=Math.exp(-$);return safeMin-_e/tt*et},c=_=>{const $=_*d*s,_e=$*i+i,tt=Math.pow(d,2)*Math.pow(_,2)*s,et=Math.exp(-$),st=calcAngularFreq(Math.pow(_,2),d);return(-o(_)+safeMin>0?-1:1)*((_e-tt)*et)/st}):(o=_=>{const j=Math.exp(-_*s),$=(_-i)*s+1;return-safeMin+j*$},c=_=>{const j=Math.exp(-_*s),$=(i-_)*(s*s);return j*$});const g=5/s,b=approximateRoot(o,c,g);if(s=secondsToMilliseconds(s),isNaN(b))return{stiffness:springDefaults.stiffness,damping:springDefaults.damping,duration:s};{const _=Math.pow(b,2)*a;return{stiffness:_,damping:d*2*Math.sqrt(a*_),duration:s}}}const rootIterations=12;function approximateRoot(s,e,i){let a=i;for(let o=1;o<rootIterations;o++)a=a-s(a)/e(a);return a}function calcAngularFreq(s,e){return s*Math.sqrt(1-e*e)}const durationKeys=["duration","bounce"],physicsKeys=["stiffness","damping","mass"];function isSpringType(s,e){return e.some(i=>s[i]!==void 0)}function getSpringOptions(s){let e={velocity:springDefaults.velocity,stiffness:springDefaults.stiffness,damping:springDefaults.damping,mass:springDefaults.mass,isResolvedFromDuration:!1,...s};if(!isSpringType(s,physicsKeys)&&isSpringType(s,durationKeys))if(s.visualDuration){const i=s.visualDuration,a=2*Math.PI/(i*1.2),o=a*a,c=2*clamp(.05,1,1-(s.bounce||0))*Math.sqrt(o);e={...e,mass:springDefaults.mass,stiffness:o,damping:c}}else{const i=findSpring(s);e={...e,...i,mass:springDefaults.mass},e.isResolvedFromDuration=!0}return e}function spring(s=springDefaults.visualDuration,e=springDefaults.bounce){const i=typeof s!="object"?{visualDuration:s,keyframes:[0,1],bounce:e}:s;let{restSpeed:a,restDelta:o}=i;const c=i.keyframes[0],d=i.keyframes[i.keyframes.length-1],g={done:!1,value:c},{stiffness:b,damping:_,mass:j,duration:$,velocity:_e,isResolvedFromDuration:tt}=getSpringOptions({...i,velocity:-millisecondsToSeconds(i.velocity||0)}),et=_e||0,st=_/(2*Math.sqrt(b*j)),at=d-c,rt=millisecondsToSeconds(Math.sqrt(b/j)),nt=Math.abs(at)<5;a||(a=nt?springDefaults.restSpeed.granular:springDefaults.restSpeed.default),o||(o=nt?springDefaults.restDelta.granular:springDefaults.restDelta.default);let it;if(st<1){const lt=calcAngularFreq(rt,st);it=ct=>{const ht=Math.exp(-st*rt*ct);return d-ht*((et+st*rt*at)/lt*Math.sin(lt*ct)+at*Math.cos(lt*ct))}}else if(st===1)it=lt=>d-Math.exp(-rt*lt)*(at+(et+rt*at)*lt);else{const lt=rt*Math.sqrt(st*st-1);it=ct=>{const ht=Math.exp(-st*rt*ct),dt=Math.min(lt*ct,300);return d-ht*((et+st*rt*at)*Math.sinh(dt)+lt*at*Math.cosh(dt))/lt}}const ot={calculatedDuration:tt&&$||null,next:lt=>{const ct=it(lt);if(tt)g.done=lt>=$;else{let ht=lt===0?et:0;st<1&&(ht=lt===0?secondsToMilliseconds(et):calcGeneratorVelocity(it,lt,ct));const dt=Math.abs(ht)<=a,gt=Math.abs(d-ct)<=o;g.done=dt&&gt}return g.value=g.done?d:ct,g},toString:()=>{const lt=Math.min(calcGeneratorDuration(ot),maxGeneratorDuration),ct=generateLinearEasing(ht=>ot.next(lt*ht).value,lt,30);return lt+"ms "+ct},toTransition:()=>{}};return ot}spring.applyToOptions=s=>{const e=createGeneratorEasing(s,100,spring);return s.ease=e.ease,s.duration=secondsToMilliseconds(e.duration),s.type="keyframes",s};function inertia({keyframes:s,velocity:e=0,power:i=.8,timeConstant:a=325,bounceDamping:o=10,bounceStiffness:c=500,modifyTarget:d,min:g,max:b,restDelta:_=.5,restSpeed:j}){const $=s[0],_e={done:!1,value:$},tt=dt=>g!==void 0&&dt<g||b!==void 0&&dt>b,et=dt=>g===void 0?b:b===void 0||Math.abs(g-dt)<Math.abs(b-dt)?g:b;let st=i*e;const at=$+st,rt=d===void 0?at:d(at);rt!==at&&(st=rt-$);const nt=dt=>-st*Math.exp(-dt/a),it=dt=>rt+nt(dt),ot=dt=>{const gt=nt(dt),vt=it(dt);_e.done=Math.abs(gt)<=_,_e.value=_e.done?rt:vt};let lt,ct;const ht=dt=>{tt(_e.value)&&(lt=dt,ct=spring({keyframes:[_e.value,et(_e.value)],velocity:calcGeneratorVelocity(it,dt,_e.value),damping:o,stiffness:c,restDelta:_,restSpeed:j}))};return ht(0),{calculatedDuration:null,next:dt=>{let gt=!1;return!ct&&lt===void 0&&(gt=!0,ot(dt),ht(dt)),lt!==void 0&&dt>=lt?ct.next(dt-lt):(!gt&&ot(dt),_e)}}}function createMixers(s,e,i){const a=[],o=i||MotionGlobalConfig.mix||mix,c=s.length-1;for(let d=0;d<c;d++){let g=o(s[d],s[d+1]);if(e){const b=Array.isArray(e)?e[d]||noop$1:e;g=pipe(b,g)}a.push(g)}return a}function interpolate(s,e,{clamp:i=!0,ease:a,mixer:o}={}){const c=s.length;if(invariant(c===e.length),c===1)return()=>e[0];if(c===2&&e[0]===e[1])return()=>e[1];const d=s[0]===s[1];s[0]>s[c-1]&&(s=[...s].reverse(),e=[...e].reverse());const g=createMixers(e,a,o),b=g.length,_=j=>{if(d&&j<s[0])return e[0];let $=0;if(b>1)for(;$<s.length-2&&!(j<s[$+1]);$++);const _e=progress(s[$],s[$+1],j);return g[$](_e)};return i?j=>_(clamp(s[0],s[c-1],j)):_}function fillOffset(s,e){const i=s[s.length-1];for(let a=1;a<=e;a++){const o=progress(0,e,a);s.push(mixNumber$1(i,1,o))}}function defaultOffset(s){const e=[0];return fillOffset(e,s.length-1),e}function convertOffsetToTimes(s,e){return s.map(i=>i*e)}function defaultEasing(s,e){return s.map(()=>e||easeInOut).splice(0,s.length-1)}function keyframes({duration:s=300,keyframes:e,times:i,ease:a="easeInOut"}){const o=isEasingArray(a)?a.map(easingDefinitionToFunction):easingDefinitionToFunction(a),c={done:!1,value:e[0]},d=convertOffsetToTimes(i&&i.length===e.length?i:defaultOffset(e),s),g=interpolate(d,e,{ease:Array.isArray(o)?o:defaultEasing(e,o)});return{calculatedDuration:s,next:b=>(c.value=g(b),c.done=b>=s,c)}}const isNotNull$1=s=>s!==null;function getFinalKeyframe$1(s,{repeat:e,repeatType:i="loop"},a,o=1){const c=s.filter(isNotNull$1),g=o<0||e&&i!=="loop"&&e%2===1?0:c.length-1;return!g||a===void 0?c[g]:a}const transitionTypeMap={decay:inertia,inertia,tween:keyframes,keyframes,spring};function replaceTransitionType(s){typeof s.type=="string"&&(s.type=transitionTypeMap[s.type])}class WithPromise{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,i){return this.finished.then(e,i)}}const percentToProgress=s=>s/100;class JSAnimation extends WithPromise{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var a,o;const{motionValue:i}=this.options;i&&i.updatedAt!==time.now()&&this.tick(time.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(o=(a=this.options).onStop)==null||o.call(a))},this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;replaceTransitionType(e);const{type:i=keyframes,repeat:a=0,repeatDelay:o=0,repeatType:c,velocity:d=0}=e;let{keyframes:g}=e;const b=i||keyframes;b!==keyframes&&typeof g[0]!="number"&&(this.mixKeyframes=pipe(percentToProgress,mix(g[0],g[1])),g=[0,100]);const _=b({...e,keyframes:g});c==="mirror"&&(this.mirroredGenerator=b({...e,keyframes:[...g].reverse(),velocity:-d})),_.calculatedDuration===null&&(_.calculatedDuration=calcGeneratorDuration(_));const{calculatedDuration:j}=_;this.calculatedDuration=j,this.resolvedDuration=j+o,this.totalDuration=this.resolvedDuration*(a+1)-o,this.generator=_}updateTime(e){const i=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=i}tick(e,i=!1){const{generator:a,totalDuration:o,mixKeyframes:c,mirroredGenerator:d,resolvedDuration:g,calculatedDuration:b}=this;if(this.startTime===null)return a.next(0);const{delay:_=0,keyframes:j,repeat:$,repeatType:_e,repeatDelay:tt,type:et,onUpdate:st,finalKeyframe:at}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-o/this.speed,this.startTime)),i?this.currentTime=e:this.updateTime(e);const rt=this.currentTime-_*(this.playbackSpeed>=0?1:-1),nt=this.playbackSpeed>=0?rt<0:rt>o;this.currentTime=Math.max(rt,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=o);let it=this.currentTime,ot=a;if($){const dt=Math.min(this.currentTime,o)/g;let gt=Math.floor(dt),vt=dt%1;!vt&&dt>=1&&(vt=1),vt===1&&gt--,gt=Math.min(gt,$+1),!!(gt%2)&&(_e==="reverse"?(vt=1-vt,tt&&(vt-=tt/g)):_e==="mirror"&&(ot=d)),it=clamp(0,1,vt)*g}const lt=nt?{done:!1,value:j[0]}:ot.next(it);c&&(lt.value=c(lt.value));let{done:ct}=lt;!nt&&b!==null&&(ct=this.playbackSpeed>=0?this.currentTime>=o:this.currentTime<=0);const ht=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&ct);return ht&&et!==inertia&&(lt.value=getFinalKeyframe$1(j,this.options,at,this.speed)),st&&st(lt.value),ht&&this.finish(),lt}then(e,i){return this.finished.then(e,i)}get duration(){return millisecondsToSeconds(this.calculatedDuration)}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+millisecondsToSeconds(e)}get time(){return millisecondsToSeconds(this.currentTime)}set time(e){var i;e=secondsToMilliseconds(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),(i=this.driver)==null||i.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(time.now());const i=this.playbackSpeed!==e;this.playbackSpeed=e,i&&(this.time=millisecondsToSeconds(this.currentTime))}play(){var o,c;if(this.isStopped)return;const{driver:e=frameloopDriver,startTime:i}=this.options;this.driver||(this.driver=e(d=>this.tick(d))),(c=(o=this.options).onPlay)==null||c.call(o);const a=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=a):this.holdTime!==null?this.startTime=a-this.holdTime:this.startTime||(this.startTime=i??a),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(time.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var e,i;this.notifyFinished(),this.teardown(),this.state="finished",(i=(e=this.options).onComplete)==null||i.call(e)}cancel(){var e,i;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(i=(e=this.options).onCancel)==null||i.call(e)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){var i;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(i=this.driver)==null||i.stop(),e.observe(this)}}function fillWildcards(s){for(let e=1;e<s.length;e++)s[e]??(s[e]=s[e-1])}const radToDeg=s=>s*180/Math.PI,rotate=s=>{const e=radToDeg(Math.atan2(s[1],s[0]));return rebaseAngle(e)},matrix2dParsers={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:s=>(Math.abs(s[0])+Math.abs(s[3]))/2,rotate,rotateZ:rotate,skewX:s=>radToDeg(Math.atan(s[1])),skewY:s=>radToDeg(Math.atan(s[2])),skew:s=>(Math.abs(s[1])+Math.abs(s[2]))/2},rebaseAngle=s=>(s=s%360,s<0&&(s+=360),s),rotateZ=rotate,scaleX=s=>Math.sqrt(s[0]*s[0]+s[1]*s[1]),scaleY=s=>Math.sqrt(s[4]*s[4]+s[5]*s[5]),matrix3dParsers={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX,scaleY,scale:s=>(scaleX(s)+scaleY(s))/2,rotateX:s=>rebaseAngle(radToDeg(Math.atan2(s[6],s[5]))),rotateY:s=>rebaseAngle(radToDeg(Math.atan2(-s[2],s[0]))),rotateZ,rotate:rotateZ,skewX:s=>radToDeg(Math.atan(s[4])),skewY:s=>radToDeg(Math.atan(s[1])),skew:s=>(Math.abs(s[1])+Math.abs(s[4]))/2};function defaultTransformValue(s){return s.includes("scale")?1:0}function parseValueFromTransform(s,e){if(!s||s==="none")return defaultTransformValue(e);const i=s.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let a,o;if(i)a=matrix3dParsers,o=i;else{const g=s.match(/^matrix\(([-\d.e\s,]+)\)$/u);a=matrix2dParsers,o=g}if(!o)return defaultTransformValue(e);const c=a[e],d=o[1].split(",").map(convertTransformToNumber);return typeof c=="function"?c(d):d[c]}const readTransformValue=(s,e)=>{const{transform:i="none"}=getComputedStyle(s);return parseValueFromTransform(i,e)};function convertTransformToNumber(s){return parseFloat(s.trim())}const transformPropOrder=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],transformProps=new Set(transformPropOrder),isNumOrPxType=s=>s===number||s===px,transformKeys=new Set(["x","y","z"]),nonTranslationalTransformKeys=transformPropOrder.filter(s=>!transformKeys.has(s));function removeNonTranslationalTransform(s){const e=[];return nonTranslationalTransformKeys.forEach(i=>{const a=s.getValue(i);a!==void 0&&(e.push([i,a.get()]),a.set(i.startsWith("scale")?1:0))}),e}const positionalValues={width:({x:s},{paddingLeft:e="0",paddingRight:i="0"})=>s.max-s.min-parseFloat(e)-parseFloat(i),height:({y:s},{paddingTop:e="0",paddingBottom:i="0"})=>s.max-s.min-parseFloat(e)-parseFloat(i),top:(s,{top:e})=>parseFloat(e),left:(s,{left:e})=>parseFloat(e),bottom:({y:s},{top:e})=>parseFloat(e)+(s.max-s.min),right:({x:s},{left:e})=>parseFloat(e)+(s.max-s.min),x:(s,{transform:e})=>parseValueFromTransform(e,"x"),y:(s,{transform:e})=>parseValueFromTransform(e,"y")};positionalValues.translateX=positionalValues.x;positionalValues.translateY=positionalValues.y;const toResolve=new Set;let isScheduled=!1,anyNeedsMeasurement=!1,isForced=!1;function measureAllKeyframes(){if(anyNeedsMeasurement){const s=Array.from(toResolve).filter(a=>a.needsMeasurement),e=new Set(s.map(a=>a.element)),i=new Map;e.forEach(a=>{const o=removeNonTranslationalTransform(a);o.length&&(i.set(a,o),a.render())}),s.forEach(a=>a.measureInitialState()),e.forEach(a=>{a.render();const o=i.get(a);o&&o.forEach(([c,d])=>{var g;(g=a.getValue(c))==null||g.set(d)})}),s.forEach(a=>a.measureEndState()),s.forEach(a=>{a.suspendedScrollY!==void 0&&window.scrollTo(0,a.suspendedScrollY)})}anyNeedsMeasurement=!1,isScheduled=!1,toResolve.forEach(s=>s.complete(isForced)),toResolve.clear()}function readAllKeyframes(){toResolve.forEach(s=>{s.readKeyframes(),s.needsMeasurement&&(anyNeedsMeasurement=!0)})}function flushKeyframeResolvers(){isForced=!0,readAllKeyframes(),measureAllKeyframes(),isForced=!1}class KeyframeResolver{constructor(e,i,a,o,c,d=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=i,this.name=a,this.motionValue=o,this.element=c,this.isAsync=d}scheduleResolve(){this.state="scheduled",this.isAsync?(toResolve.add(this),isScheduled||(isScheduled=!0,frame.read(readAllKeyframes),frame.resolveKeyframes(measureAllKeyframes))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:i,element:a,motionValue:o}=this;if(e[0]===null){const c=o==null?void 0:o.get(),d=e[e.length-1];if(c!==void 0)e[0]=c;else if(a&&i){const g=a.readValue(i,d);g!=null&&(e[0]=g)}e[0]===void 0&&(e[0]=d),o&&c===void 0&&o.set(e[0])}fillWildcards(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),toResolve.delete(this)}cancel(){this.state==="scheduled"&&(toResolve.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const isCSSVar=s=>s.startsWith("--");function setStyle(s,e,i){isCSSVar(e)?s.style.setProperty(e,i):s.style[e]=i}const supportsScrollTimeline=memo(()=>window.ScrollTimeline!==void 0),supportsFlags={};function memoSupports(s,e){const i=memo(s);return()=>supportsFlags[e]??i()}const supportsLinearEasing=memoSupports(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),cubicBezierAsString=([s,e,i,a])=>`cubic-bezier(${s}, ${e}, ${i}, ${a})`,supportedWaapiEasing={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:cubicBezierAsString([0,.65,.55,1]),circOut:cubicBezierAsString([.55,0,1,.45]),backIn:cubicBezierAsString([.31,.01,.66,-.59]),backOut:cubicBezierAsString([.33,1.53,.69,.99])};function mapEasingToNativeEasing(s,e){if(s)return typeof s=="function"?supportsLinearEasing()?generateLinearEasing(s,e):"ease-out":isBezierDefinition(s)?cubicBezierAsString(s):Array.isArray(s)?s.map(i=>mapEasingToNativeEasing(i,e)||supportedWaapiEasing.easeOut):supportedWaapiEasing[s]}function startWaapiAnimation(s,e,i,{delay:a=0,duration:o=300,repeat:c=0,repeatType:d="loop",ease:g="easeOut",times:b}={},_=void 0){const j={[e]:i};b&&(j.offset=b);const $=mapEasingToNativeEasing(g,o);Array.isArray($)&&(j.easing=$);const _e={delay:a,duration:o,easing:Array.isArray($)?"linear":$,fill:"both",iterations:c+1,direction:d==="reverse"?"alternate":"normal"};return _&&(_e.pseudoElement=_),s.animate(j,_e)}function isGenerator(s){return typeof s=="function"&&"applyToOptions"in s}function applyGeneratorOptions({type:s,...e}){return isGenerator(s)&&supportsLinearEasing()?s.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class NativeAnimation extends WithPromise{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:i,name:a,keyframes:o,pseudoElement:c,allowFlatten:d=!1,finalKeyframe:g,onComplete:b}=e;this.isPseudoElement=!!c,this.allowFlatten=d,this.options=e,invariant(typeof e.type!="string");const _=applyGeneratorOptions(e);this.animation=startWaapiAnimation(i,a,o,_,c),_.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!c){const j=getFinalKeyframe$1(o,this.options,g,this.speed);this.updateMotionValue?this.updateMotionValue(j):setStyle(i,a,j),this.animation.cancel()}b==null||b(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var e,i;(i=(e=this.animation).finish)==null||i.call(e)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var e,i;this.isPseudoElement||(i=(e=this.animation).commitStyles)==null||i.call(e)}get duration(){var i,a;const e=((a=(i=this.animation.effect)==null?void 0:i.getComputedTiming)==null?void 0:a.call(i).duration)||0;return millisecondsToSeconds(Number(e))}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+millisecondsToSeconds(e)}get time(){return millisecondsToSeconds(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=secondsToMilliseconds(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:i}){var a;return this.allowFlatten&&((a=this.animation.effect)==null||a.updateTiming({easing:"linear"})),this.animation.onfinish=null,e&&supportsScrollTimeline()?(this.animation.timeline=e,noop$1):i(this)}}const unsupportedEasingFunctions={anticipate,backInOut,circInOut};function isUnsupportedEase(s){return s in unsupportedEasingFunctions}function replaceStringEasing(s){typeof s.ease=="string"&&isUnsupportedEase(s.ease)&&(s.ease=unsupportedEasingFunctions[s.ease])}const sampleDelta=10;class NativeAnimationExtended extends NativeAnimation{constructor(e){replaceStringEasing(e),replaceTransitionType(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:i,onUpdate:a,onComplete:o,element:c,...d}=this.options;if(!i)return;if(e!==void 0){i.set(e);return}const g=new JSAnimation({...d,autoplay:!1}),b=secondsToMilliseconds(this.finishedTime??this.time);i.setWithVelocity(g.sample(b-sampleDelta).value,g.sample(b).value,sampleDelta),g.stop()}}const isAnimatable=(s,e)=>e==="zIndex"?!1:!!(typeof s=="number"||Array.isArray(s)||typeof s=="string"&&(complex.test(s)||s==="0")&&!s.startsWith("url("));function hasKeyframesChanged(s){const e=s[0];if(s.length===1)return!0;for(let i=0;i<s.length;i++)if(s[i]!==e)return!0}function canAnimate(s,e,i,a){const o=s[0];if(o===null)return!1;if(e==="display"||e==="visibility")return!0;const c=s[s.length-1],d=isAnimatable(o,e),g=isAnimatable(c,e);return!d||!g?!1:hasKeyframesChanged(s)||(i==="spring"||isGenerator(i))&&a}function makeAnimationInstant(s){s.duration=0,s.type="keyframes"}const acceleratedValues=new Set(["opacity","clipPath","filter","transform"]),supportsWaapi=memo(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function supportsBrowserAnimation(s){var j;const{motionValue:e,name:i,repeatDelay:a,repeatType:o,damping:c,type:d}=s;if(!(((j=e==null?void 0:e.owner)==null?void 0:j.current)instanceof HTMLElement))return!1;const{onUpdate:b,transformTemplate:_}=e.owner.getProps();return supportsWaapi()&&i&&acceleratedValues.has(i)&&(i!=="transform"||!_)&&!b&&!a&&o!=="mirror"&&c!==0&&d!=="inertia"}const MAX_RESOLVE_DELAY=40;class AsyncMotionValueAnimation extends WithPromise{constructor({autoplay:e=!0,delay:i=0,type:a="keyframes",repeat:o=0,repeatDelay:c=0,repeatType:d="loop",keyframes:g,name:b,motionValue:_,element:j,...$}){var et;super(),this.stop=()=>{var st,at;this._animation&&(this._animation.stop(),(st=this.stopTimeline)==null||st.call(this)),(at=this.keyframeResolver)==null||at.cancel()},this.createdAt=time.now();const _e={autoplay:e,delay:i,type:a,repeat:o,repeatDelay:c,repeatType:d,name:b,motionValue:_,element:j,...$},tt=(j==null?void 0:j.KeyframeResolver)||KeyframeResolver;this.keyframeResolver=new tt(g,(st,at,rt)=>this.onKeyframesResolved(st,at,_e,!rt),b,_,j),(et=this.keyframeResolver)==null||et.scheduleResolve()}onKeyframesResolved(e,i,a,o){this.keyframeResolver=void 0;const{name:c,type:d,velocity:g,delay:b,isHandoff:_,onUpdate:j}=a;this.resolvedAt=time.now(),canAnimate(e,c,d,g)||((MotionGlobalConfig.instantAnimations||!b)&&(j==null||j(getFinalKeyframe$1(e,a,i))),e[0]=e[e.length-1],makeAnimationInstant(a),a.repeat=0);const _e={startTime:o?this.resolvedAt?this.resolvedAt-this.createdAt>MAX_RESOLVE_DELAY?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:i,...a,keyframes:e},tt=!_&&supportsBrowserAnimation(_e)?new NativeAnimationExtended({..._e,element:_e.motionValue.owner.current}):new JSAnimation(_e);tt.finished.then(()=>this.notifyFinished()).catch(noop$1),this.pendingTimeline&&(this.stopTimeline=tt.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=tt}get finished(){return this._animation?this.animation.finished:this._finished}then(e,i){return this.finished.finally(e).then(()=>{})}get animation(){var e;return this._animation||((e=this.keyframeResolver)==null||e.resume(),flushKeyframeResolvers()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var e;this._animation&&this.animation.cancel(),(e=this.keyframeResolver)==null||e.cancel()}}const splitCSSVariableRegex=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function parseCSSVariable(s){const e=splitCSSVariableRegex.exec(s);if(!e)return[,];const[,i,a,o]=e;return[`--${i??a}`,o]}function getVariableValue(s,e,i=1){const[a,o]=parseCSSVariable(s);if(!a)return;const c=window.getComputedStyle(e).getPropertyValue(a);if(c){const d=c.trim();return isNumericalString(d)?parseFloat(d):d}return isCSSVariableToken(o)?getVariableValue(o,e,i+1):o}function getValueTransition(s,e){return(s==null?void 0:s[e])??(s==null?void 0:s.default)??s}const positionalKeys=new Set(["width","height","top","left","right","bottom",...transformPropOrder]),auto={test:s=>s==="auto",parse:s=>s},testValueType=s=>e=>e.test(s),dimensionValueTypes=[number,px,percent,degrees,vw,vh,auto],findDimensionValueType=s=>dimensionValueTypes.find(testValueType(s));function isNone(s){return typeof s=="number"?s===0:s!==null?s==="none"||s==="0"||isZeroValueString(s):!0}const maxDefaults=new Set(["brightness","contrast","saturate","opacity"]);function applyDefaultFilter(s){const[e,i]=s.slice(0,-1).split("(");if(e==="drop-shadow")return s;const[a]=i.match(floatRegex)||[];if(!a)return s;const o=i.replace(a,"");let c=maxDefaults.has(e)?1:0;return a!==i&&(c*=100),e+"("+c+o+")"}const functionRegex=/\b([a-z-]*)\(.*?\)/gu,filter={...complex,getAnimatableNone:s=>{const e=s.match(functionRegex);return e?e.map(applyDefaultFilter).join(" "):s}},int={...number,transform:Math.round},transformValueTypes={rotate:degrees,rotateX:degrees,rotateY:degrees,rotateZ:degrees,scale,scaleX:scale,scaleY:scale,scaleZ:scale,skew:degrees,skewX:degrees,skewY:degrees,distance:px,translateX:px,translateY:px,translateZ:px,x:px,y:px,z:px,perspective:px,transformPerspective:px,opacity:alpha,originX:progressPercentage,originY:progressPercentage,originZ:px},numberValueTypes={borderWidth:px,borderTopWidth:px,borderRightWidth:px,borderBottomWidth:px,borderLeftWidth:px,borderRadius:px,radius:px,borderTopLeftRadius:px,borderTopRightRadius:px,borderBottomRightRadius:px,borderBottomLeftRadius:px,width:px,maxWidth:px,height:px,maxHeight:px,top:px,right:px,bottom:px,left:px,padding:px,paddingTop:px,paddingRight:px,paddingBottom:px,paddingLeft:px,margin:px,marginTop:px,marginRight:px,marginBottom:px,marginLeft:px,backgroundPositionX:px,backgroundPositionY:px,...transformValueTypes,zIndex:int,fillOpacity:alpha,strokeOpacity:alpha,numOctaves:int},defaultValueTypes={...numberValueTypes,color,backgroundColor:color,outlineColor:color,fill:color,stroke:color,borderColor:color,borderTopColor:color,borderRightColor:color,borderBottomColor:color,borderLeftColor:color,filter,WebkitFilter:filter},getDefaultValueType=s=>defaultValueTypes[s];function getAnimatableNone(s,e){let i=getDefaultValueType(s);return i!==filter&&(i=complex),i.getAnimatableNone?i.getAnimatableNone(e):void 0}const invalidTemplates=new Set(["auto","none","0"]);function makeNoneKeyframesAnimatable(s,e,i){let a=0,o;for(;a<s.length&&!o;){const c=s[a];typeof c=="string"&&!invalidTemplates.has(c)&&analyseComplexValue(c).values.length&&(o=s[a]),a++}if(o&&i)for(const c of e)s[c]=getAnimatableNone(i,o)}class DOMKeyframesResolver extends KeyframeResolver{constructor(e,i,a,o,c){super(e,i,a,o,c,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:i,name:a}=this;if(!i||!i.current)return;super.readKeyframes();for(let b=0;b<e.length;b++){let _=e[b];if(typeof _=="string"&&(_=_.trim(),isCSSVariableToken(_))){const j=getVariableValue(_,i.current);j!==void 0&&(e[b]=j),b===e.length-1&&(this.finalKeyframe=_)}}if(this.resolveNoneKeyframes(),!positionalKeys.has(a)||e.length!==2)return;const[o,c]=e,d=findDimensionValueType(o),g=findDimensionValueType(c);if(d!==g)if(isNumOrPxType(d)&&isNumOrPxType(g))for(let b=0;b<e.length;b++){const _=e[b];typeof _=="string"&&(e[b]=parseFloat(_))}else positionalValues[a]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:i}=this,a=[];for(let o=0;o<e.length;o++)(e[o]===null||isNone(e[o]))&&a.push(o);a.length&&makeNoneKeyframesAnimatable(e,a,i)}measureInitialState(){const{element:e,unresolvedKeyframes:i,name:a}=this;if(!e||!e.current)return;a==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=positionalValues[a](e.measureViewportBox(),window.getComputedStyle(e.current)),i[0]=this.measuredOrigin;const o=i[i.length-1];o!==void 0&&e.getValue(a,o).jump(o,!1)}measureEndState(){var g;const{element:e,name:i,unresolvedKeyframes:a}=this;if(!e||!e.current)return;const o=e.getValue(i);o&&o.jump(this.measuredOrigin,!1);const c=a.length-1,d=a[c];a[c]=positionalValues[i](e.measureViewportBox(),window.getComputedStyle(e.current)),d!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=d),(g=this.removedTransforms)!=null&&g.length&&this.removedTransforms.forEach(([b,_])=>{e.getValue(b).set(_)}),this.resolveNoneKeyframes()}}function resolveElements(s,e,i){if(s instanceof EventTarget)return[s];if(typeof s=="string"){let a=document;const o=(i==null?void 0:i[s])??a.querySelectorAll(s);return o?Array.from(o):[]}return Array.from(s)}const getValueAsType=(s,e)=>e&&typeof s=="number"?e.transform(s):s;function isHTMLElement(s){return isObject(s)&&"offsetHeight"in s}const MAX_VELOCITY_DELTA=30,isFloat=s=>!isNaN(parseFloat(s));class MotionValue{constructor(e,i={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=a=>{var c;const o=time.now();if(this.updatedAt!==o&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(a),this.current!==this.prev&&((c=this.events.change)==null||c.notify(this.current),this.dependents))for(const d of this.dependents)d.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=i.owner}setCurrent(e){this.current=e,this.updatedAt=time.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=isFloat(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,i){this.events[e]||(this.events[e]=new SubscriptionManager);const a=this.events[e].add(i);return e==="change"?()=>{a(),frame.read(()=>{this.events.change.getSize()||this.stop()})}:a}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,i){this.passiveEffect=e,this.stopPassiveEffect=i}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,i,a){this.set(i),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-a}jump(e,i=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,i&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var e;(e=this.events.change)==null||e.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=time.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>MAX_VELOCITY_DELTA)return 0;const i=Math.min(this.updatedAt-this.prevUpdatedAt,MAX_VELOCITY_DELTA);return velocityPerSecond(parseFloat(this.current)-parseFloat(this.prevFrameValue),i)}start(e){return this.stop(),new Promise(i=>{this.hasAnimated=!0,this.animation=e(i),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var e,i;(e=this.dependents)==null||e.clear(),(i=this.events.destroy)==null||i.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function motionValue(s,e){return new MotionValue(s,e)}const{schedule:microtask}=createRenderBatcher(queueMicrotask,!1),isDragging={x:!1,y:!1};function isDragActive(){return isDragging.x||isDragging.y}function setDragLock(s){return s==="x"||s==="y"?isDragging[s]?null:(isDragging[s]=!0,()=>{isDragging[s]=!1}):isDragging.x||isDragging.y?null:(isDragging.x=isDragging.y=!0,()=>{isDragging.x=isDragging.y=!1})}function setupGesture(s,e){const i=resolveElements(s),a=new AbortController,o={passive:!0,...e,signal:a.signal};return[i,o,()=>a.abort()]}function isValidHover(s){return!(s.pointerType==="touch"||isDragActive())}function hover(s,e,i={}){const[a,o,c]=setupGesture(s,i),d=g=>{if(!isValidHover(g))return;const{target:b}=g,_=e(b,g);if(typeof _!="function"||!b)return;const j=$=>{isValidHover($)&&(_($),b.removeEventListener("pointerleave",j))};b.addEventListener("pointerleave",j,o)};return a.forEach(g=>{g.addEventListener("pointerenter",d,o)}),c}const isNodeOrChild=(s,e)=>e?s===e?!0:isNodeOrChild(s,e.parentElement):!1,isPrimaryPointer=s=>s.pointerType==="mouse"?typeof s.button!="number"||s.button<=0:s.isPrimary!==!1,focusableElements=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function isElementKeyboardAccessible(s){return focusableElements.has(s.tagName)||s.tabIndex!==-1}const isPressing=new WeakSet;function filterEvents(s){return e=>{e.key==="Enter"&&s(e)}}function firePointerEvent(s,e){s.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const enableKeyboardPress=(s,e)=>{const i=s.currentTarget;if(!i)return;const a=filterEvents(()=>{if(isPressing.has(i))return;firePointerEvent(i,"down");const o=filterEvents(()=>{firePointerEvent(i,"up")}),c=()=>firePointerEvent(i,"cancel");i.addEventListener("keyup",o,e),i.addEventListener("blur",c,e)});i.addEventListener("keydown",a,e),i.addEventListener("blur",()=>i.removeEventListener("keydown",a),e)};function isValidPressEvent(s){return isPrimaryPointer(s)&&!isDragActive()}function press(s,e,i={}){const[a,o,c]=setupGesture(s,i),d=g=>{const b=g.currentTarget;if(!isValidPressEvent(g))return;isPressing.add(b);const _=e(b,g),j=(tt,et)=>{window.removeEventListener("pointerup",$),window.removeEventListener("pointercancel",_e),isPressing.has(b)&&isPressing.delete(b),isValidPressEvent(tt)&&typeof _=="function"&&_(tt,{success:et})},$=tt=>{j(tt,b===window||b===document||i.useGlobalTarget||isNodeOrChild(b,tt.target))},_e=tt=>{j(tt,!1)};window.addEventListener("pointerup",$,o),window.addEventListener("pointercancel",_e,o)};return a.forEach(g=>{(i.useGlobalTarget?window:g).addEventListener("pointerdown",d,o),isHTMLElement(g)&&(g.addEventListener("focus",_=>enableKeyboardPress(_,o)),!isElementKeyboardAccessible(g)&&!g.hasAttribute("tabindex")&&(g.tabIndex=0))}),c}function isSVGElement(s){return isObject(s)&&"ownerSVGElement"in s}function isSVGSVGElement(s){return isSVGElement(s)&&s.tagName==="svg"}const isMotionValue=s=>!!(s&&s.getVelocity),valueTypes=[...dimensionValueTypes,color,complex],findValueType=s=>valueTypes.find(testValueType(s)),MotionConfigContext=reactExports.createContext({transformPagePoint:s=>s,isStatic:!1,reducedMotion:"never"});function usePresence(s=!0){const e=reactExports.useContext(PresenceContext);if(e===null)return[!0,null];const{isPresent:i,onExitComplete:a,register:o}=e,c=reactExports.useId();reactExports.useEffect(()=>{if(s)return o(c)},[s]);const d=reactExports.useCallback(()=>s&&a&&a(c),[c,a,s]);return!i&&a?[!1,d]:[!0]}const LazyContext=reactExports.createContext({strict:!1}),featureProps={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},featureDefinitions={};for(const s in featureProps)featureDefinitions[s]={isEnabled:e=>featureProps[s].some(i=>!!e[i])};function loadFeatures(s){for(const e in s)featureDefinitions[e]={...featureDefinitions[e],...s[e]}}const validMotionProps=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function isValidMotionProp(s){return s.startsWith("while")||s.startsWith("drag")&&s!=="draggable"||s.startsWith("layout")||s.startsWith("onTap")||s.startsWith("onPan")||s.startsWith("onLayout")||validMotionProps.has(s)}let shouldForward=s=>!isValidMotionProp(s);function loadExternalIsValidProp(s){typeof s=="function"&&(shouldForward=e=>e.startsWith("on")?!isValidMotionProp(e):s(e))}try{loadExternalIsValidProp(require("@emotion/is-prop-valid").default)}catch{}function filterProps(s,e,i){const a={};for(const o in s)o==="values"&&typeof s.values=="object"||(shouldForward(o)||i===!0&&isValidMotionProp(o)||!e&&!isValidMotionProp(o)||s.draggable&&o.startsWith("onDrag"))&&(a[o]=s[o]);return a}const MotionContext=reactExports.createContext({});function isAnimationControls(s){return s!==null&&typeof s=="object"&&typeof s.start=="function"}function isVariantLabel(s){return typeof s=="string"||Array.isArray(s)}const variantPriorityOrder=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],variantProps=["initial",...variantPriorityOrder];function isControllingVariants(s){return isAnimationControls(s.animate)||variantProps.some(e=>isVariantLabel(s[e]))}function isVariantNode(s){return!!(isControllingVariants(s)||s.variants)}function getCurrentTreeVariants(s,e){if(isControllingVariants(s)){const{initial:i,animate:a}=s;return{initial:i===!1||isVariantLabel(i)?i:void 0,animate:isVariantLabel(a)?a:void 0}}return s.inherit!==!1?e:{}}function useCreateMotionContext(s){const{initial:e,animate:i}=getCurrentTreeVariants(s,reactExports.useContext(MotionContext));return reactExports.useMemo(()=>({initial:e,animate:i}),[variantLabelsAsDependency(e),variantLabelsAsDependency(i)])}function variantLabelsAsDependency(s){return Array.isArray(s)?s.join(" "):s}const scaleCorrectors={};function addScaleCorrector(s){for(const e in s)scaleCorrectors[e]=s[e],isCSSVariableName(e)&&(scaleCorrectors[e].isCSSVariable=!0)}function isForcedMotionValue(s,{layout:e,layoutId:i}){return transformProps.has(s)||s.startsWith("origin")||(e||i!==void 0)&&(!!scaleCorrectors[s]||s==="opacity")}const translateAlias={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},numTransforms=transformPropOrder.length;function buildTransform(s,e,i){let a="",o=!0;for(let c=0;c<numTransforms;c++){const d=transformPropOrder[c],g=s[d];if(g===void 0)continue;let b=!0;if(typeof g=="number"?b=g===(d.startsWith("scale")?1:0):b=parseFloat(g)===0,!b||i){const _=getValueAsType(g,numberValueTypes[d]);if(!b){o=!1;const j=translateAlias[d]||d;a+=`${j}(${_}) `}i&&(e[d]=_)}}return a=a.trim(),i?a=i(e,o?"":a):o&&(a="none"),a}function buildHTMLStyles(s,e,i){const{style:a,vars:o,transformOrigin:c}=s;let d=!1,g=!1;for(const b in e){const _=e[b];if(transformProps.has(b)){d=!0;continue}else if(isCSSVariableName(b)){o[b]=_;continue}else{const j=getValueAsType(_,numberValueTypes[b]);b.startsWith("origin")?(g=!0,c[b]=j):a[b]=j}}if(e.transform||(d||i?a.transform=buildTransform(e,s.transform,i):a.transform&&(a.transform="none")),g){const{originX:b="50%",originY:_="50%",originZ:j=0}=c;a.transformOrigin=`${b} ${_} ${j}`}}const createHtmlRenderState=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function copyRawValuesOnly(s,e,i){for(const a in e)!isMotionValue(e[a])&&!isForcedMotionValue(a,i)&&(s[a]=e[a])}function useInitialMotionValues({transformTemplate:s},e){return reactExports.useMemo(()=>{const i=createHtmlRenderState();return buildHTMLStyles(i,e,s),Object.assign({},i.vars,i.style)},[e])}function useStyle(s,e){const i=s.style||{},a={};return copyRawValuesOnly(a,i,s),Object.assign(a,useInitialMotionValues(s,e)),a}function useHTMLProps(s,e){const i={},a=useStyle(s,e);return s.drag&&s.dragListener!==!1&&(i.draggable=!1,a.userSelect=a.WebkitUserSelect=a.WebkitTouchCallout="none",a.touchAction=s.drag===!0?"none":`pan-${s.drag==="x"?"y":"x"}`),s.tabIndex===void 0&&(s.onTap||s.onTapStart||s.whileTap)&&(i.tabIndex=0),i.style=a,i}const dashKeys={offset:"stroke-dashoffset",array:"stroke-dasharray"},camelKeys={offset:"strokeDashoffset",array:"strokeDasharray"};function buildSVGPath(s,e,i=1,a=0,o=!0){s.pathLength=1;const c=o?dashKeys:camelKeys;s[c.offset]=px.transform(-a);const d=px.transform(e),g=px.transform(i);s[c.array]=`${d} ${g}`}function buildSVGAttrs(s,{attrX:e,attrY:i,attrScale:a,pathLength:o,pathSpacing:c=1,pathOffset:d=0,...g},b,_,j){if(buildHTMLStyles(s,g,_),b){s.style.viewBox&&(s.attrs.viewBox=s.style.viewBox);return}s.attrs=s.style,s.style={};const{attrs:$,style:_e}=s;$.transform&&(_e.transform=$.transform,delete $.transform),(_e.transform||$.transformOrigin)&&(_e.transformOrigin=$.transformOrigin??"50% 50%",delete $.transformOrigin),_e.transform&&(_e.transformBox=(j==null?void 0:j.transformBox)??"fill-box",delete $.transformBox),e!==void 0&&($.x=e),i!==void 0&&($.y=i),a!==void 0&&($.scale=a),o!==void 0&&buildSVGPath($,o,c,d,!1)}const createSvgRenderState=()=>({...createHtmlRenderState(),attrs:{}}),isSVGTag=s=>typeof s=="string"&&s.toLowerCase()==="svg";function useSVGProps(s,e,i,a){const o=reactExports.useMemo(()=>{const c=createSvgRenderState();return buildSVGAttrs(c,e,isSVGTag(a),s.transformTemplate,s.style),{...c.attrs,style:{...c.style}}},[e]);if(s.style){const c={};copyRawValuesOnly(c,s.style,s),o.style={...c,...o.style}}return o}const lowercaseSVGElements=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function isSVGComponent(s){return typeof s!="string"||s.includes("-")?!1:!!(lowercaseSVGElements.indexOf(s)>-1||/[A-Z]/u.test(s))}function useRender(s,e,i,{latestValues:a},o,c=!1){const g=(isSVGComponent(s)?useSVGProps:useHTMLProps)(e,a,o,s),b=filterProps(e,typeof s=="string",c),_=s!==reactExports.Fragment?{...b,...g,ref:i}:{},{children:j}=e,$=reactExports.useMemo(()=>isMotionValue(j)?j.get():j,[j]);return reactExports.createElement(s,{..._,children:$})}function getValueState(s){const e=[{},{}];return s==null||s.values.forEach((i,a)=>{e[0][a]=i.get(),e[1][a]=i.getVelocity()}),e}function resolveVariantFromProps(s,e,i,a){if(typeof e=="function"){const[o,c]=getValueState(a);e=e(i!==void 0?i:s.custom,o,c)}if(typeof e=="string"&&(e=s.variants&&s.variants[e]),typeof e=="function"){const[o,c]=getValueState(a);e=e(i!==void 0?i:s.custom,o,c)}return e}function resolveMotionValue(s){return isMotionValue(s)?s.get():s}function makeState({scrapeMotionValuesFromProps:s,createRenderState:e},i,a,o){return{latestValues:makeLatestValues(i,a,o,s),renderState:e()}}function makeLatestValues(s,e,i,a){const o={},c=a(s,{});for(const _e in c)o[_e]=resolveMotionValue(c[_e]);let{initial:d,animate:g}=s;const b=isControllingVariants(s),_=isVariantNode(s);e&&_&&!b&&s.inherit!==!1&&(d===void 0&&(d=e.initial),g===void 0&&(g=e.animate));let j=i?i.initial===!1:!1;j=j||d===!1;const $=j?g:d;if($&&typeof $!="boolean"&&!isAnimationControls($)){const _e=Array.isArray($)?$:[$];for(let tt=0;tt<_e.length;tt++){const et=resolveVariantFromProps(s,_e[tt]);if(et){const{transitionEnd:st,transition:at,...rt}=et;for(const nt in rt){let it=rt[nt];if(Array.isArray(it)){const ot=j?it.length-1:0;it=it[ot]}it!==null&&(o[nt]=it)}for(const nt in st)o[nt]=st[nt]}}}return o}const makeUseVisualState=s=>(e,i)=>{const a=reactExports.useContext(MotionContext),o=reactExports.useContext(PresenceContext),c=()=>makeState(s,e,a,o);return i?c():useConstant(c)};function scrapeMotionValuesFromProps$1(s,e,i){var c;const{style:a}=s,o={};for(const d in a)(isMotionValue(a[d])||e.style&&isMotionValue(e.style[d])||isForcedMotionValue(d,s)||((c=i==null?void 0:i.getValue(d))==null?void 0:c.liveStyle)!==void 0)&&(o[d]=a[d]);return o}const useHTMLVisualState=makeUseVisualState({scrapeMotionValuesFromProps:scrapeMotionValuesFromProps$1,createRenderState:createHtmlRenderState});function scrapeMotionValuesFromProps(s,e,i){const a=scrapeMotionValuesFromProps$1(s,e,i);for(const o in s)if(isMotionValue(s[o])||isMotionValue(e[o])){const c=transformPropOrder.indexOf(o)!==-1?"attr"+o.charAt(0).toUpperCase()+o.substring(1):o;a[c]=s[o]}return a}const useSVGVisualState=makeUseVisualState({scrapeMotionValuesFromProps,createRenderState:createSvgRenderState}),motionComponentSymbol=Symbol.for("motionComponentSymbol");function isRefObject(s){return s&&typeof s=="object"&&Object.prototype.hasOwnProperty.call(s,"current")}function useMotionRef(s,e,i){return reactExports.useCallback(a=>{a&&s.onMount&&s.onMount(a),e&&(a?e.mount(a):e.unmount()),i&&(typeof i=="function"?i(a):isRefObject(i)&&(i.current=a))},[e])}const camelToDash=s=>s.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),optimizedAppearDataId="framerAppearId",optimizedAppearDataAttribute="data-"+camelToDash(optimizedAppearDataId),SwitchLayoutGroupContext=reactExports.createContext({});function useVisualElement(s,e,i,a,o){var st,at;const{visualElement:c}=reactExports.useContext(MotionContext),d=reactExports.useContext(LazyContext),g=reactExports.useContext(PresenceContext),b=reactExports.useContext(MotionConfigContext).reducedMotion,_=reactExports.useRef(null);a=a||d.renderer,!_.current&&a&&(_.current=a(s,{visualState:e,parent:c,props:i,presenceContext:g,blockInitialAnimation:g?g.initial===!1:!1,reducedMotionConfig:b}));const j=_.current,$=reactExports.useContext(SwitchLayoutGroupContext);j&&!j.projection&&o&&(j.type==="html"||j.type==="svg")&&createProjectionNode$1(_.current,i,o,$);const _e=reactExports.useRef(!1);reactExports.useInsertionEffect(()=>{j&&_e.current&&j.update(i,g)});const tt=i[optimizedAppearDataAttribute],et=reactExports.useRef(!!tt&&!((st=window.MotionHandoffIsComplete)!=null&&st.call(window,tt))&&((at=window.MotionHasOptimisedAnimation)==null?void 0:at.call(window,tt)));return useIsomorphicLayoutEffect(()=>{j&&(_e.current=!0,window.MotionIsMounted=!0,j.updateFeatures(),j.scheduleRenderMicrotask(),et.current&&j.animationState&&j.animationState.animateChanges())}),reactExports.useEffect(()=>{j&&(!et.current&&j.animationState&&j.animationState.animateChanges(),et.current&&(queueMicrotask(()=>{var rt;(rt=window.MotionHandoffMarkAsComplete)==null||rt.call(window,tt)}),et.current=!1),j.enteringChildren=void 0)}),j}function createProjectionNode$1(s,e,i,a){const{layoutId:o,layout:c,drag:d,dragConstraints:g,layoutScroll:b,layoutRoot:_,layoutCrossfade:j}=e;s.projection=new i(s.latestValues,e["data-framer-portal-id"]?void 0:getClosestProjectingNode(s.parent)),s.projection.setOptions({layoutId:o,layout:c,alwaysMeasureLayout:!!d||g&&isRefObject(g),visualElement:s,animationType:typeof c=="string"?c:"both",initialPromotionConfig:a,crossfade:j,layoutScroll:b,layoutRoot:_})}function getClosestProjectingNode(s){if(s)return s.options.allowProjection!==!1?s.projection:getClosestProjectingNode(s.parent)}function createMotionComponent(s,{forwardMotionProps:e=!1}={},i,a){i&&loadFeatures(i);const o=isSVGComponent(s)?useSVGVisualState:useHTMLVisualState;function c(g,b){let _;const j={...reactExports.useContext(MotionConfigContext),...g,layoutId:useLayoutId(g)},{isStatic:$}=j,_e=useCreateMotionContext(g),tt=o(g,$);if(!$&&isBrowser){useStrictMode();const et=getProjectionFunctionality(j);_=et.MeasureLayout,_e.visualElement=useVisualElement(s,tt,j,a,et.ProjectionNode)}return jsxRuntimeExports.jsxs(MotionContext.Provider,{value:_e,children:[_&&_e.visualElement?jsxRuntimeExports.jsx(_,{visualElement:_e.visualElement,...j}):null,useRender(s,g,useMotionRef(tt,_e.visualElement,b),tt,$,e)]})}c.displayName=`motion.${typeof s=="string"?s:`create(${s.displayName??s.name??""})`}`;const d=reactExports.forwardRef(c);return d[motionComponentSymbol]=s,d}function useLayoutId({layoutId:s}){const e=reactExports.useContext(LayoutGroupContext).id;return e&&s!==void 0?e+"-"+s:s}function useStrictMode(s,e){reactExports.useContext(LazyContext).strict}function getProjectionFunctionality(s){const{drag:e,layout:i}=featureDefinitions;if(!e&&!i)return{};const a={...e,...i};return{MeasureLayout:e!=null&&e.isEnabled(s)||i!=null&&i.isEnabled(s)?a.MeasureLayout:void 0,ProjectionNode:a.ProjectionNode}}function createMotionProxy(s,e){if(typeof Proxy>"u")return createMotionComponent;const i=new Map,a=(c,d)=>createMotionComponent(c,d,s,e),o=(c,d)=>a(c,d);return new Proxy(o,{get:(c,d)=>d==="create"?a:(i.has(d)||i.set(d,createMotionComponent(d,void 0,s,e)),i.get(d))})}function convertBoundingBoxToBox({top:s,left:e,right:i,bottom:a}){return{x:{min:e,max:i},y:{min:s,max:a}}}function convertBoxToBoundingBox({x:s,y:e}){return{top:e.min,right:s.max,bottom:e.max,left:s.min}}function transformBoxPoints(s,e){if(!e)return s;const i=e({x:s.left,y:s.top}),a=e({x:s.right,y:s.bottom});return{top:i.y,left:i.x,bottom:a.y,right:a.x}}function isIdentityScale(s){return s===void 0||s===1}function hasScale({scale:s,scaleX:e,scaleY:i}){return!isIdentityScale(s)||!isIdentityScale(e)||!isIdentityScale(i)}function hasTransform(s){return hasScale(s)||has2DTranslate(s)||s.z||s.rotate||s.rotateX||s.rotateY||s.skewX||s.skewY}function has2DTranslate(s){return is2DTranslate(s.x)||is2DTranslate(s.y)}function is2DTranslate(s){return s&&s!=="0%"}function scalePoint(s,e,i){const a=s-i,o=e*a;return i+o}function applyPointDelta(s,e,i,a,o){return o!==void 0&&(s=scalePoint(s,o,a)),scalePoint(s,i,a)+e}function applyAxisDelta(s,e=0,i=1,a,o){s.min=applyPointDelta(s.min,e,i,a,o),s.max=applyPointDelta(s.max,e,i,a,o)}function applyBoxDelta(s,{x:e,y:i}){applyAxisDelta(s.x,e.translate,e.scale,e.originPoint),applyAxisDelta(s.y,i.translate,i.scale,i.originPoint)}const TREE_SCALE_SNAP_MIN=.999999999999,TREE_SCALE_SNAP_MAX=1.0000000000001;function applyTreeDeltas(s,e,i,a=!1){const o=i.length;if(!o)return;e.x=e.y=1;let c,d;for(let g=0;g<o;g++){c=i[g],d=c.projectionDelta;const{visualElement:b}=c.options;b&&b.props.style&&b.props.style.display==="contents"||(a&&c.options.layoutScroll&&c.scroll&&c!==c.root&&transformBox(s,{x:-c.scroll.offset.x,y:-c.scroll.offset.y}),d&&(e.x*=d.x.scale,e.y*=d.y.scale,applyBoxDelta(s,d)),a&&hasTransform(c.latestValues)&&transformBox(s,c.latestValues))}e.x<TREE_SCALE_SNAP_MAX&&e.x>TREE_SCALE_SNAP_MIN&&(e.x=1),e.y<TREE_SCALE_SNAP_MAX&&e.y>TREE_SCALE_SNAP_MIN&&(e.y=1)}function translateAxis(s,e){s.min=s.min+e,s.max=s.max+e}function transformAxis(s,e,i,a,o=.5){const c=mixNumber$1(s.min,s.max,o);applyAxisDelta(s,e,i,c,a)}function transformBox(s,e){transformAxis(s.x,e.x,e.scaleX,e.scale,e.originX),transformAxis(s.y,e.y,e.scaleY,e.scale,e.originY)}function measureViewportBox(s,e){return convertBoundingBoxToBox(transformBoxPoints(s.getBoundingClientRect(),e))}function measurePageBox(s,e,i){const a=measureViewportBox(s,i),{scroll:o}=e;return o&&(translateAxis(a.x,o.offset.x),translateAxis(a.y,o.offset.y)),a}const createAxisDelta=()=>({translate:0,scale:1,origin:0,originPoint:0}),createDelta=()=>({x:createAxisDelta(),y:createAxisDelta()}),createAxis=()=>({min:0,max:0}),createBox=()=>({x:createAxis(),y:createAxis()}),prefersReducedMotion={current:null},hasReducedMotionListener={current:!1};function initPrefersReducedMotion(){if(hasReducedMotionListener.current=!0,!!isBrowser)if(window.matchMedia){const s=window.matchMedia("(prefers-reduced-motion)"),e=()=>prefersReducedMotion.current=s.matches;s.addEventListener("change",e),e()}else prefersReducedMotion.current=!1}const visualElementStore=new WeakMap;function updateMotionValuesFromProps(s,e,i){for(const a in e){const o=e[a],c=i[a];if(isMotionValue(o))s.addValue(a,o);else if(isMotionValue(c))s.addValue(a,motionValue(o,{owner:s}));else if(c!==o)if(s.hasValue(a)){const d=s.getValue(a);d.liveStyle===!0?d.jump(o):d.hasAnimated||d.set(o)}else{const d=s.getStaticValue(a);s.addValue(a,motionValue(d!==void 0?d:o,{owner:s}))}}for(const a in i)e[a]===void 0&&s.removeValue(a);return e}const propEventHandlers=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class VisualElement{scrapeMotionValuesFromProps(e,i,a){return{}}constructor({parent:e,props:i,presenceContext:a,reducedMotionConfig:o,blockInitialAnimation:c,visualState:d},g={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=KeyframeResolver,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const _e=time.now();this.renderScheduledAt<_e&&(this.renderScheduledAt=_e,frame.render(this.render,!1,!0))};const{latestValues:b,renderState:_}=d;this.latestValues=b,this.baseTarget={...b},this.initialValues=i.initial?{...b}:{},this.renderState=_,this.parent=e,this.props=i,this.presenceContext=a,this.depth=e?e.depth+1:0,this.reducedMotionConfig=o,this.options=g,this.blockInitialAnimation=!!c,this.isControllingVariants=isControllingVariants(i),this.isVariantNode=isVariantNode(i),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:j,...$}=this.scrapeMotionValuesFromProps(i,{},this);for(const _e in $){const tt=$[_e];b[_e]!==void 0&&isMotionValue(tt)&&tt.set(b[_e])}}mount(e){var i;this.current=e,visualElementStore.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((a,o)=>this.bindToMotionValue(o,a)),hasReducedMotionListener.current||initPrefersReducedMotion(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:prefersReducedMotion.current,(i=this.parent)==null||i.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var e;this.projection&&this.projection.unmount(),cancelFrame(this.notifyUpdate),cancelFrame(this.render),this.valueSubscriptions.forEach(i=>i()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),(e=this.parent)==null||e.removeChild(this);for(const i in this.events)this.events[i].clear();for(const i in this.features){const a=this.features[i];a&&(a.unmount(),a.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,i){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const a=transformProps.has(e);a&&this.onBindTransform&&this.onBindTransform();const o=i.on("change",d=>{this.latestValues[e]=d,this.props.onUpdate&&frame.preRender(this.notifyUpdate),a&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let c;window.MotionCheckAppearSync&&(c=window.MotionCheckAppearSync(this,e,i)),this.valueSubscriptions.set(e,()=>{o(),c&&c(),i.owner&&i.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in featureDefinitions){const i=featureDefinitions[e];if(!i)continue;const{isEnabled:a,Feature:o}=i;if(!this.features[e]&&o&&a(this.props)&&(this.features[e]=new o(this)),this.features[e]){const c=this.features[e];c.isMounted?c.update():(c.mount(),c.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):createBox()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,i){this.latestValues[e]=i}update(e,i){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=i;for(let a=0;a<propEventHandlers.length;a++){const o=propEventHandlers[a];this.propEventSubscriptions[o]&&(this.propEventSubscriptions[o](),delete this.propEventSubscriptions[o]);const c="on"+o,d=e[c];d&&(this.propEventSubscriptions[o]=this.on(o,d))}this.prevMotionValues=updateMotionValuesFromProps(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const i=this.getClosestVariantNode();if(i)return i.variantChildren&&i.variantChildren.add(e),()=>i.variantChildren.delete(e)}addValue(e,i){const a=this.values.get(e);i!==a&&(a&&this.removeValue(e),this.bindToMotionValue(e,i),this.values.set(e,i),this.latestValues[e]=i.get())}removeValue(e){this.values.delete(e);const i=this.valueSubscriptions.get(e);i&&(i(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,i){if(this.props.values&&this.props.values[e])return this.props.values[e];let a=this.values.get(e);return a===void 0&&i!==void 0&&(a=motionValue(i===null?void 0:i,{owner:this}),this.addValue(e,a)),a}readValue(e,i){let a=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return a!=null&&(typeof a=="string"&&(isNumericalString(a)||isZeroValueString(a))?a=parseFloat(a):!findValueType(a)&&complex.test(i)&&(a=getAnimatableNone(e,i)),this.setBaseTarget(e,isMotionValue(a)?a.get():a)),isMotionValue(a)?a.get():a}setBaseTarget(e,i){this.baseTarget[e]=i}getBaseTarget(e){var c;const{initial:i}=this.props;let a;if(typeof i=="string"||typeof i=="object"){const d=resolveVariantFromProps(this.props,i,(c=this.presenceContext)==null?void 0:c.custom);d&&(a=d[e])}if(i&&a!==void 0)return a;const o=this.getBaseTargetFromProps(this.props,e);return o!==void 0&&!isMotionValue(o)?o:this.initialValues[e]!==void 0&&a===void 0?void 0:this.baseTarget[e]}on(e,i){return this.events[e]||(this.events[e]=new SubscriptionManager),this.events[e].add(i)}notify(e,...i){this.events[e]&&this.events[e].notify(...i)}scheduleRenderMicrotask(){microtask.render(this.render)}}class DOMVisualElement extends VisualElement{constructor(){super(...arguments),this.KeyframeResolver=DOMKeyframesResolver}sortInstanceNodePosition(e,i){return e.compareDocumentPosition(i)&2?1:-1}getBaseTargetFromProps(e,i){return e.style?e.style[i]:void 0}removeValueFromRenderState(e,{vars:i,style:a}){delete i[e],delete a[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;isMotionValue(e)&&(this.childSubscription=e.on("change",i=>{this.current&&(this.current.textContent=`${i}`)}))}}function renderHTML(s,{style:e,vars:i},a,o){const c=s.style;let d;for(d in e)c[d]=e[d];o==null||o.applyProjectionStyles(c,a);for(d in i)c.setProperty(d,i[d])}function getComputedStyle$1(s){return window.getComputedStyle(s)}class HTMLVisualElement extends DOMVisualElement{constructor(){super(...arguments),this.type="html",this.renderInstance=renderHTML}readValueFromInstance(e,i){var a;if(transformProps.has(i))return(a=this.projection)!=null&&a.isProjecting?defaultTransformValue(i):readTransformValue(e,i);{const o=getComputedStyle$1(e),c=(isCSSVariableName(i)?o.getPropertyValue(i):o[i])||0;return typeof c=="string"?c.trim():c}}measureInstanceViewportBox(e,{transformPagePoint:i}){return measureViewportBox(e,i)}build(e,i,a){buildHTMLStyles(e,i,a.transformTemplate)}scrapeMotionValuesFromProps(e,i,a){return scrapeMotionValuesFromProps$1(e,i,a)}}const camelCaseAttributes=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function renderSVG(s,e,i,a){renderHTML(s,e,void 0,a);for(const o in e.attrs)s.setAttribute(camelCaseAttributes.has(o)?o:camelToDash(o),e.attrs[o])}class SVGVisualElement extends DOMVisualElement{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=createBox}getBaseTargetFromProps(e,i){return e[i]}readValueFromInstance(e,i){if(transformProps.has(i)){const a=getDefaultValueType(i);return a&&a.default||0}return i=camelCaseAttributes.has(i)?i:camelToDash(i),e.getAttribute(i)}scrapeMotionValuesFromProps(e,i,a){return scrapeMotionValuesFromProps(e,i,a)}build(e,i,a){buildSVGAttrs(e,i,this.isSVGTag,a.transformTemplate,a.style)}renderInstance(e,i,a,o){renderSVG(e,i,a,o)}mount(e){this.isSVGTag=isSVGTag(e.tagName),super.mount(e)}}const createDomVisualElement=(s,e)=>isSVGComponent(s)?new SVGVisualElement(e):new HTMLVisualElement(e,{allowProjection:s!==reactExports.Fragment});function resolveVariant(s,e,i){const a=s.getProps();return resolveVariantFromProps(a,e,i!==void 0?i:a.custom,s)}const isKeyframesTarget=s=>Array.isArray(s);function setMotionValue(s,e,i){s.hasValue(e)?s.getValue(e).set(i):s.addValue(e,motionValue(i))}function resolveFinalValueInKeyframes(s){return isKeyframesTarget(s)?s[s.length-1]||0:s}function setTarget(s,e){const i=resolveVariant(s,e);let{transitionEnd:a={},transition:o={},...c}=i||{};c={...c,...a};for(const d in c){const g=resolveFinalValueInKeyframes(c[d]);setMotionValue(s,d,g)}}function isWillChangeMotionValue(s){return!!(isMotionValue(s)&&s.add)}function addValueToWillChange(s,e){const i=s.getValue("willChange");if(isWillChangeMotionValue(i))return i.add(e);if(!i&&MotionGlobalConfig.WillChange){const a=new MotionGlobalConfig.WillChange("auto");s.addValue("willChange",a),a.add(e)}}function getOptimisedAppearId(s){return s.props[optimizedAppearDataAttribute]}const isNotNull=s=>s!==null;function getFinalKeyframe(s,{repeat:e,repeatType:i="loop"},a){const o=s.filter(isNotNull),c=e&&i!=="loop"&&e%2===1?0:o.length-1;return o[c]}const underDampedSpring={type:"spring",stiffness:500,damping:25,restSpeed:10},criticallyDampedSpring=s=>({type:"spring",stiffness:550,damping:s===0?2*Math.sqrt(550):30,restSpeed:10}),keyframesTransition={type:"keyframes",duration:.8},ease={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},getDefaultTransition=(s,{keyframes:e})=>e.length>2?keyframesTransition:transformProps.has(s)?s.startsWith("scale")?criticallyDampedSpring(e[1]):underDampedSpring:ease;function isTransitionDefined({when:s,delay:e,delayChildren:i,staggerChildren:a,staggerDirection:o,repeat:c,repeatType:d,repeatDelay:g,from:b,elapsed:_,...j}){return!!Object.keys(j).length}const animateMotionValue=(s,e,i,a={},o,c)=>d=>{const g=getValueTransition(a,s)||{},b=g.delay||a.delay||0;let{elapsed:_=0}=a;_=_-secondsToMilliseconds(b);const j={keyframes:Array.isArray(i)?i:[null,i],ease:"easeOut",velocity:e.getVelocity(),...g,delay:-_,onUpdate:_e=>{e.set(_e),g.onUpdate&&g.onUpdate(_e)},onComplete:()=>{d(),g.onComplete&&g.onComplete()},name:s,motionValue:e,element:c?void 0:o};isTransitionDefined(g)||Object.assign(j,getDefaultTransition(s,j)),j.duration&&(j.duration=secondsToMilliseconds(j.duration)),j.repeatDelay&&(j.repeatDelay=secondsToMilliseconds(j.repeatDelay)),j.from!==void 0&&(j.keyframes[0]=j.from);let $=!1;if((j.type===!1||j.duration===0&&!j.repeatDelay)&&(makeAnimationInstant(j),j.delay===0&&($=!0)),(MotionGlobalConfig.instantAnimations||MotionGlobalConfig.skipAnimations)&&($=!0,makeAnimationInstant(j),j.delay=0),j.allowFlatten=!g.type&&!g.ease,$&&!c&&e.get()!==void 0){const _e=getFinalKeyframe(j.keyframes,g);if(_e!==void 0){frame.update(()=>{j.onUpdate(_e),j.onComplete()});return}}return g.isSync?new JSAnimation(j):new AsyncMotionValueAnimation(j)};function shouldBlockAnimation({protectedKeys:s,needsAnimating:e},i){const a=s.hasOwnProperty(i)&&e[i]!==!0;return e[i]=!1,a}function animateTarget(s,e,{delay:i=0,transitionOverride:a,type:o}={}){let{transition:c=s.getDefaultTransition(),transitionEnd:d,...g}=e;a&&(c=a);const b=[],_=o&&s.animationState&&s.animationState.getState()[o];for(const j in g){const $=s.getValue(j,s.latestValues[j]??null),_e=g[j];if(_e===void 0||_&&shouldBlockAnimation(_,j))continue;const tt={delay:i,...getValueTransition(c||{},j)},et=$.get();if(et!==void 0&&!$.isAnimating&&!Array.isArray(_e)&&_e===et&&!tt.velocity)continue;let st=!1;if(window.MotionHandoffAnimation){const rt=getOptimisedAppearId(s);if(rt){const nt=window.MotionHandoffAnimation(rt,j,frame);nt!==null&&(tt.startTime=nt,st=!0)}}addValueToWillChange(s,j),$.start(animateMotionValue(j,$,_e,s.shouldReduceMotion&&positionalKeys.has(j)?{type:!1}:tt,s,st));const at=$.animation;at&&b.push(at)}return d&&Promise.all(b).then(()=>{frame.update(()=>{d&&setTarget(s,d)})}),b}function calcChildStagger(s,e,i,a=0,o=1){const c=Array.from(s).sort((_,j)=>_.sortNodePosition(j)).indexOf(e),d=s.size,g=(d-1)*a;return typeof i=="function"?i(c,d):o===1?c*a:g-c*a}function animateVariant(s,e,i={}){var b;const a=resolveVariant(s,e,i.type==="exit"?(b=s.presenceContext)==null?void 0:b.custom:void 0);let{transition:o=s.getDefaultTransition()||{}}=a||{};i.transitionOverride&&(o=i.transitionOverride);const c=a?()=>Promise.all(animateTarget(s,a,i)):()=>Promise.resolve(),d=s.variantChildren&&s.variantChildren.size?(_=0)=>{const{delayChildren:j=0,staggerChildren:$,staggerDirection:_e}=o;return animateChildren(s,e,_,j,$,_e,i)}:()=>Promise.resolve(),{when:g}=o;if(g){const[_,j]=g==="beforeChildren"?[c,d]:[d,c];return _().then(()=>j())}else return Promise.all([c(),d(i.delay)])}function animateChildren(s,e,i=0,a=0,o=0,c=1,d){const g=[];for(const b of s.variantChildren)b.notify("AnimationStart",e),g.push(animateVariant(b,e,{...d,delay:i+(typeof a=="function"?0:a)+calcChildStagger(s.variantChildren,b,a,o,c)}).then(()=>b.notify("AnimationComplete",e)));return Promise.all(g)}function animateVisualElement(s,e,i={}){s.notify("AnimationStart",e);let a;if(Array.isArray(e)){const o=e.map(c=>animateVariant(s,c,i));a=Promise.all(o)}else if(typeof e=="string")a=animateVariant(s,e,i);else{const o=typeof e=="function"?resolveVariant(s,e,i.custom):e;a=Promise.all(animateTarget(s,o,i))}return a.then(()=>{s.notify("AnimationComplete",e)})}function shallowCompare(s,e){if(!Array.isArray(e))return!1;const i=e.length;if(i!==s.length)return!1;for(let a=0;a<i;a++)if(e[a]!==s[a])return!1;return!0}const numVariantProps=variantProps.length;function getVariantContext(s){if(!s)return;if(!s.isControllingVariants){const i=s.parent?getVariantContext(s.parent)||{}:{};return s.props.initial!==void 0&&(i.initial=s.props.initial),i}const e={};for(let i=0;i<numVariantProps;i++){const a=variantProps[i],o=s.props[a];(isVariantLabel(o)||o===!1)&&(e[a]=o)}return e}const reversePriorityOrder=[...variantPriorityOrder].reverse(),numAnimationTypes=variantPriorityOrder.length;function animateList(s){return e=>Promise.all(e.map(({animation:i,options:a})=>animateVisualElement(s,i,a)))}function createAnimationState(s){let e=animateList(s),i=createState(),a=!0;const o=b=>(_,j)=>{var _e;const $=resolveVariant(s,j,b==="exit"?(_e=s.presenceContext)==null?void 0:_e.custom:void 0);if($){const{transition:tt,transitionEnd:et,...st}=$;_={..._,...st,...et}}return _};function c(b){e=b(s)}function d(b){const{props:_}=s,j=getVariantContext(s.parent)||{},$=[],_e=new Set;let tt={},et=1/0;for(let at=0;at<numAnimationTypes;at++){const rt=reversePriorityOrder[at],nt=i[rt],it=_[rt]!==void 0?_[rt]:j[rt],ot=isVariantLabel(it),lt=rt===b?nt.isActive:null;lt===!1&&(et=at);let ct=it===j[rt]&&it!==_[rt]&&ot;if(ct&&a&&s.manuallyAnimateOnMount&&(ct=!1),nt.protectedKeys={...tt},!nt.isActive&&lt===null||!it&&!nt.prevProp||isAnimationControls(it)||typeof it=="boolean")continue;const ht=checkVariantsDidChange(nt.prevProp,it);let dt=ht||rt===b&&nt.isActive&&!ct&&ot||at>et&&ot,gt=!1;const vt=Array.isArray(it)?it:[it];let St=vt.reduce(o(rt),{});lt===!1&&(St={});const{prevResolvedValues:Tt={}}=nt,Ct={...Tt,...St},Rt=yt=>{dt=!0,_e.has(yt)&&(gt=!0,_e.delete(yt)),nt.needsAnimating[yt]=!0;const ut=s.getValue(yt);ut&&(ut.liveStyle=!1)};for(const yt in Ct){const ut=St[yt],ft=Tt[yt];if(tt.hasOwnProperty(yt))continue;let xt=!1;isKeyframesTarget(ut)&&isKeyframesTarget(ft)?xt=!shallowCompare(ut,ft):xt=ut!==ft,xt?ut!=null?Rt(yt):_e.add(yt):ut!==void 0&&_e.has(yt)?Rt(yt):nt.protectedKeys[yt]=!0}nt.prevProp=it,nt.prevResolvedValues=St,nt.isActive&&(tt={...tt,...St}),a&&s.blockInitialAnimation&&(dt=!1);const bt=ct&&ht;dt&&(!bt||gt)&&$.push(...vt.map(yt=>{const ut={type:rt};if(typeof yt=="string"&&a&&!bt&&s.manuallyAnimateOnMount&&s.parent){const{parent:ft}=s,xt=resolveVariant(ft,yt);if(ft.enteringChildren&&xt){const{delayChildren:mt}=xt.transition||{};ut.delay=calcChildStagger(ft.enteringChildren,s,mt)}}return{animation:yt,options:ut}}))}if(_e.size){const at={};if(typeof _.initial!="boolean"){const rt=resolveVariant(s,Array.isArray(_.initial)?_.initial[0]:_.initial);rt&&rt.transition&&(at.transition=rt.transition)}_e.forEach(rt=>{const nt=s.getBaseTarget(rt),it=s.getValue(rt);it&&(it.liveStyle=!0),at[rt]=nt??null}),$.push({animation:at})}let st=!!$.length;return a&&(_.initial===!1||_.initial===_.animate)&&!s.manuallyAnimateOnMount&&(st=!1),a=!1,st?e($):Promise.resolve()}function g(b,_){var $;if(i[b].isActive===_)return Promise.resolve();($=s.variantChildren)==null||$.forEach(_e=>{var tt;return(tt=_e.animationState)==null?void 0:tt.setActive(b,_)}),i[b].isActive=_;const j=d(b);for(const _e in i)i[_e].protectedKeys={};return j}return{animateChanges:d,setActive:g,setAnimateFunction:c,getState:()=>i,reset:()=>{i=createState()}}}function checkVariantsDidChange(s,e){return typeof e=="string"?e!==s:Array.isArray(e)?!shallowCompare(e,s):!1}function createTypeState(s=!1){return{isActive:s,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function createState(){return{animate:createTypeState(!0),whileInView:createTypeState(),whileHover:createTypeState(),whileTap:createTypeState(),whileDrag:createTypeState(),whileFocus:createTypeState(),exit:createTypeState()}}class Feature{constructor(e){this.isMounted=!1,this.node=e}update(){}}class AnimationFeature extends Feature{constructor(e){super(e),e.animationState||(e.animationState=createAnimationState(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();isAnimationControls(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:i}=this.node.prevProps||{};e!==i&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)==null||e.call(this)}}let id$1=0;class ExitAnimationFeature extends Feature{constructor(){super(...arguments),this.id=id$1++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:i}=this.node.presenceContext,{isPresent:a}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===a)return;const o=this.node.animationState.setActive("exit",!e);i&&!e&&o.then(()=>{i(this.id)})}mount(){const{register:e,onExitComplete:i}=this.node.presenceContext||{};i&&i(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const animations={animation:{Feature:AnimationFeature},exit:{Feature:ExitAnimationFeature}};function addDomEvent(s,e,i,a={passive:!0}){return s.addEventListener(e,i,a),()=>s.removeEventListener(e,i)}function extractEventInfo(s){return{point:{x:s.pageX,y:s.pageY}}}const addPointerInfo=s=>e=>isPrimaryPointer(e)&&s(e,extractEventInfo(e));function addPointerEvent(s,e,i,a){return addDomEvent(s,e,addPointerInfo(i),a)}const SCALE_PRECISION=1e-4,SCALE_MIN=1-SCALE_PRECISION,SCALE_MAX=1+SCALE_PRECISION,TRANSLATE_PRECISION=.01,TRANSLATE_MIN=0-TRANSLATE_PRECISION,TRANSLATE_MAX=0+TRANSLATE_PRECISION;function calcLength(s){return s.max-s.min}function isNear(s,e,i){return Math.abs(s-e)<=i}function calcAxisDelta(s,e,i,a=.5){s.origin=a,s.originPoint=mixNumber$1(e.min,e.max,s.origin),s.scale=calcLength(i)/calcLength(e),s.translate=mixNumber$1(i.min,i.max,s.origin)-s.originPoint,(s.scale>=SCALE_MIN&&s.scale<=SCALE_MAX||isNaN(s.scale))&&(s.scale=1),(s.translate>=TRANSLATE_MIN&&s.translate<=TRANSLATE_MAX||isNaN(s.translate))&&(s.translate=0)}function calcBoxDelta(s,e,i,a){calcAxisDelta(s.x,e.x,i.x,a?a.originX:void 0),calcAxisDelta(s.y,e.y,i.y,a?a.originY:void 0)}function calcRelativeAxis(s,e,i){s.min=i.min+e.min,s.max=s.min+calcLength(e)}function calcRelativeBox(s,e,i){calcRelativeAxis(s.x,e.x,i.x),calcRelativeAxis(s.y,e.y,i.y)}function calcRelativeAxisPosition(s,e,i){s.min=e.min-i.min,s.max=s.min+calcLength(e)}function calcRelativePosition(s,e,i){calcRelativeAxisPosition(s.x,e.x,i.x),calcRelativeAxisPosition(s.y,e.y,i.y)}function eachAxis(s){return[s("x"),s("y")]}const getContextWindow=({current:s})=>s?s.ownerDocument.defaultView:null,distance=(s,e)=>Math.abs(s-e);function distance2D(s,e){const i=distance(s.x,e.x),a=distance(s.y,e.y);return Math.sqrt(i**2+a**2)}class PanSession{constructor(e,i,{transformPagePoint:a,contextWindow:o=window,dragSnapToOrigin:c=!1,distanceThreshold:d=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const _e=getPanInfo(this.lastMoveEventInfo,this.history),tt=this.startEvent!==null,et=distance2D(_e.offset,{x:0,y:0})>=this.distanceThreshold;if(!tt&&!et)return;const{point:st}=_e,{timestamp:at}=frameData;this.history.push({...st,timestamp:at});const{onStart:rt,onMove:nt}=this.handlers;tt||(rt&&rt(this.lastMoveEvent,_e),this.startEvent=this.lastMoveEvent),nt&&nt(this.lastMoveEvent,_e)},this.handlePointerMove=(_e,tt)=>{this.lastMoveEvent=_e,this.lastMoveEventInfo=transformPoint(tt,this.transformPagePoint),frame.update(this.updatePoint,!0)},this.handlePointerUp=(_e,tt)=>{this.end();const{onEnd:et,onSessionEnd:st,resumeAnimation:at}=this.handlers;if(this.dragSnapToOrigin&&at&&at(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const rt=getPanInfo(_e.type==="pointercancel"?this.lastMoveEventInfo:transformPoint(tt,this.transformPagePoint),this.history);this.startEvent&&et&&et(_e,rt),st&&st(_e,rt)},!isPrimaryPointer(e))return;this.dragSnapToOrigin=c,this.handlers=i,this.transformPagePoint=a,this.distanceThreshold=d,this.contextWindow=o||window;const g=extractEventInfo(e),b=transformPoint(g,this.transformPagePoint),{point:_}=b,{timestamp:j}=frameData;this.history=[{..._,timestamp:j}];const{onSessionStart:$}=i;$&&$(e,getPanInfo(b,this.history)),this.removeListeners=pipe(addPointerEvent(this.contextWindow,"pointermove",this.handlePointerMove),addPointerEvent(this.contextWindow,"pointerup",this.handlePointerUp),addPointerEvent(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),cancelFrame(this.updatePoint)}}function transformPoint(s,e){return e?{point:e(s.point)}:s}function subtractPoint(s,e){return{x:s.x-e.x,y:s.y-e.y}}function getPanInfo({point:s},e){return{point:s,delta:subtractPoint(s,lastDevicePoint(e)),offset:subtractPoint(s,startDevicePoint(e)),velocity:getVelocity(e,.1)}}function startDevicePoint(s){return s[0]}function lastDevicePoint(s){return s[s.length-1]}function getVelocity(s,e){if(s.length<2)return{x:0,y:0};let i=s.length-1,a=null;const o=lastDevicePoint(s);for(;i>=0&&(a=s[i],!(o.timestamp-a.timestamp>secondsToMilliseconds(e)));)i--;if(!a)return{x:0,y:0};const c=millisecondsToSeconds(o.timestamp-a.timestamp);if(c===0)return{x:0,y:0};const d={x:(o.x-a.x)/c,y:(o.y-a.y)/c};return d.x===1/0&&(d.x=0),d.y===1/0&&(d.y=0),d}function applyConstraints(s,{min:e,max:i},a){return e!==void 0&&s<e?s=a?mixNumber$1(e,s,a.min):Math.max(s,e):i!==void 0&&s>i&&(s=a?mixNumber$1(i,s,a.max):Math.min(s,i)),s}function calcRelativeAxisConstraints(s,e,i){return{min:e!==void 0?s.min+e:void 0,max:i!==void 0?s.max+i-(s.max-s.min):void 0}}function calcRelativeConstraints(s,{top:e,left:i,bottom:a,right:o}){return{x:calcRelativeAxisConstraints(s.x,i,o),y:calcRelativeAxisConstraints(s.y,e,a)}}function calcViewportAxisConstraints(s,e){let i=e.min-s.min,a=e.max-s.max;return e.max-e.min<s.max-s.min&&([i,a]=[a,i]),{min:i,max:a}}function calcViewportConstraints(s,e){return{x:calcViewportAxisConstraints(s.x,e.x),y:calcViewportAxisConstraints(s.y,e.y)}}function calcOrigin(s,e){let i=.5;const a=calcLength(s),o=calcLength(e);return o>a?i=progress(e.min,e.max-a,s.min):a>o&&(i=progress(s.min,s.max-o,e.min)),clamp(0,1,i)}function rebaseAxisConstraints(s,e){const i={};return e.min!==void 0&&(i.min=e.min-s.min),e.max!==void 0&&(i.max=e.max-s.min),i}const defaultElastic=.35;function resolveDragElastic(s=defaultElastic){return s===!1?s=0:s===!0&&(s=defaultElastic),{x:resolveAxisElastic(s,"left","right"),y:resolveAxisElastic(s,"top","bottom")}}function resolveAxisElastic(s,e,i){return{min:resolvePointElastic(s,e),max:resolvePointElastic(s,i)}}function resolvePointElastic(s,e){return typeof s=="number"?s:s[e]||0}const elementDragControls=new WeakMap;class VisualElementDragControls{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=createBox(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:i=!1,distanceThreshold:a}={}){const{presenceContext:o}=this.visualElement;if(o&&o.isPresent===!1)return;const c=$=>{const{dragSnapToOrigin:_e}=this.getProps();_e?this.pauseAnimation():this.stopAnimation(),i&&this.snapToCursor(extractEventInfo($).point)},d=($,_e)=>{const{drag:tt,dragPropagation:et,onDragStart:st}=this.getProps();if(tt&&!et&&(this.openDragLock&&this.openDragLock(),this.openDragLock=setDragLock(tt),!this.openDragLock))return;this.latestPointerEvent=$,this.latestPanInfo=_e,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),eachAxis(rt=>{let nt=this.getAxisMotionValue(rt).get()||0;if(percent.test(nt)){const{projection:it}=this.visualElement;if(it&&it.layout){const ot=it.layout.layoutBox[rt];ot&&(nt=calcLength(ot)*(parseFloat(nt)/100))}}this.originPoint[rt]=nt}),st&&frame.postRender(()=>st($,_e)),addValueToWillChange(this.visualElement,"transform");const{animationState:at}=this.visualElement;at&&at.setActive("whileDrag",!0)},g=($,_e)=>{this.latestPointerEvent=$,this.latestPanInfo=_e;const{dragPropagation:tt,dragDirectionLock:et,onDirectionLock:st,onDrag:at}=this.getProps();if(!tt&&!this.openDragLock)return;const{offset:rt}=_e;if(et&&this.currentDirection===null){this.currentDirection=getCurrentDirection(rt),this.currentDirection!==null&&st&&st(this.currentDirection);return}this.updateAxis("x",_e.point,rt),this.updateAxis("y",_e.point,rt),this.visualElement.render(),at&&at($,_e)},b=($,_e)=>{this.latestPointerEvent=$,this.latestPanInfo=_e,this.stop($,_e),this.latestPointerEvent=null,this.latestPanInfo=null},_=()=>eachAxis($=>{var _e;return this.getAnimationState($)==="paused"&&((_e=this.getAxisMotionValue($).animation)==null?void 0:_e.play())}),{dragSnapToOrigin:j}=this.getProps();this.panSession=new PanSession(e,{onSessionStart:c,onStart:d,onMove:g,onSessionEnd:b,resumeAnimation:_},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:j,distanceThreshold:a,contextWindow:getContextWindow(this.visualElement)})}stop(e,i){const a=e||this.latestPointerEvent,o=i||this.latestPanInfo,c=this.isDragging;if(this.cancel(),!c||!o||!a)return;const{velocity:d}=o;this.startAnimation(d);const{onDragEnd:g}=this.getProps();g&&frame.postRender(()=>g(a,o))}cancel(){this.isDragging=!1;const{projection:e,animationState:i}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:a}=this.getProps();!a&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),i&&i.setActive("whileDrag",!1)}updateAxis(e,i,a){const{drag:o}=this.getProps();if(!a||!shouldDrag(e,o,this.currentDirection))return;const c=this.getAxisMotionValue(e);let d=this.originPoint[e]+a[e];this.constraints&&this.constraints[e]&&(d=applyConstraints(d,this.constraints[e],this.elastic[e])),c.set(d)}resolveConstraints(){var c;const{dragConstraints:e,dragElastic:i}=this.getProps(),a=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(c=this.visualElement.projection)==null?void 0:c.layout,o=this.constraints;e&&isRefObject(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&a?this.constraints=calcRelativeConstraints(a.layoutBox,e):this.constraints=!1,this.elastic=resolveDragElastic(i),o!==this.constraints&&a&&this.constraints&&!this.hasMutatedConstraints&&eachAxis(d=>{this.constraints!==!1&&this.getAxisMotionValue(d)&&(this.constraints[d]=rebaseAxisConstraints(a.layoutBox[d],this.constraints[d]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:i}=this.getProps();if(!e||!isRefObject(e))return!1;const a=e.current,{projection:o}=this.visualElement;if(!o||!o.layout)return!1;const c=measurePageBox(a,o.root,this.visualElement.getTransformPagePoint());let d=calcViewportConstraints(o.layout.layoutBox,c);if(i){const g=i(convertBoxToBoundingBox(d));this.hasMutatedConstraints=!!g,g&&(d=convertBoundingBoxToBox(g))}return d}startAnimation(e){const{drag:i,dragMomentum:a,dragElastic:o,dragTransition:c,dragSnapToOrigin:d,onDragTransitionEnd:g}=this.getProps(),b=this.constraints||{},_=eachAxis(j=>{if(!shouldDrag(j,i,this.currentDirection))return;let $=b&&b[j]||{};d&&($={min:0,max:0});const _e=o?200:1e6,tt=o?40:1e7,et={type:"inertia",velocity:a?e[j]:0,bounceStiffness:_e,bounceDamping:tt,timeConstant:750,restDelta:1,restSpeed:10,...c,...$};return this.startAxisValueAnimation(j,et)});return Promise.all(_).then(g)}startAxisValueAnimation(e,i){const a=this.getAxisMotionValue(e);return addValueToWillChange(this.visualElement,e),a.start(animateMotionValue(e,a,0,i,this.visualElement,!1))}stopAnimation(){eachAxis(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){eachAxis(e=>{var i;return(i=this.getAxisMotionValue(e).animation)==null?void 0:i.pause()})}getAnimationState(e){var i;return(i=this.getAxisMotionValue(e).animation)==null?void 0:i.state}getAxisMotionValue(e){const i=`_drag${e.toUpperCase()}`,a=this.visualElement.getProps(),o=a[i];return o||this.visualElement.getValue(e,(a.initial?a.initial[e]:void 0)||0)}snapToCursor(e){eachAxis(i=>{const{drag:a}=this.getProps();if(!shouldDrag(i,a,this.currentDirection))return;const{projection:o}=this.visualElement,c=this.getAxisMotionValue(i);if(o&&o.layout){const{min:d,max:g}=o.layout.layoutBox[i];c.set(e[i]-mixNumber$1(d,g,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:i}=this.getProps(),{projection:a}=this.visualElement;if(!isRefObject(i)||!a||!this.constraints)return;this.stopAnimation();const o={x:0,y:0};eachAxis(d=>{const g=this.getAxisMotionValue(d);if(g&&this.constraints!==!1){const b=g.get();o[d]=calcOrigin({min:b,max:b},this.constraints[d])}});const{transformTemplate:c}=this.visualElement.getProps();this.visualElement.current.style.transform=c?c({},""):"none",a.root&&a.root.updateScroll(),a.updateLayout(),this.resolveConstraints(),eachAxis(d=>{if(!shouldDrag(d,e,null))return;const g=this.getAxisMotionValue(d),{min:b,max:_}=this.constraints[d];g.set(mixNumber$1(b,_,o[d]))})}addListeners(){if(!this.visualElement.current)return;elementDragControls.set(this.visualElement,this);const e=this.visualElement.current,i=addPointerEvent(e,"pointerdown",b=>{const{drag:_,dragListener:j=!0}=this.getProps();_&&j&&this.start(b)}),a=()=>{const{dragConstraints:b}=this.getProps();isRefObject(b)&&b.current&&(this.constraints=this.resolveRefConstraints())},{projection:o}=this.visualElement,c=o.addEventListener("measure",a);o&&!o.layout&&(o.root&&o.root.updateScroll(),o.updateLayout()),frame.read(a);const d=addDomEvent(window,"resize",()=>this.scalePositionWithinConstraints()),g=o.addEventListener("didUpdate",({delta:b,hasLayoutChanged:_})=>{this.isDragging&&_&&(eachAxis(j=>{const $=this.getAxisMotionValue(j);$&&(this.originPoint[j]+=b[j].translate,$.set($.get()+b[j].translate))}),this.visualElement.render())});return()=>{d(),i(),c(),g&&g()}}getProps(){const e=this.visualElement.getProps(),{drag:i=!1,dragDirectionLock:a=!1,dragPropagation:o=!1,dragConstraints:c=!1,dragElastic:d=defaultElastic,dragMomentum:g=!0}=e;return{...e,drag:i,dragDirectionLock:a,dragPropagation:o,dragConstraints:c,dragElastic:d,dragMomentum:g}}}function shouldDrag(s,e,i){return(e===!0||e===s)&&(i===null||i===s)}function getCurrentDirection(s,e=10){let i=null;return Math.abs(s.y)>e?i="y":Math.abs(s.x)>e&&(i="x"),i}class DragGesture extends Feature{constructor(e){super(e),this.removeGroupControls=noop$1,this.removeListeners=noop$1,this.controls=new VisualElementDragControls(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||noop$1}unmount(){this.removeGroupControls(),this.removeListeners()}}const asyncHandler=s=>(e,i)=>{s&&frame.postRender(()=>s(e,i))};class PanGesture extends Feature{constructor(){super(...arguments),this.removePointerDownListener=noop$1}onPointerDown(e){this.session=new PanSession(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:getContextWindow(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:i,onPan:a,onPanEnd:o}=this.node.getProps();return{onSessionStart:asyncHandler(e),onStart:asyncHandler(i),onMove:a,onEnd:(c,d)=>{delete this.session,o&&frame.postRender(()=>o(c,d))}}}mount(){this.removePointerDownListener=addPointerEvent(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const globalProjectionState={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function pixelsToPercent(s,e){return e.max===e.min?0:s/(e.max-e.min)*100}const correctBorderRadius={correct:(s,e)=>{if(!e.target)return s;if(typeof s=="string")if(px.test(s))s=parseFloat(s);else return s;const i=pixelsToPercent(s,e.target.x),a=pixelsToPercent(s,e.target.y);return`${i}% ${a}%`}},correctBoxShadow={correct:(s,{treeScale:e,projectionDelta:i})=>{const a=s,o=complex.parse(s);if(o.length>5)return a;const c=complex.createTransformer(s),d=typeof o[0]!="number"?1:0,g=i.x.scale*e.x,b=i.y.scale*e.y;o[0+d]/=g,o[1+d]/=b;const _=mixNumber$1(g,b,.5);return typeof o[2+d]=="number"&&(o[2+d]/=_),typeof o[3+d]=="number"&&(o[3+d]/=_),c(o)}};let hasTakenAnySnapshot=!1;class MeasureLayoutWithContext extends reactExports.Component{componentDidMount(){const{visualElement:e,layoutGroup:i,switchLayoutGroup:a,layoutId:o}=this.props,{projection:c}=e;addScaleCorrector(defaultScaleCorrectors),c&&(i.group&&i.group.add(c),a&&a.register&&o&&a.register(c),hasTakenAnySnapshot&&c.root.didUpdate(),c.addEventListener("animationComplete",()=>{this.safeToRemove()}),c.setOptions({...c.options,onExitComplete:()=>this.safeToRemove()})),globalProjectionState.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:i,visualElement:a,drag:o,isPresent:c}=this.props,{projection:d}=a;return d&&(d.isPresent=c,hasTakenAnySnapshot=!0,o||e.layoutDependency!==i||i===void 0||e.isPresent!==c?d.willUpdate():this.safeToRemove(),e.isPresent!==c&&(c?d.promote():d.relegate()||frame.postRender(()=>{const g=d.getStack();(!g||!g.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),microtask.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:i,switchLayoutGroup:a}=this.props,{projection:o}=e;hasTakenAnySnapshot=!0,o&&(o.scheduleCheckAfterUnmount(),i&&i.group&&i.group.remove(o),a&&a.deregister&&a.deregister(o))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function MeasureLayout(s){const[e,i]=usePresence(),a=reactExports.useContext(LayoutGroupContext);return jsxRuntimeExports.jsx(MeasureLayoutWithContext,{...s,layoutGroup:a,switchLayoutGroup:reactExports.useContext(SwitchLayoutGroupContext),isPresent:e,safeToRemove:i})}const defaultScaleCorrectors={borderRadius:{...correctBorderRadius,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:correctBorderRadius,borderTopRightRadius:correctBorderRadius,borderBottomLeftRadius:correctBorderRadius,borderBottomRightRadius:correctBorderRadius,boxShadow:correctBoxShadow};function animateSingleValue(s,e,i){const a=isMotionValue(s)?s:motionValue(s);return a.start(animateMotionValue("",a,e,i)),a.animation}const compareByDepth=(s,e)=>s.depth-e.depth;class FlatTree{constructor(){this.children=[],this.isDirty=!1}add(e){addUniqueItem(this.children,e),this.isDirty=!0}remove(e){removeItem(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(compareByDepth),this.isDirty=!1,this.children.forEach(e)}}function delay(s,e){const i=time.now(),a=({timestamp:o})=>{const c=o-i;c>=e&&(cancelFrame(a),s(c-e))};return frame.setup(a,!0),()=>cancelFrame(a)}const borders=["TopLeft","TopRight","BottomLeft","BottomRight"],numBorders=borders.length,asNumber=s=>typeof s=="string"?parseFloat(s):s,isPx=s=>typeof s=="number"||px.test(s);function mixValues(s,e,i,a,o,c){o?(s.opacity=mixNumber$1(0,i.opacity??1,easeCrossfadeIn(a)),s.opacityExit=mixNumber$1(e.opacity??1,0,easeCrossfadeOut(a))):c&&(s.opacity=mixNumber$1(e.opacity??1,i.opacity??1,a));for(let d=0;d<numBorders;d++){const g=`border${borders[d]}Radius`;let b=getRadius(e,g),_=getRadius(i,g);if(b===void 0&&_===void 0)continue;b||(b=0),_||(_=0),b===0||_===0||isPx(b)===isPx(_)?(s[g]=Math.max(mixNumber$1(asNumber(b),asNumber(_),a),0),(percent.test(_)||percent.test(b))&&(s[g]+="%")):s[g]=_}(e.rotate||i.rotate)&&(s.rotate=mixNumber$1(e.rotate||0,i.rotate||0,a))}function getRadius(s,e){return s[e]!==void 0?s[e]:s.borderRadius}const easeCrossfadeIn=compress(0,.5,circOut),easeCrossfadeOut=compress(.5,.95,noop$1);function compress(s,e,i){return a=>a<s?0:a>e?1:i(progress(s,e,a))}function copyAxisInto(s,e){s.min=e.min,s.max=e.max}function copyBoxInto(s,e){copyAxisInto(s.x,e.x),copyAxisInto(s.y,e.y)}function copyAxisDeltaInto(s,e){s.translate=e.translate,s.scale=e.scale,s.originPoint=e.originPoint,s.origin=e.origin}function removePointDelta(s,e,i,a,o){return s-=e,s=scalePoint(s,1/i,a),o!==void 0&&(s=scalePoint(s,1/o,a)),s}function removeAxisDelta(s,e=0,i=1,a=.5,o,c=s,d=s){if(percent.test(e)&&(e=parseFloat(e),e=mixNumber$1(d.min,d.max,e/100)-d.min),typeof e!="number")return;let g=mixNumber$1(c.min,c.max,a);s===c&&(g-=e),s.min=removePointDelta(s.min,e,i,g,o),s.max=removePointDelta(s.max,e,i,g,o)}function removeAxisTransforms(s,e,[i,a,o],c,d){removeAxisDelta(s,e[i],e[a],e[o],e.scale,c,d)}const xKeys=["x","scaleX","originX"],yKeys=["y","scaleY","originY"];function removeBoxTransforms(s,e,i,a){removeAxisTransforms(s.x,e,xKeys,i?i.x:void 0,a?a.x:void 0),removeAxisTransforms(s.y,e,yKeys,i?i.y:void 0,a?a.y:void 0)}function isAxisDeltaZero(s){return s.translate===0&&s.scale===1}function isDeltaZero(s){return isAxisDeltaZero(s.x)&&isAxisDeltaZero(s.y)}function axisEquals(s,e){return s.min===e.min&&s.max===e.max}function boxEquals(s,e){return axisEquals(s.x,e.x)&&axisEquals(s.y,e.y)}function axisEqualsRounded(s,e){return Math.round(s.min)===Math.round(e.min)&&Math.round(s.max)===Math.round(e.max)}function boxEqualsRounded(s,e){return axisEqualsRounded(s.x,e.x)&&axisEqualsRounded(s.y,e.y)}function aspectRatio(s){return calcLength(s.x)/calcLength(s.y)}function axisDeltaEquals(s,e){return s.translate===e.translate&&s.scale===e.scale&&s.originPoint===e.originPoint}class NodeStack{constructor(){this.members=[]}add(e){addUniqueItem(this.members,e),e.scheduleRender()}remove(e){if(removeItem(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const i=this.members[this.members.length-1];i&&this.promote(i)}}relegate(e){const i=this.members.findIndex(o=>e===o);if(i===0)return!1;let a;for(let o=i;o>=0;o--){const c=this.members[o];if(c.isPresent!==!1){a=c;break}}return a?(this.promote(a),!0):!1}promote(e,i){const a=this.lead;if(e!==a&&(this.prevLead=a,this.lead=e,e.show(),a)){a.instance&&a.scheduleRender(),e.scheduleRender(),e.resumeFrom=a,i&&(e.resumeFrom.preserveOpacity=!0),a.snapshot&&(e.snapshot=a.snapshot,e.snapshot.latestValues=a.animationValues||a.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:o}=e.options;o===!1&&a.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:i,resumingFrom:a}=e;i.onExitComplete&&i.onExitComplete(),a&&a.options.onExitComplete&&a.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function buildProjectionTransform(s,e,i){let a="";const o=s.x.translate/e.x,c=s.y.translate/e.y,d=(i==null?void 0:i.z)||0;if((o||c||d)&&(a=`translate3d(${o}px, ${c}px, ${d}px) `),(e.x!==1||e.y!==1)&&(a+=`scale(${1/e.x}, ${1/e.y}) `),i){const{transformPerspective:_,rotate:j,rotateX:$,rotateY:_e,skewX:tt,skewY:et}=i;_&&(a=`perspective(${_}px) ${a}`),j&&(a+=`rotate(${j}deg) `),$&&(a+=`rotateX(${$}deg) `),_e&&(a+=`rotateY(${_e}deg) `),tt&&(a+=`skewX(${tt}deg) `),et&&(a+=`skewY(${et}deg) `)}const g=s.x.scale*e.x,b=s.y.scale*e.y;return(g!==1||b!==1)&&(a+=`scale(${g}, ${b})`),a||"none"}const transformAxes=["","X","Y","Z"],animationTarget=1e3;let id=0;function resetDistortingTransform(s,e,i,a){const{latestValues:o}=e;o[s]&&(i[s]=o[s],e.setStaticValue(s,0),a&&(a[s]=0))}function cancelTreeOptimisedTransformAnimations(s){if(s.hasCheckedOptimisedAppear=!0,s.root===s)return;const{visualElement:e}=s.options;if(!e)return;const i=getOptimisedAppearId(e);if(window.MotionHasOptimisedAnimation(i,"transform")){const{layout:o,layoutId:c}=s.options;window.MotionCancelOptimisedAnimation(i,"transform",frame,!(o||c))}const{parent:a}=s;a&&!a.hasCheckedOptimisedAppear&&cancelTreeOptimisedTransformAnimations(a)}function createProjectionNode({attachResizeListener:s,defaultParent:e,measureScroll:i,checkIsScrollRoot:a,resetTransform:o}){return class{constructor(d={},g=e==null?void 0:e()){this.id=id++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(propagateDirtyNodes),this.nodes.forEach(resolveTargetDelta),this.nodes.forEach(calcProjection),this.nodes.forEach(cleanDirtyNodes)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=d,this.root=g?g.root||g:this,this.path=g?[...g.path,g]:[],this.parent=g,this.depth=g?g.depth+1:0;for(let b=0;b<this.path.length;b++)this.path[b].shouldResetTransform=!0;this.root===this&&(this.nodes=new FlatTree)}addEventListener(d,g){return this.eventHandlers.has(d)||this.eventHandlers.set(d,new SubscriptionManager),this.eventHandlers.get(d).add(g)}notifyListeners(d,...g){const b=this.eventHandlers.get(d);b&&b.notify(...g)}hasListeners(d){return this.eventHandlers.has(d)}mount(d){if(this.instance)return;this.isSVG=isSVGElement(d)&&!isSVGSVGElement(d),this.instance=d;const{layoutId:g,layout:b,visualElement:_}=this.options;if(_&&!_.current&&_.mount(d),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(b||g)&&(this.isLayoutDirty=!0),s){let j,$=0;const _e=()=>this.root.updateBlockedByResize=!1;frame.read(()=>{$=window.innerWidth}),s(d,()=>{const tt=window.innerWidth;tt!==$&&($=tt,this.root.updateBlockedByResize=!0,j&&j(),j=delay(_e,250),globalProjectionState.hasAnimatedSinceResize&&(globalProjectionState.hasAnimatedSinceResize=!1,this.nodes.forEach(finishAnimation)))})}g&&this.root.registerSharedNode(g,this),this.options.animate!==!1&&_&&(g||b)&&this.addEventListener("didUpdate",({delta:j,hasLayoutChanged:$,hasRelativeLayoutChanged:_e,layout:tt})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const et=this.options.transition||_.getDefaultTransition()||defaultLayoutTransition,{onLayoutAnimationStart:st,onLayoutAnimationComplete:at}=_.getProps(),rt=!this.targetLayout||!boxEqualsRounded(this.targetLayout,tt),nt=!$&&_e;if(this.options.layoutRoot||this.resumeFrom||nt||$&&(rt||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const it={...getValueTransition(et,"layout"),onPlay:st,onComplete:at};(_.shouldReduceMotion||this.options.layoutRoot)&&(it.delay=0,it.type=!1),this.startAnimation(it),this.setAnimationOrigin(j,nt)}else $||finishAnimation(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=tt})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const d=this.getStack();d&&d.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),cancelFrame(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(resetSkewAndRotation),this.animationId++)}getTransformTemplate(){const{visualElement:d}=this.options;return d&&d.getProps().transformTemplate}willUpdate(d=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&cancelTreeOptimisedTransformAnimations(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let j=0;j<this.path.length;j++){const $=this.path[j];$.shouldResetTransform=!0,$.updateScroll("snapshot"),$.options.layoutRoot&&$.willUpdate(!1)}const{layoutId:g,layout:b}=this.options;if(g===void 0&&!b)return;const _=this.getTransformTemplate();this.prevTransformTemplateValue=_?_(this.latestValues,""):void 0,this.updateSnapshot(),d&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(clearMeasurements);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(clearIsLayoutDirty);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(resetTransformStyle),this.nodes.forEach(updateLayout),this.nodes.forEach(notifyLayoutUpdate)):this.nodes.forEach(clearIsLayoutDirty),this.clearAllSnapshots();const g=time.now();frameData.delta=clamp(0,1e3/60,g-frameData.timestamp),frameData.timestamp=g,frameData.isProcessing=!0,frameSteps.update.process(frameData),frameSteps.preRender.process(frameData),frameSteps.render.process(frameData),frameData.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,microtask.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(clearSnapshot),this.sharedNodes.forEach(removeLeadSnapshots)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,frame.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){frame.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!calcLength(this.snapshot.measuredBox.x)&&!calcLength(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let b=0;b<this.path.length;b++)this.path[b].updateScroll();const d=this.layout;this.layout=this.measure(!1),this.layoutCorrected=createBox(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:g}=this.options;g&&g.notify("LayoutMeasure",this.layout.layoutBox,d?d.layoutBox:void 0)}updateScroll(d="measure"){let g=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===d&&(g=!1),g&&this.instance){const b=a(this.instance);this.scroll={animationId:this.root.animationId,phase:d,isRoot:b,offset:i(this.instance),wasRoot:this.scroll?this.scroll.isRoot:b}}}resetTransform(){if(!o)return;const d=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,g=this.projectionDelta&&!isDeltaZero(this.projectionDelta),b=this.getTransformTemplate(),_=b?b(this.latestValues,""):void 0,j=_!==this.prevTransformTemplateValue;d&&this.instance&&(g||hasTransform(this.latestValues)||j)&&(o(this.instance,_),this.shouldResetTransform=!1,this.scheduleRender())}measure(d=!0){const g=this.measurePageBox();let b=this.removeElementScroll(g);return d&&(b=this.removeTransform(b)),roundBox(b),{animationId:this.root.animationId,measuredBox:g,layoutBox:b,latestValues:{},source:this.id}}measurePageBox(){var _;const{visualElement:d}=this.options;if(!d)return createBox();const g=d.measureViewportBox();if(!(((_=this.scroll)==null?void 0:_.wasRoot)||this.path.some(checkNodeWasScrollRoot))){const{scroll:j}=this.root;j&&(translateAxis(g.x,j.offset.x),translateAxis(g.y,j.offset.y))}return g}removeElementScroll(d){var b;const g=createBox();if(copyBoxInto(g,d),(b=this.scroll)!=null&&b.wasRoot)return g;for(let _=0;_<this.path.length;_++){const j=this.path[_],{scroll:$,options:_e}=j;j!==this.root&&$&&_e.layoutScroll&&($.wasRoot&&copyBoxInto(g,d),translateAxis(g.x,$.offset.x),translateAxis(g.y,$.offset.y))}return g}applyTransform(d,g=!1){const b=createBox();copyBoxInto(b,d);for(let _=0;_<this.path.length;_++){const j=this.path[_];!g&&j.options.layoutScroll&&j.scroll&&j!==j.root&&transformBox(b,{x:-j.scroll.offset.x,y:-j.scroll.offset.y}),hasTransform(j.latestValues)&&transformBox(b,j.latestValues)}return hasTransform(this.latestValues)&&transformBox(b,this.latestValues),b}removeTransform(d){const g=createBox();copyBoxInto(g,d);for(let b=0;b<this.path.length;b++){const _=this.path[b];if(!_.instance||!hasTransform(_.latestValues))continue;hasScale(_.latestValues)&&_.updateSnapshot();const j=createBox(),$=_.measurePageBox();copyBoxInto(j,$),removeBoxTransforms(g,_.latestValues,_.snapshot?_.snapshot.layoutBox:void 0,j)}return hasTransform(this.latestValues)&&removeBoxTransforms(g,this.latestValues),g}setTargetDelta(d){this.targetDelta=d,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(d){this.options={...this.options,...d,crossfade:d.crossfade!==void 0?d.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==frameData.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(d=!1){var _e;const g=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=g.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=g.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=g.isSharedProjectionDirty);const b=!!this.resumingFrom||this!==g;if(!(d||b&&this.isSharedProjectionDirty||this.isProjectionDirty||(_e=this.parent)!=null&&_e.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:j,layoutId:$}=this.options;if(!(!this.layout||!(j||$))){if(this.resolvedRelativeTargetAt=frameData.timestamp,!this.targetDelta&&!this.relativeTarget){const tt=this.getClosestProjectingParent();tt&&tt.layout&&this.animationProgress!==1?(this.relativeParent=tt,this.forceRelativeParentToResolveTarget(),this.relativeTarget=createBox(),this.relativeTargetOrigin=createBox(),calcRelativePosition(this.relativeTargetOrigin,this.layout.layoutBox,tt.layout.layoutBox),copyBoxInto(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=createBox(),this.targetWithTransforms=createBox()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),calcRelativeBox(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):copyBoxInto(this.target,this.layout.layoutBox),applyBoxDelta(this.target,this.targetDelta)):copyBoxInto(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const tt=this.getClosestProjectingParent();tt&&!!tt.resumingFrom==!!this.resumingFrom&&!tt.options.layoutScroll&&tt.target&&this.animationProgress!==1?(this.relativeParent=tt,this.forceRelativeParentToResolveTarget(),this.relativeTarget=createBox(),this.relativeTargetOrigin=createBox(),calcRelativePosition(this.relativeTargetOrigin,this.target,tt.target),copyBoxInto(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||hasScale(this.parent.latestValues)||has2DTranslate(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var et;const d=this.getLead(),g=!!this.resumingFrom||this!==d;let b=!0;if((this.isProjectionDirty||(et=this.parent)!=null&&et.isProjectionDirty)&&(b=!1),g&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(b=!1),this.resolvedRelativeTargetAt===frameData.timestamp&&(b=!1),b)return;const{layout:_,layoutId:j}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(_||j))return;copyBoxInto(this.layoutCorrected,this.layout.layoutBox);const $=this.treeScale.x,_e=this.treeScale.y;applyTreeDeltas(this.layoutCorrected,this.treeScale,this.path,g),d.layout&&!d.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(d.target=d.layout.layoutBox,d.targetWithTransforms=createBox());const{target:tt}=d;if(!tt){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(copyAxisDeltaInto(this.prevProjectionDelta.x,this.projectionDelta.x),copyAxisDeltaInto(this.prevProjectionDelta.y,this.projectionDelta.y)),calcBoxDelta(this.projectionDelta,this.layoutCorrected,tt,this.latestValues),(this.treeScale.x!==$||this.treeScale.y!==_e||!axisDeltaEquals(this.projectionDelta.x,this.prevProjectionDelta.x)||!axisDeltaEquals(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",tt))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(d=!0){var g;if((g=this.options.visualElement)==null||g.scheduleRender(),d){const b=this.getStack();b&&b.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=createDelta(),this.projectionDelta=createDelta(),this.projectionDeltaWithTransform=createDelta()}setAnimationOrigin(d,g=!1){const b=this.snapshot,_=b?b.latestValues:{},j={...this.latestValues},$=createDelta();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!g;const _e=createBox(),tt=b?b.source:void 0,et=this.layout?this.layout.source:void 0,st=tt!==et,at=this.getStack(),rt=!at||at.members.length<=1,nt=!!(st&&!rt&&this.options.crossfade===!0&&!this.path.some(hasOpacityCrossfade));this.animationProgress=0;let it;this.mixTargetDelta=ot=>{const lt=ot/1e3;mixAxisDelta($.x,d.x,lt),mixAxisDelta($.y,d.y,lt),this.setTargetDelta($),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(calcRelativePosition(_e,this.layout.layoutBox,this.relativeParent.layout.layoutBox),mixBox(this.relativeTarget,this.relativeTargetOrigin,_e,lt),it&&boxEquals(this.relativeTarget,it)&&(this.isProjectionDirty=!1),it||(it=createBox()),copyBoxInto(it,this.relativeTarget)),st&&(this.animationValues=j,mixValues(j,_,this.latestValues,lt,nt,rt)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=lt},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(d){var g,b,_;this.notifyListeners("animationStart"),(g=this.currentAnimation)==null||g.stop(),(_=(b=this.resumingFrom)==null?void 0:b.currentAnimation)==null||_.stop(),this.pendingAnimation&&(cancelFrame(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=frame.update(()=>{globalProjectionState.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=motionValue(0)),this.currentAnimation=animateSingleValue(this.motionValue,[0,1e3],{...d,velocity:0,isSync:!0,onUpdate:j=>{this.mixTargetDelta(j),d.onUpdate&&d.onUpdate(j)},onStop:()=>{},onComplete:()=>{d.onComplete&&d.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const d=this.getStack();d&&d.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(animationTarget),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const d=this.getLead();let{targetWithTransforms:g,target:b,layout:_,latestValues:j}=d;if(!(!g||!b||!_)){if(this!==d&&this.layout&&_&&shouldAnimatePositionOnly(this.options.animationType,this.layout.layoutBox,_.layoutBox)){b=this.target||createBox();const $=calcLength(this.layout.layoutBox.x);b.x.min=d.target.x.min,b.x.max=b.x.min+$;const _e=calcLength(this.layout.layoutBox.y);b.y.min=d.target.y.min,b.y.max=b.y.min+_e}copyBoxInto(g,b),transformBox(g,j),calcBoxDelta(this.projectionDeltaWithTransform,this.layoutCorrected,g,j)}}registerSharedNode(d,g){this.sharedNodes.has(d)||this.sharedNodes.set(d,new NodeStack),this.sharedNodes.get(d).add(g);const _=g.options.initialPromotionConfig;g.promote({transition:_?_.transition:void 0,preserveFollowOpacity:_&&_.shouldPreserveFollowOpacity?_.shouldPreserveFollowOpacity(g):void 0})}isLead(){const d=this.getStack();return d?d.lead===this:!0}getLead(){var g;const{layoutId:d}=this.options;return d?((g=this.getStack())==null?void 0:g.lead)||this:this}getPrevLead(){var g;const{layoutId:d}=this.options;return d?(g=this.getStack())==null?void 0:g.prevLead:void 0}getStack(){const{layoutId:d}=this.options;if(d)return this.root.sharedNodes.get(d)}promote({needsReset:d,transition:g,preserveFollowOpacity:b}={}){const _=this.getStack();_&&_.promote(this,b),d&&(this.projectionDelta=void 0,this.needsReset=!0),g&&this.setOptions({transition:g})}relegate(){const d=this.getStack();return d?d.relegate(this):!1}resetSkewAndRotation(){const{visualElement:d}=this.options;if(!d)return;let g=!1;const{latestValues:b}=d;if((b.z||b.rotate||b.rotateX||b.rotateY||b.rotateZ||b.skewX||b.skewY)&&(g=!0),!g)return;const _={};b.z&&resetDistortingTransform("z",d,_,this.animationValues);for(let j=0;j<transformAxes.length;j++)resetDistortingTransform(`rotate${transformAxes[j]}`,d,_,this.animationValues),resetDistortingTransform(`skew${transformAxes[j]}`,d,_,this.animationValues);d.render();for(const j in _)d.setStaticValue(j,_[j]),this.animationValues&&(this.animationValues[j]=_[j]);d.scheduleRender()}applyProjectionStyles(d,g){if(!this.instance||this.isSVG)return;if(!this.isVisible){d.visibility="hidden";return}const b=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,d.visibility="",d.opacity="",d.pointerEvents=resolveMotionValue(g==null?void 0:g.pointerEvents)||"",d.transform=b?b(this.latestValues,""):"none";return}const _=this.getLead();if(!this.projectionDelta||!this.layout||!_.target){this.options.layoutId&&(d.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,d.pointerEvents=resolveMotionValue(g==null?void 0:g.pointerEvents)||""),this.hasProjected&&!hasTransform(this.latestValues)&&(d.transform=b?b({},""):"none",this.hasProjected=!1);return}d.visibility="";const j=_.animationValues||_.latestValues;this.applyTransformsToTarget();let $=buildProjectionTransform(this.projectionDeltaWithTransform,this.treeScale,j);b&&($=b(j,$)),d.transform=$;const{x:_e,y:tt}=this.projectionDelta;d.transformOrigin=`${_e.origin*100}% ${tt.origin*100}% 0`,_.animationValues?d.opacity=_===this?j.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:j.opacityExit:d.opacity=_===this?j.opacity!==void 0?j.opacity:"":j.opacityExit!==void 0?j.opacityExit:0;for(const et in scaleCorrectors){if(j[et]===void 0)continue;const{correct:st,applyTo:at,isCSSVariable:rt}=scaleCorrectors[et],nt=$==="none"?j[et]:st(j[et],_);if(at){const it=at.length;for(let ot=0;ot<it;ot++)d[at[ot]]=nt}else rt?this.options.visualElement.renderState.vars[et]=nt:d[et]=nt}this.options.layoutId&&(d.pointerEvents=_===this?resolveMotionValue(g==null?void 0:g.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(d=>{var g;return(g=d.currentAnimation)==null?void 0:g.stop()}),this.root.nodes.forEach(clearMeasurements),this.root.sharedNodes.clear()}}}function updateLayout(s){s.updateLayout()}function notifyLayoutUpdate(s){var i;const e=((i=s.resumeFrom)==null?void 0:i.snapshot)||s.snapshot;if(s.isLead()&&s.layout&&e&&s.hasListeners("didUpdate")){const{layoutBox:a,measuredBox:o}=s.layout,{animationType:c}=s.options,d=e.source!==s.layout.source;c==="size"?eachAxis($=>{const _e=d?e.measuredBox[$]:e.layoutBox[$],tt=calcLength(_e);_e.min=a[$].min,_e.max=_e.min+tt}):shouldAnimatePositionOnly(c,e.layoutBox,a)&&eachAxis($=>{const _e=d?e.measuredBox[$]:e.layoutBox[$],tt=calcLength(a[$]);_e.max=_e.min+tt,s.relativeTarget&&!s.currentAnimation&&(s.isProjectionDirty=!0,s.relativeTarget[$].max=s.relativeTarget[$].min+tt)});const g=createDelta();calcBoxDelta(g,a,e.layoutBox);const b=createDelta();d?calcBoxDelta(b,s.applyTransform(o,!0),e.measuredBox):calcBoxDelta(b,a,e.layoutBox);const _=!isDeltaZero(g);let j=!1;if(!s.resumeFrom){const $=s.getClosestProjectingParent();if($&&!$.resumeFrom){const{snapshot:_e,layout:tt}=$;if(_e&&tt){const et=createBox();calcRelativePosition(et,e.layoutBox,_e.layoutBox);const st=createBox();calcRelativePosition(st,a,tt.layoutBox),boxEqualsRounded(et,st)||(j=!0),$.options.layoutRoot&&(s.relativeTarget=st,s.relativeTargetOrigin=et,s.relativeParent=$)}}}s.notifyListeners("didUpdate",{layout:a,snapshot:e,delta:b,layoutDelta:g,hasLayoutChanged:_,hasRelativeLayoutChanged:j})}else if(s.isLead()){const{onExitComplete:a}=s.options;a&&a()}s.options.transition=void 0}function propagateDirtyNodes(s){s.parent&&(s.isProjecting()||(s.isProjectionDirty=s.parent.isProjectionDirty),s.isSharedProjectionDirty||(s.isSharedProjectionDirty=!!(s.isProjectionDirty||s.parent.isProjectionDirty||s.parent.isSharedProjectionDirty)),s.isTransformDirty||(s.isTransformDirty=s.parent.isTransformDirty))}function cleanDirtyNodes(s){s.isProjectionDirty=s.isSharedProjectionDirty=s.isTransformDirty=!1}function clearSnapshot(s){s.clearSnapshot()}function clearMeasurements(s){s.clearMeasurements()}function clearIsLayoutDirty(s){s.isLayoutDirty=!1}function resetTransformStyle(s){const{visualElement:e}=s.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),s.resetTransform()}function finishAnimation(s){s.finishAnimation(),s.targetDelta=s.relativeTarget=s.target=void 0,s.isProjectionDirty=!0}function resolveTargetDelta(s){s.resolveTargetDelta()}function calcProjection(s){s.calcProjection()}function resetSkewAndRotation(s){s.resetSkewAndRotation()}function removeLeadSnapshots(s){s.removeLeadSnapshot()}function mixAxisDelta(s,e,i){s.translate=mixNumber$1(e.translate,0,i),s.scale=mixNumber$1(e.scale,1,i),s.origin=e.origin,s.originPoint=e.originPoint}function mixAxis(s,e,i,a){s.min=mixNumber$1(e.min,i.min,a),s.max=mixNumber$1(e.max,i.max,a)}function mixBox(s,e,i,a){mixAxis(s.x,e.x,i.x,a),mixAxis(s.y,e.y,i.y,a)}function hasOpacityCrossfade(s){return s.animationValues&&s.animationValues.opacityExit!==void 0}const defaultLayoutTransition={duration:.45,ease:[.4,0,.1,1]},userAgentContains=s=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(s),roundPoint=userAgentContains("applewebkit/")&&!userAgentContains("chrome/")?Math.round:noop$1;function roundAxis(s){s.min=roundPoint(s.min),s.max=roundPoint(s.max)}function roundBox(s){roundAxis(s.x),roundAxis(s.y)}function shouldAnimatePositionOnly(s,e,i){return s==="position"||s==="preserve-aspect"&&!isNear(aspectRatio(e),aspectRatio(i),.2)}function checkNodeWasScrollRoot(s){var e;return s!==s.root&&((e=s.scroll)==null?void 0:e.wasRoot)}const DocumentProjectionNode=createProjectionNode({attachResizeListener:(s,e)=>addDomEvent(s,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),rootProjectionNode={current:void 0},HTMLProjectionNode=createProjectionNode({measureScroll:s=>({x:s.scrollLeft,y:s.scrollTop}),defaultParent:()=>{if(!rootProjectionNode.current){const s=new DocumentProjectionNode({});s.mount(window),s.setOptions({layoutScroll:!0}),rootProjectionNode.current=s}return rootProjectionNode.current},resetTransform:(s,e)=>{s.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:s=>window.getComputedStyle(s).position==="fixed"}),drag={pan:{Feature:PanGesture},drag:{Feature:DragGesture,ProjectionNode:HTMLProjectionNode,MeasureLayout}};function handleHoverEvent(s,e,i){const{props:a}=s;s.animationState&&a.whileHover&&s.animationState.setActive("whileHover",i==="Start");const o="onHover"+i,c=a[o];c&&frame.postRender(()=>c(e,extractEventInfo(e)))}class HoverGesture extends Feature{mount(){const{current:e}=this.node;e&&(this.unmount=hover(e,(i,a)=>(handleHoverEvent(this.node,a,"Start"),o=>handleHoverEvent(this.node,o,"End"))))}unmount(){}}class FocusGesture extends Feature{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=pipe(addDomEvent(this.node.current,"focus",()=>this.onFocus()),addDomEvent(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function handlePressEvent(s,e,i){const{props:a}=s;if(s.current instanceof HTMLButtonElement&&s.current.disabled)return;s.animationState&&a.whileTap&&s.animationState.setActive("whileTap",i==="Start");const o="onTap"+(i==="End"?"":i),c=a[o];c&&frame.postRender(()=>c(e,extractEventInfo(e)))}class PressGesture extends Feature{mount(){const{current:e}=this.node;e&&(this.unmount=press(e,(i,a)=>(handlePressEvent(this.node,a,"Start"),(o,{success:c})=>handlePressEvent(this.node,o,c?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const observerCallbacks=new WeakMap,observers=new WeakMap,fireObserverCallback=s=>{const e=observerCallbacks.get(s.target);e&&e(s)},fireAllObserverCallbacks=s=>{s.forEach(fireObserverCallback)};function initIntersectionObserver({root:s,...e}){const i=s||document;observers.has(i)||observers.set(i,{});const a=observers.get(i),o=JSON.stringify(e);return a[o]||(a[o]=new IntersectionObserver(fireAllObserverCallbacks,{root:s,...e})),a[o]}function observeIntersection(s,e,i){const a=initIntersectionObserver(e);return observerCallbacks.set(s,i),a.observe(s),()=>{observerCallbacks.delete(s),a.unobserve(s)}}const thresholdNames={some:0,all:1};class InViewFeature extends Feature{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:i,margin:a,amount:o="some",once:c}=e,d={root:i?i.current:void 0,rootMargin:a,threshold:typeof o=="number"?o:thresholdNames[o]},g=b=>{const{isIntersecting:_}=b;if(this.isInView===_||(this.isInView=_,c&&!_&&this.hasEnteredView))return;_&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",_);const{onViewportEnter:j,onViewportLeave:$}=this.node.getProps(),_e=_?j:$;_e&&_e(b)};return observeIntersection(this.node.current,d,g)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:i}=this.node;["amount","margin","root"].some(hasViewportOptionChanged(e,i))&&this.startObserver()}unmount(){}}function hasViewportOptionChanged({viewport:s={}},{viewport:e={}}={}){return i=>s[i]!==e[i]}const gestureAnimations={inView:{Feature:InViewFeature},tap:{Feature:PressGesture},focus:{Feature:FocusGesture},hover:{Feature:HoverGesture}},layout={layout:{ProjectionNode:HTMLProjectionNode,MeasureLayout}},featureBundle={...animations,...gestureAnimations,...drag,...layout},motion=createMotionProxy(featureBundle,createDomVisualElement),Aboutus=({onBack:s,onNavigate:e,isActive:i})=>{const a=reactExports.useRef(null);reactExports.useEffect(()=>{if(!i)return;const c=d=>{var g,b;d.key==="ArrowLeft"?e&&e("ArrowLeft"):d.key==="ArrowDown"?(g=a.current)==null||g.scrollBy({top:100,behavior:"smooth"}):d.key==="ArrowUp"&&((b=a.current)==null||b.scrollBy({top:-100,behavior:"smooth"}))};return window.addEventListener("keydown",c),()=>{window.removeEventListener("keydown",c)}},[i,e]);const o=[{title:"For Creators, By a Creator",desc:"Founded by an award-winning independent filmmaker who knows the struggle of being unheard."},{title:"Built-in Affiliate Model",desc:"Every viewer becomes a distributor the moment they purchase a ticket."},{title:"Smart, Transparent, and Fair",desc:"Revenue shares, real-time wallets, no subscriptions, and region-based pricing."},{title:"Multi-Language, Multi-Talent, One Vision",desc:"We celebrate cultural diversity across regions and industries under a single platform."}];return jsxRuntimeExports.jsx("div",{ref:a,className:"h-screen w-full bg-custom-gradient text-white overflow-y-auto flex-1 scrollbar-hide",children:jsxRuntimeExports.jsxs("div",{className:"px-6 py-8",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-10",children:[jsxRuntimeExports.jsx("h1",{className:"!text-3xl font-bold text-red-500 mb-2 sm:mb-0",children:"About Us"}),jsxRuntimeExports.jsxs("p",{className:"text-xs sm:text-sm text-right",children:["Visit"," ",jsxRuntimeExports.jsx("a",{href:"https://uat.bookmytheatre.com",target:"_blank",rel:"noreferrer",className:"text-red-500 underline",children:"https://uat.bookmytheatre.com"})," ","for more information"]})]}),jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold mb-1",children:"1. Data Collection"}),jsxRuntimeExports.jsx("p",{className:"opacity-90 mb-4",children:"More Than a Platform. A Global Stage for Stories That Matter."}),jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Our Mission"}),jsxRuntimeExports.jsx("p",{className:"mb-6 leading-relaxed",children:"To empower independent filmmakers, elevate global cinema, and give every user a voice and a stake in the stories they love."}),jsxRuntimeExports.jsx("h4",{className:"text-center font-semibold text-base uppercase mb-4",children:"What Makes Us Different"}),o.map((c,d)=>jsxRuntimeExports.jsxs("div",{className:"bg-red-700/80 rounded-md p-4 mb-4 transition hover:bg-red-700",children:[jsxRuntimeExports.jsx("h5",{className:"font-semibold text-sm mb-2",children:c.title}),jsxRuntimeExports.jsx("p",{className:"text-sm leading-relaxed",children:c.desc})]},d)),jsxRuntimeExports.jsx("div",{className:"h-px bg-white opacity-30 my-10"}),jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-center mb-6",children:"Why It Matters"}),jsxRuntimeExports.jsxs("p",{className:"text-lg leading-7 mb-5 text-center",children:["We're not here to compete with the giants. ",jsxRuntimeExports.jsx("br",{}),"We're here to change the rules."]}),jsxRuntimeExports.jsxs("p",{className:"text-lg leading-7 mb-5 text-center",children:["Because talent isn't exclusive. ",jsxRuntimeExports.jsx("br",{}),"Opportunity shouldn't be either."]}),jsxRuntimeExports.jsx("p",{className:"italic opacity-90 text-center text-base mb-10",children:"This is for the dreamers who edit in silence, the writers who rewrite until dawn, and the filmmakers who fight for every frame."}),jsxRuntimeExports.jsx("div",{className:"h-px bg-white opacity-30 my-10"}),jsxRuntimeExports.jsx("h3",{className:"text-lg font-bold mb-4",children:"From the Founder"}),jsxRuntimeExports.jsxs("p",{className:"text-center opacity-90 leading-7 mb-6",children:[`"I didn't create Book My Theatre because I had a plan. I created it because I had no choice. I realized how broken the system is for real creators. This platform is for everyone who believes that stories are not made in studios  they're made in hearts.`,jsxRuntimeExports.jsx("br",{}),jsxRuntimeExports.jsx("br",{}),`I'm not asking you to believe in me. I'm asking you to believe in the power of your own story."`]}),jsxRuntimeExports.jsxs("p",{className:"text-center font-semibold opacity-90",children:[" Saga Reddy Thumma ",jsxRuntimeExports.jsx("br",{})," Founder & CEO"]})]})})},Contactus=reactExports.forwardRef(({onNavigate:s,isActive:e},i)=>{const a=reactExports.useRef(null);return reactExports.useEffect(()=>{if(!e)return;const o=c=>{c.key==="ArrowLeft"?s&&s("ArrowLeft"):c.key==="ArrowDown"?a.current&&a.current.scrollBy({top:100,behavior:"smooth"}):c.key==="ArrowUp"&&a.current&&a.current.scrollBy({top:-100,behavior:"smooth"})};return window.addEventListener("keydown",o),()=>{window.removeEventListener("keydown",o)}},[s,e]),jsxRuntimeExports.jsxs("div",{ref:a,className:"text-white flex-1 h-screen overflow-y-auto",children:[jsxRuntimeExports.jsx("div",{className:"flex items-center justify-between px-6 py-8 border-b border-gray-700",children:jsxRuntimeExports.jsx("div",{className:"flex items-center gap-3",children:jsxRuntimeExports.jsx("h1",{className:"!text-3xl font-bold text-[#d94b4b]",children:"Contact Us"})})}),jsxRuntimeExports.jsxs("div",{className:"px-6 py-8 flex flex-col lg:flex-row gap-10",children:[jsxRuntimeExports.jsxs("div",{className:"lg:w-1/2",children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold text-[#d94b4b] mb-4",children:"Get in Touch with Book My Theatre"}),jsxRuntimeExports.jsx("p",{className:"text-gray-300 leading-relaxed",children:"At Book My Theatre, were here to help you reach your learning goals with personalized support. Contact us today to start your journey toward success!"})]}),jsxRuntimeExports.jsxs("div",{className:"lg:w-1/2 space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"bg-white/5 p-5 rounded-xl",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Customer Support"}),jsxRuntimeExports.jsxs("p",{className:"text-gray-300 text-sm leading-relaxed",children:["Email: support@bookmytheatre.com ",jsxRuntimeExports.jsx("br",{}),"Phone: +1-555-0123 ",jsxRuntimeExports.jsx("br",{}),"Hours: 24/7"]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-white/5 p-5 rounded-xl",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Business Inquiries"}),jsxRuntimeExports.jsxs("p",{className:"text-gray-300 text-sm leading-relaxed",children:["Email: business@bookmytheatre.com ",jsxRuntimeExports.jsx("br",{}),"Phone: +1-555-0124"]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-white/5 p-5 rounded-xl",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Technical Support"}),jsxRuntimeExports.jsxs("p",{className:"text-gray-300 text-sm leading-relaxed",children:["Email: tech@bookmytheatre.com ",jsxRuntimeExports.jsx("br",{}),"Response Time: Within 24 hours"]})]})]})]})]})}),Faq=({onBack:s,onNavigate:e,isActive:i})=>{const a=reactExports.useRef(null);reactExports.useEffect(()=>{if(!i)return;const c=d=>{d.key==="ArrowLeft"?e&&e("ArrowLeft"):d.key==="ArrowDown"?a.current&&a.current.scrollBy({top:100,behavior:"smooth"}):d.key==="ArrowUp"&&a.current&&a.current.scrollBy({top:-100,behavior:"smooth"})};return window.addEventListener("keydown",c),()=>{window.removeEventListener("keydown",c)}},[e,i]);const o=[{question:"How do I create an account?",answer:"Click on the Sign Up button and follow the registration process."},{question:"How does the affiliate model work?",answer:"Every viewer becomes a distributor when they purchase a ticket and can earn commissions."},{question:"What payment methods do you accept?",answer:"We accept credit cards, debit cards, and various digital payment methods."},{question:"Can I watch content offline?",answer:"Currently, we only support online streaming for security reasons."}];return jsxRuntimeExports.jsxs("div",{ref:a,className:"w-full h-screen bg-custom-gradient text-white overflow-y-auto",children:[jsxRuntimeExports.jsx("div",{className:"flex items-center px-6 py-8 border-b border-gray-700",children:jsxRuntimeExports.jsx("h1",{className:"!text-3xl font-bold text-[#d94b4b]",children:"Frequently Asked Questions"})}),jsxRuntimeExports.jsx("div",{className:"px-6 py-8",children:o.map((c,d)=>jsxRuntimeExports.jsxs("div",{className:"mb-8",children:[jsxRuntimeExports.jsxs("h3",{className:"text-xl font-semibold mb-3",children:["Q: ",c.question]}),jsxRuntimeExports.jsxs("p",{className:"text-gray-300 text-base leading-relaxed",children:["A: ",c.answer]}),d<o.length-1&&jsxRuntimeExports.jsx("div",{className:"h-px bg-gray-700 mt-6"})]},d))})]})},Allplans=({onBack:s,onNavigate:e,isActive:i})=>{const a=reactExports.useRef(null);reactExports.useEffect(()=>{if(!i)return;const c=d=>{d.key==="ArrowLeft"?e&&e("ArrowLeft"):d.key==="ArrowDown"?a.current&&a.current.scrollBy({top:100,behavior:"smooth"}):d.key==="ArrowUp"&&a.current&&a.current.scrollBy({top:-100,behavior:"smooth"})};return window.addEventListener("keydown",c),()=>{window.removeEventListener("keydown",c)}},[e,i]);const o=[{name:"Basic",price:"Free",features:["Access to limited content","Standard streaming quality","Basic support"]},{name:"Premium",price:"$9.99/month",features:["Access to all content","HD streaming","Priority support","Offline viewing"]},{name:"Creator",price:"Custom",features:["All Premium features","Revenue sharing","Analytics dashboard","Dedicated support"]}];return jsxRuntimeExports.jsxs("div",{ref:a,className:"w-full bg-custom-gradient text-white flex-1 h-screen overflow-y-auto",children:[jsxRuntimeExports.jsx("div",{className:"flex items-center px-6 py-8 border-b border-gray-700",children:jsxRuntimeExports.jsx("h1",{className:"text-3xl font-bold",children:"All Plans"})}),jsxRuntimeExports.jsxs("div",{className:"px-6 py-8",children:[jsxRuntimeExports.jsx("h2",{className:"text-center text-3xl font-bold mb-10",children:"Choose Your Plan"}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-1 gap-8",children:o.map((c,d)=>jsxRuntimeExports.jsxs("div",{className:`bg-white/10 backdrop-blur-sm rounded-xl p-6 hover:bg-white/20 transition-all \r
                 flex flex-col h-full`,children:[jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[" ",jsxRuntimeExports.jsx("h3",{className:"text-2xl font-bold mb-3",children:c.name}),jsxRuntimeExports.jsx("p",{className:"text-[#D9D0C4] text-xl font-semibold mb-5",children:c.price}),jsxRuntimeExports.jsx("ul",{className:"mb-6 space-y-2",children:c.features.map((g,b)=>jsxRuntimeExports.jsxs("li",{className:"text-gray-200 text-base leading-relaxed",children:[" ",g]},b))})]}),jsxRuntimeExports.jsx("button",{className:"w-full bg-[#7a1717] py-3 rounded-lg font-bold text-white hover:bg-[#a31b1b] transition mt-auto",children:"Select Plan"})]},d))})]})]})},Terms=({onNavigate:s,isActive:e})=>{const i=reactExports.useRef(null);return reactExports.useEffect(()=>{if(!e)return;const a=o=>{var c,d;o.key==="ArrowLeft"?s&&s("ArrowLeft"):o.key==="ArrowDown"?(c=i.current)==null||c.scrollBy({top:100,behavior:"smooth"}):o.key==="ArrowUp"&&((d=i.current)==null||d.scrollBy({top:-100,behavior:"smooth"}))};return window.addEventListener("keydown",a),()=>{window.removeEventListener("keydown",a)}},[e,s]),jsxRuntimeExports.jsx("div",{ref:i,className:"w-full h-screen bg-custom-gradient text-white overflow-y-auto scrollbar-hide",children:jsxRuntimeExports.jsxs("div",{className:"px-6 py-8",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-8",children:[jsxRuntimeExports.jsx("div",{className:"flex flex-row items-center gap-3",children:jsxRuntimeExports.jsx("h1",{className:"text-3xl font-bold text-[#d94b4b] mb-2 sm:mb-0",children:"Terms & Conditions"})}),jsxRuntimeExports.jsxs("p",{className:"text-sm text-right",children:["Visit"," ",jsxRuntimeExports.jsx("a",{href:"https://uat.bookmytheatre.com",target:"_blank",rel:"noopener noreferrer",className:"text-[#d94b4b] hover:underline",children:"https://uat.bookmytheatre.com"})," ","for more information"]})]}),jsxRuntimeExports.jsx("h2",{className:"text-white font-bold text-base mb-2",children:"1. Definitions"}),jsxRuntimeExports.jsxs("p",{className:"text-gray-300 text-sm leading-6 mb-5",children:[jsxRuntimeExports.jsx("strong",{children:"Platform:"})," Refers to the Book My Theatre website, applications, services, and technologies. ",jsxRuntimeExports.jsx("br",{}),jsxRuntimeExports.jsx("strong",{children:"User:"})," Anyone accessing or using the platform, including viewers and affiliates. ",jsxRuntimeExports.jsx("br",{}),jsxRuntimeExports.jsx("strong",{children:"Filmmaker:"})," A content creator submitting films or trailers. ",jsxRuntimeExports.jsx("br",{}),jsxRuntimeExports.jsx("strong",{children:"Affiliate:"})," A user who shares films via referral links and earns from successful referrals. ",jsxRuntimeExports.jsx("br",{}),jsxRuntimeExports.jsx("strong",{children:"Net Revenue:"})," Gross income after deducting applicable taxes, platform fees, and transaction costs."]}),jsxRuntimeExports.jsx("h2",{className:"text-white font-bold text-base mb-2",children:"2. Platform Use"}),jsxRuntimeExports.jsxs("p",{className:"text-gray-300 text-sm leading-6 mb-5",children:["Users must be 18 years or older, or use the platform under the supervision of a parent or guardian. ",jsxRuntimeExports.jsx("br",{}),"Users agree not to use the platform for illegal activity, fraud, or copyright violations. ",jsxRuntimeExports.jsx("br",{}),"Book My Theatre may suspend or terminate any account found to violate these rules."]}),jsxRuntimeExports.jsx("h2",{className:"text-white font-bold text-base mb-2",children:"3. Intellectual Property & Anti-Cloning Policy"}),jsxRuntimeExports.jsxs("p",{className:"text-gray-300 text-sm leading-6 mb-5",children:["Users must be 18 years or older, or use the platform under the supervision of a parent or guardian. ",jsxRuntimeExports.jsx("br",{}),"Users agree not to use the platform for illegal activity, fraud, or copyright violations. ",jsxRuntimeExports.jsx("br",{}),"Book My Theatre may suspend or terminate any account found to violate these rules."]}),jsxRuntimeExports.jsx("h2",{className:"text-white font-bold text-base mb-2",children:"4. User Responsibilities"}),jsxRuntimeExports.jsxs("p",{className:"text-gray-300 text-sm leading-6 mb-5",children:["Users are responsible for maintaining the confidentiality of their account information and password. ",jsxRuntimeExports.jsx("br",{}),"Users must promptly notify Book My Theatre of any unauthorized use of their account or any other breach of security."]})]})})},Privacypolicy=({onNavigate:s,isActive:e})=>{const i=reactExports.useRef(null);return reactExports.useEffect(()=>{if(!e)return;const a=o=>{var c,d;o.key==="ArrowLeft"?s&&s("ArrowLeft"):o.key==="ArrowDown"?(c=i.current)==null||c.scrollBy({top:100,behavior:"smooth"}):o.key==="ArrowUp"&&((d=i.current)==null||d.scrollBy({top:-100,behavior:"smooth"}))};return window.addEventListener("keydown",a),()=>{window.removeEventListener("keydown",a)}},[e,s]),jsxRuntimeExports.jsx("div",{ref:i,className:"w-full h-screen flex flex-col bg-linear-to-b from-black to-[#5B0203] text-white overflow-y-auto scrollbar-hide",children:jsxRuntimeExports.jsxs("div",{className:"px-6 py-8",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center",children:[jsxRuntimeExports.jsx("div",{className:"flex flex-row items-center gap-3",children:jsxRuntimeExports.jsx("h1",{className:"text-3xl font-bold text-[#d94b4b] mb-2 sm:mb-0",children:"Privacy Policy"})}),jsxRuntimeExports.jsxs("p",{className:"text-sm text-right text-white",children:["Visit"," ",jsxRuntimeExports.jsx("a",{href:"https://uat.bookmytheatre.com",target:"_blank",rel:"noopener noreferrer",className:"text-[#d94b4b] underline",children:"https://uat.bookmytheatre.com"})," ","for more information"]})]}),jsxRuntimeExports.jsx("h2",{className:"text-white font-bold text-md mt-6 mb-1",children:"1. Data Collection"}),jsxRuntimeExports.jsxs("p",{className:"text-[#d6d6d6] text-xs leading-6 mb-4",children:["We collect only essential user information (e.g., email, phone number) for account setup and transactions.",jsxRuntimeExports.jsx("br",{}),"We do not collect unnecessary personal data."]}),jsxRuntimeExports.jsx("h2",{className:"text-white font-bold text-md mt-4 mb-1",children:"2. Data Usage"}),jsxRuntimeExports.jsxs("p",{className:"text-[#d6d6d6] text-sm leading-6 mb-4",children:["Process transactions",jsxRuntimeExports.jsx("br",{}),"Provide customer support",jsxRuntimeExports.jsx("br",{}),"Enhance user experience",jsxRuntimeExports.jsx("br",{}),"Comply with legal obligations"]}),jsxRuntimeExports.jsx("h2",{className:"text-white font-bold text-md mt-4 mb-1",children:"3. Security"}),jsxRuntimeExports.jsxs("p",{className:"text-[#d6d6d6] text-sm leading-6 mb-4",children:["We do not sell or share personal data with third parties for marketing.",jsxRuntimeExports.jsx("br",{}),"Data may be shared with trusted partners only for service delivery (e.g., payment processing)"]}),jsxRuntimeExports.jsx("h2",{className:"text-white font-bold text-md mt-4 mb-1",children:"4. Your Rights"}),jsxRuntimeExports.jsxs("p",{className:"text-[#d6d6d6] text-sm leading-6 mb-4",children:["We do not sell or share personal data with third parties for marketing.",jsxRuntimeExports.jsx("br",{}),"Data may be shared with trusted partners only for service delivery (e.g., payment processing)"]}),jsxRuntimeExports.jsx("h2",{className:"text-white font-bold text-md mt-4 mb-1",children:"5. Cookies"}),jsxRuntimeExports.jsxs("p",{className:"text-[#d6d6d6] text-sm leading-6 mb-4",children:["We use cookies to optimize performance.",jsxRuntimeExports.jsx("br",{}),"Users may choose to block cookies in browser settings."]})]})})},bankLogo=""+new URL("banklogo-CtmUlKhk.png",import.meta.url).href,Userapi=axios.create({baseURL:`${Config.api_url}/users/`,withCredentials:!0,headers:{Accept:"application/json","Content-Type":"application/json"}}),BankAccountDetails=({onNavigate:s,isActive:e})=>{const i=reactExports.useRef(null),{userInfo:a}=useUserdetails(),[o,c]=reactExports.useState(!1),[d,g]=reactExports.useState([]),[b,_]=reactExports.useState(""),[j,$]=reactExports.useState(1),[_e,tt]=reactExports.useState(0),et=6,st=(a==null?void 0:a.id)||null;async function at(rt,nt,it){c(!0);try{const lt=(await Userapi.get("fetchuserbankaccounts",{params:{page:rt,limit:nt,user_id:st},headers:{"Content-Type":"application/json"}})).data;if(lt.status==="error"){_(lt.message||"Error fetching data");return}g(lt.userbankaccounts||[]),tt(lt.totalpages||1),_("")}catch(ot){_((ot==null?void 0:ot.message)||"Network error")}finally{c(!1)}}return reactExports.useEffect(()=>{if(!e)return;const rt=nt=>{var it,ot;nt.key==="ArrowLeft"?s&&s("ArrowLeft"):nt.key==="ArrowDown"?(it=i.current)==null||it.scrollBy({top:100,behavior:"smooth"}):nt.key==="ArrowUp"&&((ot=i.current)==null||ot.scrollBy({top:-100,behavior:"smooth"}))};return window.addEventListener("keydown",rt),()=>{window.removeEventListener("keydown",rt)}},[e,s]),reactExports.useEffect(()=>{at(j,et)},[j]),jsxRuntimeExports.jsxs("div",{ref:i,className:"w-full h-screen bg-linear-to-b from-black to-[#5B0203] px-6 py-8 text-white overflow-y-auto scrollbar-hide",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col md:flex-row items-start justify-between mb-6",children:[jsxRuntimeExports.jsx("h1",{className:"text-[#C02628] text-3xl font-bold mb-2 md:mb-0",children:"Bank Accounts"}),jsxRuntimeExports.jsxs("p",{className:"text-sm md:text-right leading-6 max-w-md",children:["Visit"," ",jsxRuntimeExports.jsx("a",{href:"https://uat.bookmytheatre.com",target:"_blank",rel:"noopener noreferrer",className:"text-[#d94b4b] underline",children:"https://uat.bookmytheatre.com"})," ","for more information"]})]}),b&&jsxRuntimeExports.jsx("p",{className:"text-red-500 text-center mb-4",children:b}),o?jsxRuntimeExports.jsx(SkeletonGrid$1,{count:6}):d.length>0?jsxRuntimeExports.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:d.map((rt,nt)=>jsxRuntimeExports.jsxs("div",{className:"relative bg-linear-to-br from-[#B73A3A] to-[#8B2B2B] rounded-xl p-6 h-56 shadow-lg shadow-black/40 overflow-hidden",children:[jsxRuntimeExports.jsx("img",{src:bankLogo,alt:"Bank Logo",className:"absolute right-3 bottom-3 w-20 h-20 opacity-30"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-white text-xl font-bold mb-1 truncate",children:rt.label||rt.bank_name||"Bank Name"}),jsxRuntimeExports.jsx("p",{className:"text-sm opacity-80 mb-1",children:"Account Number"}),jsxRuntimeExports.jsx("p",{className:"text-lg font-semibold tracking-wider mb-2",children:rt.account_number||"XXXXXXXXXX"}),rt.ifsc_code&&jsxRuntimeExports.jsxs("p",{className:"text-sm opacity-90",children:["IFSC: ",rt.ifsc_code]}),rt.routing_number&&jsxRuntimeExports.jsxs("p",{className:"text-sm opacity-90",children:["Routing: ",rt.routing_number]}),rt.swift_code&&jsxRuntimeExports.jsxs("p",{className:"text-sm opacity-90",children:["SWIFT: ",rt.swift_code]}),rt.iban&&jsxRuntimeExports.jsxs("p",{className:"text-sm opacity-90",children:["IBAN: ",rt.iban]})]})]},nt))}):jsxRuntimeExports.jsx("p",{className:"text-center mt-10 text-lg",children:"No bank accounts found."}),_e>1&&!o&&jsxRuntimeExports.jsxs("div",{className:"flex justify-center items-center gap-6 mt-10",children:[jsxRuntimeExports.jsx("button",{disabled:j<=1,onClick:()=>$(rt=>Math.max(rt-1,1)),className:`px-6 py-2 rounded-full ${j<=1?"bg-gray-600 opacity-50 cursor-not-allowed":"bg-[#C02628] hover:bg-[#a11e1e]"}`,children:"Prev"}),jsxRuntimeExports.jsxs("p",{className:"text-lg",children:["Page ",j," of ",_e]}),jsxRuntimeExports.jsx("button",{disabled:j>=_e,onClick:()=>$(rt=>Math.min(rt+1,_e)),className:`px-6 py-2 rounded-full ${j>=_e?"bg-gray-600 opacity-50 cursor-not-allowed":"bg-[#C02628] hover:bg-[#a11e1e]"}`,children:"Next"})]})]})},SkeletonGrid$1=({count:s=6})=>jsxRuntimeExports.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 w-full",children:Array.from({length:s}).map((e,i)=>jsxRuntimeExports.jsx(SkeletonCard$1,{},i))}),SkeletonCard$1=()=>jsxRuntimeExports.jsx("div",{className:"relative rounded-xl bg-[#282828] p-6 h-56 shadow-lg shadow-black/40 animate-pulse",children:jsxRuntimeExports.jsxs("div",{className:"space-y-3",children:[jsxRuntimeExports.jsx("div",{className:"h-6 bg-gray-600 rounded w-3/4"}),jsxRuntimeExports.jsx("div",{className:"h-4 bg-gray-600 rounded w-1/3"}),jsxRuntimeExports.jsx("div",{className:"h-5 bg-gray-500 rounded w-1/2"}),jsxRuntimeExports.jsx("div",{className:"pt-2"}),jsxRuntimeExports.jsx("div",{className:"h-4 bg-gray-600 rounded w-2/5"})]})}),Affiliate=({onNavigate:s,isActive:e})=>{const i=reactExports.useRef(null);reactExports.useEffect(()=>{if(!e)return;const o=c=>{var d,g;c.key==="ArrowLeft"?s&&s("ArrowLeft"):c.key==="ArrowDown"?(d=i.current)==null||d.scrollBy({top:100,behavior:"smooth"}):c.key==="ArrowUp"&&((g=i.current)==null||g.scrollBy({top:-100,behavior:"smooth"}))};return window.addEventListener("keydown",o),()=>{window.removeEventListener("keydown",o)}},[e,s]);const a=[{title:"How It Works?",desc:`Instant Activation: Purchase a film and instantly get affiliate rights. No extra steps.
Get Your Link: Share your referral link from your dashboard.
Earn As You Share: Earn 30% of net revenue from each successful referral.`},{title:"Transparent Earnings",desc:`Payouts Every Quarter: 90% of earnings paid quarterly to your bank account.
Annual Bonus: 10% of each quarters earnings paid out fully on March 31st each year.`},{title:"Real-Time Dashboard Access",desc:`Viewers / Distributors: Track purchases, earnings, and referral stats.
Filmmakers: Monitor ticket sales, language performance, and impact.`},{title:"Built for Global Impact",desc:`Multilingual film versions
Available worldwide
Scalable, secure real-time infrastructure`}];return jsxRuntimeExports.jsx("div",{ref:i,className:"w-full h-screen flex flex-col bg-linear-to-b from-black to-[#5B0203] text-white overflow-y-auto scrollbar-hide",children:jsxRuntimeExports.jsxs("div",{className:"p-6 pb-8",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center",children:[jsxRuntimeExports.jsx("div",{className:"flex flex-row items-center gap-3",children:jsxRuntimeExports.jsx("h1",{className:"text-3xl font-bold text-white mb-2 sm:mb-0",children:"Affiliate Program"})}),jsxRuntimeExports.jsxs("p",{className:"text-sm text-right",children:["Visit"," ",jsxRuntimeExports.jsx("a",{href:"https://uat.bookmytheatre.com",target:"_blank",rel:"noopener noreferrer",className:"text-[#d94b4b] underline",children:"https://uat.bookmytheatre.com"})," ","for more information"]})]}),jsxRuntimeExports.jsx("h2",{className:"text-lg font-bold mt-6 mb-2",children:"Share & Earn"}),jsxRuntimeExports.jsxs("p",{className:"text-sm text-white/90 leading-6 mb-6 whitespace-pre-line",children:["The Book My Theatre Way",`
`,"Watch. Share. Earn.",`
`,"No Signups. No Barriers.",`
`,"At Book My Theatre, the moment you watch a film  you become more than just a viewer.",`
`,"You become a distributor."]}),jsxRuntimeExports.jsx("div",{className:"space-y-4",children:a.map((o,c)=>jsxRuntimeExports.jsxs("div",{className:"bg-[#B73A3A] rounded-md p-4 shadow-md transition-transform hover:scale-[1.01]",children:[jsxRuntimeExports.jsx("h3",{className:"font-bold text-sm mb-2",children:o.title}),jsxRuntimeExports.jsx("p",{className:"text-xs leading-6 whitespace-pre-line",children:o.desc})]},c))})]})})},Devicedetails=({onNavigate:s,isActive:e})=>{const i=reactExports.useRef(null);return reactExports.useEffect(()=>{if(!e)return;const a=o=>{var c,d;o.key==="ArrowLeft"?s&&s("ArrowLeft"):o.key==="ArrowDown"?(c=i.current)==null||c.scrollBy({top:100,behavior:"smooth"}):o.key==="ArrowUp"&&((d=i.current)==null||d.scrollBy({top:-100,behavior:"smooth"}))};return window.addEventListener("keydown",a),()=>{window.removeEventListener("keydown",a)}},[e,s]),jsxRuntimeExports.jsx("div",{ref:i,className:"w-full h-screen flex flex-col bg-linear-to-b from-black to-[#5B0203] text-white overflow-y-auto scrollbar-hide",children:jsxRuntimeExports.jsxs("div",{className:"p-6 pb-8",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center",children:[jsxRuntimeExports.jsx("div",{className:"flex flex-row items-center gap-3",children:jsxRuntimeExports.jsx("h1",{className:"text-3xl font-bold text-[#d94b4b] mb-2 sm:mb-0",children:"Device Details"})}),jsxRuntimeExports.jsxs("p",{className:"text-sm text-right",children:["Visit"," ",jsxRuntimeExports.jsx("a",{href:"https://uat.bookmytheatre.com",target:"_blank",rel:"noopener noreferrer",className:"text-[#d94b4b] underline",children:"https://uat.bookmytheatre.com"})," ","for more information"]})]}),jsxRuntimeExports.jsxs("div",{className:"mt-6 space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-md font-bold text-white mb-1",children:"ESN"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-300 leading-6",children:"Electronic Serial Number Nj jdduhjfufhnviuvii9weudnc vn vmvkvnvmn hj cffghjkkdjdkkldkncjc37489defdefdmnlnclndlnlnklncdncl"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-md font-bold text-white mb-1",children:"Software Version"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-300 leading-6",children:"0.121.97"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-md font-bold text-white mb-1",children:"Book My Theater Version"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-300 leading-6",children:"0.0012.3"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-md font-bold text-white mb-1",children:"DNS Servers"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-300 leading-6",children:"192.185.0.1"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-md font-bold text-white mb-1",children:"Check your network"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-300 leading-6",children:"Test your internet connection for any problems that might prevent you from using Book My Theatre."})]})]})]})})},paymentLogo=""+new URL("paymenthistory-BcXFvxk5.png",import.meta.url).href,Paymentapi=axios.create({baseURL:`${Config.api_url}/payment/`,withCredentials:!0,headers:{Accept:"application/json","Content-Type":"application/json"}}),PaymentHistory=({onNavigate:s,isActive:e})=>{const i=reactExports.useRef(null),{userInfo:a}=useUserdetails(),[o,c]=reactExports.useState(!1),[d,g]=reactExports.useState([]),[b,_]=reactExports.useState(0),[j,$]=reactExports.useState(""),[_e,tt]=reactExports.useState(1),[et,st]=reactExports.useState(null),at=6,rt=(a==null?void 0:a.uuid)||null;async function nt(it,ot,lt){c(!0);try{const ht=(await Paymentapi.get("getallpayments",{params:{page:it,limit:ot,user_uid:lt}})).data;if(ht.status==="error"){$(ht.message||"Error fetching payments");return}g(ht.paymentdata||[]),_(ht.totalpages||1),$("")}catch(ct){$(ct.message||"Network error")}finally{c(!1)}}return reactExports.useEffect(()=>{if(!e){st(null);return}b>1&&et===null&&st(0);const it=ot=>{var lt,ct;ot.preventDefault(),ot.key==="ArrowLeft"?et===1?st(0):s("ArrowLeft"):ot.key==="ArrowRight"?et===0&&_e<b&&st(1):ot.key==="Enter"?et===0&&_e>1?tt(ht=>Math.max(ht-1,1)):et===1&&_e<b&&tt(ht=>Math.min(ht+1,b)):ot.key==="ArrowDown"?(lt=i.current)==null||lt.scrollBy({top:100,behavior:"smooth"}):ot.key==="ArrowUp"&&((ct=i.current)==null||ct.scrollBy({top:-100,behavior:"smooth"}))};return window.addEventListener("keydown",it),()=>{window.removeEventListener("keydown",it)}},[e,s,et,_e,b]),reactExports.useEffect(()=>{nt(_e,at,rt)},[_e]),jsxRuntimeExports.jsxs("div",{ref:i,className:"w-full h-screen -to-b from-black to-[#5B0203] text-white px-6 py-8 overflow-y-auto scrollbar-hide",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col md:flex-row items-start justify-between mb-6",children:[jsxRuntimeExports.jsx("h1",{className:"text-[#C02628] text-3xl font-bold mb-2 md:mb-0",children:"Payment History"}),jsxRuntimeExports.jsxs("p",{className:"text-sm md:text-right leading-6 max-w-md",children:["Visit"," ",jsxRuntimeExports.jsx("a",{href:"https://uat.bookmytheatre.com",target:"_blank",rel:"noopener noreferrer",className:"text-[#d94b4b] underline",children:"https://uat.bookmytheatre.com"})," ","for more information"]})]}),j&&jsxRuntimeExports.jsx("p",{className:"text-red-500 text-center mb-4",children:j}),o?jsxRuntimeExports.jsx(SkeletonGrid,{count:6}):d&&d.length>0?jsxRuntimeExports.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:d.map((it,ot)=>{var lt;return jsxRuntimeExports.jsxs("div",{className:"relative rounded-xl overflow-hidden bg-linear-to-b from-[#282828] to-[#C02628] p-6 h-56 shadow-lg shadow-black/40",children:[jsxRuntimeExports.jsx("img",{src:paymentLogo,alt:"Payment Logo",className:"absolute right-3 bottom-3 w-20 h-20 opacity-30"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-white text-xl font-bold mb-1 truncate",children:((lt=it.movie_details)==null?void 0:lt.title)||"N/A"}),jsxRuntimeExports.jsx("p",{className:"text-white text-sm opacity-80 mb-1",children:it.payment_ref_uid}),jsxRuntimeExports.jsxs("p",{className:"text-white text-base mb-3",children:["Date:"," ",new Date(it.payment_date_time).toLocaleString("en-IN")]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center bg-white px-2 py-1 rounded-md",children:[jsxRuntimeExports.jsx("span",{className:"h-2 w-2 rounded-full bg-[#0CA201] mr-2"}),jsxRuntimeExports.jsx("p",{className:"text-[#0CA201] text-sm font-semibold",children:it.payment_status})]}),jsxRuntimeExports.jsxs("p",{className:"text-[#36FE27] text-lg font-bold",children:[it.currency_symbol||"",it.amount]})]})]})]},ot)})}):jsxRuntimeExports.jsx("p",{className:"text-center mt-10 text-lg",children:"No payments found."}),b>1&&!o&&jsxRuntimeExports.jsxs("div",{className:"flex justify-center items-center gap-6 mt-10",children:[jsxRuntimeExports.jsx("button",{disabled:_e<=1,onClick:()=>tt(it=>Math.max(it-1,1)),className:`px-6 py-2 rounded-full transition-all duration-200 ${_e<=1?"bg-gray-600 opacity-50 cursor-not-allowed":`bg-[#C02628] hover:bg-[#a11e1e] ${e&&et===0?"scale-110 ring-4 ring-white":""}`}`,children:"Prev"}),jsxRuntimeExports.jsxs("p",{className:"text-lg",children:["Page ",_e," of ",b]}),jsxRuntimeExports.jsx("button",{disabled:_e>=b,onClick:()=>tt(it=>Math.min(it+1,b)),className:`px-6 py-2 rounded-full transition-all duration-200 ${_e>=b?"bg-gray-600 opacity-50 cursor-not-allowed":`bg-[#C02628] hover:bg-[#a11e1e] ${e&&et===1?"scale-110 ring-4 ring-white":""}`}`,children:"Next"})]})]})},SkeletonGrid=({count:s=6})=>jsxRuntimeExports.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 w-full",children:Array.from({length:s}).map((e,i)=>jsxRuntimeExports.jsx(SkeletonCard,{},i))}),SkeletonCard=()=>jsxRuntimeExports.jsx("div",{className:"relative rounded-xl bg-[#282828] p-6 h-56 shadow-lg shadow-black/40 animate-pulse",children:jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsx("div",{className:"h-6 bg-gray-600 rounded w-3/4"}),jsxRuntimeExports.jsx("div",{className:"h-4 bg-gray-600 rounded w-1/2"}),jsxRuntimeExports.jsx("div",{className:"h-4 bg-gray-600 rounded w-5/6"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 pt-2",children:[jsxRuntimeExports.jsx("div",{className:"h-8 bg-gray-500 rounded-md w-24"}),jsxRuntimeExports.jsx("div",{className:"h-7 bg-gray-500 rounded w-20"})]})]})}),accountMenu=[{id:1,label:"Contact Us",icon:"headset",component:"contact"},{id:2,label:"FAQ's",icon:"faq",component:"faqs"},{id:3,label:"All Plans",icon:"plans",component:"plans"},{id:4,label:"About Us",icon:"about",component:"about"},{id:5,label:"Terms of Use",icon:"terms",component:"terms"},{id:6,label:"Privacy Policy",icon:"privacy",component:"privacy"},{id:7,label:"Affiliate Program",icon:"affiliate",component:"affiliate"},{id:8,label:"Bank Accounts",icon:"bank",component:"mybankaccounts"},{id:9,label:"Device Details",icon:"device",component:"Devicedetails"},{id:10,label:"Payment History",icon:"paymenthistory",component:"paymenthistory"},{id:11,label:"Log Out",icon:"logout",component:"logout"}],CircleButton=({item:s,onClick:e,isFocused:i})=>{const a=o=>{const c="cursor-pointer pointer-events-auto";switch(s.icon){case"headset":return jsxRuntimeExports.jsx(IconHeadphones,{size:60,color:o,className:c});case"faq":return jsxRuntimeExports.jsx(IconQuestionMark,{size:60,color:o,className:c});case"plans":return jsxRuntimeExports.jsx(IconFileText,{size:60,color:o,className:c});case"about":return jsxRuntimeExports.jsx(IconUser,{size:60,color:o,className:c});case"terms":return jsxRuntimeExports.jsx(IconFileDescription,{size:60,color:o,className:c});case"privacy":return jsxRuntimeExports.jsx(IconShieldLock,{size:60,color:o,className:c});case"affiliate":return jsxRuntimeExports.jsx(IconUsersGroup,{size:60,color:o,className:c});case"bank":return jsxRuntimeExports.jsx(IconBuildingBank,{size:60,color:o,className:c});case"device":return jsxRuntimeExports.jsx(IconDeviceAnalytics,{size:60,color:o,className:c});case"paymenthistory":return jsxRuntimeExports.jsx(IconTransactionRupee,{size:60,color:o,className:c});case"logout":return jsxRuntimeExports.jsx(IconLogin,{size:60,color:o,className:c});default:return null}};return jsxRuntimeExports.jsxs(motion.button,{onClick:()=>e(s),whileHover:{scale:1.12},transition:{duration:.25},className:`w-44 h-44 rounded-full flex flex-col items-center justify-center text-center shadow-lg cursor-pointer outline-none transition-all duration-200
        ${i?"scale-110 ring-4 ring-white bg-[#A12222]":"bg-[#D9D0C4] hover:shadow-xl"}`,style:{display:"flex",alignItems:"center",justifyContent:"center"},children:[a(i?"#fff":"#1a1a1a"),jsxRuntimeExports.jsx("span",{className:`text-md font-bold cursor-pointer mt-3 px-2 ${i?"text-white":"text-black"}`,children:s.label})]})},Myaccount=({isActive:s,onNavigate:e})=>{const{resetAuthdetails:i}=useUserdetails(),a=useNavigate(),o=async()=>{try{localStorage.removeItem("user_info"),localStorage.removeItem("access_token"),i(),a("/")}catch(_){console.error("Error logging out:",_)}},c=_=>{_.component==="logout"?o():_.component&&a(`/myaccount/${_.component}`)},{selectedIndex:d,containerRef:g}=useDpadNavigation({totalItems:accountMenu.length,columns:8,enabled:s,onEnter:_=>{const j=accountMenu[_];j&&c(j)},onDirectionChange:(_,j)=>{j||e(_)}}),b=()=>jsxRuntimeExports.jsxs("div",{className:"w-full flex flex-col min-h-screen text-white px-6 py-8",children:[jsxRuntimeExports.jsx("h1",{className:"text-4xl font-bold mb-12",children:"My Account"}),jsxRuntimeExports.jsx("div",{className:"flex flex-col gap-6 flex-1",children:jsxRuntimeExports.jsx("div",{className:"flex flex-row flex-wrap gap-12",ref:g,children:accountMenu.map((_,j)=>jsxRuntimeExports.jsx("div",{className:"flex justify-center",children:jsxRuntimeExports.jsx(CircleButton,{item:_,onClick:c,isFocused:s&&d===j})},_.id))})}),jsxRuntimeExports.jsxs("p",{className:"text-md text-right mt-auto",children:["Visit"," ",jsxRuntimeExports.jsx("a",{href:"https://uat.bookmytheatre.com",className:"text-orange-400 underline hover:text-orange-300 transition-colors",target:"_blank",rel:"noopener noreferrer",children:"https://uat.bookmytheatre.com"})," ","for more information"]})]});return jsxRuntimeExports.jsx("div",{className:"flex-1 h-screen overflow-y-auto scrollbar-hide",children:jsxRuntimeExports.jsxs(Routes,{children:[jsxRuntimeExports.jsx(Route,{path:"/",element:b()}),jsxRuntimeExports.jsx(Route,{path:"/about",element:jsxRuntimeExports.jsx(Aboutus,{onBack:()=>a(-1),onNavigate:e,isActive:s})}),jsxRuntimeExports.jsx(Route,{path:"/contact",element:jsxRuntimeExports.jsx(Contactus,{onBack:()=>a(-1),onNavigate:e,isActive:s})}),jsxRuntimeExports.jsx(Route,{path:"/faqs",element:jsxRuntimeExports.jsx(Faq,{onBack:()=>a(-1),onNavigate:e,isActive:s})}),jsxRuntimeExports.jsx(Route,{path:"/plans",element:jsxRuntimeExports.jsx(Allplans,{onBack:()=>a(-1),onNavigate:e,isActive:s})}),jsxRuntimeExports.jsx(Route,{path:"/terms",element:jsxRuntimeExports.jsx(Terms,{onBack:()=>a(-1),onNavigate:e,isActive:s})}),jsxRuntimeExports.jsx(Route,{path:"/privacy",element:jsxRuntimeExports.jsx(Privacypolicy,{onBack:()=>a(-1),onNavigate:e,isActive:s})}),jsxRuntimeExports.jsx(Route,{path:"/affiliate",element:jsxRuntimeExports.jsx(Affiliate,{onBack:()=>a(-1),onNavigate:e,isActive:s})}),jsxRuntimeExports.jsx(Route,{path:"/Devicedetails",element:jsxRuntimeExports.jsx(Devicedetails,{onBack:()=>a(-1),onNavigate:e,isActive:s})}),jsxRuntimeExports.jsx(Route,{path:"/mybankaccounts",element:jsxRuntimeExports.jsx(BankAccountDetails,{onBack:()=>a(-1),onNavigate:e,isActive:s})}),jsxRuntimeExports.jsx(Route,{path:"/paymenthistory",element:jsxRuntimeExports.jsx(PaymentHistory,{onBack:()=>a(-1),onNavigate:e,isActive:s})})]})})},SECTIONS={SIDEBAR:"SIDEBAR",MYACCOUNT:"MYACCOUNT"},MyaccountWrapperPage=()=>{const[s,e]=reactExports.useState(SECTIONS.SIDEBAR),i=reactExports.useCallback((a,o)=>{a==="ArrowRight"&&o===SECTIONS.SIDEBAR?e(SECTIONS.MYACCOUNT):a==="ArrowLeft"&&o===SECTIONS.MYACCOUNT&&e(SECTIONS.SIDEBAR)},[]);return jsxRuntimeExports.jsxs("div",{className:"flex flex-row min-h-screen bg-linear-to-b from-black to-[#5B0203]",children:[jsxRuntimeExports.jsx(Sidebar,{isActive:s===SECTIONS.SIDEBAR,onNavigate:a=>i(a,SECTIONS.SIDEBAR)}),jsxRuntimeExports.jsx(Myaccount,{isActive:s===SECTIONS.MYACCOUNT,onNavigate:a=>i(a,SECTIONS.MYACCOUNT)})]})},IndividualMovieCard=({movie:s})=>{var i;const e=useNavigate();return jsxRuntimeExports.jsxs("div",{className:"bg-[#2f2f2f] rounded-lg flex flex-col gap-2 h-76 overflow-hidden shadow-md hover:shadow-lg transition-shadow duration-200",children:[jsxRuntimeExports.jsx("div",{onClick:()=>e(`/movie/${s.uuid}`),className:"cursor-pointer",children:jsxRuntimeExports.jsx("img",{src:s.main_banner||"https://via.placeholder.com/300x400",alt:s.title,className:"w-full h-32 object-cover rounded-t-lg"})}),jsxRuntimeExports.jsxs("div",{className:"p-4 flex flex-col gap-2 text-white",children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-medium cursor-pointer hover:text-yellow-400 transition-colors",onClick:()=>e(`/movie/${s.uuid}`),children:s.title.length>15?`${s.title.slice(0,10)}...`:s.title}),jsxRuntimeExports.jsxs("p",{className:"text-white/90 text-xs font-poppins",children:[new Date(s.release_date).getFullYear()," "," ",jsxRuntimeExports.jsx("span",{className:"text-white font-light",children:s!=null&&s.duration&&s.duration.includes(":")?`${parseInt(s.duration.split(":")[0],10)}h ${parseInt(s.duration.split(":")[1],10)}m`:"---"}),((i=s==null?void 0:s.languages)==null?void 0:i.length)>0&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:["  ",s.languages.join(", ")]})]}),jsxRuntimeExports.jsx("p",{className:"text-white/80 text-xs font-poppins line-clamp-3",children:s.short_description||"No description available."})]}),jsxRuntimeExports.jsx("div",{className:"pb-3 px-2 mt-auto",children:jsxRuntimeExports.jsxs("button",{onClick:()=>e(`/movie/${s.uuid}`),className:"w-full h-10 bg-linear-to-br from-[#6a6a6a] to-[#5b5b5b] rounded-lg flex items-center justify-center gap-2 hover:from-[#7a7a7a] hover:to-[#646464] transition-all duration-200",children:[jsxRuntimeExports.jsx("span",{className:"text-white text-sm font-semibold",children:"Play Now"}),jsxRuntimeExports.jsx(Play,{size:16,color:"white"})]})})]})},IndividualCardSkeleton=()=>jsxRuntimeExports.jsxs("div",{className:"bg-[#2f2f2f] rounded-lg flex flex-col gap-2 w-44 h-72 mr-4 animate-pulse",children:[jsxRuntimeExports.jsx("div",{className:"w-full h-32 bg-gray-700 rounded-t-lg"}),jsxRuntimeExports.jsxs("div",{className:"p-4 space-y-2",children:[jsxRuntimeExports.jsx("div",{className:"h-4 bg-gray-700 rounded w-3/4"}),jsxRuntimeExports.jsx("div",{className:"h-3 bg-gray-700 rounded w-1/2"}),jsxRuntimeExports.jsx("div",{className:"h-3 bg-gray-700 rounded w-full"}),jsxRuntimeExports.jsx("div",{className:"h-3 bg-gray-700 rounded w-3/4 mt-1"})]})]});function SingleMoviePage(){var Zt;const{uuid:s}=useParams(),e=s,i=useNavigate(),[a,o]=reactExports.useState(null),[c,d]=reactExports.useState([]),[g,b]=reactExports.useState([]),[_,j]=reactExports.useState(!1),[$,_e]=reactExports.useState(!0),[tt,et]=reactExports.useState(!0),[st,at]=reactExports.useState(null),[rt,nt]=reactExports.useState("BUTTONS"),[it,ot]=reactExports.useState({buttons:0,movies:0}),[lt,ct]=reactExports.useState(!0),[ht,dt]=reactExports.useState(!0),[gt,vt]=reactExports.useState(!0),[St,Tt]=reactExports.useState(!0),[Ct,Rt]=reactExports.useState(!0),[bt,pt]=reactExports.useState(!1),[yt,ut]=reactExports.useState(""),[ft,xt]=reactExports.useState(""),[mt,Et]=reactExports.useState(""),{userInfo:At,isLogged:Pt}=useUserdetails(),wt=(At==null?void 0:At.id)||null,It=(At==null?void 0:At.uuid)||null,Mt=(At==null?void 0:At.affiliateCode)||null,Bt=reactExports.useRef([]),Gt=reactExports.useRef([]),Ft=reactExports.useCallback(async()=>{var _t,$t,Ht;if(e)try{dt(!0);const jt=(await Movieapi.get(`movie/${e}`)).data;if(jt.status==="error"){ut({message:jt.message,server_res:jt});return}o(jt.movie_details),ut("")}catch(Vt){ut({message:(($t=(_t=Vt.response)==null?void 0:_t.data)==null?void 0:$t.message)||Vt.message||"Failed to fetch movie details",server_res:((Ht=Vt.response)==null?void 0:Ht.data)||null})}finally{dt(!1)}},[e]),Ut=reactExports.useCallback(async()=>{var _t,$t,Ht;if(e)try{vt(!0);const jt=(await Movieapi.get(`getcastdetails/${e}`)).data;if(jt.status==="error"){ut({message:jt.message,server_res:jt});return}d(jt.cast_details||[]),ut("")}catch(Vt){ut({message:(($t=(_t=Vt.response)==null?void 0:_t.data)==null?void 0:$t.message)||Vt.message||"Failed to fetch cast details",server_res:((Ht=Vt.response)==null?void 0:Ht.data)||null})}finally{vt(!1)}},[e]),Xt=reactExports.useCallback(async()=>{var _t,$t,Ht;if(e)try{Tt(!0);const jt=(await Moviestatapi.get("checkformovieandtrailer",{params:{movie_uid:e}})).data;if(jt.status==="error")throw new Error(jt.message);et(jt.ismovieexists),_e(jt.istrailerexists),at(jt.language_id),ut("")}catch(Vt){ut({message:(($t=(_t=Vt.response)==null?void 0:_t.data)==null?void 0:$t.message)||Vt.message||"Failed to check movie and trailer",server_res:((Ht=Vt.response)==null?void 0:Ht.data)||null})}finally{Tt(!1)}},[e]),kt=reactExports.useCallback(async()=>{var _t,$t,Ht;if(!It||!e){Rt(!1);return}try{Rt(!0);const jt=(await Movieapi.get("/getusermoviepermission",{params:{user_uid:It,movie_uid:e}})).data;if(jt.status==="errorMessage")throw new Error(jt.message);j((jt==null?void 0:jt.isMovieInUserMovies)||!1),ut("")}catch(Vt){ut({message:(($t=(_t=Vt.response)==null?void 0:_t.data)==null?void 0:$t.message)||Vt.message||"Failed to fetch user movie permission",server_res:((Ht=Vt.response)==null?void 0:Ht.data)||null})}finally{Rt(!1)}},[It,e]),Lt=reactExports.useCallback(async()=>{var _t,$t,Ht;try{const jt=(await Movieapi.get("getmoviescourosel")).data;if(jt.status==="error"){ut({message:jt.message,server_res:jt});return}b(jt.movies_carousel_details||[]),ut("")}catch(Vt){ut({message:(($t=(_t=Vt.response)==null?void 0:_t.data)==null?void 0:$t.message)||Vt.message||"Failed to fetch movie carousel",server_res:((Ht=Vt.response)==null?void 0:Ht.data)||null})}},[]),Wt=reactExports.useCallback(async()=>{ut(""),ct(!0),await Promise.all([Ft(),Ut(),Xt(),kt(),Lt()])},[Ft,Ut,Xt,kt,Lt]),Nt=reactExports.useCallback(async(_t,$t)=>{if(!(!wt||!e))try{await Moviestatapi.post("/addwatchhistory",{user_id:wt,movie_uid:e,video_type:_t,watch_time:$t})}catch(Ht){console.error("Failed to add watch history:",Ht)}},[wt,e]),Kt=reactExports.useCallback(async()=>{var _t,$t,Ht;if(!wt||!e){alert("User information is missing");return}try{pt(!0),xt("");const jt=(await Moviestatapi.post("/getmovie",{movie_uid:e,user_id:wt})).data;if(jt.status==="error")throw new Error(jt.message);Nt("Movie",jt.data.watch_time),i("/player",{state:{movie_uuid:e,type:"Movie",user_uid:It,language_Id:st,videoUrl:jt.data.movie_url,movieWatchTime:jt.data.watch_time,referenceUid:jt.data.reference_uid,user_id:wt}})}catch(Vt){xt({message:(($t=(_t=Vt.response)==null?void 0:_t.data)==null?void 0:$t.message)||Vt.message||"Failed to play movie",server_res:((Ht=Vt.response)==null?void 0:Ht.data)||null})}finally{pt(!1)}},[wt,e,It,st,i,Nt]),Qt=reactExports.useCallback(async()=>{var _t,$t,Ht,Vt,jt;try{pt(!0),Et("");const qt=(await Moviestatapi.post("/gettrailer",{movie_uid:e,user_id:wt})).data;if(qt.status==="error")throw new Error(qt.message);Nt("Trailer",0),i("/player",{state:{movie_uuid:e,type:"Trailer",user_uid:It,language_Id:st,videoUrl:qt.trailer_url||((_t=qt.data)==null?void 0:_t.trailer_url),movieWatchTime:0,referenceUid:qt.reference_uid||(($t=qt.data)==null?void 0:$t.reference_uid),user_id:wt}})}catch(er){Et({message:((Vt=(Ht=er.response)==null?void 0:Ht.data)==null?void 0:Vt.message)||er.message||"Failed to play trailer",server_res:((jt=er.response)==null?void 0:jt.data)||null})}finally{pt(!1)}},[wt,e,It,st,i,Nt]),tr=reactExports.useCallback(()=>{if(!Pt){i("/login");return}alert("To buy this movie, please use our mobile app or website.")},[Pt,i]);reactExports.useCallback(()=>{if(!a)return;const _t=a.title||"Check out this movie!",$t=a.short_description||"Watch this amazing movie!",Ht=`${window.location.origin}/movie/${a.uuid}?affiliate=${Mt}`;console.log("Share URL:",`${_t}
${$t}
${Ht}`),alert("Share URL copied to console (TV implementation pending).")},[a,Mt]),reactExports.useEffect(()=>{e&&Wt()},[e,Wt]),reactExports.useEffect(()=>{if(!ht&&!gt&&!St&&!Ct){const $t=setTimeout(()=>ct(!1),200);return()=>clearTimeout($t)}},[ht,gt,St,Ct]);const zt=[];return $&&zt.push("trailer"),(a==null?void 0:a.status)!=="Schedule"&&(Pt&&_&&tt?zt.push("play"):zt.push("buy")),reactExports.useEffect(()=>{const _t=$t=>{var Ht,Vt;switch($t.preventDefault(),rt){case"SIDEBAR":$t.key==="ArrowRight"&&nt("BUTTONS");break;case"BUTTONS":$t.key==="ArrowLeft"?it.buttons===0?nt("SIDEBAR"):ot(qt=>({...qt,buttons:qt.buttons-1})):$t.key==="ArrowRight"?ot(qt=>({...qt,buttons:Math.min(zt.length-1,qt.buttons+1)})):$t.key==="ArrowDown"?g.length>0&&nt("MOVIES"):$t.key==="Enter"&&((Ht=Bt.current[it.buttons])==null||Ht.click());break;case"MOVIES":const jt=7,er=it.movies;if($t.key==="ArrowUp"){const qt=er-jt;qt<0?nt("BUTTONS"):ot(sr=>({...sr,movies:qt}))}else $t.key==="ArrowDown"?ot(qt=>({...qt,movies:Math.min(g.length-1,er+jt)})):$t.key==="ArrowLeft"?er%jt===0?nt("SIDEBAR"):ot(qt=>({...qt,movies:Math.max(0,er-1)})):$t.key==="ArrowRight"?ot(qt=>({...qt,movies:Math.min(g.length-1,er+1)})):$t.key==="Enter"&&((Vt=Gt.current[er])==null||Vt.click());break}};return window.addEventListener("keydown",_t),()=>window.removeEventListener("keydown",_t)},[rt,it,zt.length,g.length]),reactExports.useEffect(()=>{let _t;rt==="BUTTONS"?_t=Bt.current[it.buttons]:rt==="MOVIES"&&(_t=Gt.current[it.movies]),_t&&_t.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})},[rt,it]),reactExports.useEffect(()=>{Gt.current=Gt.current.slice(0,g.length)},[g]),lt||!a?jsxRuntimeExports.jsxs("div",{className:"w-full h-screen bg-linear-to-b from-black to-[#5B0203] flex",children:[jsxRuntimeExports.jsx(Sidebar,{}),jsxRuntimeExports.jsxs("div",{className:"flex-1 overflow-auto",children:[jsxRuntimeExports.jsx("div",{className:"w-full h-[500px] bg-gray-800 animate-pulse"}),jsxRuntimeExports.jsxs("div",{className:"px-6 py-4",children:[jsxRuntimeExports.jsx("div",{className:"w-2/5 h-8 bg-gray-700 rounded mb-3 animate-pulse"}),jsxRuntimeExports.jsx("div",{className:"w-1/3 h-6 bg-gray-700 rounded mb-6 animate-pulse"}),jsxRuntimeExports.jsx("div",{className:"flex gap-4 flex-wrap",children:Array.from({length:6}).map((_t,$t)=>jsxRuntimeExports.jsx(IndividualCardSkeleton,{},$t))})]})]})]}):yt&&!a?jsxRuntimeExports.jsxs("div",{className:"w-full h-screen bg-linear-to-b from-black to-[#5B0203] flex",children:[jsxRuntimeExports.jsx(Sidebar,{}),jsxRuntimeExports.jsx("div",{className:"flex-1 flex items-center justify-center p-6",children:jsxRuntimeExports.jsx(Errorpanelcardview,{errorMessages:yt,retry:Wt})})]}):jsxRuntimeExports.jsxs("div",{className:"w-full h-screen bg-linear-to-b from-black to-[#5B0203] flex text-white",children:[jsxRuntimeExports.jsx(Sidebar,{isActive:rt==="SIDEBAR",isLogged:Pt,forceRedirect:"/login"}),jsxRuntimeExports.jsxs("main",{className:"flex-1 overflow-auto",children:[jsxRuntimeExports.jsxs("div",{className:"w-full h-[650px] bg-center bg-cover relative",style:{backgroundImage:`url('${(a==null?void 0:a.main_banner)||(a==null?void 0:a.main_thumbnail)||"https://via.placeholder.com/1280x720"}')`},children:[jsxRuntimeExports.jsx("div",{className:"absolute inset-0 bg-linear-to-b from-transparent to-black/80"}),jsxRuntimeExports.jsxs("div",{className:"absolute bottom-8 left-8 right-8",children:[jsxRuntimeExports.jsx("h1",{className:"text-5xl font-bold mb-4",children:a==null?void 0:a.title}),jsxRuntimeExports.jsxs("div",{className:"flex gap-4 items-center",children:[$&&jsxRuntimeExports.jsx("button",{onClick:Qt,ref:_t=>Bt.current[zt.indexOf("trailer")]=_t,disabled:bt,tabIndex:0,className:`flex items-center gap-3 px-6 py-3 rounded bg-black/40 transition-all duration-200 ${rt==="BUTTONS"&&it.buttons===zt.indexOf("trailer")?"scale-110 ring-4 ring-white":""}`,children:bt?jsxRuntimeExports.jsx("div",{className:"w-4 h-4 border-white border-t-2 rounded animate-spin"}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Play,{size:18}),jsxRuntimeExports.jsx("span",{className:"text-lg font-bold",children:"Trailer"})]})}),(a==null?void 0:a.status)!=="Schedule"&&(Pt&&_&&tt?jsxRuntimeExports.jsx("button",{onClick:Kt,ref:_t=>Bt.current[zt.indexOf("play")]=_t,disabled:bt,tabIndex:0,className:`flex items-center gap-3 px-6 py-3 rounded bg-[#c02628] transition-all duration-200 ${rt==="BUTTONS"&&it.buttons===zt.indexOf("play")?"scale-110 ring-4 ring-white":""}`,children:bt?jsxRuntimeExports.jsx("div",{className:"w-4 h-4 border-white border-t-2 rounded animate-spin"}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Play,{size:18}),jsxRuntimeExports.jsx("span",{className:"text-lg font-bold",children:"Play"})]})}):jsxRuntimeExports.jsxs("button",{onClick:tr,ref:_t=>Bt.current[zt.indexOf("buy")]=_t,tabIndex:0,className:`flex items-center gap-3 px-6 py-3 rounded bg-[#c02628] transition-all duration-200 ${rt==="BUTTONS"&&it.buttons===zt.indexOf("buy")?"scale-110 ring-4 ring-white":""}`,children:[jsxRuntimeExports.jsx(ShoppingBag,{size:18}),jsxRuntimeExports.jsx("span",{className:"text-lg font-bold",children:"Buy Now"})]}))]})]})]}),jsxRuntimeExports.jsxs("div",{className:"px-8 py-6",children:[ft&&jsxRuntimeExports.jsx(Errorpanelcardview,{errorMessages:ft,retry:Kt}),mt&&jsxRuntimeExports.jsx(Errorpanelcardview,{errorMessages:mt,retry:Qt}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-8",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(SectionHeading,{title:"Details"}),jsxRuntimeExports.jsxs("div",{className:"text-gray-300 mb-4",children:[jsxRuntimeExports.jsxs("div",{className:"mb-2",children:[jsxRuntimeExports.jsx("strong",{children:"Year:"})," ",a!=null&&a.release_date?new Date(a.release_date).getFullYear():"---","|",jsxRuntimeExports.jsx("strong",{children:"Duration:"})," ",a!=null&&a.duration&&a.duration.includes(":")?`${parseInt(a.duration.split(":")[0],10)}h ${parseInt(a.duration.split(":")[1],10)}m`:"---"]}),jsxRuntimeExports.jsxs("div",{className:"mb-2",children:[jsxRuntimeExports.jsx("strong",{children:"Languages:"})," ",((Zt=a==null?void 0:a.languages)==null?void 0:Zt.length)>0?a.languages.join(", "):"---"]}),jsxRuntimeExports.jsxs("div",{className:"mb-2",children:[jsxRuntimeExports.jsx("strong",{children:"Genres:"})," ",Array.isArray(a==null?void 0:a.categories)?a.categories.map(_t=>_t.name).join(", "):"N/A"]})]}),jsxRuntimeExports.jsxs("div",{className:"mb-6",children:[jsxRuntimeExports.jsx("h4",{className:"text-white font-bold mb-2",children:"Description"}),jsxRuntimeExports.jsx("p",{className:"text-gray-300 leading-relaxed",children:(a==null?void 0:a.description)||(a==null?void 0:a.short_description)||"No description available."})]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-xl font-bold mb-3",children:"Cast & Crew"}),jsxRuntimeExports.jsx("div",{className:"flex overflow-x-auto gap-6",children:Array.isArray(c)&&c.length>0?c.map(_t=>jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center w-24",children:[jsxRuntimeExports.jsx("img",{src:_t!=null&&_t.image?encodeURI(_t.image):"https://via.placeholder.com/64",alt:_t==null?void 0:_t.name,className:"w-16 h-16 rounded-full border border-white mb-2 object-cover"}),jsxRuntimeExports.jsx("div",{className:"text-white text-xs text-center font-semibold truncate w-full",children:(_t==null?void 0:_t.name)||"N/A"}),jsxRuntimeExports.jsx("div",{className:"text-gray-400 text-xs text-center truncate w-full",children:(_t==null?void 0:_t.title)||(_t==null?void 0:_t.department)||"N/A"})]},_t.uuid||_t.id)):jsxRuntimeExports.jsx("div",{className:"text-gray-400",children:"No cast details available"})})]})]}),jsxRuntimeExports.jsxs("div",{className:"mt-8",children:[jsxRuntimeExports.jsx(SectionHeading,{title:"More Like This"}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-7 gap-6",children:g.length===0?Array.from({length:8}).map((_t,$t)=>jsxRuntimeExports.jsx(IndividualCardSkeleton,{},$t)):g.map((_t,$t)=>jsxRuntimeExports.jsx("div",{ref:Ht=>Gt.current[$t]=Ht,onClick:()=>i(`/movie/${_t.uuid||_t.id}`),className:`transition-transform duration-200 rounded-lg ${rt==="MOVIES"&&it.movies===$t?"scale-110 ring-4 ring-[#c02628]/50":""}`,tabIndex:0,onFocus:()=>nt("MOVIES"),children:jsxRuntimeExports.jsx(IndividualMovieCard,{movie:_t,onClick:()=>i(`/movie/${_t.uuid||_t.id}`)})},_t.id))})]})]})]})]})}const isFiniteNumber=Number.isFinite||function(s){return typeof s=="number"&&isFinite(s)},isSafeInteger=Number.isSafeInteger||function(s){return typeof s=="number"&&Math.abs(s)<=MAX_SAFE_INTEGER},MAX_SAFE_INTEGER=Number.MAX_SAFE_INTEGER||9007199254740991;let ErrorTypes=function(s){return s.NETWORK_ERROR="networkError",s.MEDIA_ERROR="mediaError",s.KEY_SYSTEM_ERROR="keySystemError",s.MUX_ERROR="muxError",s.OTHER_ERROR="otherError",s}({}),ErrorDetails=function(s){return s.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",s.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",s.KEY_SYSTEM_NO_SESSION="keySystemNoSession",s.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",s.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",s.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",s.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",s.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",s.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",s.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",s.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR="keySystemDestroyMediaKeysError",s.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR="keySystemDestroyCloseSessionError",s.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR="keySystemDestroyRemoveSessionError",s.MANIFEST_LOAD_ERROR="manifestLoadError",s.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",s.MANIFEST_PARSING_ERROR="manifestParsingError",s.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",s.LEVEL_EMPTY_ERROR="levelEmptyError",s.LEVEL_LOAD_ERROR="levelLoadError",s.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",s.LEVEL_PARSING_ERROR="levelParsingError",s.LEVEL_SWITCH_ERROR="levelSwitchError",s.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",s.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",s.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",s.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",s.FRAG_LOAD_ERROR="fragLoadError",s.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",s.FRAG_DECRYPT_ERROR="fragDecryptError",s.FRAG_PARSING_ERROR="fragParsingError",s.FRAG_GAP="fragGap",s.REMUX_ALLOC_ERROR="remuxAllocError",s.KEY_LOAD_ERROR="keyLoadError",s.KEY_LOAD_TIMEOUT="keyLoadTimeOut",s.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",s.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",s.BUFFER_APPEND_ERROR="bufferAppendError",s.BUFFER_APPENDING_ERROR="bufferAppendingError",s.BUFFER_STALLED_ERROR="bufferStalledError",s.BUFFER_FULL_ERROR="bufferFullError",s.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",s.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",s.ASSET_LIST_LOAD_ERROR="assetListLoadError",s.ASSET_LIST_LOAD_TIMEOUT="assetListLoadTimeout",s.ASSET_LIST_PARSING_ERROR="assetListParsingError",s.INTERSTITIAL_ASSET_ITEM_ERROR="interstitialAssetItemError",s.INTERNAL_EXCEPTION="internalException",s.INTERNAL_ABORTED="aborted",s.ATTACH_MEDIA_ERROR="attachMediaError",s.UNKNOWN="unknown",s}({}),Events=function(s){return s.MEDIA_ATTACHING="hlsMediaAttaching",s.MEDIA_ATTACHED="hlsMediaAttached",s.MEDIA_DETACHING="hlsMediaDetaching",s.MEDIA_DETACHED="hlsMediaDetached",s.MEDIA_ENDED="hlsMediaEnded",s.STALL_RESOLVED="hlsStallResolved",s.BUFFER_RESET="hlsBufferReset",s.BUFFER_CODECS="hlsBufferCodecs",s.BUFFER_CREATED="hlsBufferCreated",s.BUFFER_APPENDING="hlsBufferAppending",s.BUFFER_APPENDED="hlsBufferAppended",s.BUFFER_EOS="hlsBufferEos",s.BUFFERED_TO_END="hlsBufferedToEnd",s.BUFFER_FLUSHING="hlsBufferFlushing",s.BUFFER_FLUSHED="hlsBufferFlushed",s.MANIFEST_LOADING="hlsManifestLoading",s.MANIFEST_LOADED="hlsManifestLoaded",s.MANIFEST_PARSED="hlsManifestParsed",s.LEVEL_SWITCHING="hlsLevelSwitching",s.LEVEL_SWITCHED="hlsLevelSwitched",s.LEVEL_LOADING="hlsLevelLoading",s.LEVEL_LOADED="hlsLevelLoaded",s.LEVEL_UPDATED="hlsLevelUpdated",s.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",s.LEVELS_UPDATED="hlsLevelsUpdated",s.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",s.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",s.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",s.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",s.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",s.AUDIO_TRACK_UPDATED="hlsAudioTrackUpdated",s.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",s.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",s.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",s.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",s.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",s.SUBTITLE_TRACK_UPDATED="hlsSubtitleTrackUpdated",s.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",s.CUES_PARSED="hlsCuesParsed",s.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",s.INIT_PTS_FOUND="hlsInitPtsFound",s.FRAG_LOADING="hlsFragLoading",s.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",s.FRAG_LOADED="hlsFragLoaded",s.FRAG_DECRYPTED="hlsFragDecrypted",s.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",s.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",s.FRAG_PARSING_METADATA="hlsFragParsingMetadata",s.FRAG_PARSED="hlsFragParsed",s.FRAG_BUFFERED="hlsFragBuffered",s.FRAG_CHANGED="hlsFragChanged",s.FPS_DROP="hlsFpsDrop",s.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",s.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",s.ERROR="hlsError",s.DESTROYING="hlsDestroying",s.KEY_LOADING="hlsKeyLoading",s.KEY_LOADED="hlsKeyLoaded",s.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",s.BACK_BUFFER_REACHED="hlsBackBufferReached",s.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",s.ASSET_LIST_LOADING="hlsAssetListLoading",s.ASSET_LIST_LOADED="hlsAssetListLoaded",s.INTERSTITIALS_UPDATED="hlsInterstitialsUpdated",s.INTERSTITIALS_BUFFERED_TO_BOUNDARY="hlsInterstitialsBufferedToBoundary",s.INTERSTITIAL_ASSET_PLAYER_CREATED="hlsInterstitialAssetPlayerCreated",s.INTERSTITIAL_STARTED="hlsInterstitialStarted",s.INTERSTITIAL_ASSET_STARTED="hlsInterstitialAssetStarted",s.INTERSTITIAL_ASSET_ENDED="hlsInterstitialAssetEnded",s.INTERSTITIAL_ASSET_ERROR="hlsInterstitialAssetError",s.INTERSTITIAL_ENDED="hlsInterstitialEnded",s.INTERSTITIALS_PRIMARY_RESUMED="hlsInterstitialsPrimaryResumed",s.PLAYOUT_LIMIT_REACHED="hlsPlayoutLimitReached",s.EVENT_CUE_ENTER="hlsEventCueEnter",s}({});var PlaylistContextType={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},PlaylistLevelType={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};class EWMA{constructor(e,i=0,a=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=i,this.totalWeight_=a}sample(e,i){const a=Math.pow(this.alpha_,e);this.estimate_=i*(1-a)+a*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class EwmaBandWidthEstimator{constructor(e,i,a,o=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=a,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new EWMA(e),this.fast_=new EWMA(i),this.defaultTTFB_=o,this.ttfb_=new EWMA(e)}update(e,i){const{slow_:a,fast_:o,ttfb_:c}=this;a.halfLife!==e&&(this.slow_=new EWMA(e,a.getEstimate(),a.getTotalWeight())),o.halfLife!==i&&(this.fast_=new EWMA(i,o.getEstimate(),o.getTotalWeight())),c.halfLife!==e&&(this.ttfb_=new EWMA(e,c.getEstimate(),c.getTotalWeight()))}sample(e,i){e=Math.max(e,this.minDelayMs_);const a=8*i,o=e/1e3,c=a/o;this.fast_.sample(o,c),this.slow_.sample(o,c)}sampleTTFB(e){const i=e/1e3,a=Math.sqrt(2)*Math.exp(-Math.pow(i,2)/2);this.ttfb_.sample(a,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}get defaultEstimate(){return this.defaultEstimate_}destroy(){}}function _defineProperty(s,e,i){return(e=_toPropertyKey(e))in s?Object.defineProperty(s,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):s[e]=i,s}function _extends(){return _extends=Object.assign?Object.assign.bind():function(s){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var a in i)({}).hasOwnProperty.call(i,a)&&(s[a]=i[a])}return s},_extends.apply(null,arguments)}function ownKeys(s,e){var i=Object.keys(s);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(s);e&&(a=a.filter(function(o){return Object.getOwnPropertyDescriptor(s,o).enumerable})),i.push.apply(i,a)}return i}function _objectSpread2(s){for(var e=1;e<arguments.length;e++){var i=arguments[e]!=null?arguments[e]:{};e%2?ownKeys(Object(i),!0).forEach(function(a){_defineProperty(s,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(i)):ownKeys(Object(i)).forEach(function(a){Object.defineProperty(s,a,Object.getOwnPropertyDescriptor(i,a))})}return s}function _toPrimitive(s,e){if(typeof s!="object"||!s)return s;var i=s[Symbol.toPrimitive];if(i!==void 0){var a=i.call(s,e);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}function _toPropertyKey(s){var e=_toPrimitive(s,"string");return typeof e=="symbol"?e:e+""}class Logger{constructor(e,i){this.trace=void 0,this.debug=void 0,this.log=void 0,this.warn=void 0,this.info=void 0,this.error=void 0;const a=`[${e}]:`;this.trace=noop,this.debug=i.debug.bind(null,a),this.log=i.log.bind(null,a),this.warn=i.warn.bind(null,a),this.info=i.info.bind(null,a),this.error=i.error.bind(null,a)}}const noop=function s(){},fakeLogger={trace:noop,debug:noop,log:noop,warn:noop,info:noop,error:noop};function createLogger(){return _extends({},fakeLogger)}function consolePrintFn(s,e){const i=self.console[s];return i?i.bind(self.console,`${e?"["+e+"] ":""}[${s}] >`):noop}function getLoggerFn(s,e,i){return e[s]?e[s].bind(e):consolePrintFn(s,i)}const exportedLogger=createLogger();function enableLogs(s,e,i){const a=createLogger();if(typeof console=="object"&&s===!0||typeof s=="object"){const o=["debug","log","info","warn","error"];o.forEach(c=>{a[c]=getLoggerFn(c,s,i)});try{a.log(`Debug logs enabled for "${e}" in hls.js version 1.6.14`)}catch{return createLogger()}o.forEach(c=>{exportedLogger[c]=getLoggerFn(c,s)})}else _extends(exportedLogger,a);return a}const logger=exportedLogger;function getMediaSource(s=!0){return typeof self>"u"?void 0:(s||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function isManagedMediaSource(s){return typeof self<"u"&&s===self.ManagedMediaSource}function isCompatibleTrackChange(s,e){const i=Object.keys(s),a=Object.keys(e),o=i.length,c=a.length;return!o||!c||o===c&&!i.some(d=>a.indexOf(d)===-1)}function utf8ArrayToStr(s,e=!1){if(typeof TextDecoder<"u"){const _=new TextDecoder("utf-8").decode(s);if(e){const j=_.indexOf("\0");return j!==-1?_.substring(0,j):_}return _.replace(/\0/g,"")}const i=s.length;let a,o,c,d="",g=0;for(;g<i;){if(a=s[g++],a===0&&e)return d;if(a===0||a===3)continue;switch(a>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:d+=String.fromCharCode(a);break;case 12:case 13:o=s[g++],d+=String.fromCharCode((a&31)<<6|o&63);break;case 14:o=s[g++],c=s[g++],d+=String.fromCharCode((a&15)<<12|(o&63)<<6|(c&63)<<0);break}}return d}function arrayToHex(s){let e="";for(let i=0;i<s.length;i++){let a=s[i].toString(16);a.length<2&&(a="0"+a),e+=a}return e}function hexToArrayBuffer(s){return Uint8Array.from(s.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}function getDefaultExportFromCjs(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var urlToolkit={exports:{}},hasRequiredUrlToolkit;function requireUrlToolkit(){return hasRequiredUrlToolkit||(hasRequiredUrlToolkit=1,function(s,e){(function(i){var a=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,o=/^(?=([^\/?#]*))\1([^]*)$/,c=/(?:\/|^)\.(?=\/)/g,d=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,g={buildAbsoluteURL:function(b,_,j){if(j=j||{},b=b.trim(),_=_.trim(),!_){if(!j.alwaysNormalize)return b;var $=g.parseURL(b);if(!$)throw new Error("Error trying to parse base URL.");return $.path=g.normalizePath($.path),g.buildURLFromParts($)}var _e=g.parseURL(_);if(!_e)throw new Error("Error trying to parse relative URL.");if(_e.scheme)return j.alwaysNormalize?(_e.path=g.normalizePath(_e.path),g.buildURLFromParts(_e)):_;var tt=g.parseURL(b);if(!tt)throw new Error("Error trying to parse base URL.");if(!tt.netLoc&&tt.path&&tt.path[0]!=="/"){var et=o.exec(tt.path);tt.netLoc=et[1],tt.path=et[2]}tt.netLoc&&!tt.path&&(tt.path="/");var st={scheme:tt.scheme,netLoc:_e.netLoc,path:null,params:_e.params,query:_e.query,fragment:_e.fragment};if(!_e.netLoc&&(st.netLoc=tt.netLoc,_e.path[0]!=="/"))if(!_e.path)st.path=tt.path,_e.params||(st.params=tt.params,_e.query||(st.query=tt.query));else{var at=tt.path,rt=at.substring(0,at.lastIndexOf("/")+1)+_e.path;st.path=g.normalizePath(rt)}return st.path===null&&(st.path=j.alwaysNormalize?g.normalizePath(_e.path):_e.path),g.buildURLFromParts(st)},parseURL:function(b){var _=a.exec(b);return _?{scheme:_[1]||"",netLoc:_[2]||"",path:_[3]||"",params:_[4]||"",query:_[5]||"",fragment:_[6]||""}:null},normalizePath:function(b){for(b=b.split("").reverse().join("").replace(c,"");b.length!==(b=b.replace(d,"")).length;);return b.split("").reverse().join("")},buildURLFromParts:function(b){return b.scheme+b.netLoc+b.path+b.params+b.query+b.fragment}};s.exports=g})()}(urlToolkit)),urlToolkit.exports}var urlToolkitExports=requireUrlToolkit();class LoadStats{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var ElementaryStreamTypes={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class BaseSegment{constructor(e){this._byteRange=null,this._url=null,this._stats=null,this._streams=null,this.base=void 0,this.relurl=void 0,typeof e=="string"&&(e={url:e}),this.base=e,makeEnumerable(this,"stats")}setByteRange(e,i){const a=e.split("@",2);let o;a.length===1?o=(i==null?void 0:i.byteRangeEndOffset)||0:o=parseInt(a[1]),this._byteRange=[o,parseInt(a[0])+o]}get baseurl(){return this.base.url}get byteRange(){return this._byteRange===null?[]:this._byteRange}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get elementaryStreams(){return this._streams===null&&(this._streams={[ElementaryStreamTypes.AUDIO]:null,[ElementaryStreamTypes.VIDEO]:null,[ElementaryStreamTypes.AUDIOVIDEO]:null}),this._streams}set elementaryStreams(e){this._streams=e}get hasStats(){return this._stats!==null}get hasStreams(){return this._streams!==null}get stats(){return this._stats===null&&(this._stats=new LoadStats),this._stats}set stats(e){this._stats=e}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=urlToolkitExports.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[ElementaryStreamTypes.AUDIO]=null,e[ElementaryStreamTypes.VIDEO]=null,e[ElementaryStreamTypes.AUDIOVIDEO]=null}}function isMediaFragment(s){return s.sn!=="initSegment"}class Fragment extends BaseSegment{constructor(e,i){super(i),this._decryptdata=null,this._programDateTime=null,this._ref=null,this._bitrate=void 0,this.rawProgramDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.playlistOffset=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=e}get byteLength(){if(this.hasStats){const e=this.stats.total;if(e)return e}if(this.byteRange.length){const e=this.byteRange[0],i=this.byteRange[1];if(isFiniteNumber(e)&&isFiniteNumber(i))return i-e}return null}get bitrate(){return this.byteLength?this.byteLength*8/this.duration:this._bitrate?this._bitrate:null}set bitrate(e){this._bitrate=e}get decryptdata(){var e;const{levelkeys:i}=this;if(!i||i.NONE)return null;if(i.identity)this._decryptdata||(this._decryptdata=i.identity.getDecryptData(this.sn));else if(!((e=this._decryptdata)!=null&&e.keyId)){const a=Object.keys(i);if(a.length===1){const o=this._decryptdata=i[a[0]]||null;o&&(this._decryptdata=o.getDecryptData(this.sn,i))}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null)return null;const e=isFiniteNumber(this.duration)?this.duration:0;return this.programDateTime+e*1e3}get encrypted(){var e;if((e=this._decryptdata)!=null&&e.encrypted)return!0;if(this.levelkeys){var i;const a=Object.keys(this.levelkeys),o=a.length;if(o>1||o===1&&(i=this.levelkeys[a[0]])!=null&&i.encrypted)return!0}return!1}get programDateTime(){return this._programDateTime===null&&this.rawProgramDateTime&&(this.programDateTime=Date.parse(this.rawProgramDateTime)),this._programDateTime}set programDateTime(e){if(!isFiniteNumber(e)){this._programDateTime=this.rawProgramDateTime=null;return}this._programDateTime=e}get ref(){return isMediaFragment(this)?(this._ref||(this._ref={base:this.base,start:this.start,duration:this.duration,sn:this.sn,programDateTime:this.programDateTime}),this._ref):null}addStart(e){this.setStart(this.start+e)}setStart(e){this.start=e,this._ref&&(this._ref.start=e)}setDuration(e){this.duration=e,this._ref&&(this._ref.duration=e)}setKeyFormat(e){const i=this.levelkeys;if(i){var a;const o=i[e];o&&!((a=this._decryptdata)!=null&&a.keyId)&&(this._decryptdata=o.getDecryptData(this.sn,i))}}abortRequests(){var e,i;(e=this.loader)==null||e.abort(),(i=this.keyLoader)==null||i.abort()}setElementaryStreamInfo(e,i,a,o,c,d=!1){const{elementaryStreams:g}=this,b=g[e];if(!b){g[e]={startPTS:i,endPTS:a,startDTS:o,endDTS:c,partial:d};return}b.startPTS=Math.min(b.startPTS,i),b.endPTS=Math.max(b.endPTS,a),b.startDTS=Math.min(b.startDTS,o),b.endDTS=Math.max(b.endDTS,c)}}class Part extends BaseSegment{constructor(e,i,a,o,c){super(a),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=i,this.index=o;const d=e.enumeratedString("BYTERANGE");d&&this.setByteRange(d,c),c&&(this.fragOffset=c.fragOffset+c.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}function getOwnPropertyDescriptorFromPrototypeChain(s,e){const i=Object.getPrototypeOf(s);if(i){const a=Object.getOwnPropertyDescriptor(i,e);return a||getOwnPropertyDescriptorFromPrototypeChain(i,e)}}function makeEnumerable(s,e){const i=getOwnPropertyDescriptorFromPrototypeChain(s,e);i&&(i.enumerable=!0,Object.defineProperty(s,e,i))}const UINT32_MAX$1=Math.pow(2,32)-1,push=[].push,RemuxerTrackIdConfig={video:1,audio:2,id3:3,text:4};function bin2str(s){return String.fromCharCode.apply(null,s)}function readUint16(s,e){const i=s[e]<<8|s[e+1];return i<0?65536+i:i}function readUint32(s,e){const i=readSint32(s,e);return i<0?4294967296+i:i}function readUint64(s,e){let i=readUint32(s,e);return i*=Math.pow(2,32),i+=readUint32(s,e+4),i}function readSint32(s,e){return s[e]<<24|s[e+1]<<16|s[e+2]<<8|s[e+3]}function hasMoofData(s){const e=s.byteLength;for(let i=0;i<e;){const a=readUint32(s,i);if(a>8&&s[i+4]===109&&s[i+5]===111&&s[i+6]===111&&s[i+7]===102)return!0;i=a>1?i+a:e}return!1}function findBox(s,e){const i=[];if(!e.length)return i;const a=s.byteLength;for(let o=0;o<a;){const c=readUint32(s,o),d=bin2str(s.subarray(o+4,o+8)),g=c>1?o+c:a;if(d===e[0])if(e.length===1)i.push(s.subarray(o+8,g));else{const b=findBox(s.subarray(o+8,g),e.slice(1));b.length&&push.apply(i,b)}o=g}return i}function parseSegmentIndex(s){const e=[],i=s[0];let a=8;const o=readUint32(s,a);a+=4;let c=0,d=0;i===0?(c=readUint32(s,a),d=readUint32(s,a+4),a+=8):(c=readUint64(s,a),d=readUint64(s,a+8),a+=16),a+=2;let g=s.length+d;const b=readUint16(s,a);a+=2;for(let _=0;_<b;_++){let j=a;const $=readUint32(s,j);j+=4;const _e=$&2147483647;if(($&2147483648)>>>31===1)return logger.warn("SIDX has hierarchical references (not supported)"),null;const et=readUint32(s,j);j+=4,e.push({referenceSize:_e,subsegmentDuration:et,info:{duration:et/o,start:g,end:g+_e-1}}),g+=_e,j+=4,a=j}return{earliestPresentationTime:c,timescale:o,version:i,referencesCount:b,references:e}}function parseInitSegment(s){const e=[],i=findBox(s,["moov","trak"]);for(let o=0;o<i.length;o++){const c=i[o],d=findBox(c,["tkhd"])[0];if(d){let g=d[0];const b=readUint32(d,g===0?12:20),_=findBox(c,["mdia","mdhd"])[0];if(_){g=_[0];const j=readUint32(_,g===0?12:20),$=findBox(c,["mdia","hdlr"])[0];if($){const _e=bin2str($.subarray(8,12)),tt={soun:ElementaryStreamTypes.AUDIO,vide:ElementaryStreamTypes.VIDEO}[_e],et=findBox(c,["mdia","minf","stbl","stsd"])[0],st=parseStsd(et);tt?(e[b]={timescale:j,type:tt,stsd:st},e[tt]=_objectSpread2({timescale:j,id:b},st)):e[b]={timescale:j,type:_e,stsd:st}}}}}return findBox(s,["moov","mvex","trex"]).forEach(o=>{const c=readUint32(o,4),d=e[c];d&&(d.default={duration:readUint32(o,12),flags:readUint32(o,20)})}),e}function parseStsd(s){const e=s.subarray(8),i=e.subarray(86),a=bin2str(e.subarray(4,8));let o=a,c;const d=a==="enca"||a==="encv";if(d){const _=findBox(e,[a])[0].subarray(a==="enca"?28:78);findBox(_,["sinf"]).forEach($=>{const _e=findBox($,["schm"])[0];if(_e){const tt=bin2str(_e.subarray(4,8));if(tt==="cbcs"||tt==="cenc"){const et=findBox($,["frma"])[0];et&&(o=bin2str(et))}}})}const g=o;switch(o){case"avc1":case"avc2":case"avc3":case"avc4":{const b=findBox(i,["avcC"])[0];b&&b.length>3&&(o+="."+toHex(b[1])+toHex(b[2])+toHex(b[3]),c=parseSupplementalDoViCodec(g==="avc1"?"dva1":"dvav",i));break}case"mp4a":{const b=findBox(e,[a])[0],_=findBox(b.subarray(28),["esds"])[0];if(_&&_.length>7){let j=4;if(_[j++]!==3)break;j=skipBERInteger(_,j),j+=2;const $=_[j++];if($&128&&(j+=2),$&64&&(j+=_[j++]),_[j++]!==4)break;j=skipBERInteger(_,j);const _e=_[j++];if(_e===64)o+="."+toHex(_e);else break;if(j+=12,_[j++]!==5)break;j=skipBERInteger(_,j);const tt=_[j++];let et=(tt&248)>>3;et===31&&(et+=1+((tt&7)<<3)+((_[j]&224)>>5)),o+="."+et}break}case"hvc1":case"hev1":{const b=findBox(i,["hvcC"])[0];if(b&&b.length>12){const _=b[1],j=["","A","B","C"][_>>6],$=_&31,_e=readUint32(b,2),tt=(_&32)>>5?"H":"L",et=b[12],st=b.subarray(6,12);o+="."+j+$,o+="."+reverse32BitInt(_e).toString(16).toUpperCase(),o+="."+tt+et;let at="";for(let rt=st.length;rt--;){const nt=st[rt];(nt||at)&&(at="."+nt.toString(16).toUpperCase()+at)}o+=at}c=parseSupplementalDoViCodec(g=="hev1"?"dvhe":"dvh1",i);break}case"dvh1":case"dvhe":case"dvav":case"dva1":case"dav1":{o=parseSupplementalDoViCodec(o,i)||o;break}case"vp09":{const b=findBox(i,["vpcC"])[0];if(b&&b.length>6){const _=b[4],j=b[5],$=b[6]>>4&15;o+="."+addLeadingZero(_)+"."+addLeadingZero(j)+"."+addLeadingZero($)}break}case"av01":{const b=findBox(i,["av1C"])[0];if(b&&b.length>2){const _=b[1]>>>5,j=b[1]&31,$=b[2]>>>7?"H":"M",_e=(b[2]&64)>>6,tt=(b[2]&32)>>5,et=_===2&&_e?tt?12:10:_e?10:8,st=(b[2]&16)>>4,at=(b[2]&8)>>3,rt=(b[2]&4)>>2,nt=b[2]&3;o+="."+_+"."+addLeadingZero(j)+$+"."+addLeadingZero(et)+"."+st+"."+at+rt+nt+"."+addLeadingZero(1)+"."+addLeadingZero(1)+"."+addLeadingZero(1)+"."+0,c=parseSupplementalDoViCodec("dav1",i)}break}}return{codec:o,encrypted:d,supplemental:c}}function parseSupplementalDoViCodec(s,e){const i=findBox(e,["dvvC"]),a=i.length?i[0]:findBox(e,["dvcC"])[0];if(a){const o=a[2]>>1&127,c=a[2]<<5&32|a[3]>>3&31;return s+"."+addLeadingZero(o)+"."+addLeadingZero(c)}}function reverse32BitInt(s){let e=0;for(let i=0;i<32;i++)e|=(s>>i&1)<<31-i;return e>>>0}function skipBERInteger(s,e){const i=e+5;for(;s[e++]&128&&e<i;);return e}function toHex(s){return("0"+s.toString(16).toUpperCase()).slice(-2)}function addLeadingZero(s){return(s<10?"0":"")+s}function patchEncyptionData(s,e){if(!s||!e)return;const i=e.keyId;i&&e.isCommonEncryption&&applyToTencBoxes(s,(a,o)=>{const c=a.subarray(8,24);c.some(d=>d!==0)||(logger.log(`[eme] Patching keyId in 'enc${o?"a":"v"}>sinf>>tenc' box: ${arrayToHex(c)} -> ${arrayToHex(i)}`),a.set(i,8))})}function parseKeyIdsFromTenc(s){const e=[];return applyToTencBoxes(s,i=>e.push(i.subarray(8,24))),e}function applyToTencBoxes(s,e){findBox(s,["moov","trak"]).forEach(a=>{const o=findBox(a,["mdia","minf","stbl","stsd"])[0];if(!o)return;const c=o.subarray(8);let d=findBox(c,["enca"]);const g=d.length>0;g||(d=findBox(c,["encv"])),d.forEach(b=>{const _=g?b.subarray(28):b.subarray(78);findBox(_,["sinf"]).forEach($=>{const _e=parseSinf($);_e&&e(_e,g)})})})}function parseSinf(s){const e=findBox(s,["schm"])[0];if(e){const i=bin2str(e.subarray(4,8));if(i==="cbcs"||i==="cenc"){const a=findBox(s,["schi","tenc"])[0];if(a)return a}}}function getSampleData(s,e,i){const a={},o=findBox(s,["moof","traf"]);for(let c=0;c<o.length;c++){const d=o[c],g=findBox(d,["tfhd"])[0],b=readUint32(g,4),_=e[b];if(!_)continue;a[b]||(a[b]={start:NaN,duration:0,sampleCount:0,timescale:_.timescale,type:_.type});const j=a[b],$=findBox(d,["tfdt"])[0];if($){const it=$[0];let ot=readUint32($,4);it===1&&(ot===UINT32_MAX$1?i.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"):(ot*=UINT32_MAX$1+1,ot+=readUint32($,8))),isFiniteNumber(ot)&&(!isFiniteNumber(j.start)||ot<j.start)&&(j.start=ot)}const _e=_.default,tt=readUint32(g,0)|(_e==null?void 0:_e.flags);let et=(_e==null?void 0:_e.duration)||0;tt&8&&(tt&2?et=readUint32(g,12):et=readUint32(g,8));const st=findBox(d,["trun"]);let at=j.start||0,rt=0,nt=et;for(let it=0;it<st.length;it++){const ot=st[it],lt=readUint32(ot,4),ct=j.sampleCount;j.sampleCount+=lt;const ht=ot[3]&1,dt=ot[3]&4,gt=ot[2]&1,vt=ot[2]&2,St=ot[2]&4,Tt=ot[2]&8;let Ct=8,Rt=lt;for(ht&&(Ct+=4),dt&&lt&&(!(ot[Ct+1]&1)&&j.keyFrameIndex===void 0&&(j.keyFrameIndex=ct),Ct+=4,gt?(nt=readUint32(ot,Ct),Ct+=4):nt=et,vt&&(Ct+=4),Tt&&(Ct+=4),at+=nt,rt+=nt,Rt--);Rt--;)gt?(nt=readUint32(ot,Ct),Ct+=4):nt=et,vt&&(Ct+=4),St&&(ot[Ct+1]&1||j.keyFrameIndex===void 0&&(j.keyFrameIndex=j.sampleCount-(Rt+1),j.keyFrameStart=at),Ct+=4),Tt&&(Ct+=4),at+=nt,rt+=nt;!rt&&et&&(rt+=et*lt)}j.duration+=rt}if(!Object.keys(a).some(c=>a[c].duration)){let c=1/0,d=0;const g=findBox(s,["sidx"]);for(let b=0;b<g.length;b++){const _=parseSegmentIndex(g[b]);if(_!=null&&_.references){c=Math.min(c,_.earliestPresentationTime/_.timescale);const j=_.references.reduce(($,_e)=>$+_e.info.duration||0,0);d=Math.max(d,j+_.earliestPresentationTime/_.timescale)}}d&&isFiniteNumber(d)&&Object.keys(a).forEach(b=>{a[b].duration||(a[b].duration=d*a[b].timescale-a[b].start)})}return a}function segmentValidRange(s){const e={valid:null,remainder:null},i=findBox(s,["moof"]);if(i.length<2)return e.remainder=s,e;const a=i[i.length-1];return e.valid=s.slice(0,a.byteOffset-8),e.remainder=s.slice(a.byteOffset-8),e}function appendUint8Array(s,e){const i=new Uint8Array(s.length+e.length);return i.set(s),i.set(e,s.length),i}function parseSamples(s,e){const i=[],a=e.samples,o=e.timescale,c=e.id;let d=!1;return findBox(a,["moof"]).map(b=>{const _=b.byteOffset-8;findBox(b,["traf"]).map($=>{const _e=findBox($,["tfdt"]).map(tt=>{const et=tt[0];let st=readUint32(tt,4);return et===1&&(st*=Math.pow(2,32),st+=readUint32(tt,8)),st/o})[0];return _e!==void 0&&(s=_e),findBox($,["tfhd"]).map(tt=>{const et=readUint32(tt,4),st=readUint32(tt,0)&16777215,at=(st&1)!==0,rt=(st&2)!==0,nt=(st&8)!==0;let it=0;const ot=(st&16)!==0;let lt=0;const ct=(st&32)!==0;let ht=8;et===c&&(at&&(ht+=8),rt&&(ht+=4),nt&&(it=readUint32(tt,ht),ht+=4),ot&&(lt=readUint32(tt,ht),ht+=4),ct&&(ht+=4),e.type==="video"&&(d=isHEVC(e.codec)),findBox($,["trun"]).map(dt=>{const gt=dt[0],vt=readUint32(dt,0)&16777215,St=(vt&1)!==0;let Tt=0;const Ct=(vt&4)!==0,Rt=(vt&256)!==0;let bt=0;const pt=(vt&512)!==0;let yt=0;const ut=(vt&1024)!==0,ft=(vt&2048)!==0;let xt=0;const mt=readUint32(dt,4);let Et=8;St&&(Tt=readUint32(dt,Et),Et+=4),Ct&&(Et+=4);let At=Tt+_;for(let Pt=0;Pt<mt;Pt++){if(Rt?(bt=readUint32(dt,Et),Et+=4):bt=it,pt?(yt=readUint32(dt,Et),Et+=4):yt=lt,ut&&(Et+=4),ft&&(gt===0?xt=readUint32(dt,Et):xt=readSint32(dt,Et),Et+=4),e.type===ElementaryStreamTypes.VIDEO){let wt=0;for(;wt<yt;){const It=readUint32(a,At);if(At+=4,isSEIMessage(d,a[At])){const Mt=a.subarray(At,At+It);parseSEIMessageFromNALu(Mt,d?2:1,s+xt/o,i)}At+=It,wt+=It+4}}s+=bt/o}}))})})}),i}function isHEVC(s){if(!s)return!1;const e=s.substring(0,4);return e==="hvc1"||e==="hev1"||e==="dvh1"||e==="dvhe"}function isSEIMessage(s,e){if(s){const i=e>>1&63;return i===39||i===40}else return(e&31)===6}function parseSEIMessageFromNALu(s,e,i,a){const o=discardEPB(s);let c=0;c+=e;let d=0,g=0,b=0;for(;c<o.length;){d=0;do{if(c>=o.length)break;b=o[c++],d+=b}while(b===255);g=0;do{if(c>=o.length)break;b=o[c++],g+=b}while(b===255);const _=o.length-c;let j=c;if(g<_)c+=g;else if(g>_){logger.error(`Malformed SEI payload. ${g} is too small, only ${_} bytes left to parse.`);break}if(d===4){if(o[j++]===181){const _e=readUint16(o,j);if(j+=2,_e===49){const tt=readUint32(o,j);if(j+=4,tt===1195456820){const et=o[j++];if(et===3){const st=o[j++],at=31&st,rt=64&st,nt=rt?2+at*3:0,it=new Uint8Array(nt);if(rt){it[0]=st;for(let ot=1;ot<nt;ot++)it[ot]=o[j++]}a.push({type:et,payloadType:d,pts:i,bytes:it})}}}}}else if(d===5&&g>16){const $=[];for(let et=0;et<16;et++){const st=o[j++].toString(16);$.push(st.length==1?"0"+st:st),(et===3||et===5||et===7||et===9)&&$.push("-")}const _e=g-16,tt=new Uint8Array(_e);for(let et=0;et<_e;et++)tt[et]=o[j++];a.push({payloadType:d,pts:i,uuid:$.join(""),userData:utf8ArrayToStr(tt),userDataBytes:tt})}}}function discardEPB(s){const e=s.byteLength,i=[];let a=1;for(;a<e-2;)s[a]===0&&s[a+1]===0&&s[a+2]===3?(i.push(a+2),a+=2):a++;if(i.length===0)return s;const o=e-i.length,c=new Uint8Array(o);let d=0;for(a=0;a<o;d++,a++)d===i[0]&&(d++,i.shift()),c[a]=s[d];return c}function parseEmsg(s){const e=s[0];let i="",a="",o=0,c=0,d=0,g=0,b=0,_=0;if(e===0){for(;bin2str(s.subarray(_,_+1))!=="\0";)i+=bin2str(s.subarray(_,_+1)),_+=1;for(i+=bin2str(s.subarray(_,_+1)),_+=1;bin2str(s.subarray(_,_+1))!=="\0";)a+=bin2str(s.subarray(_,_+1)),_+=1;a+=bin2str(s.subarray(_,_+1)),_+=1,o=readUint32(s,12),c=readUint32(s,16),g=readUint32(s,20),b=readUint32(s,24),_=28}else if(e===1){_+=4,o=readUint32(s,_),_+=4;const $=readUint32(s,_);_+=4;const _e=readUint32(s,_);for(_+=4,d=2**32*$+_e,isSafeInteger(d)||(d=Number.MAX_SAFE_INTEGER,logger.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),g=readUint32(s,_),_+=4,b=readUint32(s,_),_+=4;bin2str(s.subarray(_,_+1))!=="\0";)i+=bin2str(s.subarray(_,_+1)),_+=1;for(i+=bin2str(s.subarray(_,_+1)),_+=1;bin2str(s.subarray(_,_+1))!=="\0";)a+=bin2str(s.subarray(_,_+1)),_+=1;a+=bin2str(s.subarray(_,_+1)),_+=1}const j=s.subarray(_,s.byteLength);return{schemeIdUri:i,value:a,timeScale:o,presentationTime:d,presentationTimeDelta:c,eventDuration:g,id:b,payload:j}}function mp4Box(s,...e){const i=e.length;let a=8,o=i;for(;o--;)a+=e[o].byteLength;const c=new Uint8Array(a);for(c[0]=a>>24&255,c[1]=a>>16&255,c[2]=a>>8&255,c[3]=a&255,c.set(s,4),o=0,a=8;o<i;o++)c.set(e[o],a),a+=e[o].byteLength;return c}function mp4pssh(s,e,i){if(s.byteLength!==16)throw new RangeError("Invalid system id");let a,o;a=0,o=new Uint8Array;let c;a>0?(c=new Uint8Array(4),e.length>0&&new DataView(c.buffer).setUint32(0,e.length,!1)):c=new Uint8Array;const d=new Uint8Array(4);return i.byteLength>0&&new DataView(d.buffer).setUint32(0,i.byteLength,!1),mp4Box([112,115,115,104],new Uint8Array([a,0,0,0]),s,c,o,d,i)}function parseMultiPssh(s){const e=[];if(s instanceof ArrayBuffer){const i=s.byteLength;let a=0;for(;a+32<i;){const o=new DataView(s,a),c=parsePssh(o);e.push(c),a+=c.size}}return e}function parsePssh(s){const e=s.getUint32(0),i=s.byteOffset,a=s.byteLength;if(a<e)return{offset:i,size:a};if(s.getUint32(4)!==1886614376)return{offset:i,size:e};const c=s.getUint32(8)>>>24;if(c!==0&&c!==1)return{offset:i,size:e};const d=s.buffer,g=arrayToHex(new Uint8Array(d,i+12,16));let b=null,_=null,j=0;if(c===0)j=28;else{const _e=s.getUint32(28);if(!_e||a<32+_e*16)return{offset:i,size:e};b=[];for(let tt=0;tt<_e;tt++)b.push(new Uint8Array(d,i+32+tt*16,16));j=32+_e*16}if(!j)return{offset:i,size:e};const $=s.getUint32(j);return e-32<$?{offset:i,size:e}:(_=new Uint8Array(d,i+j+4,$),{version:c,systemId:g,kids:b,data:_,offset:i,size:e})}const userAgentHevcSupportIsInaccurate=()=>/\(Windows.+Firefox\//i.test(navigator.userAgent),sampleEntryCodesISO={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,dav1:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function isCodecType(s,e){const i=sampleEntryCodesISO[e];return!!i&&!!i[s.slice(0,4)]}function areCodecsMediaSourceSupported(s,e,i=!0){return!s.split(",").some(a=>!isCodecMediaSourceSupported(a,e,i))}function isCodecMediaSourceSupported(s,e,i=!0){var a;const o=getMediaSource(i);return(a=o==null?void 0:o.isTypeSupported(mimeTypeForCodec(s,e)))!=null?a:!1}function mimeTypeForCodec(s,e){return`${e}/mp4;codecs=${s}`}function videoCodecPreferenceValue(s){if(s){const e=s.substring(0,4);return sampleEntryCodesISO.video[e]}return 2}function codecsSetSelectionPreferenceValue(s){const e=userAgentHevcSupportIsInaccurate();return s.split(",").reduce((i,a)=>{const c=e&&isHEVC(a)?9:sampleEntryCodesISO.video[a];return c?(c*2+i)/(i?3:2):(sampleEntryCodesISO.audio[a]+i)/(i?2:1)},0)}const CODEC_COMPATIBLE_NAMES={};function getCodecCompatibleNameLower(s,e=!0){if(CODEC_COMPATIBLE_NAMES[s])return CODEC_COMPATIBLE_NAMES[s];const i={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"],"mp4a.40.34":["mp3"]}[s];for(let o=0;o<i.length;o++){var a;if(isCodecMediaSourceSupported(i[o],"audio",e))return CODEC_COMPATIBLE_NAMES[s]=i[o],i[o];if(i[o]==="mp3"&&(a=getMediaSource(e))!=null&&a.isTypeSupported("audio/mpeg"))return""}return s}const AUDIO_CODEC_REGEXP=/flac|opus|mp4a\.40\.34/i;function getCodecCompatibleName(s,e=!0){return s.replace(AUDIO_CODEC_REGEXP,i=>getCodecCompatibleNameLower(i.toLowerCase(),e))}function replaceVideoCodec(s,e){const i=[];if(s){const a=s.split(",");for(let o=0;o<a.length;o++)isCodecType(a[o],"video")||i.push(a[o])}return e&&i.push(e),i.join(",")}function pickMostCompleteCodecName(s,e){if(s&&(s.length>4||["ac-3","ec-3","alac","fLaC","Opus"].indexOf(s)!==-1)&&(isCodecSupportedAsType(s,"audio")||isCodecSupportedAsType(s,"video")))return s;if(e){const i=e.split(",");if(i.length>1){if(s){for(let a=i.length;a--;)if(i[a].substring(0,4)===s.substring(0,4))return i[a]}return i[0]}}return e||s}function isCodecSupportedAsType(s,e){return isCodecType(s,e)&&isCodecMediaSourceSupported(s,e)}function convertAVC1ToAVCOTI(s){const e=s.split(",");for(let i=0;i<e.length;i++){const a=e[i].split(".");a.length>2&&a[0]==="avc1"&&(e[i]=`avc1.${parseInt(a[1]).toString(16)}${("000"+parseInt(a[2]).toString(16)).slice(-4)}`)}return e.join(",")}function fillInMissingAV01Params(s){if(s.startsWith("av01.")){const e=s.split("."),i=["0","111","01","01","01","0"];for(let a=e.length;a>4&&a<10;a++)e[a]=i[a-4];return e.join(".")}return s}function getM2TSSupportedAudioTypes(s){const e=getMediaSource(s)||{isTypeSupported:()=>!1};return{mpeg:e.isTypeSupported("audio/mpeg"),mp3:e.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:e.isTypeSupported('audio/mp4; codecs="ac-3"')}}function getCodecsForMimeType(s){return s.replace(/^.+codecs=["']?([^"']+).*$/,"$1")}const supportedResult={supported:!0,powerEfficient:!0,smooth:!0},unsupportedResult={supported:!1,smooth:!1,powerEfficient:!1},SUPPORTED_INFO_DEFAULT={supported:!0,configurations:[],decodingInfoResults:[supportedResult]};function getUnsupportedResult(s,e){return{supported:!1,configurations:e,decodingInfoResults:[unsupportedResult],error:s}}function requiresMediaCapabilitiesDecodingInfo(s,e,i,a,o,c){const d=s.videoCodec,g=s.audioCodec?s.audioGroups:null,b=c==null?void 0:c.audioCodec,_=c==null?void 0:c.channels,j=_?parseInt(_):b?1/0:2;let $=null;if(g!=null&&g.length)try{g.length===1&&g[0]?$=e.groups[g[0]].channels:$=g.reduce((_e,tt)=>{if(tt){const et=e.groups[tt];if(!et)throw new Error(`Audio track group ${tt} not found`);Object.keys(et.channels).forEach(st=>{_e[st]=(_e[st]||0)+et.channels[st]})}return _e},{2:0})}catch{return!0}return d!==void 0&&(d.split(",").some(_e=>isHEVC(_e))||s.width>1920&&s.height>1088||s.height>1920&&s.width>1088||s.frameRate>Math.max(a,30)||s.videoRange!=="SDR"&&s.videoRange!==i||s.bitrate>Math.max(o,8e6))||!!$&&isFiniteNumber(j)&&Object.keys($).some(_e=>parseInt(_e)>j)}function getMediaDecodingInfoPromise(s,e,i,a={}){const o=s.videoCodec;if(!o&&!s.audioCodec||!i)return Promise.resolve(SUPPORTED_INFO_DEFAULT);const c=[],d=makeVideoConfigurations(s),g=d.length,b=makeAudioConfigurations(s,e,g>0),_=b.length;for(let j=g||1*_||1;j--;){const $={type:"media-source"};if(g&&($.video=d[j%g]),_){$.audio=b[j%_];const _e=$.audio.bitrate;$.video&&_e&&($.video.bitrate-=_e)}c.push($)}if(o){const j=navigator.userAgent;if(o.split(",").some($=>isHEVC($))&&userAgentHevcSupportIsInaccurate())return Promise.resolve(getUnsupportedResult(new Error(`Overriding Windows Firefox HEVC MediaCapabilities result based on user-agent string: (${j})`),c))}return Promise.all(c.map(j=>{const $=getMediaDecodingInfoKey(j);return a[$]||(a[$]=i.decodingInfo(j))})).then(j=>({supported:!j.some($=>!$.supported),configurations:c,decodingInfoResults:j})).catch(j=>({supported:!1,configurations:c,decodingInfoResults:[],error:j}))}function makeVideoConfigurations(s){var e;const i=(e=s.videoCodec)==null?void 0:e.split(","),a=getVariantDecodingBitrate(s),o=s.width||640,c=s.height||480,d=s.frameRate||30,g=s.videoRange.toLowerCase();return i?i.map(b=>{const _={contentType:mimeTypeForCodec(fillInMissingAV01Params(b),"video"),width:o,height:c,bitrate:a,framerate:d};return g!=="sdr"&&(_.transferFunction=g),_}):[]}function makeAudioConfigurations(s,e,i){var a;const o=(a=s.audioCodec)==null?void 0:a.split(","),c=getVariantDecodingBitrate(s);return o&&s.audioGroups?s.audioGroups.reduce((d,g)=>{var b;const _=g?(b=e.groups[g])==null?void 0:b.tracks:null;return _?_.reduce((j,$)=>{if($.groupId===g){const _e=parseFloat($.channels||"");o.forEach(tt=>{const et={contentType:mimeTypeForCodec(tt,"audio"),bitrate:i?estimatedAudioBitrate(tt,c):c};_e&&(et.channels=""+_e),j.push(et)})}return j},d):d},[]):[]}function estimatedAudioBitrate(s,e){if(e<=1)return 1;let i=128e3;return s==="ec-3"?i=768e3:s==="ac-3"&&(i=64e4),Math.min(e/2,i)}function getVariantDecodingBitrate(s){return Math.ceil(Math.max(s.bitrate*.9,s.averageBitrate)/1e3)*1e3||1}function getMediaDecodingInfoKey(s){let e="";const{audio:i,video:a}=s;if(a){const o=getCodecsForMimeType(a.contentType);e+=`${o}_r${a.height}x${a.width}f${Math.ceil(a.framerate)}${a.transferFunction||"sd"}_${Math.ceil(a.bitrate/1e5)}`}if(i){const o=getCodecsForMimeType(i.contentType);e+=`${a?"_":""}${o}_c${i.channels}`}return e}const HdcpLevels=["NONE","TYPE-0","TYPE-1",null];function isHdcpLevel(s){return HdcpLevels.indexOf(s)>-1}const VideoRangeValues=["SDR","PQ","HLG"];function isVideoRange(s){return!!s&&VideoRangeValues.indexOf(s)>-1}var HlsSkip={No:"",Yes:"YES",v2:"v2"};function getSkipValue(s){const{canSkipUntil:e,canSkipDateRanges:i,age:a}=s,o=a<e/2;return e&&o?i?HlsSkip.v2:HlsSkip.Yes:HlsSkip.No}class HlsUrlParameters{constructor(e,i,a){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=i,this.skip=a}addDirectives(e){const i=new self.URL(e);return this.msn!==void 0&&i.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&i.searchParams.set("_HLS_part",this.part.toString()),this.skip&&i.searchParams.set("_HLS_skip",this.skip),i.href}}class Level{constructor(e){if(this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.supplemental=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.frameRate=e.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=e.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.codecSet=[e.videoCodec,e.audioCodec].filter(a=>!!a).map(a=>a.substring(0,4)).join(","),"supplemental"in e){var i;this.supplemental=e.supplemental;const a=(i=e.supplemental)==null?void 0:i.videoCodec;a&&a!==e.videoCodec&&(this.codecSet+=`,${a.substring(0,4)}`)}this.addGroupId("audio",e.attrs.AUDIO),this.addGroupId("text",e.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(e){return hasGroup(this._audioGroups,e)}hasSubtitleGroup(e){return hasGroup(this._subtitleGroups,e)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(e,i){if(i){if(e==="audio"){let a=this._audioGroups;a||(a=this._audioGroups=[]),a.indexOf(i)===-1&&a.push(i)}else if(e==="text"){let a=this._subtitleGroups;a||(a=this._subtitleGroups=[]),a.indexOf(i)===-1&&a.push(i)}}}get urlId(){return 0}set urlId(e){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var e;return(e=this.audioGroups)==null?void 0:e[0]}get textGroupId(){var e;return(e=this.subtitleGroups)==null?void 0:e[0]}addFallback(){}}function hasGroup(s,e){return!e||!s?!1:s.indexOf(e)!==-1}function isHdrSupported(){if(typeof matchMedia=="function"){const s=matchMedia("(dynamic-range: high)"),e=matchMedia("bad query");if(s.media!==e.media)return s.matches===!0}return!1}function getVideoSelectionOptions(s,e){let i=!1,a=[];if(s&&(i=s!=="SDR",a=[s]),e){a=e.allowedVideoRanges||VideoRangeValues.slice(0);const o=a.join("")!=="SDR"&&!e.videoCodec;i=e.preferHDR!==void 0?e.preferHDR:o&&isHdrSupported(),i||(a=["SDR"])}return{preferHDR:i,allowedVideoRanges:a}}const omitCircularRefsReplacer=s=>{const e=new WeakSet;return(i,a)=>{if(s&&(a=s(i,a)),typeof a=="object"&&a!==null){if(e.has(a))return;e.add(a)}return a}},stringify=(s,e)=>JSON.stringify(s,omitCircularRefsReplacer(e));function getStartCodecTier(s,e,i,a,o){const c=Object.keys(s),d=a==null?void 0:a.channels,g=a==null?void 0:a.audioCodec,b=o==null?void 0:o.videoCodec,_=d&&parseInt(d)===2;let j=!1,$=!1,_e=1/0,tt=1/0,et=1/0,st=1/0,at=0,rt=[];const{preferHDR:nt,allowedVideoRanges:it}=getVideoSelectionOptions(e,o);for(let dt=c.length;dt--;){const gt=s[c[dt]];j||(j=gt.channels[2]>0),_e=Math.min(_e,gt.minHeight),tt=Math.min(tt,gt.minFramerate),et=Math.min(et,gt.minBitrate),it.filter(St=>gt.videoRanges[St]>0).length>0&&($=!0)}_e=isFiniteNumber(_e)?_e:0,tt=isFiniteNumber(tt)?tt:0;const ot=Math.max(1080,_e),lt=Math.max(30,tt);et=isFiniteNumber(et)?et:i,i=Math.max(et,i),$||(e=void 0);const ct=c.length>1;return{codecSet:c.reduce((dt,gt)=>{const vt=s[gt];if(gt===dt)return dt;if(rt=$?it.filter(St=>vt.videoRanges[St]>0):[],ct){if(vt.minBitrate>i)return logStartCodecCandidateIgnored(gt,`min bitrate of ${vt.minBitrate} > current estimate of ${i}`),dt;if(!vt.hasDefaultAudio)return logStartCodecCandidateIgnored(gt,"no renditions with default or auto-select sound found"),dt;if(g&&gt.indexOf(g.substring(0,4))%5!==0)return logStartCodecCandidateIgnored(gt,`audio codec preference "${g}" not found`),dt;if(d&&!_){if(!vt.channels[d])return logStartCodecCandidateIgnored(gt,`no renditions with ${d} channel sound found (channels options: ${Object.keys(vt.channels)})`),dt}else if((!g||_)&&j&&vt.channels[2]===0)return logStartCodecCandidateIgnored(gt,"no renditions with stereo sound found"),dt;if(vt.minHeight>ot)return logStartCodecCandidateIgnored(gt,`min resolution of ${vt.minHeight} > maximum of ${ot}`),dt;if(vt.minFramerate>lt)return logStartCodecCandidateIgnored(gt,`min framerate of ${vt.minFramerate} > maximum of ${lt}`),dt;if(!rt.some(St=>vt.videoRanges[St]>0))return logStartCodecCandidateIgnored(gt,`no variants with VIDEO-RANGE of ${stringify(rt)} found`),dt;if(b&&gt.indexOf(b.substring(0,4))%5!==0)return logStartCodecCandidateIgnored(gt,`video codec preference "${b}" not found`),dt;if(vt.maxScore<at)return logStartCodecCandidateIgnored(gt,`max score of ${vt.maxScore} < selected max of ${at}`),dt}return dt&&(codecsSetSelectionPreferenceValue(gt)>=codecsSetSelectionPreferenceValue(dt)||vt.fragmentError>s[dt].fragmentError)?dt:(st=vt.minIndex,at=vt.maxScore,gt)},void 0),videoRanges:rt,preferHDR:nt,minFramerate:tt,minBitrate:et,minIndex:st}}function logStartCodecCandidateIgnored(s,e){logger.log(`[abr] start candidates with "${s}" ignored because ${e}`)}function getAudioTracksByGroup(s){return s.reduce((e,i)=>{let a=e.groups[i.groupId];a||(a=e.groups[i.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),a.tracks.push(i);const o=i.channels||"2";return a.channels[o]=(a.channels[o]||0)+1,a.hasDefault=a.hasDefault||i.default,a.hasAutoSelect=a.hasAutoSelect||i.autoselect,a.hasDefault&&(e.hasDefaultAudio=!0),a.hasAutoSelect&&(e.hasAutoSelectAudio=!0),e},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function getCodecTiers(s,e,i,a){return s.slice(i,a+1).reduce((o,c,d)=>{if(!c.codecSet)return o;const g=c.audioGroups;let b=o[c.codecSet];b||(o[c.codecSet]=b={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,minIndex:d,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!g,fragmentError:0}),b.minBitrate=Math.min(b.minBitrate,c.bitrate);const _=Math.min(c.height,c.width);return b.minHeight=Math.min(b.minHeight,_),b.minFramerate=Math.min(b.minFramerate,c.frameRate),b.minIndex=Math.min(b.minIndex,d),b.maxScore=Math.max(b.maxScore,c.score),b.fragmentError+=c.fragmentError,b.videoRanges[c.videoRange]=(b.videoRanges[c.videoRange]||0)+1,g&&g.forEach(j=>{if(!j)return;const $=e.groups[j];$&&(b.hasDefaultAudio=b.hasDefaultAudio||e.hasDefaultAudio?$.hasDefault:$.hasAutoSelect||!e.hasDefaultAudio&&!e.hasAutoSelectAudio,Object.keys($.channels).forEach(_e=>{b.channels[_e]=(b.channels[_e]||0)+$.channels[_e]}))}),o},{})}function getBasicSelectionOption(s){if(!s)return s;const{lang:e,assocLang:i,characteristics:a,channels:o,audioCodec:c}=s;return{lang:e,assocLang:i,characteristics:a,channels:o,audioCodec:c}}function findMatchingOption(s,e,i){if("attrs"in s){const a=e.indexOf(s);if(a!==-1)return a}for(let a=0;a<e.length;a++){const o=e[a];if(matchesOption(s,o,i))return a}return-1}function matchesOption(s,e,i){const{groupId:a,name:o,lang:c,assocLang:d,default:g}=s,b=s.forced;return(a===void 0||e.groupId===a)&&(o===void 0||e.name===o)&&(c===void 0||languagesMatch(c,e.lang))&&(c===void 0||e.assocLang===d)&&(g===void 0||e.default===g)&&(b===void 0||e.forced===b)&&(!("characteristics"in s)||characteristicsMatch(s.characteristics||"",e.characteristics))&&(i===void 0||i(s,e))}function languagesMatch(s,e="--"){return s.length===e.length?s===e:s.startsWith(e)||e.startsWith(s)}function characteristicsMatch(s,e=""){const i=s.split(","),a=e.split(",");return i.length===a.length&&!i.some(o=>a.indexOf(o)===-1)}function audioMatchPredicate(s,e){const{audioCodec:i,channels:a}=s;return(i===void 0||(e.audioCodec||"").substring(0,4)===i.substring(0,4))&&(a===void 0||a===(e.channels||"2"))}function findClosestLevelWithAudioGroup(s,e,i,a,o){const c=e[a],g=e.reduce((_e,tt,et)=>{const st=tt.uri;return(_e[st]||(_e[st]=[])).push(et),_e},{})[c.uri];g.length>1&&(a=Math.max.apply(Math,g));const b=c.videoRange,_=c.frameRate,j=c.codecSet.substring(0,4),$=searchDownAndUpList(e,a,_e=>{if(_e.videoRange!==b||_e.frameRate!==_||_e.codecSet.substring(0,4)!==j)return!1;const tt=_e.audioGroups,et=i.filter(st=>!tt||tt.indexOf(st.groupId)!==-1);return findMatchingOption(s,et,o)>-1});return $>-1?$:searchDownAndUpList(e,a,_e=>{const tt=_e.audioGroups,et=i.filter(st=>!tt||tt.indexOf(st.groupId)!==-1);return findMatchingOption(s,et,o)>-1})}function searchDownAndUpList(s,e,i){for(let a=e;a>-1;a--)if(i(s[a]))return a;for(let a=e+1;a<s.length;a++)if(i(s[a]))return a;return-1}function useAlternateAudio(s,e){var i;return!!s&&s!==((i=e.loadLevelObj)==null?void 0:i.uri)}class AbrController extends Logger{constructor(e){super("abr",e.logger),this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.rebufferNotice=-1,this.supportedCache={},this.bwEstimator=void 0,this._abandonRulesCheck=i=>{var a;const{fragCurrent:o,partCurrent:c,hls:d}=this,{autoLevelEnabled:g,media:b}=d;if(!o||!b)return;const _=performance.now(),j=c?c.stats:o.stats,$=c?c.duration:o.duration,_e=_-j.loading.start,tt=d.minAutoLevel,et=o.level,st=this._nextAutoLevel;if(j.aborted||j.loaded&&j.loaded===j.total||et<=tt){this.clearTimer(),this._nextAutoLevel=-1;return}if(!g)return;const at=st>-1&&st!==et,rt=!!i||at;if(!rt&&(b.paused||!b.playbackRate||!b.readyState))return;const nt=d.mainForwardBufferInfo;if(!rt&&nt===null)return;const it=this.bwEstimator.getEstimateTTFB(),ot=Math.abs(b.playbackRate);if(_e<=Math.max(it,1e3*($/(ot*2))))return;const lt=nt?nt.len/ot:0,ct=j.loading.first?j.loading.first-j.loading.start:-1,ht=j.loaded&&ct>-1,dt=this.getBwEstimate(),gt=d.levels,vt=gt[et],St=Math.max(j.loaded,Math.round($*(o.bitrate||vt.averageBitrate)/8));let Tt=ht?_e-ct:_e;Tt<1&&ht&&(Tt=Math.min(_e,j.loaded*8/dt));const Ct=ht?j.loaded*1e3/Tt:0,Rt=it/1e3,bt=Ct?(St-j.loaded)/Ct:St*8/dt+Rt;if(bt<=lt)return;const pt=Ct?Ct*8:dt,yt=((a=(i==null?void 0:i.details)||this.hls.latestLevelDetails)==null?void 0:a.live)===!0,ut=this.hls.config.abrBandWidthUpFactor;let ft=Number.POSITIVE_INFINITY,xt;for(xt=et-1;xt>tt;xt--){const Pt=gt[xt].maxBitrate,wt=!gt[xt].details||yt;if(ft=this.getTimeToLoadFrag(Rt,pt,$*Pt,wt),ft<Math.min(lt,$+Rt))break}if(ft>=bt||ft>$*10)return;ht?this.bwEstimator.sample(_e-Math.min(it,ct),j.loaded):this.bwEstimator.sampleTTFB(_e);const mt=gt[xt].maxBitrate;this.getBwEstimate()*ut>mt&&this.resetEstimator(mt);const Et=this.findBestLevel(mt,tt,xt,0,lt,1,1);Et>-1&&(xt=Et),this.warn(`Fragment ${o.sn}${c?" part "+c.index:""} of level ${et} is loading too slowly;
      Fragment duration: ${o.duration.toFixed(3)}
      Time to underbuffer: ${lt.toFixed(3)} s
      Estimated load time for current fragment: ${bt.toFixed(3)} s
      Estimated load time for down switch fragment: ${ft.toFixed(3)} s
      TTFB estimate: ${ct|0} ms
      Current BW estimate: ${isFiniteNumber(dt)?dt|0:"Unknown"} bps
      New BW estimate: ${this.getBwEstimate()|0} bps
      Switching to level ${xt} @ ${mt|0} bps`),d.nextLoadLevel=d.nextAutoLevel=xt,this.clearTimer();const At=()=>{if(this.clearTimer(),this.fragCurrent===o&&this.hls.loadLevel===xt&&xt>0){const Pt=this.getStarvationDelay();if(this.warn(`Aborting inflight request ${xt>0?"and switching down":""}
      Fragment duration: ${o.duration.toFixed(3)} s
      Time to underbuffer: ${Pt.toFixed(3)} s`),o.abortRequests(),this.fragCurrent=this.partCurrent=null,xt>tt){let wt=this.findBestLevel(this.hls.levels[tt].bitrate,tt,xt,0,Pt,1,1);wt===-1&&(wt=tt),this.hls.nextLoadLevel=this.hls.nextAutoLevel=wt,this.resetEstimator(this.hls.levels[wt].bitrate)}}};at||bt>ft*2?At():this.timer=self.setInterval(At,ft*1e3),d.trigger(Events.FRAG_LOAD_EMERGENCY_ABORTED,{frag:o,part:c,stats:j})},this.hls=e,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(e){e&&(this.log(`setting initial bwe to ${e}`),this.hls.config.abrEwmaDefaultEstimate=e),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const e=this.hls.config;return new EwmaBandWidthEstimator(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)}registerListeners(){const{hls:e}=this;e.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Events.FRAG_LOADING,this.onFragLoading,this),e.on(Events.FRAG_LOADED,this.onFragLoaded,this),e.on(Events.FRAG_BUFFERED,this.onFragBuffered,this),e.on(Events.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(Events.LEVEL_LOADED,this.onLevelLoaded,this),e.on(Events.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(Events.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.on(Events.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e&&(e.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Events.FRAG_LOADING,this.onFragLoading,this),e.off(Events.FRAG_LOADED,this.onFragLoaded,this),e.off(Events.FRAG_BUFFERED,this.onFragBuffered,this),e.off(Events.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(Events.LEVEL_LOADED,this.onLevelLoaded,this),e.off(Events.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(Events.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.off(Events.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=this.supportedCache=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(e,i){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.supportedCache={},this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(e,i){const a=i.frag;if(!this.ignoreFragment(a)){if(!a.bitrateTest){var o;this.fragCurrent=a,this.partCurrent=(o=i.part)!=null?o:null}this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(e,i){this.clearTimer()}onError(e,i){if(!i.fatal)switch(i.details){case ErrorDetails.BUFFER_ADD_CODEC_ERROR:case ErrorDetails.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case ErrorDetails.FRAG_LOAD_TIMEOUT:{const a=i.frag,{fragCurrent:o,partCurrent:c}=this;if(a&&o&&a.sn===o.sn&&a.level===o.level){const d=performance.now(),g=c?c.stats:a.stats,b=d-g.loading.start,_=g.loading.first?g.loading.first-g.loading.start:-1;if(g.loaded&&_>-1){const $=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(b-Math.min($,_),g.loaded)}else this.bwEstimator.sampleTTFB(b)}break}}}getTimeToLoadFrag(e,i,a,o){const c=e+a/i,d=o?e+this.lastLevelLoadSec:0;return c+d}onLevelLoaded(e,i){const a=this.hls.config,{loading:o}=i.stats,c=o.end-o.first;isFiniteNumber(c)&&(this.lastLevelLoadSec=c/1e3),i.details.live?this.bwEstimator.update(a.abrEwmaSlowLive,a.abrEwmaFastLive):this.bwEstimator.update(a.abrEwmaSlowVoD,a.abrEwmaFastVoD),this.timer>-1&&this._abandonRulesCheck(i.levelInfo)}onFragLoaded(e,{frag:i,part:a}){const o=a?a.stats:i.stats;if(i.type===PlaylistLevelType.MAIN&&this.bwEstimator.sampleTTFB(o.loading.first-o.loading.start),!this.ignoreFragment(i)){if(this.clearTimer(),i.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const c=a?a.duration:i.duration,d=this.hls.levels[i.level],g=(d.loaded?d.loaded.bytes:0)+o.loaded,b=(d.loaded?d.loaded.duration:0)+c;d.loaded={bytes:g,duration:b},d.realBitrate=Math.round(8*g/b)}if(i.bitrateTest){const c={stats:o,frag:i,part:a,id:i.type};this.onFragBuffered(Events.FRAG_BUFFERED,c),i.bitrateTest=!1}else this.lastLoadedFragLevel=i.level}}onFragBuffered(e,i){const{frag:a,part:o}=i,c=o!=null&&o.stats.loaded?o.stats:a.stats;if(c.aborted||this.ignoreFragment(a))return;const d=c.parsing.end-c.loading.start-Math.min(c.loading.first-c.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(d,c.loaded),c.bwEstimate=this.getBwEstimate(),a.bitrateTest?this.bitrateTestDelay=d/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==PlaylistLevelType.MAIN||e.sn==="initSegment"}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:e,minAutoLevel:i}=this.hls,a=this.getBwEstimate(),o=this.hls.config.maxStarvationDelay,c=this.findBestLevel(a,i,e,0,o,1,1);if(c>-1)return c;const d=this.hls.firstLevel,g=Math.min(Math.max(d,i),e);return this.warn(`Could not find best starting auto level. Defaulting to first in playlist ${d} clamped to ${g}`),g}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const e=this.forcedAutoLevel,a=this.bwEstimator.canEstimate(),o=this.lastLoadedFragLevel>-1;if(e!==-1&&(!a||!o||this.nextAutoLevelKey===this.getAutoLevelKey()))return e;const c=a&&o?this.getNextABRAutoLevel():this.firstAutoLevel;if(e!==-1){const d=this.hls.levels;if(d.length>Math.max(e,c)&&d[e].loadError<=d[c].loadError)return e}return this._nextAutoLevel=c,this.nextAutoLevelKey=this.getAutoLevelKey(),c}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:i,hls:a}=this;if(a.levels.length<=1)return a.loadLevel;const{maxAutoLevel:o,config:c,minAutoLevel:d}=a,g=i?i.duration:e?e.duration:0,b=this.getBwEstimate(),_=this.getStarvationDelay();let j=c.abrBandWidthFactor,$=c.abrBandWidthUpFactor;if(_){const at=this.findBestLevel(b,d,o,_,0,j,$);if(at>=0)return this.rebufferNotice=-1,at}let _e=g?Math.min(g,c.maxStarvationDelay):c.maxStarvationDelay;if(!_){const at=this.bitrateTestDelay;at&&(_e=(g?Math.min(g,c.maxLoadingDelay):c.maxLoadingDelay)-at,this.info(`bitrate test took ${Math.round(1e3*at)}ms, set first fragment max fetchDuration to ${Math.round(1e3*_e)} ms`),j=$=1)}const tt=this.findBestLevel(b,d,o,_,_e,j,$);if(this.rebufferNotice!==tt&&(this.rebufferNotice=tt,this.info(`${_?"rebuffering expected":"buffer is empty"}, optimal quality level ${tt}`)),tt>-1)return tt;const et=a.levels[d],st=a.loadLevelObj;return st&&(et==null?void 0:et.bitrate)<st.bitrate?d:a.loadLevel}getStarvationDelay(){const e=this.hls,i=e.media;if(!i)return 1/0;const a=i&&i.playbackRate!==0?Math.abs(i.playbackRate):1,o=e.mainForwardBufferInfo;return(o?o.len:0)/a}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(e,i,a,o,c,d,g){var b;const _=o+c,j=this.lastLoadedFragLevel,$=j===-1?this.hls.firstLevel:j,{fragCurrent:_e,partCurrent:tt}=this,{levels:et,allAudioTracks:st,loadLevel:at,config:rt}=this.hls;if(et.length===1)return 0;const nt=et[$],it=!!((b=this.hls.latestLevelDetails)!=null&&b.live),ot=at===-1||j===-1;let lt,ct="SDR",ht=(nt==null?void 0:nt.frameRate)||0;const{audioPreference:dt,videoPreference:gt}=rt,vt=this.audioTracksByGroup||(this.audioTracksByGroup=getAudioTracksByGroup(st));let St=-1;if(ot){if(this.firstSelection!==-1)return this.firstSelection;const pt=this.codecTiers||(this.codecTiers=getCodecTiers(et,vt,i,a)),yt=getStartCodecTier(pt,ct,e,dt,gt),{codecSet:ut,videoRanges:ft,minFramerate:xt,minBitrate:mt,minIndex:Et,preferHDR:At}=yt;St=Et,lt=ut,ct=At?ft[ft.length-1]:ft[0],ht=xt,e=Math.max(e,mt),this.log(`picked start tier ${stringify(yt)}`)}else lt=nt==null?void 0:nt.codecSet,ct=nt==null?void 0:nt.videoRange;const Tt=tt?tt.duration:_e?_e.duration:0,Ct=this.bwEstimator.getEstimateTTFB()/1e3,Rt=[];for(let pt=a;pt>=i;pt--){var bt;const yt=et[pt],ut=pt>$;if(!yt)continue;if(rt.useMediaCapabilities&&!yt.supportedResult&&!yt.supportedPromise){const wt=navigator.mediaCapabilities;typeof(wt==null?void 0:wt.decodingInfo)=="function"&&requiresMediaCapabilitiesDecodingInfo(yt,vt,ct,ht,e,dt)?(yt.supportedPromise=getMediaDecodingInfoPromise(yt,vt,wt,this.supportedCache),yt.supportedPromise.then(It=>{if(!this.hls)return;yt.supportedResult=It;const Mt=this.hls.levels,Bt=Mt.indexOf(yt);It.error?this.warn(`MediaCapabilities decodingInfo error: "${It.error}" for level ${Bt} ${stringify(It)}`):It.supported?It.decodingInfoResults.some(Gt=>Gt.smooth===!1||Gt.powerEfficient===!1)&&this.log(`MediaCapabilities decodingInfo for level ${Bt} not smooth or powerEfficient: ${stringify(It)}`):(this.warn(`Unsupported MediaCapabilities decodingInfo result for level ${Bt} ${stringify(It)}`),Bt>-1&&Mt.length>1&&(this.log(`Removing unsupported level ${Bt}`),this.hls.removeLevel(Bt),this.hls.loadLevel===-1&&(this.hls.nextLoadLevel=0)))}).catch(It=>{this.warn(`Error handling MediaCapabilities decodingInfo: ${It}`)})):yt.supportedResult=SUPPORTED_INFO_DEFAULT}if((lt&&yt.codecSet!==lt||ct&&yt.videoRange!==ct||ut&&ht>yt.frameRate||!ut&&ht>0&&ht<yt.frameRate||(bt=yt.supportedResult)!=null&&(bt=bt.decodingInfoResults)!=null&&bt.some(wt=>wt.smooth===!1))&&(!ot||pt!==St)){Rt.push(pt);continue}const ft=yt.details,xt=(tt?ft==null?void 0:ft.partTarget:ft==null?void 0:ft.averagetargetduration)||Tt;let mt;ut?mt=g*e:mt=d*e;const Et=Tt&&o>=Tt*2&&c===0?yt.averageBitrate:yt.maxBitrate,At=this.getTimeToLoadFrag(Ct,mt,Et*xt,ft===void 0);if(mt>=Et&&(pt===j||yt.loadError===0&&yt.fragmentError===0)&&(At<=Ct||!isFiniteNumber(At)||it&&!this.bitrateTestDelay||At<_)){const wt=this.forcedAutoLevel;return pt!==at&&(wt===-1||wt!==at)&&(Rt.length&&this.trace(`Skipped level(s) ${Rt.join(",")} of ${a} max with CODECS and VIDEO-RANGE:"${et[Rt[0]].codecs}" ${et[Rt[0]].videoRange}; not compatible with "${lt}" ${ct}`),this.info(`switch candidate:${$}->${pt} adjustedbw(${Math.round(mt)})-bitrate=${Math.round(mt-Et)} ttfb:${Ct.toFixed(1)} avgDuration:${xt.toFixed(1)} maxFetchDuration:${_.toFixed(1)} fetchDuration:${At.toFixed(1)} firstSelection:${ot} codecSet:${yt.codecSet} videoRange:${yt.videoRange} hls.loadLevel:${at}`)),ot&&(this.firstSelection=pt),pt}}return-1}set nextAutoLevel(e){const i=this.deriveNextAutoLevel(e);this._nextAutoLevel!==i&&(this.nextAutoLevelKey="",this._nextAutoLevel=i)}deriveNextAutoLevel(e){const{maxAutoLevel:i,minAutoLevel:a}=this.hls;return Math.min(Math.max(e,a),i)}}const BinarySearch={search:function(s,e){let i=0,a=s.length-1,o=null,c=null;for(;i<=a;){o=(i+a)/2|0,c=s[o];const d=e(c);if(d>0)i=o+1;else if(d<0)a=o-1;else return c}return null}};function findFragmentByPDT(s,e,i){if(e===null||!Array.isArray(s)||!s.length||!isFiniteNumber(e))return null;const a=s[0].programDateTime;if(e<(a||0))return null;const o=s[s.length-1].endProgramDateTime;if(e>=(o||0))return null;for(let c=0;c<s.length;++c){const d=s[c];if(pdtWithinToleranceTest(e,i,d))return d}return null}function findFragmentByPTS(s,e,i=0,a=0,o=.005){let c=null;if(s){c=e[1+s.sn-e[0].sn]||null;const g=s.endDTS-i;g>0&&g<15e-7&&(i+=15e-7),c&&s.level!==c.level&&c.end<=s.end&&(c=e[2+s.sn-e[0].sn]||null)}else i===0&&e[0].start===0&&(c=e[0]);if(c&&((!s||s.level===c.level)&&fragmentWithinToleranceTest(i,a,c)===0||fragmentWithinFastStartSwitch(c,s,Math.min(o,a))))return c;const d=BinarySearch.search(e,fragmentWithinToleranceTest.bind(null,i,a));return d&&(d!==s||!c)?d:c}function fragmentWithinFastStartSwitch(s,e,i){if(e&&e.start===0&&e.level<s.level&&(e.endPTS||0)>0){const a=e.tagList.reduce((o,c)=>(c[0]==="INF"&&(o+=parseFloat(c[1])),o),i);return s.start<=a}return!1}function fragmentWithinToleranceTest(s=0,e=0,i){if(i.start<=s&&i.start+i.duration>s)return 0;const a=Math.min(e,i.duration+(i.deltaPTS?i.deltaPTS:0));return i.start+i.duration-a<=s?1:i.start-a>s&&i.start?-1:0}function pdtWithinToleranceTest(s,e,i){const a=Math.min(e,i.duration+(i.deltaPTS?i.deltaPTS:0))*1e3;return(i.endProgramDateTime||0)-a>s}function findNearestWithCC(s,e,i){if(s&&s.startCC<=e&&s.endCC>=e){let a=s.fragments;const{fragmentHint:o}=s;o&&(a=a.concat(o));let c;return BinarySearch.search(a,d=>d.cc<e?1:d.cc>e?-1:(c=d,d.end<=i?1:d.start>i?-1:0)),c||null}return null}function isTimeoutError(s){switch(s.details){case ErrorDetails.FRAG_LOAD_TIMEOUT:case ErrorDetails.KEY_LOAD_TIMEOUT:case ErrorDetails.LEVEL_LOAD_TIMEOUT:case ErrorDetails.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function isKeyError(s){return s.details.startsWith("key")}function isUnusableKeyError(s){return isKeyError(s)&&!!s.frag&&!s.frag.decryptdata}function getRetryConfig(s,e){const i=isTimeoutError(e);return s.default[`${i?"timeout":"error"}Retry`]}function getRetryDelay(s,e){const i=s.backoff==="linear"?1:Math.pow(2,e);return Math.min(i*s.retryDelayMs,s.maxRetryDelayMs)}function getLoaderConfigWithoutReties(s){return _objectSpread2(_objectSpread2({},s),{errorRetry:null,timeoutRetry:null})}function shouldRetry(s,e,i,a){if(!s)return!1;const o=a==null?void 0:a.code,c=e<s.maxNumRetry&&(retryForHttpStatus(o)||!!i);return s.shouldRetry?s.shouldRetry(s,e,i,a,c):c}function retryForHttpStatus(s){return offlineHttpStatus(s)||!!s&&(s<400||s>499)}function offlineHttpStatus(s){return s===0&&navigator.onLine===!1}var NetworkErrorAction={DoNothing:0,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,RetryRequest:5},ErrorActionFlags={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2,MoveAllAlternatesMatchingKey:4};class ErrorController extends Logger{constructor(e){super("error-controller",e.logger),this.hls=void 0,this.playlistError=0,this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(Events.ERROR,this.onError,this),e.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Events.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const e=this.hls;e&&(e.off(Events.ERROR,this.onError,this),e.off(Events.ERROR,this.onErrorOut,this),e.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Events.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null}startLoad(e){}stopLoad(){this.playlistError=0}getVariantLevelIndex(e){return(e==null?void 0:e.type)===PlaylistLevelType.MAIN?e.level:this.getVariantIndex()}getVariantIndex(){var e;const i=this.hls,a=i.currentLevel;return(e=i.loadLevelObj)!=null&&e.details||a===-1?i.loadLevel:a}variantHasKey(e,i){if(e){var a;if((a=e.details)!=null&&a.hasKey(i))return!0;const o=e.audioGroups;if(o)return this.hls.allAudioTracks.filter(d=>o.indexOf(d.groupId)>=0).some(d=>{var g;return(g=d.details)==null?void 0:g.hasKey(i)})}return!1}onManifestLoading(){this.playlistError=0}onLevelUpdated(){this.playlistError=0}onError(e,i){var a;if(i.fatal)return;const o=this.hls,c=i.context;switch(i.details){case ErrorDetails.FRAG_LOAD_ERROR:case ErrorDetails.FRAG_LOAD_TIMEOUT:case ErrorDetails.KEY_LOAD_ERROR:case ErrorDetails.KEY_LOAD_TIMEOUT:i.errorAction=this.getFragRetryOrSwitchAction(i);return;case ErrorDetails.FRAG_PARSING_ERROR:if((a=i.frag)!=null&&a.gap){i.errorAction=createDoNothingErrorAction();return}case ErrorDetails.FRAG_GAP:case ErrorDetails.FRAG_DECRYPT_ERROR:{i.errorAction=this.getFragRetryOrSwitchAction(i),i.errorAction.action=NetworkErrorAction.SendAlternateToPenaltyBox;return}case ErrorDetails.LEVEL_EMPTY_ERROR:case ErrorDetails.LEVEL_PARSING_ERROR:{var d;const b=i.parent===PlaylistLevelType.MAIN?i.level:o.loadLevel;i.details===ErrorDetails.LEVEL_EMPTY_ERROR&&((d=i.context)!=null&&(d=d.levelDetails)!=null&&d.live)?i.errorAction=this.getPlaylistRetryOrSwitchAction(i,b):(i.levelRetry=!1,i.errorAction=this.getLevelSwitchAction(i,b))}return;case ErrorDetails.LEVEL_LOAD_ERROR:case ErrorDetails.LEVEL_LOAD_TIMEOUT:typeof(c==null?void 0:c.level)=="number"&&(i.errorAction=this.getPlaylistRetryOrSwitchAction(i,c.level));return;case ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:case ErrorDetails.SUBTITLE_LOAD_ERROR:case ErrorDetails.SUBTITLE_TRACK_LOAD_TIMEOUT:if(c){const b=o.loadLevelObj;if(b&&(c.type===PlaylistContextType.AUDIO_TRACK&&b.hasAudioGroup(c.groupId)||c.type===PlaylistContextType.SUBTITLE_TRACK&&b.hasSubtitleGroup(c.groupId))){i.errorAction=this.getPlaylistRetryOrSwitchAction(i,o.loadLevel),i.errorAction.action=NetworkErrorAction.SendAlternateToPenaltyBox,i.errorAction.flags=ErrorActionFlags.MoveAllAlternatesMatchingHost;return}}return;case ErrorDetails.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:i.errorAction={action:NetworkErrorAction.SendAlternateToPenaltyBox,flags:ErrorActionFlags.MoveAllAlternatesMatchingHDCP};return;case ErrorDetails.KEY_SYSTEM_SESSION_UPDATE_FAILED:case ErrorDetails.KEY_SYSTEM_STATUS_INTERNAL_ERROR:case ErrorDetails.KEY_SYSTEM_NO_SESSION:i.errorAction={action:NetworkErrorAction.SendAlternateToPenaltyBox,flags:ErrorActionFlags.MoveAllAlternatesMatchingKey};return;case ErrorDetails.BUFFER_ADD_CODEC_ERROR:case ErrorDetails.REMUX_ALLOC_ERROR:case ErrorDetails.BUFFER_APPEND_ERROR:if(!i.errorAction){var g;i.errorAction=this.getLevelSwitchAction(i,(g=i.level)!=null?g:o.loadLevel)}return;case ErrorDetails.INTERNAL_EXCEPTION:case ErrorDetails.BUFFER_APPENDING_ERROR:case ErrorDetails.BUFFER_FULL_ERROR:case ErrorDetails.LEVEL_SWITCH_ERROR:case ErrorDetails.BUFFER_STALLED_ERROR:case ErrorDetails.BUFFER_SEEK_OVER_HOLE:case ErrorDetails.BUFFER_NUDGE_ON_STALL:i.errorAction=createDoNothingErrorAction();return}i.type===ErrorTypes.KEY_SYSTEM_ERROR&&(i.levelRetry=!1,i.errorAction=createDoNothingErrorAction())}getPlaylistRetryOrSwitchAction(e,i){const a=this.hls,o=getRetryConfig(a.config.playlistLoadPolicy,e),c=this.playlistError++;if(shouldRetry(o,c,isTimeoutError(e),e.response))return{action:NetworkErrorAction.RetryRequest,flags:ErrorActionFlags.None,retryConfig:o,retryCount:c};const g=this.getLevelSwitchAction(e,i);return o&&(g.retryConfig=o,g.retryCount=c),g}getFragRetryOrSwitchAction(e){const i=this.hls,a=this.getVariantLevelIndex(e.frag),o=i.levels[a],{fragLoadPolicy:c,keyLoadPolicy:d}=i.config,g=getRetryConfig(isKeyError(e)?d:c,e),b=i.levels.reduce((j,$)=>j+$.fragmentError,0);if(o&&(e.details!==ErrorDetails.FRAG_GAP&&o.fragmentError++,!isUnusableKeyError(e)&&shouldRetry(g,b,isTimeoutError(e),e.response)))return{action:NetworkErrorAction.RetryRequest,flags:ErrorActionFlags.None,retryConfig:g,retryCount:b};const _=this.getLevelSwitchAction(e,a);return g&&(_.retryConfig=g,_.retryCount=b),_}getLevelSwitchAction(e,i){const a=this.hls;i==null&&(i=a.loadLevel);const o=this.hls.levels[i];if(o){var c,d;const _=e.details;o.loadError++,_===ErrorDetails.BUFFER_APPEND_ERROR&&o.fragmentError++;let j=-1;const{levels:$,loadLevel:_e,minAutoLevel:tt,maxAutoLevel:et}=a;!a.autoLevelEnabled&&!a.config.preserveManualLevelOnError&&(a.loadLevel=-1);const st=(c=e.frag)==null?void 0:c.type,rt=(st===PlaylistLevelType.AUDIO&&_===ErrorDetails.FRAG_PARSING_ERROR||e.sourceBufferName==="audio"&&(_===ErrorDetails.BUFFER_ADD_CODEC_ERROR||_===ErrorDetails.BUFFER_APPEND_ERROR))&&$.some(({audioCodec:ct})=>o.audioCodec!==ct),it=e.sourceBufferName==="video"&&(_===ErrorDetails.BUFFER_ADD_CODEC_ERROR||_===ErrorDetails.BUFFER_APPEND_ERROR)&&$.some(({codecSet:ct,audioCodec:ht})=>o.codecSet!==ct&&o.audioCodec===ht),{type:ot,groupId:lt}=(d=e.context)!=null?d:{};for(let ct=$.length;ct--;){const ht=(ct+_e)%$.length;if(ht!==_e&&ht>=tt&&ht<=et&&$[ht].loadError===0){var g,b;const dt=$[ht];if(_===ErrorDetails.FRAG_GAP&&st===PlaylistLevelType.MAIN&&e.frag){const gt=$[ht].details;if(gt){const vt=findFragmentByPTS(e.frag,gt.fragments,e.frag.start);if(vt!=null&&vt.gap)continue}}else{if(ot===PlaylistContextType.AUDIO_TRACK&&dt.hasAudioGroup(lt)||ot===PlaylistContextType.SUBTITLE_TRACK&&dt.hasSubtitleGroup(lt))continue;if(st===PlaylistLevelType.AUDIO&&(g=o.audioGroups)!=null&&g.some(gt=>dt.hasAudioGroup(gt))||st===PlaylistLevelType.SUBTITLE&&(b=o.subtitleGroups)!=null&&b.some(gt=>dt.hasSubtitleGroup(gt))||rt&&o.audioCodec===dt.audioCodec||it&&o.codecSet===dt.codecSet||!rt&&o.codecSet!==dt.codecSet)continue}j=ht;break}}if(j>-1&&a.loadLevel!==j)return e.levelRetry=!0,this.playlistError=0,{action:NetworkErrorAction.SendAlternateToPenaltyBox,flags:ErrorActionFlags.None,nextAutoLevel:j}}return{action:NetworkErrorAction.SendAlternateToPenaltyBox,flags:ErrorActionFlags.MoveAllAlternatesMatchingHost}}onErrorOut(e,i){var a;switch((a=i.errorAction)==null?void 0:a.action){case NetworkErrorAction.DoNothing:break;case NetworkErrorAction.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(i),!i.errorAction.resolved&&i.details!==ErrorDetails.FRAG_GAP?i.fatal=!0:/MediaSource readyState: ended/.test(i.error.message)&&(this.warn(`MediaSource ended after "${i.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError());break}if(i.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(e){const i=this.hls,a=e.errorAction;if(!a)return;const{flags:o}=a,c=a.nextAutoLevel;switch(o){case ErrorActionFlags.None:this.switchLevel(e,c);break;case ErrorActionFlags.MoveAllAlternatesMatchingHDCP:{const b=this.getVariantLevelIndex(e.frag),_=i.levels[b],j=_==null?void 0:_.attrs["HDCP-LEVEL"];if(a.hdcpLevel=j,j==="NONE")this.warn("HDCP policy resticted output with HDCP-LEVEL=NONE");else if(j){i.maxHdcpLevel=HdcpLevels[HdcpLevels.indexOf(j)-1],a.resolved=!0,this.warn(`Restricting playback to HDCP-LEVEL of "${i.maxHdcpLevel}" or lower`);break}}case ErrorActionFlags.MoveAllAlternatesMatchingKey:{const b=e.decryptdata;if(b){const _=this.hls.levels,j=_.length;for(let _e=j;_e--;)if(this.variantHasKey(_[_e],b)){var d,g;this.log(`Banned key found in level ${_e} (${_[_e].bitrate}bps) or audio group "${(d=_[_e].audioGroups)==null?void 0:d.join(",")}" (${(g=e.frag)==null?void 0:g.type} fragment) ${arrayToHex(b.keyId||[])}`),_[_e].fragmentError++,_[_e].loadError++,this.log(`Removing level ${_e} with key error (${e.error})`),this.hls.removeLevel(_e)}const $=e.frag;if(this.hls.levels.length<j)a.resolved=!0;else if($&&$.type!==PlaylistLevelType.MAIN){const _e=$.decryptdata;_e&&!b.matches(_e)&&(a.resolved=!0)}}break}}a.resolved||this.switchLevel(e,c)}switchLevel(e,i){if(i!==void 0&&e.errorAction&&(this.warn(`switching to level ${i} after ${e.details}`),this.hls.nextAutoLevel=i,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel,e.details===ErrorDetails.BUFFER_ADD_CODEC_ERROR&&e.mimeType&&e.sourceBufferName!=="audiovideo")){const a=getCodecsForMimeType(e.mimeType),o=this.hls.levels;for(let c=o.length;c--;)o[c][`${e.sourceBufferName}Codec`]===a&&(this.log(`Removing level ${c} for ${e.details} ("${a}" not supported)`),this.hls.removeLevel(c))}}}function createDoNothingErrorAction(s){const e={action:NetworkErrorAction.DoNothing,flags:ErrorActionFlags.None};return s&&(e.resolved=!0),e}var FragmentState={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class FragmentTracker{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e&&(e.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Events.BUFFER_APPENDED,this.onBufferAppended,this),e.on(Events.FRAG_BUFFERED,this.onFragBuffered,this),e.on(Events.FRAG_LOADED,this.onFragLoaded,this))}_unregisterListeners(){const{hls:e}=this;e&&(e.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Events.BUFFER_APPENDED,this.onBufferAppended,this),e.off(Events.FRAG_BUFFERED,this.onFragBuffered,this),e.off(Events.FRAG_LOADED,this.onFragLoaded,this))}destroy(){this._unregisterListeners(),this.hls=this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,i){const a=this.activePartLists[i];if(a)for(let o=a.length;o--;){const c=a[o];if(!c)break;if(c.start<=e&&e<=c.end&&c.loaded)return c}return this.getBufferedFrag(e,i)}getBufferedFrag(e,i){return this.getFragAtPos(e,i,!0)}getFragAtPos(e,i,a){const{fragments:o}=this,c=Object.keys(o);for(let d=c.length;d--;){const g=o[c[d]];if((g==null?void 0:g.body.type)===i&&(!a||g.buffered)){const b=g.body;if(b.start<=e&&e<=b.end)return b}}return null}detectEvictedFragments(e,i,a,o,c){this.timeRanges&&(this.timeRanges[e]=i);const d=(o==null?void 0:o.fragment.sn)||-1;Object.keys(this.fragments).forEach(g=>{const b=this.fragments[g];if(!b||d>=b.body.sn)return;if(!b.buffered&&(!b.loaded||c)){b.body.type===a&&this.removeFragment(b.body);return}const _=b.range[e];if(_){if(_.time.length===0){this.removeFragment(b.body);return}_.time.some(j=>{const $=!this.isTimeBuffered(j.startPTS,j.endPTS,i);return $&&this.removeFragment(b.body),$})}})}detectPartialFragments(e){const i=this.timeRanges;if(!i||e.frag.sn==="initSegment")return;const a=e.frag,o=getFragmentKey(a),c=this.fragments[o];if(!c||c.buffered&&a.gap)return;const d=!a.relurl;Object.keys(i).forEach(g=>{const b=a.elementaryStreams[g];if(!b)return;const _=i[g],j=d||b.partial===!0;c.range[g]=this.getBufferedTimes(a,e.part,j,_)}),c.loaded=null,Object.keys(c.range).length?(c.buffered=!0,(c.body.endList=a.endList||c.body.endList)&&(this.endListFragments[c.body.type]=c),isPartial(c)||this.removeParts(a.sn-1,a.type)):this.removeFragment(c.body)}removeParts(e,i){const a=this.activePartLists[i];a&&(this.activePartLists[i]=filterParts(a,o=>o.fragment.sn>=e))}fragBuffered(e,i){const a=getFragmentKey(e);let o=this.fragments[a];!o&&i&&(o=this.fragments[a]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),o&&(o.loaded=null,o.buffered=!0)}getBufferedTimes(e,i,a,o){const c={time:[],partial:a},d=e.start,g=e.end,b=e.minEndPTS||g,_=e.maxStartPTS||d;for(let j=0;j<o.length;j++){const $=o.start(j)-this.bufferPadding,_e=o.end(j)+this.bufferPadding;if(_>=$&&b<=_e){c.time.push({startPTS:Math.max(d,o.start(j)),endPTS:Math.min(g,o.end(j))});break}else if(d<_e&&g>$){const tt=Math.max(d,o.start(j)),et=Math.min(g,o.end(j));et>tt&&(c.partial=!0,c.time.push({startPTS:tt,endPTS:et}))}else if(g<=$)break}return c}getPartialFragment(e){let i=null,a,o,c,d=0;const{bufferPadding:g,fragments:b}=this;return Object.keys(b).forEach(_=>{const j=b[_];j&&isPartial(j)&&(o=j.body.start-g,c=j.body.end+g,e>=o&&e<=c&&(a=Math.min(e-o,c-e),d<=a&&(i=j.body,d=a)))}),i}isEndListAppended(e){const i=this.endListFragments[e];return i!==void 0&&(i.buffered||isPartial(i))}getState(e){const i=getFragmentKey(e),a=this.fragments[i];return a?a.buffered?isPartial(a)?FragmentState.PARTIAL:FragmentState.OK:FragmentState.APPENDING:FragmentState.NOT_LOADED}isTimeBuffered(e,i,a){let o,c;for(let d=0;d<a.length;d++){if(o=a.start(d)-this.bufferPadding,c=a.end(d)+this.bufferPadding,e>=o&&i<=c)return!0;if(i<=o)return!1}return!1}onManifestLoading(){this.removeAllFragments()}onFragLoaded(e,i){if(i.frag.sn==="initSegment"||i.frag.bitrateTest)return;const a=i.frag,o=i.part?null:i,c=getFragmentKey(a);this.fragments[c]={body:a,appendedPTS:null,loaded:o,buffered:!1,range:Object.create(null)}}onBufferAppended(e,i){const{frag:a,part:o,timeRanges:c,type:d}=i;if(a.sn==="initSegment")return;const g=a.type;if(o){let _=this.activePartLists[g];_||(this.activePartLists[g]=_=[]),_.push(o)}this.timeRanges=c;const b=c[d];this.detectEvictedFragments(d,b,g,o)}onFragBuffered(e,i){this.detectPartialFragments(i)}hasFragment(e){const i=getFragmentKey(e);return!!this.fragments[i]}hasFragments(e){const{fragments:i}=this,a=Object.keys(i);if(!e)return a.length>0;for(let o=a.length;o--;){const c=i[a[o]];if((c==null?void 0:c.body.type)===e)return!0}return!1}hasParts(e){var i;return!!((i=this.activePartLists[e])!=null&&i.length)}removeFragmentsInRange(e,i,a,o,c){o&&!this.hasGaps||Object.keys(this.fragments).forEach(d=>{const g=this.fragments[d];if(!g)return;const b=g.body;b.type!==a||o&&!b.gap||b.start<i&&b.end>e&&(g.buffered||c)&&this.removeFragment(b)})}removeFragment(e){const i=getFragmentKey(e);e.clearElementaryStreamInfo();const a=this.activePartLists[e.type];if(a){const o=e.sn;this.activePartLists[e.type]=filterParts(a,c=>c.fragment.sn!==o)}delete this.fragments[i],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){var e;this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1;const i=(e=this.hls)==null||(e=e.latestLevelDetails)==null?void 0:e.partList;i&&i.forEach(a=>a.clearElementaryStreamInfo())}}function isPartial(s){var e,i,a;return s.buffered&&!!(s.body.gap||(e=s.range.video)!=null&&e.partial||(i=s.range.audio)!=null&&i.partial||(a=s.range.audiovideo)!=null&&a.partial)}function getFragmentKey(s){return`${s.type}_${s.level}_${s.sn}`}function filterParts(s,e){return s.filter(i=>{const a=e(i);return a||i.clearElementaryStreamInfo(),a})}var DecrypterAesMode={cbc:0,ctr:1};class AESCrypto{constructor(e,i,a){this.subtle=void 0,this.aesIV=void 0,this.aesMode=void 0,this.subtle=e,this.aesIV=i,this.aesMode=a}decrypt(e,i){switch(this.aesMode){case DecrypterAesMode.cbc:return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},i,e);case DecrypterAesMode.ctr:return this.subtle.decrypt({name:"AES-CTR",counter:this.aesIV,length:64},i,e);default:throw new Error(`[AESCrypto] invalid aes mode ${this.aesMode}`)}}}function removePadding(s){const e=s.byteLength,i=e&&new DataView(s.buffer).getUint8(e-1);return i?s.slice(0,e-i):s}class AESDecryptor{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const i=new DataView(e),a=new Uint32Array(4);for(let o=0;o<4;o++)a[o]=i.getUint32(o*4);return a}initTable(){const e=this.sBox,i=this.invSBox,a=this.subMix,o=a[0],c=a[1],d=a[2],g=a[3],b=this.invSubMix,_=b[0],j=b[1],$=b[2],_e=b[3],tt=new Uint32Array(256);let et=0,st=0,at=0;for(at=0;at<256;at++)at<128?tt[at]=at<<1:tt[at]=at<<1^283;for(at=0;at<256;at++){let rt=st^st<<1^st<<2^st<<3^st<<4;rt=rt>>>8^rt&255^99,e[et]=rt,i[rt]=et;const nt=tt[et],it=tt[nt],ot=tt[it];let lt=tt[rt]*257^rt*16843008;o[et]=lt<<24|lt>>>8,c[et]=lt<<16|lt>>>16,d[et]=lt<<8|lt>>>24,g[et]=lt,lt=ot*16843009^it*65537^nt*257^et*16843008,_[rt]=lt<<24|lt>>>8,j[rt]=lt<<16|lt>>>16,$[rt]=lt<<8|lt>>>24,_e[rt]=lt,et?(et=nt^tt[tt[tt[ot^nt]]],st^=tt[tt[st]]):et=st=1}}expandKey(e){const i=this.uint8ArrayToUint32Array_(e);let a=!0,o=0;for(;o<i.length&&a;)a=i[o]===this.key[o],o++;if(a)return;this.key=i;const c=this.keySize=i.length;if(c!==4&&c!==6&&c!==8)throw new Error("Invalid aes key size="+c);const d=this.ksRows=(c+6+1)*4;let g,b;const _=this.keySchedule=new Uint32Array(d),j=this.invKeySchedule=new Uint32Array(d),$=this.sBox,_e=this.rcon,tt=this.invSubMix,et=tt[0],st=tt[1],at=tt[2],rt=tt[3];let nt,it;for(g=0;g<d;g++){if(g<c){nt=_[g]=i[g];continue}it=nt,g%c===0?(it=it<<8|it>>>24,it=$[it>>>24]<<24|$[it>>>16&255]<<16|$[it>>>8&255]<<8|$[it&255],it^=_e[g/c|0]<<24):c>6&&g%c===4&&(it=$[it>>>24]<<24|$[it>>>16&255]<<16|$[it>>>8&255]<<8|$[it&255]),_[g]=nt=(_[g-c]^it)>>>0}for(b=0;b<d;b++)g=d-b,b&3?it=_[g]:it=_[g-4],b<4||g<=4?j[b]=it:j[b]=et[$[it>>>24]]^st[$[it>>>16&255]]^at[$[it>>>8&255]]^rt[$[it&255]],j[b]=j[b]>>>0}networkToHostOrderSwap(e){return e<<24|(e&65280)<<8|(e&16711680)>>8|e>>>24}decrypt(e,i,a){const o=this.keySize+6,c=this.invKeySchedule,d=this.invSBox,g=this.invSubMix,b=g[0],_=g[1],j=g[2],$=g[3],_e=this.uint8ArrayToUint32Array_(a);let tt=_e[0],et=_e[1],st=_e[2],at=_e[3];const rt=new Int32Array(e),nt=new Int32Array(rt.length);let it,ot,lt,ct,ht,dt,gt,vt,St,Tt,Ct,Rt,bt,pt;const yt=this.networkToHostOrderSwap;for(;i<rt.length;){for(St=yt(rt[i]),Tt=yt(rt[i+1]),Ct=yt(rt[i+2]),Rt=yt(rt[i+3]),ht=St^c[0],dt=Rt^c[1],gt=Ct^c[2],vt=Tt^c[3],bt=4,pt=1;pt<o;pt++)it=b[ht>>>24]^_[dt>>16&255]^j[gt>>8&255]^$[vt&255]^c[bt],ot=b[dt>>>24]^_[gt>>16&255]^j[vt>>8&255]^$[ht&255]^c[bt+1],lt=b[gt>>>24]^_[vt>>16&255]^j[ht>>8&255]^$[dt&255]^c[bt+2],ct=b[vt>>>24]^_[ht>>16&255]^j[dt>>8&255]^$[gt&255]^c[bt+3],ht=it,dt=ot,gt=lt,vt=ct,bt=bt+4;it=d[ht>>>24]<<24^d[dt>>16&255]<<16^d[gt>>8&255]<<8^d[vt&255]^c[bt],ot=d[dt>>>24]<<24^d[gt>>16&255]<<16^d[vt>>8&255]<<8^d[ht&255]^c[bt+1],lt=d[gt>>>24]<<24^d[vt>>16&255]<<16^d[ht>>8&255]<<8^d[dt&255]^c[bt+2],ct=d[vt>>>24]<<24^d[ht>>16&255]<<16^d[dt>>8&255]<<8^d[gt&255]^c[bt+3],nt[i]=yt(it^tt),nt[i+1]=yt(ct^et),nt[i+2]=yt(lt^st),nt[i+3]=yt(ot^at),tt=St,et=Tt,st=Ct,at=Rt,i=i+4}return nt.buffer}}class FastAESKey{constructor(e,i,a){this.subtle=void 0,this.key=void 0,this.aesMode=void 0,this.subtle=e,this.key=i,this.aesMode=a}expandKey(){const e=getSubtleAlgoName(this.aesMode);return this.subtle.importKey("raw",this.key,{name:e},!1,["encrypt","decrypt"])}}function getSubtleAlgoName(s){switch(s){case DecrypterAesMode.cbc:return"AES-CBC";case DecrypterAesMode.ctr:return"AES-CTR";default:throw new Error(`[FastAESKey] invalid aes mode ${s}`)}}const CHUNK_SIZE=16;class Decrypter{constructor(e,{removePKCS7Padding:i=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.enableSoftwareAES=void 0,this.enableSoftwareAES=e.enableSoftwareAES,this.removePKCS7Padding=i,i)try{const a=self.crypto;a&&(this.subtle=a.subtle||a.webkitSubtle)}catch{}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:i}=this;if(!e||i)return this.reset(),null;const a=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?removePadding(a):a}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,i,a,o){return this.useSoftware?new Promise((c,d)=>{const g=ArrayBuffer.isView(e)?e:new Uint8Array(e);this.softwareDecrypt(g,i,a,o);const b=this.flush();b?c(b.buffer):d(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(e),i,a,o)}softwareDecrypt(e,i,a,o){const{currentIV:c,currentResult:d,remainderData:g}=this;if(o!==DecrypterAesMode.cbc||i.byteLength!==16)return logger.warn("SoftwareDecrypt: can only handle AES-128-CBC"),null;this.logOnce("JS AES decrypt"),g&&(e=appendUint8Array(g,e),this.remainderData=null);const b=this.getValidChunk(e);if(!b.length)return null;c&&(a=c);let _=this.softwareDecrypter;_||(_=this.softwareDecrypter=new AESDecryptor),_.expandKey(i);const j=d;return this.currentResult=_.decrypt(b.buffer,0,a),this.currentIV=b.slice(-16).buffer,j||null}webCryptoDecrypt(e,i,a,o){if(this.key!==i||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(e,i,a,o));this.key=i,this.fastAesKey=new FastAESKey(this.subtle,i,o)}return this.fastAesKey.expandKey().then(c=>this.subtle?(this.logOnce("WebCrypto AES decrypt"),new AESCrypto(this.subtle,new Uint8Array(a),o).decrypt(e.buffer,c)):Promise.reject(new Error("web crypto not initialized"))).catch(c=>(logger.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${c.name}: ${c.message}`),this.onWebCryptoError(e,i,a,o)))}onWebCryptoError(e,i,a,o){const c=this.enableSoftwareAES;if(c){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,i,a,o);const d=this.flush();if(d)return d.buffer}throw new Error("WebCrypto"+(c?" and softwareDecrypt":"")+": failed to decrypt data")}getValidChunk(e){let i=e;const a=e.length-e.length%CHUNK_SIZE;return a!==e.length&&(i=e.slice(0,a),this.remainderData=e.slice(a)),i}logOnce(e){this.logEnabled&&(logger.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}const MIN_CHUNK_SIZE=Math.pow(2,17);class FragmentLoader{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,i){const a=e.url;if(!a)return Promise.reject(new LoadError({type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error(`Fragment does not have a ${a?"part list":"url"}`),networkDetails:null}));this.abort();const o=this.config,c=o.fLoader,d=o.loader;return new Promise((g,b)=>{if(this.loader&&this.loader.destroy(),e.gap)if(e.tagList.some(et=>et[0]==="GAP")){b(createGapLoadError(e));return}else e.gap=!1;const _=this.loader=c?new c(o):new d(o),j=createLoaderContext(e);e.loader=_;const $=getLoaderConfigWithoutReties(o.fragLoadPolicy.default),_e={loadPolicy:$,timeout:$.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:e.sn==="initSegment"?1/0:MIN_CHUNK_SIZE};e.stats=_.stats;const tt={onSuccess:(et,st,at,rt)=>{this.resetLoader(e,_);let nt=et.data;at.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(nt.slice(0,16)),nt=nt.slice(16)),g({frag:e,part:null,payload:nt,networkDetails:rt})},onError:(et,st,at,rt)=>{this.resetLoader(e,_),b(new LoadError({type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:_objectSpread2({url:a,data:void 0},et),error:new Error(`HTTP Error ${et.code} ${et.text}`),networkDetails:at,stats:rt}))},onAbort:(et,st,at)=>{this.resetLoader(e,_),b(new LoadError({type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:at,stats:et}))},onTimeout:(et,st,at)=>{this.resetLoader(e,_),b(new LoadError({type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${_e.timeout}ms`),networkDetails:at,stats:et}))}};i&&(tt.onProgress=(et,st,at,rt)=>i({frag:e,part:null,payload:at,networkDetails:rt})),_.load(j,_e,tt)})}loadPart(e,i,a){this.abort();const o=this.config,c=o.fLoader,d=o.loader;return new Promise((g,b)=>{if(this.loader&&this.loader.destroy(),e.gap||i.gap){b(createGapLoadError(e,i));return}const _=this.loader=c?new c(o):new d(o),j=createLoaderContext(e,i);e.loader=_;const $=getLoaderConfigWithoutReties(o.fragLoadPolicy.default),_e={loadPolicy:$,timeout:$.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:MIN_CHUNK_SIZE};i.stats=_.stats,_.load(j,_e,{onSuccess:(tt,et,st,at)=>{this.resetLoader(e,_),this.updateStatsFromPart(e,i);const rt={frag:e,part:i,payload:tt.data,networkDetails:at};a(rt),g(rt)},onError:(tt,et,st,at)=>{this.resetLoader(e,_),b(new LoadError({type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:i,response:_objectSpread2({url:j.url,data:void 0},tt),error:new Error(`HTTP Error ${tt.code} ${tt.text}`),networkDetails:st,stats:at}))},onAbort:(tt,et,st)=>{e.stats.aborted=i.stats.aborted,this.resetLoader(e,_),b(new LoadError({type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:e,part:i,error:new Error("Aborted"),networkDetails:st,stats:tt}))},onTimeout:(tt,et,st)=>{this.resetLoader(e,_),b(new LoadError({type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:i,error:new Error(`Timeout after ${_e.timeout}ms`),networkDetails:st,stats:tt}))}})})}updateStatsFromPart(e,i){const a=e.stats,o=i.stats,c=o.total;if(a.loaded+=o.loaded,c){const b=Math.round(e.duration/i.duration),_=Math.min(Math.round(a.loaded/c),b),$=(b-_)*Math.round(a.loaded/_);a.total=a.loaded+$}else a.total=Math.max(a.loaded,a.total);const d=a.loading,g=o.loading;d.start?d.first+=g.first-g.start:(d.start=g.start,d.first=g.first),d.end=g.end}resetLoader(e,i){e.loader=null,this.loader===i&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),i.destroy()}}function createLoaderContext(s,e=null){const i=e||s,a={frag:s,part:e,responseType:"arraybuffer",url:i.url,headers:{},rangeStart:0,rangeEnd:0},o=i.byteRangeStartOffset,c=i.byteRangeEndOffset;if(isFiniteNumber(o)&&isFiniteNumber(c)){var d;let g=o,b=c;if(s.sn==="initSegment"&&isMethodFullSegmentAesCbc((d=s.decryptdata)==null?void 0:d.method)){const _=c-o;_%16&&(b=c+(16-_%16)),o!==0&&(a.resetIV=!0,g=o-16)}a.rangeStart=g,a.rangeEnd=b}return a}function createGapLoadError(s,e){const i=new Error(`GAP ${s.gap?"tag":"attribute"} found`),a={type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_GAP,fatal:!1,frag:s,error:i,networkDetails:null};return e&&(a.part=e),(e||s).stats.aborted=!0,new LoadError(a)}function isMethodFullSegmentAesCbc(s){return s==="AES-128"||s==="AES-256"}class LoadError extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class TaskLoop extends Logger{constructor(e,i){super(e,i),this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}class ChunkMetadata{constructor(e,i,a,o=0,c=-1,d=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=getNewPerformanceTiming(),this.buffering={audio:getNewPerformanceTiming(),video:getNewPerformanceTiming(),audiovideo:getNewPerformanceTiming()},this.level=e,this.sn=i,this.id=a,this.size=o,this.part=c,this.partial=d}}function getNewPerformanceTiming(){return{start:0,executeStart:0,executeEnd:0,end:0}}const noopBuffered={length:0,start:()=>0,end:()=>0};class BufferHelper{static isBuffered(e,i){if(e){const a=BufferHelper.getBuffered(e);for(let o=a.length;o--;)if(i>=a.start(o)&&i<=a.end(o))return!0}return!1}static bufferedRanges(e){if(e){const i=BufferHelper.getBuffered(e);return BufferHelper.timeRangesToArray(i)}return[]}static timeRangesToArray(e){const i=[];for(let a=0;a<e.length;a++)i.push({start:e.start(a),end:e.end(a)});return i}static bufferInfo(e,i,a){if(e){const o=BufferHelper.bufferedRanges(e);if(o.length)return BufferHelper.bufferedInfo(o,i,a)}return{len:0,start:i,end:i,bufferedIndex:-1}}static bufferedInfo(e,i,a){i=Math.max(0,i),e.length>1&&e.sort((j,$)=>j.start-$.start||$.end-j.end);let o=-1,c=[];if(a)for(let j=0;j<e.length;j++){i>=e[j].start&&i<=e[j].end&&(o=j);const $=c.length;if($){const _e=c[$-1].end;e[j].start-_e<a?e[j].end>_e&&(c[$-1].end=e[j].end):c.push(e[j])}else c.push(e[j])}else c=e;let d=0,g,b=i,_=i;for(let j=0;j<c.length;j++){const $=c[j].start,_e=c[j].end;if(o===-1&&i>=$&&i<=_e&&(o=j),i+a>=$&&i<_e)b=$,_=_e,d=_-i;else if(i+a<$){g=$;break}}return{len:d,start:b||0,end:_||0,nextStart:g,buffered:e,bufferedIndex:o}}static getBuffered(e){try{return e.buffered||noopBuffered}catch(i){return logger.log("failed to get media.buffered",i),noopBuffered}}}const VARIABLE_REPLACEMENT_REGEX=/\{\$([a-zA-Z0-9-_]+)\}/g;function hasVariableReferences(s){return VARIABLE_REPLACEMENT_REGEX.test(s)}function substituteVariables(s,e){if(s.variableList!==null||s.hasVariableRefs){const i=s.variableList;return e.replace(VARIABLE_REPLACEMENT_REGEX,a=>{const o=a.substring(2,a.length-1),c=i==null?void 0:i[o];return c===void 0?(s.playlistParsingError||(s.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${o}"`)),a):c})}return e}function addVariableDefinition(s,e,i){let a=s.variableList;a||(s.variableList=a={});let o,c;if("QUERYPARAM"in e){o=e.QUERYPARAM;try{const d=new self.URL(i).searchParams;if(d.has(o))c=d.get(o);else throw new Error(`"${o}" does not match any query parameter in URI: "${i}"`)}catch(d){s.playlistParsingError||(s.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${d.message}`))}}else o=e.NAME,c=e.VALUE;o in a?s.playlistParsingError||(s.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${o}"`)):a[o]=c||""}function importVariableDefinition(s,e,i){const a=e.IMPORT;if(i&&a in i){let o=s.variableList;o||(s.variableList=o={}),o[a]=i[a]}else s.playlistParsingError||(s.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${a}"`))}const DECIMAL_RESOLUTION_REGEX=/^(\d+)x(\d+)$/,ATTR_LIST_REGEX=/(.+?)=(".*?"|.*?)(?:,|$)/g;class AttrList{constructor(e,i){typeof e=="string"&&(e=AttrList.parseAttrList(e,i)),_extends(this,e)}get clientAttrs(){return Object.keys(this).filter(e=>e.substring(0,2)==="X-")}decimalInteger(e){const i=parseInt(this[e],10);return i>Number.MAX_SAFE_INTEGER?1/0:i}hexadecimalInteger(e){if(this[e]){let i=(this[e]||"0x").slice(2);i=(i.length&1?"0":"")+i;const a=new Uint8Array(i.length/2);for(let o=0;o<i.length/2;o++)a[o]=parseInt(i.slice(o*2,o*2+2),16);return a}return null}hexadecimalIntegerAsNumber(e){const i=parseInt(this[e],16);return i>Number.MAX_SAFE_INTEGER?1/0:i}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,i){const a=this[e];return a?parseFloat(a):i}enumeratedString(e){return this[e]}enumeratedStringList(e,i){const a=this[e];return(a?a.split(/[ ,]+/):[]).reduce((o,c)=>(o[c.toLowerCase()]=!0,o),i)}bool(e){return this[e]==="YES"}decimalResolution(e){const i=DECIMAL_RESOLUTION_REGEX.exec(this[e]);if(i!==null)return{width:parseInt(i[1],10),height:parseInt(i[2],10)}}static parseAttrList(e,i){let a;const o={},c='"';for(ATTR_LIST_REGEX.lastIndex=0;(a=ATTR_LIST_REGEX.exec(e))!==null;){const d=a[1].trim();let g=a[2];const b=g.indexOf(c)===0&&g.lastIndexOf(c)===g.length-1;let _=!1;if(b)g=g.slice(1,-1);else switch(d){case"IV":case"SCTE35-CMD":case"SCTE35-IN":case"SCTE35-OUT":_=!0}if(i&&(b||_))g=substituteVariables(i,g);else if(!_&&!b)switch(d){case"CLOSED-CAPTIONS":if(g==="NONE")break;case"ALLOWED-CPC":case"CLASS":case"ASSOC-LANGUAGE":case"AUDIO":case"BYTERANGE":case"CHANNELS":case"CHARACTERISTICS":case"CODECS":case"DATA-ID":case"END-DATE":case"GROUP-ID":case"ID":case"IMPORT":case"INSTREAM-ID":case"KEYFORMAT":case"KEYFORMATVERSIONS":case"LANGUAGE":case"NAME":case"PATHWAY-ID":case"QUERYPARAM":case"RECENTLY-REMOVED-DATERANGES":case"SERVER-URI":case"STABLE-RENDITION-ID":case"STABLE-VARIANT-ID":case"START-DATE":case"SUBTITLES":case"SUPPLEMENTAL-CODECS":case"URI":case"VALUE":case"VIDEO":case"X-ASSET-LIST":case"X-ASSET-URI":logger.warn(`${e}: attribute ${d} is missing quotes`)}o[d]=g}return o}}const CLASS_INTERSTITIAL="com.apple.hls.interstitial";function isDateRangeCueAttribute(s){return s!=="ID"&&s!=="CLASS"&&s!=="CUE"&&s!=="START-DATE"&&s!=="DURATION"&&s!=="END-DATE"&&s!=="END-ON-NEXT"}function isSCTE35Attribute(s){return s==="SCTE35-OUT"||s==="SCTE35-IN"||s==="SCTE35-CMD"}class DateRange{constructor(e,i,a=0){var o;if(this.attr=void 0,this.tagAnchor=void 0,this.tagOrder=void 0,this._startDate=void 0,this._endDate=void 0,this._dateAtEnd=void 0,this._cue=void 0,this._badValueForSameId=void 0,this.tagAnchor=(i==null?void 0:i.tagAnchor)||null,this.tagOrder=(o=i==null?void 0:i.tagOrder)!=null?o:a,i){const c=i.attr;for(const d in c)if(Object.prototype.hasOwnProperty.call(e,d)&&e[d]!==c[d]){logger.warn(`DATERANGE tag attribute: "${d}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=d;break}e=_extends(new AttrList({}),c,e)}if(this.attr=e,i?(this._startDate=i._startDate,this._cue=i._cue,this._endDate=i._endDate,this._dateAtEnd=i._dateAtEnd):this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const c=(i==null?void 0:i.endDate)||new Date(this.attr["END-DATE"]);isFiniteNumber(c.getTime())&&(this._endDate=c)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get cue(){const e=this._cue;return e===void 0?this._cue=this.attr.enumeratedStringList(this.attr.CUE?"CUE":"X-CUE",{pre:!1,post:!1,once:!1}):e}get startTime(){const{tagAnchor:e}=this;return e===null||e.programDateTime===null?(logger.warn(`Expected tagAnchor Fragment with PDT set for DateRange "${this.id}": ${e}`),NaN):e.start+(this.startDate.getTime()-e.programDateTime)/1e3}get startDate(){return this._startDate}get endDate(){const e=this._endDate||this._dateAtEnd;if(e)return e;const i=this.duration;return i!==null?this._dateAtEnd=new Date(this._startDate.getTime()+i*1e3):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(isFiniteNumber(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isInterstitial(){return this.class===CLASS_INTERSTITIAL}get isValid(){return!!this.id&&!this._badValueForSameId&&isFiniteNumber(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)&&(!this.attr.CUE||!this.cue.pre&&!this.cue.post||this.cue.pre!==this.cue.post)&&(!this.isInterstitial||"X-ASSET-URI"in this.attr||"X-ASSET-LIST"in this.attr)}}const DEFAULT_TARGET_DURATION=10;class LevelDetails{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.dateRangeTagCount=0,this.live=!0,this.requestScheduled=-1,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.appliedTimelineOffset=void 0,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e){this.advanced=!0,this.updated=!0;return}const i=this.lastPartSn-e.lastPartSn,a=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!a||!!i||!this.live,this.advanced=this.endSN>e.endSN||i>0||i===0&&a>0,this.updated||this.advanced?this.misses=Math.floor(e.misses*.6):this.misses=e.misses+1}hasKey(e){return this.encryptedFragments.some(i=>{let a=i.decryptdata;return a||(i.setKeyFormat(e.keyFormat),a=i.decryptdata),!!a&&e.matches(a)})}get hasProgramDateTime(){return this.fragments.length?isFiniteNumber(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||DEFAULT_TARGET_DURATION}get drift(){const e=this.driftEndTime-this.driftStartTime;return e>0?(this.driftEnd-this.driftStart)*1e3/e:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){return this.fragments.length?this.fragments[this.fragments.length-1].end:0}get fragmentStart(){return this.fragments.length?this.fragments[0].start:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].index:-1}get maxPartIndex(){const e=this.partList;if(e){const i=this.lastPartIndex;if(i!==-1){for(let a=e.length;a--;)if(e[a].index>i)return e[a].index;return i}}return 0}get lastPartSn(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}get expired(){if(this.live&&this.age&&this.misses<3){const e=this.partEnd-this.fragmentStart;return this.age>Math.max(e,this.totalduration)+this.levelTargetDuration}return!1}}function arrayValuesMatch(s,e){return s.length===e.length?!s.some((i,a)=>i!==e[a]):!1}function optionalArrayValuesMatch(s,e){return!s&&!e?!0:!s||!e?!1:arrayValuesMatch(s,e)}function isFullSegmentEncryption(s){return s==="AES-128"||s==="AES-256"||s==="AES-256-CTR"}function getAesModeFromFullSegmentMethod(s){switch(s){case"AES-128":case"AES-256":return DecrypterAesMode.cbc;case"AES-256-CTR":return DecrypterAesMode.ctr;default:throw new Error(`invalid full segment method ${s}`)}}function base64Decode(s){return Uint8Array.from(atob(s),e=>e.charCodeAt(0))}function strToUtf8array(s){return Uint8Array.from(unescape(encodeURIComponent(s)),e=>e.charCodeAt(0))}function getKeyIdBytes(s){const e=strToUtf8array(s).subarray(0,16),i=new Uint8Array(16);return i.set(e,16-e.length),i}function changeEndianness(s){const e=function(a,o,c){const d=a[o];a[o]=a[c],a[c]=d};e(s,0,3),e(s,1,2),e(s,4,5),e(s,6,7)}function convertDataUriToArrayBytes(s){const e=s.split(":");let i=null;if(e[0]==="data"&&e.length===2){const a=e[1].split(";"),o=a[a.length-1].split(",");if(o.length===2){const c=o[0]==="base64",d=o[1];c?(a.splice(-1,1),i=base64Decode(d)):i=getKeyIdBytes(d)}}return i}const optionalSelf=typeof self<"u"?self:void 0;var KeySystems={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},KeySystemFormats={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function keySystemFormatToKeySystemDomain(s){switch(s){case KeySystemFormats.FAIRPLAY:return KeySystems.FAIRPLAY;case KeySystemFormats.PLAYREADY:return KeySystems.PLAYREADY;case KeySystemFormats.WIDEVINE:return KeySystems.WIDEVINE;case KeySystemFormats.CLEARKEY:return KeySystems.CLEARKEY}}function keySystemDomainToKeySystemFormat(s){switch(s){case KeySystems.FAIRPLAY:return KeySystemFormats.FAIRPLAY;case KeySystems.PLAYREADY:return KeySystemFormats.PLAYREADY;case KeySystems.WIDEVINE:return KeySystemFormats.WIDEVINE;case KeySystems.CLEARKEY:return KeySystemFormats.CLEARKEY}}function getKeySystemsForConfig(s){const{drmSystems:e,widevineLicenseUrl:i}=s,a=e?[KeySystems.FAIRPLAY,KeySystems.WIDEVINE,KeySystems.PLAYREADY,KeySystems.CLEARKEY].filter(o=>!!e[o]):[];return!a[KeySystems.WIDEVINE]&&i&&a.push(KeySystems.WIDEVINE),a}const requestMediaKeySystemAccess=function(s){return optionalSelf!=null&&(s=optionalSelf.navigator)!=null&&s.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}();function getSupportedMediaKeySystemConfigurations(s,e,i,a){let o;switch(s){case KeySystems.FAIRPLAY:o=["cenc","sinf"];break;case KeySystems.WIDEVINE:case KeySystems.PLAYREADY:o=["cenc"];break;case KeySystems.CLEARKEY:o=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${s}`)}return createMediaKeySystemConfigurations(o,e,i,a)}function createMediaKeySystemConfigurations(s,e,i,a){return[{initDataTypes:s,persistentState:a.persistentState||"optional",distinctiveIdentifier:a.distinctiveIdentifier||"optional",sessionTypes:a.sessionTypes||[a.sessionType||"temporary"],audioCapabilities:e.map(c=>({contentType:`audio/mp4; codecs=${c}`,robustness:a.audioRobustness||"",encryptionScheme:a.audioEncryptionScheme||null})),videoCapabilities:i.map(c=>({contentType:`video/mp4; codecs=${c}`,robustness:a.videoRobustness||"",encryptionScheme:a.videoEncryptionScheme||null}))}]}function isPersistentSessionType(s){var e;return!!s&&(s.sessionType==="persistent-license"||!!((e=s.sessionTypes)!=null&&e.some(i=>i==="persistent-license")))}function parsePlayReadyWRM(s){const e=new Uint16Array(s.buffer,s.byteOffset,s.byteLength/2),i=String.fromCharCode.apply(null,Array.from(e)),a=i.substring(i.indexOf("<"),i.length),d=new DOMParser().parseFromString(a,"text/xml").getElementsByTagName("KID")[0];if(d){const g=d.childNodes[0]?d.childNodes[0].nodeValue:d.getAttribute("VALUE");if(g){const b=base64Decode(g).subarray(0,16);return changeEndianness(b),b}}return null}let keyUriToKeyIdMap={};class LevelKey{static clearKeyUriToKeyIdMap(){keyUriToKeyIdMap={}}static setKeyIdForUri(e,i){keyUriToKeyIdMap[e]=i}constructor(e,i,a,o=[1],c=null,d){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=i,this.keyFormat=a,this.keyFormatVersions=o,this.iv=c,this.encrypted=e?e!=="NONE":!1,this.isCommonEncryption=this.encrypted&&!isFullSegmentEncryption(e),d!=null&&d.startsWith("0x")&&(this.keyId=new Uint8Array(hexToArrayBuffer(d)))}matches(e){return e.uri===this.uri&&e.method===this.method&&e.encrypted===this.encrypted&&e.keyFormat===this.keyFormat&&arrayValuesMatch(e.keyFormatVersions,this.keyFormatVersions)&&optionalArrayValuesMatch(e.iv,this.iv)&&optionalArrayValuesMatch(e.keyId,this.keyId)}isSupported(){if(this.method){if(isFullSegmentEncryption(this.method)||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case KeySystemFormats.FAIRPLAY:case KeySystemFormats.WIDEVINE:case KeySystemFormats.PLAYREADY:case KeySystemFormats.CLEARKEY:return["SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(e,i){if(!this.encrypted||!this.uri)return null;if(isFullSegmentEncryption(this.method)){let c=this.iv;return c||(typeof e!="number"&&(logger.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0),c=createInitializationVector(e)),new LevelKey(this.method,this.uri,"identity",this.keyFormatVersions,c)}if(this.keyId){const c=keyUriToKeyIdMap[this.uri];if(c&&!arrayValuesMatch(this.keyId,c)&&LevelKey.setKeyIdForUri(this.uri,this.keyId),this.pssh)return this}const a=convertDataUriToArrayBytes(this.uri);if(a)switch(this.keyFormat){case KeySystemFormats.WIDEVINE:if(this.pssh=a,!this.keyId){const c=parseMultiPssh(a.buffer);if(c.length){var o;const d=c[0];this.keyId=(o=d.kids)!=null&&o.length?d.kids[0]:null}}this.keyId||(this.keyId=getKeyIdFromPlayReadyKey(i));break;case KeySystemFormats.PLAYREADY:{const c=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=mp4pssh(c,null,a),this.keyId=parsePlayReadyWRM(a);break}default:{let c=a.subarray(0,16);if(c.length!==16){const d=new Uint8Array(16);d.set(c,16-c.length),c=d}this.keyId=c;break}}if(!this.keyId||this.keyId.byteLength!==16){let c;c=getKeyIdFromWidevineKey(i),c||(c=getKeyIdFromPlayReadyKey(i),c||(c=keyUriToKeyIdMap[this.uri])),c&&(this.keyId=c,LevelKey.setKeyIdForUri(this.uri,c))}return this}}function getKeyIdFromWidevineKey(s){const e=s==null?void 0:s[KeySystemFormats.WIDEVINE];return e?e.keyId:null}function getKeyIdFromPlayReadyKey(s){const e=s==null?void 0:s[KeySystemFormats.PLAYREADY];if(e){const i=convertDataUriToArrayBytes(e.uri);if(i)return parsePlayReadyWRM(i)}return null}function createInitializationVector(s){const e=new Uint8Array(16);for(let i=12;i<16;i++)e[i]=s>>8*(15-i)&255;return e}const MASTER_PLAYLIST_REGEX=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,MASTER_PLAYLIST_MEDIA_REGEX=/#EXT-X-MEDIA:(.*)/g,IS_MEDIA_PLAYLIST=/^#EXT(?:INF|-X-TARGETDURATION):/m,LEVEL_PLAYLIST_REGEX_FAST=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#.*/.source].join("|"),"g"),LEVEL_PLAYLIST_REGEX_SLOW=new RegExp([/#EXT-X-(PROGRAM-DATE-TIME|BYTERANGE|DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class M3U8Parser{static findGroup(e,i){for(let a=0;a<e.length;a++){const o=e[a];if(o.id===i)return o}}static resolve(e,i){return urlToolkitExports.buildAbsoluteURL(i,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return IS_MEDIA_PLAYLIST.test(e)}static parseMasterPlaylist(e,i){const a=hasVariableReferences(e),o={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:a},c=[];if(MASTER_PLAYLIST_REGEX.lastIndex=0,!e.startsWith("#EXTM3U"))return o.playlistParsingError=new Error("no EXTM3U delimiter"),o;let d;for(;(d=MASTER_PLAYLIST_REGEX.exec(e))!=null;)if(d[1]){var g;const _=new AttrList(d[1],o),j=substituteVariables(o,d[2]),$={attrs:_,bitrate:_.decimalInteger("BANDWIDTH")||_.decimalInteger("AVERAGE-BANDWIDTH"),name:_.NAME,url:M3U8Parser.resolve(j,i)},_e=_.decimalResolution("RESOLUTION");_e&&($.width=_e.width,$.height=_e.height),setCodecs(_.CODECS,$);const tt=_["SUPPLEMENTAL-CODECS"];tt&&($.supplemental={},setCodecs(tt,$.supplemental)),(g=$.unknownCodecs)!=null&&g.length||c.push($),o.levels.push($)}else if(d[3]){const _=d[3],j=d[4];switch(_){case"SESSION-DATA":{const $=new AttrList(j,o),_e=$["DATA-ID"];_e&&(o.sessionData===null&&(o.sessionData={}),o.sessionData[_e]=$);break}case"SESSION-KEY":{const $=parseKey(j,i,o);$.encrypted&&$.isSupported()?(o.sessionKeys===null&&(o.sessionKeys=[]),o.sessionKeys.push($)):logger.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${j}"`);break}case"DEFINE":{{const $=new AttrList(j,o);addVariableDefinition(o,$,i)}break}case"CONTENT-STEERING":{const $=new AttrList(j,o);o.contentSteering={uri:M3U8Parser.resolve($["SERVER-URI"],i),pathwayId:$["PATHWAY-ID"]||"."};break}case"START":{o.startTimeOffset=parseStartTimeOffset(j);break}}}const b=c.length>0&&c.length<o.levels.length;return o.levels=b?c:o.levels,o.levels.length===0&&(o.playlistParsingError=new Error("no levels found in manifest")),o}static parseMasterPlaylistMedia(e,i,a){let o;const c={},d=a.levels,g={AUDIO:d.map(_=>({id:_.attrs.AUDIO,audioCodec:_.audioCodec})),SUBTITLES:d.map(_=>({id:_.attrs.SUBTITLES,textCodec:_.textCodec})),"CLOSED-CAPTIONS":[]};let b=0;for(MASTER_PLAYLIST_MEDIA_REGEX.lastIndex=0;(o=MASTER_PLAYLIST_MEDIA_REGEX.exec(e))!==null;){const _=new AttrList(o[1],a),j=_.TYPE;if(j){const $=g[j],_e=c[j]||[];c[j]=_e;const tt=_.LANGUAGE,et=_["ASSOC-LANGUAGE"],st=_.CHANNELS,at=_.CHARACTERISTICS,rt=_["INSTREAM-ID"],nt={attrs:_,bitrate:0,id:b++,groupId:_["GROUP-ID"]||"",name:_.NAME||tt||"",type:j,default:_.bool("DEFAULT"),autoselect:_.bool("AUTOSELECT"),forced:_.bool("FORCED"),lang:tt,url:_.URI?M3U8Parser.resolve(_.URI,i):""};if(et&&(nt.assocLang=et),st&&(nt.channels=st),at&&(nt.characteristics=at),rt&&(nt.instreamId=rt),$!=null&&$.length){const it=M3U8Parser.findGroup($,nt.groupId)||$[0];assignCodec(nt,it,"audioCodec"),assignCodec(nt,it,"textCodec")}_e.push(nt)}}return c}static parseLevelPlaylist(e,i,a,o,c,d){var g;const b={url:i},_=new LevelDetails(i),j=_.fragments,$=[];let _e=null,tt=0,et=0,st=0,at=0,rt=0,nt=null,it=new Fragment(o,b),ot,lt,ct,ht=-1,dt=!1,gt=null,vt;if(LEVEL_PLAYLIST_REGEX_FAST.lastIndex=0,_.m3u8=e,_.hasVariableRefs=hasVariableReferences(e),((g=LEVEL_PLAYLIST_REGEX_FAST.exec(e))==null?void 0:g[0])!=="#EXTM3U")return _.playlistParsingError=new Error("Missing format identifier #EXTM3U"),_;for(;(ot=LEVEL_PLAYLIST_REGEX_FAST.exec(e))!==null;){dt&&(dt=!1,it=new Fragment(o,b),it.playlistOffset=st,it.setStart(st),it.sn=tt,it.cc=at,rt&&(it.bitrate=rt),it.level=a,_e&&(it.initSegment=_e,_e.rawProgramDateTime&&(it.rawProgramDateTime=_e.rawProgramDateTime,_e.rawProgramDateTime=null),gt&&(it.setByteRange(gt),gt=null)));const Rt=ot[1];if(Rt){it.duration=parseFloat(Rt);const bt=(" "+ot[2]).slice(1);it.title=bt||null,it.tagList.push(bt?["INF",Rt,bt]:["INF",Rt])}else if(ot[3]){if(isFiniteNumber(it.duration)){it.playlistOffset=st,it.setStart(st),ct&&setFragLevelKeys(it,ct,_),it.sn=tt,it.level=a,it.cc=at,j.push(it);const bt=(" "+ot[3]).slice(1);it.relurl=substituteVariables(_,bt),assignProgramDateTime(it,nt,$),nt=it,st+=it.duration,tt++,et=0,dt=!0}}else{if(ot=ot[0].match(LEVEL_PLAYLIST_REGEX_SLOW),!ot){logger.warn("No matches on slow regex match for level playlist!");continue}for(lt=1;lt<ot.length&&ot[lt]===void 0;lt++);const bt=(" "+ot[lt]).slice(1),pt=(" "+ot[lt+1]).slice(1),yt=ot[lt+2]?(" "+ot[lt+2]).slice(1):null;switch(bt){case"BYTERANGE":nt?it.setByteRange(pt,nt):it.setByteRange(pt);break;case"PROGRAM-DATE-TIME":it.rawProgramDateTime=pt,it.tagList.push(["PROGRAM-DATE-TIME",pt]),ht===-1&&(ht=j.length);break;case"PLAYLIST-TYPE":_.type&&assignMultipleMediaPlaylistTagOccuranceError(_,bt,ot),_.type=pt.toUpperCase();break;case"MEDIA-SEQUENCE":_.startSN!==0?assignMultipleMediaPlaylistTagOccuranceError(_,bt,ot):j.length>0&&assignMustAppearBeforeSegmentsError(_,bt,ot),tt=_.startSN=parseInt(pt);break;case"SKIP":{_.skippedSegments&&assignMultipleMediaPlaylistTagOccuranceError(_,bt,ot);const ut=new AttrList(pt,_),ft=ut.decimalInteger("SKIPPED-SEGMENTS");if(isFiniteNumber(ft)){_.skippedSegments+=ft;for(let mt=ft;mt--;)j.push(null);tt+=ft}const xt=ut.enumeratedString("RECENTLY-REMOVED-DATERANGES");xt&&(_.recentlyRemovedDateranges=(_.recentlyRemovedDateranges||[]).concat(xt.split("	")));break}case"TARGETDURATION":_.targetduration!==0&&assignMultipleMediaPlaylistTagOccuranceError(_,bt,ot),_.targetduration=Math.max(parseInt(pt),1);break;case"VERSION":_.version!==null&&assignMultipleMediaPlaylistTagOccuranceError(_,bt,ot),_.version=parseInt(pt);break;case"INDEPENDENT-SEGMENTS":break;case"ENDLIST":_.live||assignMultipleMediaPlaylistTagOccuranceError(_,bt,ot),_.live=!1;break;case"#":(pt||yt)&&it.tagList.push(yt?[pt,yt]:[pt]);break;case"DISCONTINUITY":at++,it.tagList.push(["DIS"]);break;case"GAP":it.gap=!0,it.tagList.push([bt]);break;case"BITRATE":it.tagList.push([bt,pt]),rt=parseInt(pt)*1e3,isFiniteNumber(rt)?it.bitrate=rt:rt=0;break;case"DATERANGE":{const ut=new AttrList(pt,_),ft=new DateRange(ut,_.dateRanges[ut.ID],_.dateRangeTagCount);_.dateRangeTagCount++,ft.isValid||_.skippedSegments?_.dateRanges[ft.id]=ft:logger.warn(`Ignoring invalid DATERANGE tag: "${pt}"`),it.tagList.push(["EXT-X-DATERANGE",pt]);break}case"DEFINE":{{const ut=new AttrList(pt,_);"IMPORT"in ut?importVariableDefinition(_,ut,d):addVariableDefinition(_,ut,i)}break}case"DISCONTINUITY-SEQUENCE":_.startCC!==0?assignMultipleMediaPlaylistTagOccuranceError(_,bt,ot):j.length>0&&assignMustAppearBeforeSegmentsError(_,bt,ot),_.startCC=at=parseInt(pt);break;case"KEY":{const ut=parseKey(pt,i,_);if(ut.isSupported()){if(ut.method==="NONE"){ct=void 0;break}ct||(ct={});const ft=ct[ut.keyFormat];ft!=null&&ft.matches(ut)||(ft&&(ct=_extends({},ct)),ct[ut.keyFormat]=ut)}else logger.warn(`[Keys] Ignoring unsupported EXT-X-KEY tag: "${pt}"`);break}case"START":_.startTimeOffset=parseStartTimeOffset(pt);break;case"MAP":{const ut=new AttrList(pt,_);if(it.duration){const ft=new Fragment(o,b);setInitSegment(ft,ut,a,ct),_e=ft,it.initSegment=_e,_e.rawProgramDateTime&&!it.rawProgramDateTime&&(it.rawProgramDateTime=_e.rawProgramDateTime)}else{const ft=it.byteRangeEndOffset;if(ft){const xt=it.byteRangeStartOffset;gt=`${ft-xt}@${xt}`}else gt=null;setInitSegment(it,ut,a,ct),_e=it,dt=!0}_e.cc=at;break}case"SERVER-CONTROL":{vt&&assignMultipleMediaPlaylistTagOccuranceError(_,bt,ot),vt=new AttrList(pt),_.canBlockReload=vt.bool("CAN-BLOCK-RELOAD"),_.canSkipUntil=vt.optionalFloat("CAN-SKIP-UNTIL",0),_.canSkipDateRanges=_.canSkipUntil>0&&vt.bool("CAN-SKIP-DATERANGES"),_.partHoldBack=vt.optionalFloat("PART-HOLD-BACK",0),_.holdBack=vt.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{_.partTarget&&assignMultipleMediaPlaylistTagOccuranceError(_,bt,ot);const ut=new AttrList(pt);_.partTarget=ut.decimalFloatingPoint("PART-TARGET");break}case"PART":{let ut=_.partList;ut||(ut=_.partList=[]);const ft=et>0?ut[ut.length-1]:void 0,xt=et++,mt=new AttrList(pt,_),Et=new Part(mt,it,b,xt,ft);ut.push(Et),it.duration+=Et.duration;break}case"PRELOAD-HINT":{const ut=new AttrList(pt,_);_.preloadHint=ut;break}case"RENDITION-REPORT":{const ut=new AttrList(pt,_);_.renditionReports=_.renditionReports||[],_.renditionReports.push(ut);break}default:logger.warn(`line parsed but not handled: ${ot}`);break}}}nt&&!nt.relurl?(j.pop(),st-=nt.duration,_.partList&&(_.fragmentHint=nt)):_.partList&&(assignProgramDateTime(it,nt,$),it.cc=at,_.fragmentHint=it,ct&&setFragLevelKeys(it,ct,_)),_.targetduration||(_.playlistParsingError=new Error("Missing Target Duration"));const St=j.length,Tt=j[0],Ct=j[St-1];if(st+=_.skippedSegments*_.targetduration,st>0&&St&&Ct){_.averagetargetduration=st/St;const Rt=Ct.sn;_.endSN=Rt!=="initSegment"?Rt:0,_.live||(Ct.endList=!0),ht>0&&(backfillProgramDateTimes(j,ht),Tt&&$.unshift(Tt))}return _.fragmentHint&&(st+=_.fragmentHint.duration),_.totalduration=st,$.length&&_.dateRangeTagCount&&Tt&&mapDateRanges($,_),_.endCC=at,_}}function mapDateRanges(s,e){let i=s.length;if(!i)if(e.hasProgramDateTime){const g=e.fragments[e.fragments.length-1];s.push(g),i++}else return;const a=s[i-1],o=e.live?1/0:e.totalduration,c=Object.keys(e.dateRanges);for(let g=c.length;g--;){const b=e.dateRanges[c[g]],_=b.startDate.getTime();b.tagAnchor=a.ref;for(let j=i;j--;){var d;if(((d=s[j])==null?void 0:d.sn)<e.startSN)break;const $=findFragmentWithStartDate(e,_,s,j,o);if($!==-1){b.tagAnchor=e.fragments[$].ref;break}}}}function findFragmentWithStartDate(s,e,i,a,o){const c=i[a];if(c){const g=c.programDateTime;if(e>=g||a===0){var d;const b=(((d=i[a+1])==null?void 0:d.start)||o)-c.start;if(e<=g+b*1e3){const _=i[a].sn-s.startSN;if(_<0)return-1;const j=s.fragments;if(j.length>i.length){const _e=(i[a+1]||j[j.length-1]).sn-s.startSN;for(let tt=_e;tt>_;tt--){const et=j[tt].programDateTime;if(e>=et&&e<et+j[tt].duration*1e3)return tt}}return _}}}return-1}function parseKey(s,e,i){var a,o;const c=new AttrList(s,i),d=(a=c.METHOD)!=null?a:"",g=c.URI,b=c.hexadecimalInteger("IV"),_=c.KEYFORMATVERSIONS,j=(o=c.KEYFORMAT)!=null?o:"identity";g&&c.IV&&!b&&logger.error(`Invalid IV: ${c.IV}`);const $=g?M3U8Parser.resolve(g,e):"",_e=(_||"1").split("/").map(Number).filter(Number.isFinite);return new LevelKey(d,$,j,_e,b,c.KEYID)}function parseStartTimeOffset(s){const i=new AttrList(s).decimalFloatingPoint("TIME-OFFSET");return isFiniteNumber(i)?i:null}function setCodecs(s,e){let i=(s||"").split(/[ ,]+/).filter(a=>a);["video","audio","text"].forEach(a=>{const o=i.filter(c=>isCodecType(c,a));o.length&&(e[`${a}Codec`]=o.map(c=>c.split("/")[0]).join(","),i=i.filter(c=>o.indexOf(c)===-1))}),e.unknownCodecs=i}function assignCodec(s,e,i){const a=e[i];a&&(s[i]=a)}function backfillProgramDateTimes(s,e){let i=s[e];for(let a=e;a--;){const o=s[a];if(!o)return;o.programDateTime=i.programDateTime-o.duration*1e3,i=o}}function assignProgramDateTime(s,e,i){s.rawProgramDateTime?i.push(s):e!=null&&e.programDateTime&&(s.programDateTime=e.endProgramDateTime)}function setInitSegment(s,e,i,a){s.relurl=e.URI,e.BYTERANGE&&s.setByteRange(e.BYTERANGE),s.level=i,s.sn="initSegment",a&&(s.levelkeys=a),s.initSegment=null}function setFragLevelKeys(s,e,i){s.levelkeys=e;const{encryptedFragments:a}=i;(!a.length||a[a.length-1].levelkeys!==e)&&Object.keys(e).some(o=>e[o].isCommonEncryption)&&a.push(s)}function assignMultipleMediaPlaylistTagOccuranceError(s,e,i){s.playlistParsingError=new Error(`#EXT-X-${e} must not appear more than once (${i[0]})`)}function assignMustAppearBeforeSegmentsError(s,e,i){s.playlistParsingError=new Error(`#EXT-X-${e} must appear before the first Media Segment (${i[0]})`)}function updateFromToPTS(s,e){const i=e.startPTS;if(isFiniteNumber(i)){let a=0,o;e.sn>s.sn?(a=i-s.start,o=s):(a=s.start-i,o=e),o.duration!==a&&o.setDuration(a)}else e.sn>s.sn?s.cc===e.cc&&s.minEndPTS?e.setStart(s.start+(s.minEndPTS-s.start)):e.setStart(s.start+s.duration):e.setStart(Math.max(s.start-e.duration,0))}function updateFragPTSDTS(s,e,i,a,o,c,d){a-i<=0&&(d.warn("Fragment should have a positive duration",e),a=i+e.duration,c=o+e.duration);let b=i,_=a;const j=e.startPTS,$=e.endPTS;if(isFiniteNumber(j)){const rt=Math.abs(j-i);s&&rt>s.totalduration?d.warn(`media timestamps and playlist times differ by ${rt}s for level ${e.level} ${s.url}`):isFiniteNumber(e.deltaPTS)?e.deltaPTS=Math.max(rt,e.deltaPTS):e.deltaPTS=rt,b=Math.max(i,j),i=Math.min(i,j),o=e.startDTS!==void 0?Math.min(o,e.startDTS):o,_=Math.min(a,$),a=Math.max(a,$),c=e.endDTS!==void 0?Math.max(c,e.endDTS):c}const _e=i-e.start;e.start!==0&&e.setStart(i),e.setDuration(a-e.start),e.startPTS=i,e.maxStartPTS=b,e.startDTS=o,e.endPTS=a,e.minEndPTS=_,e.endDTS=c;const tt=e.sn;if(!s||tt<s.startSN||tt>s.endSN)return 0;let et;const st=tt-s.startSN,at=s.fragments;for(at[st]=e,et=st;et>0;et--)updateFromToPTS(at[et],at[et-1]);for(et=st;et<at.length-1;et++)updateFromToPTS(at[et],at[et+1]);return s.fragmentHint&&updateFromToPTS(at[at.length-1],s.fragmentHint),s.PTSKnown=s.alignedSliding=!0,_e}function mergeDetails(s,e,i){if(s===e)return;let a=null;const o=s.fragments;for(let j=o.length-1;j>=0;j--){const $=o[j].initSegment;if($){a=$;break}}s.fragmentHint&&delete s.fragmentHint.endPTS;let c;mapFragmentIntersection(s,e,(j,$,_e,tt)=>{if((!e.startCC||e.skippedSegments)&&$.cc!==j.cc){const et=j.cc-$.cc;for(let st=_e;st<tt.length;st++)tt[st].cc+=et;e.endCC=tt[tt.length-1].cc}isFiniteNumber(j.startPTS)&&isFiniteNumber(j.endPTS)&&($.setStart($.startPTS=j.startPTS),$.startDTS=j.startDTS,$.maxStartPTS=j.maxStartPTS,$.endPTS=j.endPTS,$.endDTS=j.endDTS,$.minEndPTS=j.minEndPTS,$.setDuration(j.endPTS-j.startPTS),$.duration&&(c=$),e.PTSKnown=e.alignedSliding=!0),j.hasStreams&&($.elementaryStreams=j.elementaryStreams),$.loader=j.loader,j.hasStats&&($.stats=j.stats),j.initSegment&&($.initSegment=j.initSegment,a=j.initSegment)});const d=e.fragments,g=e.fragmentHint?d.concat(e.fragmentHint):d;if(a&&g.forEach(j=>{var $;j&&(!j.initSegment||j.initSegment.relurl===(($=a)==null?void 0:$.relurl))&&(j.initSegment=a)}),e.skippedSegments){if(e.deltaUpdateFailed=d.some(j=>!j),e.deltaUpdateFailed){i.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let j=e.skippedSegments;j--;)d.shift();e.startSN=d[0].sn}else{e.canSkipDateRanges&&(e.dateRanges=mergeDateRanges(s.dateRanges,e,i));const j=s.fragments.filter($=>$.rawProgramDateTime);if(s.hasProgramDateTime&&!e.hasProgramDateTime)for(let $=1;$<g.length;$++)g[$].programDateTime===null&&assignProgramDateTime(g[$],g[$-1],j);mapDateRanges(j,e)}e.endCC=d[d.length-1].cc}if(!e.startCC){var b;const j=getFragmentWithSN(s,e.startSN-1);e.startCC=(b=j==null?void 0:j.cc)!=null?b:d[0].cc}mapPartIntersection(s.partList,e.partList,(j,$)=>{$.elementaryStreams=j.elementaryStreams,$.stats=j.stats}),c?updateFragPTSDTS(e,c,c.startPTS,c.endPTS,c.startDTS,c.endDTS,i):adjustSliding(s,e),d.length&&(e.totalduration=e.edge-d[0].start),e.driftStartTime=s.driftStartTime,e.driftStart=s.driftStart;const _=e.advancedDateTime;if(e.advanced&&_){const j=e.edge;e.driftStart||(e.driftStartTime=_,e.driftStart=j),e.driftEndTime=_,e.driftEnd=j}else e.driftEndTime=s.driftEndTime,e.driftEnd=s.driftEnd,e.advancedDateTime=s.advancedDateTime;e.requestScheduled===-1&&(e.requestScheduled=s.requestScheduled)}function mergeDateRanges(s,e,i){const{dateRanges:a,recentlyRemovedDateranges:o}=e,c=_extends({},s);o&&o.forEach(b=>{delete c[b]});const g=Object.keys(c).length;return g?(Object.keys(a).forEach(b=>{const _=c[b],j=new DateRange(a[b].attr,_);j.isValid?(c[b]=j,_||(j.tagOrder+=g)):i.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${stringify(a[b].attr)}"`)}),c):a}function mapPartIntersection(s,e,i){if(s&&e){let a=0;for(let o=0,c=s.length;o<=c;o++){const d=s[o],g=e[o+a];d&&g&&d.index===g.index&&d.fragment.sn===g.fragment.sn?i(d,g):a--}}}function mapFragmentIntersection(s,e,i){const a=e.skippedSegments,o=Math.max(s.startSN,e.startSN)-e.startSN,c=(s.fragmentHint?1:0)+(a?e.endSN:Math.min(s.endSN,e.endSN))-e.startSN,d=e.startSN-s.startSN,g=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,b=s.fragmentHint?s.fragments.concat(s.fragmentHint):s.fragments;for(let _=o;_<=c;_++){const j=b[d+_];let $=g[_];if(a&&!$&&j&&($=e.fragments[_]=j),j&&$){i(j,$,_,g);const _e=j.relurl,tt=$.relurl;if(_e&&notEqualAfterStrippingQueries(_e,tt)){e.playlistParsingError=getSequenceError(`media sequence mismatch ${$.sn}:`,s,e,j,$);return}else if(j.cc!==$.cc){e.playlistParsingError=getSequenceError(`discontinuity sequence mismatch (${j.cc}!=${$.cc})`,s,e,j,$);return}}}}function getSequenceError(s,e,i,a,o){return new Error(`${s} ${o.url}
Playlist starting @${e.startSN}
${e.m3u8}

Playlist starting @${i.startSN}
${i.m3u8}`)}function adjustSliding(s,e,i=!0){const a=e.startSN+e.skippedSegments-s.startSN,o=s.fragments,c=a>=0;let d=0;if(c&&a<o.length)d=o[a].start;else if(c&&e.startSN===s.endSN+1)d=s.fragmentEnd;else if(c&&i)d=s.fragmentStart+a*e.levelTargetDuration;else if(!e.skippedSegments&&e.fragmentStart===0)d=s.fragmentStart;else return;addSliding(e,d)}function addSliding(s,e){if(e){const i=s.fragments;for(let a=s.skippedSegments;a<i.length;a++)i[a].addStart(e);s.fragmentHint&&s.fragmentHint.addStart(e)}}function computeReloadInterval(s,e=1/0){let i=1e3*s.targetduration;if(s.updated){const a=s.fragments;if(a.length&&i*4>e){const c=a[a.length-1].duration*1e3;c<i&&(i=c)}}else i/=2;return Math.round(i)}function getFragmentWithSN(s,e,i){if(!s)return null;let a=s.fragments[e-s.startSN];return a||(a=s.fragmentHint,a&&a.sn===e)?a:e<s.startSN&&i&&i.sn===e?i:null}function getPartWith(s,e,i){return s?findPart(s.partList,e,i):null}function findPart(s,e,i){if(s)for(let a=s.length;a--;){const o=s[a];if(o.index===i&&o.fragment.sn===e)return o}return null}function reassignFragmentLevelIndexes(s){s.forEach((e,i)=>{var a;(a=e.details)==null||a.fragments.forEach(o=>{o.level=i,o.initSegment&&(o.initSegment.level=i)})})}function notEqualAfterStrippingQueries(s,e){return s!==e&&e?stripQuery(s)!==stripQuery(e):!1}function stripQuery(s){return s.replace(/\?[^?]*$/,"")}function findFirstFragWithCC(s,e){for(let a=0,o=s.length;a<o;a++){var i;if(((i=s[a])==null?void 0:i.cc)===e)return s[a]}return null}function shouldAlignOnDiscontinuities(s,e){return!!(s&&e.startCC<s.endCC&&e.endCC>s.startCC)}function adjustFragmentStart(s,e){const i=s.start+e;s.startPTS=i,s.setStart(i),s.endPTS=i+s.duration}function adjustSlidingStart(s,e){const i=e.fragments;for(let a=0,o=i.length;a<o;a++)adjustFragmentStart(i[a],s);e.fragmentHint&&adjustFragmentStart(e.fragmentHint,s),e.alignedSliding=!0}function alignStream(s,e){s&&(alignDiscontinuities(e,s),e.alignedSliding||alignMediaPlaylistByPDT(e,s),!e.alignedSliding&&!e.skippedSegments&&adjustSliding(s,e,!1))}function alignDiscontinuities(s,e){if(!shouldAlignOnDiscontinuities(e,s))return;const i=Math.min(e.endCC,s.endCC),a=findFirstFragWithCC(e.fragments,i),o=findFirstFragWithCC(s.fragments,i);if(!a||!o)return;logger.log(`Aligning playlist at start of dicontinuity sequence ${i}`);const c=a.start-o.start;adjustSlidingStart(c,s)}function alignMediaPlaylistByPDT(s,e){if(!s.hasProgramDateTime||!e.hasProgramDateTime)return;const i=s.fragments,a=e.fragments;if(!i.length||!a.length)return;let o,c;const d=Math.min(e.endCC,s.endCC);e.startCC<d&&s.startCC<d&&(o=findFirstFragWithCC(a,d),c=findFirstFragWithCC(i,d)),(!o||!c)&&(o=a[Math.floor(a.length/2)],c=findFirstFragWithCC(i,o.cc)||i[Math.floor(i.length/2)]);const g=o.programDateTime,b=c.programDateTime;if(!g||!b)return;const _=(b-g)/1e3-(c.start-o.start);adjustSlidingStart(_,s)}function addEventListener(s,e,i){removeEventListener(s,e,i),s.addEventListener(e,i)}function removeEventListener(s,e,i){s.removeEventListener(e,i)}const TimeRanges={toString:function(s){let e="";const i=s.length;for(let a=0;a<i;a++)e+=`[${s.start(a).toFixed(3)}-${s.end(a).toFixed(3)}]`;return e}},State={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class BaseStreamController extends TaskLoop{constructor(e,i,a,o,c){super(o,e.logger),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=State.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.buffering=!0,this.loadingParts=!1,this.loopSn=void 0,this.onMediaSeeking=()=>{const{config:d,fragCurrent:g,media:b,mediaBuffer:_,state:j}=this,$=b?b.currentTime:0,_e=BufferHelper.bufferInfo(_||b,$,d.maxBufferHole),tt=!_e.len;if(this.log(`Media seeking to ${isFiniteNumber($)?$.toFixed(3):$}, state: ${j}, ${tt?"out of":"in"} buffer`),this.state===State.ENDED)this.resetLoadingState();else if(g){const et=d.maxFragLookUpTolerance,st=g.start-et,at=g.start+g.duration+et;if(tt||at<_e.start||st>_e.end){const rt=$>at;($<st||rt)&&(rt&&g.loader&&(this.log(`Cancelling fragment load for seek (sn: ${g.sn})`),g.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}if(b){this.fragmentTracker.removeFragmentsInRange($,1/0,this.playlistType,!0);const et=this.lastCurrentTime;if($>et&&(this.lastCurrentTime=$),!this.loadingParts){const st=Math.max(_e.end,$),at=this.shouldLoadParts(this.getLevelDetails(),st);at&&(this.log(`LL-Part loading ON after seeking to ${$.toFixed(2)} with buffer @${st.toFixed(2)}`),this.loadingParts=at)}}this.hls.hasEnoughToStart||(this.log(`Setting ${tt?"startPosition":"nextLoadPosition"} to ${$} for seek without enough to start`),this.nextLoadPosition=$,tt&&(this.startPosition=$)),tt&&this.state===State.IDLE&&this.tickImmediate()},this.onMediaEnded=()=>{this.log("setting startPosition to 0 because media ended"),this.startPosition=this.lastCurrentTime=0},this.playlistType=c,this.hls=e,this.fragmentLoader=new FragmentLoader(e.config),this.keyLoader=a,this.fragmentTracker=i,this.config=e.config,this.decrypter=new Decrypter(e.config)}registerListeners(){const{hls:e}=this;e.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Events.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(Events.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Events.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(Events.ERROR,this.onError,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){if(this.state===State.STOPPED)return;this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;e!=null&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=State.STOPPED}get startPositionValue(){const{nextLoadPosition:e,startPosition:i}=this;return i===-1&&e?e:i}get bufferingEnabled(){return this.buffering}pauseBuffering(){this.buffering=!1}resumeBuffering(){this.buffering=!0}get inFlightFrag(){return{frag:this.fragCurrent,state:this.state}}_streamEnded(e,i){if(i.live||!this.media)return!1;const a=e.end||0,o=this.config.timelineOffset||0;if(a<=o)return!1;const c=e.buffered;this.config.maxBufferHole&&c&&c.length>1&&(e=BufferHelper.bufferedInfo(c,e.start,0));const d=e.nextStart;if(d&&d>o&&d<i.edge||this.media.currentTime<e.start)return!1;const b=i.partList;if(b!=null&&b.length){const j=b[b.length-1];return BufferHelper.isBuffered(this.media,j.start+j.duration/2)}const _=i.fragments[i.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(_)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null)return this.levelLastLoaded.details}get timelineOffset(){const e=this.config.timelineOffset;if(e){var i;return((i=this.getLevelDetails())==null?void 0:i.appliedTimelineOffset)||e}return 0}onMediaAttached(e,i){const a=this.media=this.mediaBuffer=i.media;addEventListener(a,"seeking",this.onMediaSeeking),addEventListener(a,"ended",this.onMediaEnded);const o=this.config;this.levels&&o.autoStartLoad&&this.state===State.STOPPED&&this.startLoad(o.startPosition)}onMediaDetaching(e,i){const a=!!i.transferMedia,o=this.media;if(o!==null){if(o.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),removeEventListener(o,"seeking",this.onMediaSeeking),removeEventListener(o,"ended",this.onMediaEnded),this.keyLoader&&!a&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loopSn=void 0,a){this.resetLoadingState(),this.resetTransmuxer();return}this.loadingParts=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}}onManifestLoading(){this.initPTS=[],this.levels=this.levelLastLoaded=this.fragCurrent=null,this.lastCurrentTime=this.startPosition=0,this.startFragRequested=!1}onError(e,i){}onManifestLoaded(e,i){this.startTimeOffset=i.startTimeOffset}onHandlerDestroying(){this.stopLoad(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),super.onHandlerDestroying(),this.hls=this.onMediaSeeking=this.onMediaEnded=null}onHandlerDestroyed(){this.state=State.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,i,a){this.startFragRequested=!0,this._loadFragForPlayback(e,i,a)}_loadFragForPlayback(e,i,a){const o=c=>{const d=c.frag;if(this.fragContextChanged(d)){this.warn(`${d.type} sn: ${d.sn}${c.part?" part: "+c.part.index:""} of ${this.fragInfo(d,!1,c.part)}) was dropped during download.`),this.fragmentTracker.removeFragment(d);return}d.stats.chunkCount++,this._handleFragmentLoadProgress(c)};this._doFragLoad(e,i,a,o).then(c=>{if(!c)return;const d=this.state,g=c.frag;if(this.fragContextChanged(g)){(d===State.FRAG_LOADING||!this.fragCurrent&&d===State.PARSING)&&(this.fragmentTracker.removeFragment(g),this.state=State.IDLE);return}"payload"in c&&(this.log(`Loaded ${g.type} sn: ${g.sn} of ${this.playlistLabel()} ${g.level}`),this.hls.trigger(Events.FRAG_LOADED,c)),this._handleFragmentLoadComplete(c)}).catch(c=>{this.state===State.STOPPED||this.state===State.ERROR||(this.warn(`Frag error: ${(c==null?void 0:c.message)||c}`),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var i;const{fragmentTracker:a}=this;if(a.getState(e)===FragmentState.APPENDING){const c=e.type,d=this.getFwdBufferInfo(this.mediaBuffer,c),g=Math.max(e.duration,d?d.len:this.config.maxBufferLength),b=this.backtrackFragment;((b?e.sn-b.sn:0)===1||this.reduceMaxBufferLength(g,e.duration))&&a.removeFragment(e)}else((i=this.mediaBuffer)==null?void 0:i.buffered.length)===0?a.removeAllFragments():a.hasParts(e.type)&&(a.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),a.getState(e)===FragmentState.PARTIAL&&a.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){const i=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:i,part:null,stats:i.stats,id:i.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}waitForLive(e){const i=e.details;return(i==null?void 0:i.live)&&i.type!=="EVENT"&&(this.levelLastLoaded!==e||i.expired)}flushMainBuffer(e,i,a=null){if(!(e-i))return;const o={startOffset:e,endOffset:i,type:a};this.hls.trigger(Events.BUFFER_FLUSHING,o)}_loadInitSegment(e,i){this._doFragLoad(e,i).then(a=>{const o=a==null?void 0:a.frag;if(!o||this.fragContextChanged(o)||!this.levels)throw new Error("init load aborted");return a}).then(a=>{const{hls:o}=this,{frag:c,payload:d}=a,g=c.decryptdata;if(d&&d.byteLength>0&&g!=null&&g.key&&g.iv&&isFullSegmentEncryption(g.method)){const b=self.performance.now();return this.decrypter.decrypt(new Uint8Array(d),g.key.buffer,g.iv.buffer,getAesModeFromFullSegmentMethod(g.method)).catch(_=>{throw o.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_DECRYPT_ERROR,fatal:!1,error:_,reason:_.message,frag:c}),_}).then(_=>{const j=self.performance.now();return o.trigger(Events.FRAG_DECRYPTED,{frag:c,payload:_,stats:{tstart:b,tdecrypt:j}}),a.payload=_,this.completeInitSegmentLoad(a)})}return this.completeInitSegmentLoad(a)}).catch(a=>{this.state===State.STOPPED||this.state===State.ERROR||(this.warn(a),this.resetFragmentLoading(e))})}completeInitSegmentLoad(e){const{levels:i}=this;if(!i)throw new Error("init load aborted, missing levels");const a=e.frag.stats;this.state!==State.STOPPED&&(this.state=State.IDLE),e.frag.data=new Uint8Array(e.payload),a.parsing.start=a.buffering.start=self.performance.now(),a.parsing.end=a.buffering.end=self.performance.now(),this.tick()}unhandledEncryptionError(e,i){var a,o;const c=e.tracks;if(c&&!i.encrypted&&((a=c.audio)!=null&&a.encrypted||(o=c.video)!=null&&o.encrypted)&&(!this.config.emeEnabled||!this.keyLoader.emeController)){const d=this.media,g=new Error(`Encrypted track with no key in ${this.fragInfo(i)} (media ${d?"attached mediaKeys: "+d.mediaKeys:"detached"})`);return this.warn(g.message),!d||d.mediaKeys?!1:(this.hls.trigger(Events.ERROR,{type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!1,error:g,frag:i}),this.resetTransmuxer(),!0)}return!1}fragContextChanged(e){const{fragCurrent:i}=this;return!e||!i||e.sn!==i.sn||e.level!==i.level}fragBufferedComplete(e,i){const a=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${e.type} sn: ${e.sn}${i?" part: "+i.index:""} of ${this.fragInfo(e,!1,i)} > buffer:${a?TimeRanges.toString(BufferHelper.getBuffered(a)):"(detached)"})`),isMediaFragment(e)){var o;if(e.type!==PlaylistLevelType.SUBTITLE){const d=e.elementaryStreams;if(!Object.keys(d).some(g=>!!d[g])){this.state=State.IDLE;return}}const c=(o=this.levels)==null?void 0:o[e.level];c!=null&&c.fragmentError&&(this.log(`Resetting level fragment error count of ${c.fragmentError} on frag buffered`),c.fragmentError=0)}this.state=State.IDLE}_handleFragmentLoadComplete(e){const{transmuxer:i}=this;if(!i)return;const{frag:a,part:o,partsLoaded:c}=e,d=!c||c.length===0||c.some(b=>!b),g=new ChunkMetadata(a.level,a.sn,a.stats.chunkCount+1,0,o?o.index:-1,!d);i.flush(g)}_handleFragmentLoadProgress(e){}_doFragLoad(e,i,a=null,o){var c;this.fragCurrent=e;const d=i.details;if(!this.levels||!d)throw new Error(`frag load aborted, missing level${d?"":" detail"}s`);let g=null;if(e.encrypted&&!((c=e.decryptdata)!=null&&c.key)){if(this.log(`Loading key for ${e.sn} of [${d.startSN}-${d.endSN}], ${this.playlistLabel()} ${e.level}`),this.state=State.KEY_LOADING,this.fragCurrent=e,g=this.keyLoader.load(e).then(_e=>{if(!this.fragContextChanged(_e.frag))return this.hls.trigger(Events.KEY_LOADED,_e),this.state===State.KEY_LOADING&&(this.state=State.IDLE),_e}),this.hls.trigger(Events.KEY_LOADING,{frag:e}),this.fragCurrent===null)return this.log("context changed in KEY_LOADING"),Promise.resolve(null)}else e.encrypted||(g=this.keyLoader.loadClear(e,d.encryptedFragments,this.startFragRequested),g&&this.log("[eme] blocking frag load until media-keys acquired"));const b=this.fragPrevious;if(isMediaFragment(e)&&(!b||e.sn!==b.sn)){const _e=this.shouldLoadParts(i.details,e.end);_e!==this.loadingParts&&(this.log(`LL-Part loading ${_e?"ON":"OFF"} loading sn ${b==null?void 0:b.sn}->${e.sn}`),this.loadingParts=_e)}if(a=Math.max(e.start,a||0),this.loadingParts&&isMediaFragment(e)){const _e=d.partList;if(_e&&o){a>d.fragmentEnd&&d.fragmentHint&&(e=d.fragmentHint);const tt=this.getNextPart(_e,e,a);if(tt>-1){const et=_e[tt];e=this.fragCurrent=et.fragment,this.log(`Loading ${e.type} sn: ${e.sn} part: ${et.index} (${tt}/${_e.length-1}) of ${this.fragInfo(e,!1,et)}) cc: ${e.cc} [${d.startSN}-${d.endSN}], target: ${parseFloat(a.toFixed(3))}`),this.nextLoadPosition=et.start+et.duration,this.state=State.FRAG_LOADING;let st;return g?st=g.then(at=>!at||this.fragContextChanged(at.frag)?null:this.doFragPartsLoad(e,et,i,o)).catch(at=>this.handleFragLoadError(at)):st=this.doFragPartsLoad(e,et,i,o).catch(at=>this.handleFragLoadError(at)),this.hls.trigger(Events.FRAG_LOADING,{frag:e,part:et,targetBufferTime:a}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):st}else if(!e.url||this.loadedEndOfParts(_e,a))return Promise.resolve(null)}}if(isMediaFragment(e)&&this.loadingParts){var _;this.log(`LL-Part loading OFF after next part miss @${a.toFixed(2)} Check buffer at sn: ${e.sn} loaded parts: ${(_=d.partList)==null?void 0:_.filter(_e=>_e.loaded).map(_e=>`[${_e.start}-${_e.end}]`)}`),this.loadingParts=!1}else if(!e.url)return Promise.resolve(null);this.log(`Loading ${e.type} sn: ${e.sn} of ${this.fragInfo(e,!1)}) cc: ${e.cc} ${"["+d.startSN+"-"+d.endSN+"]"}, target: ${parseFloat(a.toFixed(3))}`),isFiniteNumber(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=State.FRAG_LOADING;const j=this.config.progressive;let $;return j&&g?$=g.then(_e=>!_e||this.fragContextChanged(_e.frag)?null:this.fragmentLoader.load(e,o)).catch(_e=>this.handleFragLoadError(_e)):$=Promise.all([this.fragmentLoader.load(e,j?o:void 0),g]).then(([_e])=>(!j&&o&&o(_e),_e)).catch(_e=>this.handleFragLoadError(_e)),this.hls.trigger(Events.FRAG_LOADING,{frag:e,targetBufferTime:a}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):$}doFragPartsLoad(e,i,a,o){return new Promise((c,d)=>{var g;const b=[],_=(g=a.details)==null?void 0:g.partList,j=$=>{this.fragmentLoader.loadPart(e,$,o).then(_e=>{b[$.index]=_e;const tt=_e.part;this.hls.trigger(Events.FRAG_LOADED,_e);const et=getPartWith(a.details,e.sn,$.index+1)||findPart(_,e.sn,$.index+1);if(et)j(et);else return c({frag:e,part:tt,partsLoaded:b})}).catch(d)};j(i)})}handleFragLoadError(e){if("data"in e){const i=e.data;i.frag&&i.details===ErrorDetails.INTERNAL_ABORTED?this.handleFragLoadAborted(i.frag,i.part):i.frag&&i.type===ErrorTypes.KEY_SYSTEM_ERROR?(i.frag.abortRequests(),this.resetStartWhenNotLoaded(),this.resetFragmentLoading(i.frag)):this.hls.trigger(Events.ERROR,i)}else this.hls.trigger(Events.ERROR,{type:ErrorTypes.OTHER_ERROR,details:ErrorDetails.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const i=this.getCurrentContext(e);if(!i||this.state!==State.PARSING){!this.fragCurrent&&this.state!==State.STOPPED&&this.state!==State.ERROR&&(this.state=State.IDLE);return}const{frag:a,part:o,level:c}=i,d=self.performance.now();a.stats.parsing.end=d,o&&(o.stats.parsing.end=d);const g=this.getLevelDetails(),_=g&&a.sn>g.endSN||this.shouldLoadParts(g,a.end);_!==this.loadingParts&&(this.log(`LL-Part loading ${_?"ON":"OFF"} after parsing segment ending @${a.end.toFixed(2)}`),this.loadingParts=_),this.updateLevelTiming(a,o,c,e.partial)}shouldLoadParts(e,i){if(this.config.lowLatencyMode){if(!e)return this.loadingParts;if(e.partList){var a;const c=e.partList[0];if(c.fragment.type===PlaylistLevelType.SUBTITLE)return!1;const d=c.end+(((a=e.fragmentHint)==null?void 0:a.duration)||0);if(i>=d){var o;if((this.hls.hasEnoughToStart?((o=this.media)==null?void 0:o.currentTime)||this.lastCurrentTime:this.getLoadPosition())>c.start-c.fragment.duration)return!0}}}return!1}getCurrentContext(e){const{levels:i,fragCurrent:a}=this,{level:o,sn:c,part:d}=e;if(!(i!=null&&i[o]))return this.warn(`Levels object was unset while buffering fragment ${c} of ${this.playlistLabel()} ${o}. The current chunk will not be buffered.`),null;const g=i[o],b=g.details,_=d>-1?getPartWith(b,c,d):null,j=_?_.fragment:getFragmentWithSN(b,c,a);return j?(a&&a!==j&&(j.stats=a.stats),{frag:j,part:_,level:g}):null}bufferFragmentData(e,i,a,o,c){if(this.state!==State.PARSING)return;const{data1:d,data2:g}=e;let b=d;if(g&&(b=appendUint8Array(d,g)),!b.length)return;const _=this.initPTS[i.cc],j=_?-_.baseTime/_.timescale:void 0,$={type:e.type,frag:i,part:a,chunkMeta:o,offset:j,parent:i.type,data:b};if(this.hls.trigger(Events.BUFFER_APPENDING,$),e.dropped&&e.independent&&!a){if(c)return;this.flushBufferGap(i)}}flushBufferGap(e){const i=this.media;if(!i)return;if(!BufferHelper.isBuffered(i,i.currentTime)){this.flushMainBuffer(0,e.start);return}const a=i.currentTime,o=BufferHelper.bufferInfo(i,a,0),c=e.duration,d=Math.min(this.config.maxFragLookUpTolerance*2,c*.25),g=Math.max(Math.min(e.start-d,o.end-d),a+d);e.start-g>d&&this.flushMainBuffer(g,e.start)}getFwdBufferInfo(e,i){var a;const o=this.getLoadPosition();if(!isFiniteNumber(o))return null;const d=this.lastCurrentTime>o||(a=this.media)!=null&&a.paused?0:this.config.maxBufferHole;return this.getFwdBufferInfoAtPos(e,o,i,d)}getFwdBufferInfoAtPos(e,i,a,o){const c=BufferHelper.bufferInfo(e,i,o);if(c.len===0&&c.nextStart!==void 0){const d=this.fragmentTracker.getBufferedFrag(i,a);if(d&&(c.nextStart<=d.end||d.gap)){const g=Math.max(Math.min(c.nextStart,d.end)-i,o);return BufferHelper.bufferInfo(e,i,g)}}return c}getMaxBufferLength(e){const{config:i}=this;let a;return e?a=Math.max(8*i.maxBufferSize/e,i.maxBufferLength):a=i.maxBufferLength,Math.min(a,i.maxMaxBufferLength)}reduceMaxBufferLength(e,i){const a=this.config,o=Math.max(Math.min(e-i,a.maxBufferLength),i),c=Math.max(e-i*3,a.maxMaxBufferLength/2,o);return c>=o?(a.maxMaxBufferLength=c,this.warn(`Reduce max buffer length to ${c}s`),!0):!1}getAppendedFrag(e,i=PlaylistLevelType.MAIN){const a=this.fragmentTracker?this.fragmentTracker.getAppendedFrag(e,i):null;return a&&"fragment"in a?a.fragment:a}getNextFragment(e,i){const a=i.fragments,o=a.length;if(!o)return null;const{config:c}=this,d=a[0].start,g=c.lowLatencyMode&&!!i.partList;let b=null;if(i.live){const $=c.initialLiveManifestSize;if(o<$)return this.warn(`Not enough fragments to start playback (have: ${o}, need: ${$})`),null;if(!i.PTSKnown&&!this.startFragRequested&&this.startPosition===-1||e<d){var _;g&&!this.loadingParts&&(this.log("LL-Part loading ON for initial live fragment"),this.loadingParts=!0),b=this.getInitialLiveFragment(i);const _e=this.hls.startPosition,tt=this.hls.liveSyncPosition,et=b?(_e!==-1&&_e>=d?_e:tt)||b.start:e;this.log(`Setting startPosition to ${et} to match start frag at live edge. mainStart: ${_e} liveSyncPosition: ${tt} frag.start: ${(_=b)==null?void 0:_.start}`),this.startPosition=this.nextLoadPosition=et}}else e<=d&&(b=a[0]);if(!b){const $=this.loadingParts?i.partEnd:i.fragmentEnd;b=this.getFragmentAtPosition(e,$,i)}let j=this.filterReplacedPrimary(b,i);if(!j&&b){const $=b.sn-i.startSN;j=this.filterReplacedPrimary(a[$+1]||null,i)}return this.mapToInitFragWhenRequired(j)}isLoopLoading(e,i){const a=this.fragmentTracker.getState(e);return(a===FragmentState.OK||a===FragmentState.PARTIAL&&!!e.gap)&&this.nextLoadPosition>i}getNextFragmentLoopLoading(e,i,a,o,c){let d=null;if(e.gap&&(d=this.getNextFragment(this.nextLoadPosition,i),d&&!d.gap&&a.nextStart)){const g=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,a.nextStart,o,0);if(g!==null&&a.len+g.len>=c){const b=d.sn;return this.loopSn!==b&&(this.log(`buffer full after gaps in "${o}" playlist starting at sn: ${b}`),this.loopSn=b),null}}return this.loopSn=void 0,d}get primaryPrefetch(){if(interstitialsEnabled(this.config)){var e;if((e=this.hls.interstitialsManager)==null||(e=e.playingItem)==null?void 0:e.event)return!0}return!1}filterReplacedPrimary(e,i){if(!e)return e;if(interstitialsEnabled(this.config)&&e.type!==PlaylistLevelType.SUBTITLE){const a=this.hls.interstitialsManager,o=a==null?void 0:a.bufferingItem;if(o){const d=o.event;if(d){if(d.appendInPlace||Math.abs(e.start-o.start)>1||o.start===0)return null}else if(e.end<=o.start&&(i==null?void 0:i.live)===!1||e.start>o.end&&o.nextEvent&&(o.nextEvent.appendInPlace||e.start-o.end>1))return null}const c=a==null?void 0:a.playerQueue;if(c)for(let d=c.length;d--;){const g=c[d].interstitial;if(g.appendInPlace&&e.start>=g.startTime&&e.end<=g.resumeTime)return null}}return e}mapToInitFragWhenRequired(e){return e!=null&&e.initSegment&&!e.initSegment.data&&!this.bitrateTest?e.initSegment:e}getNextPart(e,i,a){let o=-1,c=!1,d=!0;for(let g=0,b=e.length;g<b;g++){const _=e[g];if(d=d&&!_.independent,o>-1&&a<_.start)break;const j=_.loaded;j?o=-1:(c||(_.independent||d)&&_.fragment===i)&&(_.fragment!==i&&this.warn(`Need buffer at ${a} but next unloaded part starts at ${_.start}`),o=g),c=j}return o}loadedEndOfParts(e,i){let a;for(let o=e.length;o--;){if(a=e[o],!a.loaded)return!1;if(i>a.start)return!0}return!1}getInitialLiveFragment(e){const i=e.fragments,a=this.fragPrevious;let o=null;if(a){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${a.programDateTime}`),o=findFragmentByPDT(i,a.endProgramDateTime,this.config.maxFragLookUpTolerance)),!o){const c=a.sn+1;if(c>=e.startSN&&c<=e.endSN){const d=i[c-e.startSN];a.cc===d.cc&&(o=d,this.log(`Live playlist, switching playlist, load frag with next SN: ${o.sn}`))}o||(o=findNearestWithCC(e,a.cc,a.end),o&&this.log(`Live playlist, switching playlist, load frag with same CC: ${o.sn}`))}}else{const c=this.hls.liveSyncPosition;c!==null&&(o=this.getFragmentAtPosition(c,this.bitrateTest?e.fragmentEnd:e.edge,e))}return o}getFragmentAtPosition(e,i,a){const{config:o}=this;let{fragPrevious:c}=this,{fragments:d,endSN:g}=a;const{fragmentHint:b}=a,{maxFragLookUpTolerance:_}=o,j=a.partList,$=!!(this.loadingParts&&j!=null&&j.length&&b);$&&!this.bitrateTest&&j[j.length-1].fragment.sn===b.sn&&(d=d.concat(b),g=b.sn);let _e;if(e<i){var tt;const st=e<this.lastCurrentTime||e>i-_||(tt=this.media)!=null&&tt.paused||!this.startFragRequested?0:_;_e=findFragmentByPTS(c,d,e,st)}else _e=d[d.length-1];if(_e){const et=_e.sn-a.startSN,st=this.fragmentTracker.getState(_e);if((st===FragmentState.OK||st===FragmentState.PARTIAL&&_e.gap)&&(c=_e),c&&_e.sn===c.sn&&(!$||j[0].fragment.sn>_e.sn||!a.live)&&_e.level===c.level){const rt=d[et+1];_e.sn<g&&this.fragmentTracker.getState(rt)!==FragmentState.OK?_e=rt:_e=null}}return _e}alignPlaylists(e,i,a){const o=e.fragments.length;if(!o)return this.warn("No fragments in live playlist"),0;const c=e.fragmentStart,d=!i,g=e.alignedSliding&&isFiniteNumber(c);if(d||!g&&!c){alignStream(a,e);const b=e.fragmentStart;return this.log(`Live playlist sliding: ${b.toFixed(2)} start-sn: ${i?i.startSN:"na"}->${e.startSN} fragments: ${o}`),b}return c}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,e.partTarget*3)}setStartPosition(e,i){let a=this.startPosition;a<i&&(a=-1);const o=this.timelineOffset;if(a===-1){const c=this.startTimeOffset!==null,d=c?this.startTimeOffset:e.startTimeOffset;d!==null&&isFiniteNumber(d)?(a=i+d,d<0&&(a+=e.edge),a=Math.min(Math.max(i,a),i+e.totalduration),this.log(`Setting startPosition to ${a} for start time offset ${d} found in ${c?"multivariant":"media"} playlist`),this.startPosition=a):e.live?(a=this.hls.liveSyncPosition||i,this.log(`Setting startPosition to -1 to start at live edge ${a}`),this.startPosition=-1):(this.log("setting startPosition to 0 by default"),this.startPosition=a=0),this.lastCurrentTime=a+o}this.nextLoadPosition=a+o}getLoadPosition(){var e;const{media:i}=this;let a=0;return(e=this.hls)!=null&&e.hasEnoughToStart&&i?a=i.currentTime:this.nextLoadPosition>=0&&(a=this.nextLoadPosition),a}handleFragLoadAborted(e,i){this.transmuxer&&e.type===this.playlistType&&isMediaFragment(e)&&e.stats.aborted&&(this.log(`Fragment ${e.sn}${i?" part "+i.index:""} of ${this.playlistLabel()} ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){(!this.fragCurrent||!this.fragContextChanged(e)&&this.state!==State.FRAG_LOADING_WAITING_RETRY)&&(this.state=State.IDLE)}onFragmentOrKeyLoadError(e,i){var a;if(i.chunkMeta&&!i.frag){const rt=this.getCurrentContext(i.chunkMeta);rt&&(i.frag=rt.frag)}const o=i.frag;if(!o||o.type!==e||!this.levels)return;if(this.fragContextChanged(o)){var c;this.warn(`Frag load error must match current frag to retry ${o.url} > ${(c=this.fragCurrent)==null?void 0:c.url}`);return}const d=i.details===ErrorDetails.FRAG_GAP;d&&this.fragmentTracker.fragBuffered(o,!0);const g=i.errorAction;if(!g){this.state=State.ERROR;return}const{action:b,flags:_,retryCount:j=0,retryConfig:$}=g,_e=!!$,tt=_e&&b===NetworkErrorAction.RetryRequest,et=_e&&!g.resolved&&_===ErrorActionFlags.MoveAllAlternatesMatchingHost,st=(a=this.hls.latestLevelDetails)==null?void 0:a.live;if(!tt&&et&&isMediaFragment(o)&&!o.endList&&st&&!isUnusableKeyError(i))this.resetFragmentErrors(e),this.treatAsGap(o),g.resolved=!0;else if((tt||et)&&j<$.maxNumRetry){var at;const rt=offlineHttpStatus((at=i.response)==null?void 0:at.code),nt=getRetryDelay($,j);if(this.resetStartWhenNotLoaded(),this.retryDate=self.performance.now()+nt,this.state=State.FRAG_LOADING_WAITING_RETRY,g.resolved=!0,rt){this.log("Waiting for connection (offline)"),this.retryDate=1/0,i.reason="offline";return}this.warn(`Fragment ${o.sn} of ${e} ${o.level} errored with ${i.details}, retrying loading ${j+1}/${$.maxNumRetry} in ${nt}ms`)}else if($)if(this.resetFragmentErrors(e),j<$.maxNumRetry)!d&&b!==NetworkErrorAction.RemoveAlternatePermanently&&(g.resolved=!0);else{this.warn(`${i.details} reached or exceeded max retry (${j})`);return}else b===NetworkErrorAction.SendAlternateToPenaltyBox?this.state=State.WAITING_LEVEL:this.state=State.ERROR;this.tickImmediate()}checkRetryDate(){const e=self.performance.now(),i=this.retryDate,a=i===1/0;(!i||e>=i||a&&!offlineHttpStatus(0))&&(a&&this.log("Connection restored (online)"),this.resetStartWhenNotLoaded(),this.state=State.IDLE)}reduceLengthAndFlushBuffer(e){if(this.state===State.PARSING||this.state===State.PARSED){const i=e.frag,a=e.parent,o=this.getFwdBufferInfo(this.mediaBuffer,a),c=o&&o.len>.5;c&&this.reduceMaxBufferLength(o.len,(i==null?void 0:i.duration)||10);const d=!c;return d&&this.warn(`Buffer full error while media.currentTime (${this.getLoadPosition()}) is not buffered, flush ${a} buffer`),i&&(this.fragmentTracker.removeFragment(i),this.nextLoadPosition=i.start),this.resetLoadingState(),d}return!1}resetFragmentErrors(e){e===PlaylistLevelType.AUDIO&&(this.fragCurrent=null),this.hls.hasEnoughToStart||(this.startFragRequested=!1),this.state!==State.STOPPED&&(this.state=State.IDLE)}afterBufferFlushed(e,i,a){if(!e)return;const o=BufferHelper.getBuffered(e);this.fragmentTracker.detectEvictedFragments(i,o,a),this.state===State.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state!==State.STOPPED&&(this.state=State.IDLE)}resetStartWhenNotLoaded(){if(!this.hls.hasEnoughToStart){this.startFragRequested=!1;const e=this.levelLastLoaded,i=e?e.details:null;i!=null&&i.live?(this.log("resetting startPosition for live start"),this.startPosition=-1,this.setStartPosition(i,i.fragmentStart),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){this.log(`Loading context changed while buffering sn ${e.sn} of ${this.playlistLabel()} ${e.level===-1?"<removed>":e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,i,a,o){const c=a.details;if(!c){this.warn("level.details undefined");return}if(!Object.keys(e.elementaryStreams).reduce((b,_)=>{const j=e.elementaryStreams[_];if(j){const $=j.endPTS-j.startPTS;if($<=0)return this.warn(`Could not parse fragment ${e.sn} ${_} duration reliably (${$})`),b||!1;const _e=o?0:updateFragPTSDTS(c,e,j.startPTS,j.endPTS,j.startDTS,j.endDTS,this);return this.hls.trigger(Events.LEVEL_PTS_UPDATED,{details:c,level:a,drift:_e,type:_,frag:e,start:j.startPTS,end:j.endPTS}),!0}return b},!1)){var g;if(a.fragmentError===0&&this.treatAsGap(e,a),((g=this.transmuxer)==null?void 0:g.error)===null){const b=new Error(`Found no media in fragment ${e.sn} of ${this.playlistLabel()} ${e.level} resetting transmuxer to fallback to playlist timing`);if(this.warn(b.message),this.hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,error:b,frag:e,reason:`Found no media in msn ${e.sn} of ${this.playlistLabel()} "${a.url}"`}),!this.hls)return;this.resetTransmuxer()}}this.state=State.PARSED,this.log(`Parsed ${e.type} sn: ${e.sn}${i?" part: "+i.index:""} of ${this.fragInfo(e,!1,i)})`),this.hls.trigger(Events.FRAG_PARSED,{frag:e,part:i})}playlistLabel(){return this.playlistType===PlaylistLevelType.MAIN?"level":"track"}fragInfo(e,i=!0,a){var o,c;return`${this.playlistLabel()} ${e.level} (${a?"part":"frag"}:[${((o=i&&!a?e.startPTS:(a||e).start)!=null?o:NaN).toFixed(3)}-${((c=i&&!a?e.endPTS:(a||e).end)!=null?c:NaN).toFixed(3)}]${a&&e.type==="main"?"INDEPENDENT="+(a.independent?"YES":"NO"):""}`}treatAsGap(e,i){i&&i.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)}resetTransmuxer(){var e;(e=this.transmuxer)==null||e.reset()}recoverWorkerError(e){e.event==="demuxerWorker"&&(this.fragmentTracker.removeAllFragments(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),this.resetStartWhenNotLoaded(),this.resetLoadingState())}set state(e){const i=this._state;i!==e&&(this._state=e,this.log(`${i}->${e}`))}get state(){return this._state}}function interstitialsEnabled(s){return!!s.interstitialsController&&s.enableInterstitialPlayback!==!1}class ChunkCache{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:i}=this;let a;if(e.length)e.length===1?a=e[0]:a=concatUint8Arrays(e,i);else return new Uint8Array(0);return this.reset(),a}reset(){this.chunks.length=0,this.dataLength=0}}function concatUint8Arrays(s,e){const i=new Uint8Array(e);let a=0;for(let o=0;o<s.length;o++){const c=s[o];i.set(c,a),a+=c.length}return i}var eventemitter3={exports:{}},hasRequiredEventemitter3;function requireEventemitter3(){return hasRequiredEventemitter3||(hasRequiredEventemitter3=1,function(s){var e=Object.prototype.hasOwnProperty,i="~";function a(){}Object.create&&(a.prototype=Object.create(null),new a().__proto__||(i=!1));function o(b,_,j){this.fn=b,this.context=_,this.once=j||!1}function c(b,_,j,$,_e){if(typeof j!="function")throw new TypeError("The listener must be a function");var tt=new o(j,$||b,_e),et=i?i+_:_;return b._events[et]?b._events[et].fn?b._events[et]=[b._events[et],tt]:b._events[et].push(tt):(b._events[et]=tt,b._eventsCount++),b}function d(b,_){--b._eventsCount===0?b._events=new a:delete b._events[_]}function g(){this._events=new a,this._eventsCount=0}g.prototype.eventNames=function(){var _=[],j,$;if(this._eventsCount===0)return _;for($ in j=this._events)e.call(j,$)&&_.push(i?$.slice(1):$);return Object.getOwnPropertySymbols?_.concat(Object.getOwnPropertySymbols(j)):_},g.prototype.listeners=function(_){var j=i?i+_:_,$=this._events[j];if(!$)return[];if($.fn)return[$.fn];for(var _e=0,tt=$.length,et=new Array(tt);_e<tt;_e++)et[_e]=$[_e].fn;return et},g.prototype.listenerCount=function(_){var j=i?i+_:_,$=this._events[j];return $?$.fn?1:$.length:0},g.prototype.emit=function(_,j,$,_e,tt,et){var st=i?i+_:_;if(!this._events[st])return!1;var at=this._events[st],rt=arguments.length,nt,it;if(at.fn){switch(at.once&&this.removeListener(_,at.fn,void 0,!0),rt){case 1:return at.fn.call(at.context),!0;case 2:return at.fn.call(at.context,j),!0;case 3:return at.fn.call(at.context,j,$),!0;case 4:return at.fn.call(at.context,j,$,_e),!0;case 5:return at.fn.call(at.context,j,$,_e,tt),!0;case 6:return at.fn.call(at.context,j,$,_e,tt,et),!0}for(it=1,nt=new Array(rt-1);it<rt;it++)nt[it-1]=arguments[it];at.fn.apply(at.context,nt)}else{var ot=at.length,lt;for(it=0;it<ot;it++)switch(at[it].once&&this.removeListener(_,at[it].fn,void 0,!0),rt){case 1:at[it].fn.call(at[it].context);break;case 2:at[it].fn.call(at[it].context,j);break;case 3:at[it].fn.call(at[it].context,j,$);break;case 4:at[it].fn.call(at[it].context,j,$,_e);break;default:if(!nt)for(lt=1,nt=new Array(rt-1);lt<rt;lt++)nt[lt-1]=arguments[lt];at[it].fn.apply(at[it].context,nt)}}return!0},g.prototype.on=function(_,j,$){return c(this,_,j,$,!1)},g.prototype.once=function(_,j,$){return c(this,_,j,$,!0)},g.prototype.removeListener=function(_,j,$,_e){var tt=i?i+_:_;if(!this._events[tt])return this;if(!j)return d(this,tt),this;var et=this._events[tt];if(et.fn)et.fn===j&&(!_e||et.once)&&(!$||et.context===$)&&d(this,tt);else{for(var st=0,at=[],rt=et.length;st<rt;st++)(et[st].fn!==j||_e&&!et[st].once||$&&et[st].context!==$)&&at.push(et[st]);at.length?this._events[tt]=at.length===1?at[0]:at:d(this,tt)}return this},g.prototype.removeAllListeners=function(_){var j;return _?(j=i?i+_:_,this._events[j]&&d(this,j)):(this._events=new a,this._eventsCount=0),this},g.prototype.off=g.prototype.removeListener,g.prototype.addListener=g.prototype.on,g.prefixed=i,g.EventEmitter=g,s.exports=g}(eventemitter3)),eventemitter3.exports}var eventemitter3Exports=requireEventemitter3(),EventEmitter=getDefaultExportFromCjs(eventemitter3Exports);const version="1.6.14",workerStore={};function hasUMDWorker(){return typeof __HLS_WORKER_BUNDLE__=="function"}function injectWorker(){const s=workerStore[version];if(s)return s.clientCount++,s;const e=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),i=self.URL.createObjectURL(e),o={worker:new self.Worker(i),objectURL:i,clientCount:1};return workerStore[version]=o,o}function loadWorker(s){const e=workerStore[s];if(e)return e.clientCount++,e;const i=new self.URL(s,self.location.href).href,o={worker:new self.Worker(i),scriptURL:i,clientCount:1};return workerStore[s]=o,o}function removeWorkerFromStore(s){const e=workerStore[s||version];if(e&&e.clientCount--===1){const{worker:a,objectURL:o}=e;delete workerStore[s||version],o&&self.URL.revokeObjectURL(o),a.terminate()}}function isId3Footer(s,e){return e+10<=s.length&&s[e]===51&&s[e+1]===68&&s[e+2]===73&&s[e+3]<255&&s[e+4]<255&&s[e+6]<128&&s[e+7]<128&&s[e+8]<128&&s[e+9]<128}function isId3Header(s,e){return e+10<=s.length&&s[e]===73&&s[e+1]===68&&s[e+2]===51&&s[e+3]<255&&s[e+4]<255&&s[e+6]<128&&s[e+7]<128&&s[e+8]<128&&s[e+9]<128}function readId3Size(s,e){let i=0;return i=(s[e]&127)<<21,i|=(s[e+1]&127)<<14,i|=(s[e+2]&127)<<7,i|=s[e+3]&127,i}function getId3Data(s,e){const i=e;let a=0;for(;isId3Header(s,e);){a+=10;const o=readId3Size(s,e+6);a+=o,isId3Footer(s,e+10)&&(a+=10),e+=a}if(a>0)return s.subarray(i,i+a)}function getAudioConfig(s,e,i,a){const o=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],c=e[i+2],d=c>>2&15;if(d>12){const tt=new Error(`invalid ADTS sampling index:${d}`);s.emit(Events.ERROR,Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,error:tt,reason:tt.message});return}const g=(c>>6&3)+1,b=e[i+3]>>6&3|(c&1)<<2,_="mp4a.40."+g,j=o[d];let $=d;(g===5||g===29)&&($-=3);const _e=[g<<3|($&14)>>1,($&1)<<7|b<<3];return logger.log(`manifest codec:${a}, parsed codec:${_}, channels:${b}, rate:${j} (ADTS object type:${g} sampling index:${d})`),{config:_e,samplerate:j,channelCount:b,codec:_,parsedCodec:_,manifestCodec:a}}function isHeaderPattern$1(s,e){return s[e]===255&&(s[e+1]&246)===240}function getHeaderLength(s,e){return s[e+1]&1?7:9}function getFullFrameLength(s,e){return(s[e+3]&3)<<11|s[e+4]<<3|(s[e+5]&224)>>>5}function canGetFrameLength(s,e){return e+5<s.length}function isHeader$1(s,e){return e+1<s.length&&isHeaderPattern$1(s,e)}function canParse$1(s,e){return canGetFrameLength(s,e)&&isHeaderPattern$1(s,e)&&getFullFrameLength(s,e)<=s.length-e}function probe$1(s,e){if(isHeader$1(s,e)){const i=getHeaderLength(s,e);if(e+i>=s.length)return!1;const a=getFullFrameLength(s,e);if(a<=i)return!1;const o=e+a;return o===s.length||isHeader$1(s,o)}return!1}function initTrackConfig(s,e,i,a,o){if(!s.samplerate){const c=getAudioConfig(e,i,a,o);if(!c)return;_extends(s,c)}}function getFrameDuration(s){return 1024*9e4/s}function parseFrameHeader(s,e){const i=getHeaderLength(s,e);if(e+i<=s.length){const a=getFullFrameLength(s,e)-i;if(a>0)return{headerLength:i,frameLength:a}}}function appendFrame$2(s,e,i,a,o){const c=getFrameDuration(s.samplerate),d=a+o*c,g=parseFrameHeader(e,i);let b;if(g){const{frameLength:$,headerLength:_e}=g,tt=_e+$,et=Math.max(0,i+tt-e.length);et?(b=new Uint8Array(tt-_e),b.set(e.subarray(i+_e,e.length),0)):b=e.subarray(i+_e,i+tt);const st={unit:b,pts:d};return et||s.samples.push(st),{sample:st,length:tt,missing:et}}const _=e.length-i;return b=new Uint8Array(_),b.set(e.subarray(i,e.length),0),{sample:{unit:b,pts:d},length:_,missing:-1}}function canParseId3(s,e){return isId3Header(s,e)&&readId3Size(s,e+6)+10<=s.length-e}function toArrayBuffer(s){return s instanceof ArrayBuffer?s:s.byteOffset==0&&s.byteLength==s.buffer.byteLength?s.buffer:new Uint8Array(s).buffer}function toUint8(s,e=0,i=1/0){return view(s,e,i,Uint8Array)}function view(s,e,i,a){const o=unsafeGetArrayBuffer(s);let c=1;"BYTES_PER_ELEMENT"in a&&(c=a.BYTES_PER_ELEMENT);const d=isArrayBufferView(s)?s.byteOffset:0,g=(d+s.byteLength)/c,b=(d+e)/c,_=Math.floor(Math.max(0,Math.min(b,g))),j=Math.floor(Math.min(_+Math.max(i,0),g));return new a(o,_,j-_)}function unsafeGetArrayBuffer(s){return s instanceof ArrayBuffer?s:s.buffer}function isArrayBufferView(s){return s&&s.buffer instanceof ArrayBuffer&&s.byteLength!==void 0&&s.byteOffset!==void 0}function decodeId3ImageFrame(s){const e={key:s.type,description:"",data:"",mimeType:null,pictureType:null},i=3;if(s.size<2)return;if(s.data[0]!==i){console.log("Ignore frame with unrecognized character encoding");return}const a=s.data.subarray(1).indexOf(0);if(a===-1)return;const o=utf8ArrayToStr(toUint8(s.data,1,a)),c=s.data[2+a],d=s.data.subarray(3+a).indexOf(0);if(d===-1)return;const g=utf8ArrayToStr(toUint8(s.data,3+a,d));let b;return o==="-->"?b=utf8ArrayToStr(toUint8(s.data,4+a+d)):b=toArrayBuffer(s.data.subarray(4+a+d)),e.mimeType=o,e.pictureType=c,e.description=g,e.data=b,e}function decodeId3PrivFrame(s){if(s.size<2)return;const e=utf8ArrayToStr(s.data,!0),i=new Uint8Array(s.data.subarray(e.length+1));return{key:s.type,info:e,data:i.buffer}}function decodeId3TextFrame(s){if(s.size<2)return;if(s.type==="TXXX"){let i=1;const a=utf8ArrayToStr(s.data.subarray(i),!0);i+=a.length+1;const o=utf8ArrayToStr(s.data.subarray(i));return{key:s.type,info:a,data:o}}const e=utf8ArrayToStr(s.data.subarray(1));return{key:s.type,info:"",data:e}}function decodeId3UrlFrame(s){if(s.type==="WXXX"){if(s.size<2)return;let i=1;const a=utf8ArrayToStr(s.data.subarray(i),!0);i+=a.length+1;const o=utf8ArrayToStr(s.data.subarray(i));return{key:s.type,info:a,data:o}}const e=utf8ArrayToStr(s.data);return{key:s.type,info:"",data:e}}function decodeId3Frame(s){return s.type==="PRIV"?decodeId3PrivFrame(s):s.type[0]==="W"?decodeId3UrlFrame(s):s.type==="APIC"?decodeId3ImageFrame(s):decodeId3TextFrame(s)}function getId3FrameData(s){const e=String.fromCharCode(s[0],s[1],s[2],s[3]),i=readId3Size(s,4),a=10;return{type:e,size:i,data:s.subarray(a,a+i)}}const HEADER_FOOTER_SIZE=10,FRAME_SIZE=10;function getId3Frames(s){let e=0;const i=[];for(;isId3Header(s,e);){const a=readId3Size(s,e+6);s[e+5]>>6&1&&(e+=HEADER_FOOTER_SIZE),e+=HEADER_FOOTER_SIZE;const o=e+a;for(;e+FRAME_SIZE<o;){const c=getId3FrameData(s.subarray(e)),d=decodeId3Frame(c);d&&i.push(d),e+=c.size+HEADER_FOOTER_SIZE}isId3Footer(s,e)&&(e+=HEADER_FOOTER_SIZE)}return i}function isId3TimestampFrame(s){return s&&s.key==="PRIV"&&s.info==="com.apple.streaming.transportStreamTimestamp"}function readId3Timestamp(s){if(s.data.byteLength===8){const e=new Uint8Array(s.data),i=e[3]&1;let a=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return a/=45,i&&(a+=4772185884e-2),Math.round(a)}}function getId3Timestamp(s){const e=getId3Frames(s);for(let i=0;i<e.length;i++){const a=e[i];if(isId3TimestampFrame(a))return readId3Timestamp(a)}}let MetadataSchema=function(s){return s.audioId3="org.id3",s.dateRange="com.apple.quicktime.HLS",s.emsg="https://aomedia.org/emsg/ID3",s.misbklv="urn:misb:KLV:bin:1910.1",s}({});function dummyTrack(s="",e=9e4){return{type:s,id:-1,pid:-1,inputTimeScale:e,sequenceNumber:-1,samples:[],dropped:0}}class BaseAudioDemuxer{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,i,a,o){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,i){return!1}appendFrame(e,i,a){}demux(e,i){this.cachedData&&(e=appendUint8Array(this.cachedData,e),this.cachedData=null);let a=getId3Data(e,0),o=a?a.length:0,c;const d=this._audioTrack,g=this._id3Track,b=a?getId3Timestamp(a):void 0,_=e.length;for((this.basePTS===null||this.frameIndex===0&&isFiniteNumber(b))&&(this.basePTS=initPTSFn(b,i,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),a&&a.length>0&&g.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:a,type:MetadataSchema.audioId3,duration:Number.POSITIVE_INFINITY});o<_;){if(this.canParse(e,o)){const j=this.appendFrame(d,e,o);j?(this.frameIndex++,this.lastPTS=j.sample.pts,o+=j.length,c=o):o=_}else canParseId3(e,o)?(a=getId3Data(e,o),g.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:a,type:MetadataSchema.audioId3,duration:Number.POSITIVE_INFINITY}),o+=a.length,c=o):o++;if(o===_&&c!==_){const j=e.slice(c);this.cachedData?this.cachedData=appendUint8Array(this.cachedData,j):this.cachedData=j}}return{audioTrack:d,videoTrack:dummyTrack(),id3Track:g,textTrack:dummyTrack()}}demuxSampleAes(e,i,a){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const i=this.cachedData;return i&&(this.cachedData=null,this.demux(i,0)),{audioTrack:this._audioTrack,videoTrack:dummyTrack(),id3Track:this._id3Track,textTrack:dummyTrack()}}destroy(){this.cachedData=null,this._audioTrack=this._id3Track=void 0}}const initPTSFn=(s,e,i)=>{if(isFiniteNumber(s))return s*90;const a=i?i.baseTime*9e4/i.timescale:0;return e*9e4+a};let chromeVersion$1=null;const BitratesMap=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],SamplesCoefficients=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],BytesInSlot=[0,1,1,4];function appendFrame$1(s,e,i,a,o){if(i+24>e.length)return;const c=parseHeader(e,i);if(c&&i+c.frameLength<=e.length){const d=c.samplesPerFrame*9e4/c.sampleRate,g=a+o*d,b={unit:e.subarray(i,i+c.frameLength),pts:g,dts:g};return s.config=[],s.channelCount=c.channelCount,s.samplerate=c.sampleRate,s.samples.push(b),{sample:b,length:c.frameLength,missing:0}}}function parseHeader(s,e){const i=s[e+1]>>3&3,a=s[e+1]>>1&3,o=s[e+2]>>4&15,c=s[e+2]>>2&3;if(i!==1&&o!==0&&o!==15&&c!==3){const d=s[e+2]>>1&1,g=s[e+3]>>6,b=i===3?3-a:a===3?3:4,_=BitratesMap[b*14+o-1]*1e3,$=SamplingRateMap[(i===3?0:i===2?1:2)*3+c],_e=g===3?1:2,tt=SamplesCoefficients[i][a],et=BytesInSlot[a],st=tt*8*et,at=Math.floor(tt*_/$+d)*et;if(chromeVersion$1===null){const it=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);chromeVersion$1=it?parseInt(it[1]):0}return!!chromeVersion$1&&chromeVersion$1<=87&&a===2&&_>=224e3&&g===0&&(s[e+3]=s[e+3]|128),{sampleRate:$,channelCount:_e,frameLength:at,samplesPerFrame:st}}}function isHeaderPattern(s,e){return s[e]===255&&(s[e+1]&224)===224&&(s[e+1]&6)!==0}function isHeader(s,e){return e+1<s.length&&isHeaderPattern(s,e)}function canParse(s,e){return isHeaderPattern(s,e)&&4<=s.length-e}function probe(s,e){if(e+1<s.length&&isHeaderPattern(s,e)){const a=parseHeader(s,e);let o=4;a!=null&&a.frameLength&&(o=a.frameLength);const c=e+o;return c===s.length||isHeader(s,c)}return!1}class AACDemuxer extends BaseAudioDemuxer{constructor(e,i){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=i}resetInitSegment(e,i,a,o){super.resetInitSegment(e,i,a,o),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:i,duration:o,inputTimeScale:9e4,dropped:0}}static probe(e,i){if(!e)return!1;const a=getId3Data(e,0);let o=(a==null?void 0:a.length)||0;if(probe(e,o))return!1;for(let c=e.length;o<c;o++)if(probe$1(e,o))return i.log("ADTS sync word found !"),!0;return!1}canParse(e,i){return canParse$1(e,i)}appendFrame(e,i,a){initTrackConfig(e,this.observer,i,a,e.manifestCodec);const o=appendFrame$2(e,i,a,this.basePTS,this.frameIndex);if(o&&o.missing===0)return o}}const getAudioBSID=(s,e)=>{let i=0,a=5;e+=a;const o=new Uint32Array(1),c=new Uint32Array(1),d=new Uint8Array(1);for(;a>0;){d[0]=s[e];const g=Math.min(a,8),b=8-g;c[0]=4278190080>>>24+b<<b,o[0]=(d[0]&c[0])>>b,i=i?i<<g|o[0]:o[0],e+=1,a-=g}return i};class AC3Demuxer extends BaseAudioDemuxer{constructor(e){super(),this.observer=void 0,this.observer=e}resetInitSegment(e,i,a,o){super.resetInitSegment(e,i,a,o),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:i,duration:o,inputTimeScale:9e4,dropped:0}}canParse(e,i){return i+64<e.length}appendFrame(e,i,a){const o=appendFrame(e,i,a,this.basePTS,this.frameIndex);if(o!==-1)return{sample:e.samples[e.samples.length-1],length:o,missing:0}}static probe(e){if(!e)return!1;const i=getId3Data(e,0);if(!i)return!1;const a=i.length;return e[a]===11&&e[a+1]===119&&getId3Timestamp(i)!==void 0&&getAudioBSID(e,a)<16}}function appendFrame(s,e,i,a,o){if(i+8>e.length||e[i]!==11||e[i+1]!==119)return-1;const c=e[i+4]>>6;if(c>=3)return-1;const g=[48e3,44100,32e3][c],b=e[i+4]&63,j=[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][b*3+c]*2;if(i+j>e.length)return-1;const $=e[i+6]>>5;let _e=0;$===2?_e+=2:($&1&&$!==1&&(_e+=2),$&4&&(_e+=2));const tt=(e[i+6]<<8|e[i+7])>>12-_e&1,st=[2,1,2,3,3,4,4,5][$]+tt,at=e[i+5]>>3,rt=e[i+5]&7,nt=new Uint8Array([c<<6|at<<1|rt>>2,(rt&3)<<6|$<<3|tt<<2|b>>4,b<<4&224]),it=1536/g*9e4,ot=a+o*it,lt=e.subarray(i,i+j);return s.config=nt,s.channelCount=st,s.samplerate=g,s.samples.push({unit:lt,pts:ot}),j}class MP3Demuxer extends BaseAudioDemuxer{resetInitSegment(e,i,a,o){super.resetInitSegment(e,i,a,o),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:i,duration:o,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const i=getId3Data(e,0);let a=(i==null?void 0:i.length)||0;if(i&&e[a]===11&&e[a+1]===119&&getId3Timestamp(i)!==void 0&&getAudioBSID(e,a)<=16)return!1;for(let o=e.length;a<o;a++)if(probe(e,a))return logger.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,i){return canParse(e,i)}appendFrame(e,i,a){if(this.basePTS!==null)return appendFrame$1(e,i,a,this.basePTS,this.frameIndex)}}const emsgSchemePattern=/\/emsg[-/]ID3/i;class MP4Demuxer{constructor(e,i){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=i}resetTimeStamp(){}resetInitSegment(e,i,a,o){const c=this.videoTrack=dummyTrack("video",1),d=this.audioTrack=dummyTrack("audio",1),g=this.txtTrack=dummyTrack("text",1);if(this.id3Track=dummyTrack("id3",1),this.timeOffset=0,!(e!=null&&e.byteLength))return;const b=parseInitSegment(e);if(b.video){const{id:_,timescale:j,codec:$,supplemental:_e}=b.video;c.id=_,c.timescale=g.timescale=j,c.codec=$,c.supplemental=_e}if(b.audio){const{id:_,timescale:j,codec:$}=b.audio;d.id=_,d.timescale=j,d.codec=$}g.id=RemuxerTrackIdConfig.text,c.sampleDuration=0,c.duration=d.duration=o}resetContiguity(){this.remainderData=null}static probe(e){return hasMoofData(e)}demux(e,i){this.timeOffset=i;let a=e;const o=this.videoTrack,c=this.txtTrack;if(this.config.progressive){this.remainderData&&(a=appendUint8Array(this.remainderData,e));const g=segmentValidRange(a);this.remainderData=g.remainder,o.samples=g.valid||new Uint8Array}else o.samples=a;const d=this.extractID3Track(o,i);return c.samples=parseSamples(i,o),{videoTrack:o,audioTrack:this.audioTrack,id3Track:d,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,i=this.videoTrack,a=this.txtTrack;i.samples=this.remainderData||new Uint8Array,this.remainderData=null;const o=this.extractID3Track(i,this.timeOffset);return a.samples=parseSamples(e,i),{videoTrack:i,audioTrack:dummyTrack(),id3Track:o,textTrack:dummyTrack()}}extractID3Track(e,i){const a=this.id3Track;if(e.samples.length){const o=findBox(e.samples,["emsg"]);o&&o.forEach(c=>{const d=parseEmsg(c);if(emsgSchemePattern.test(d.schemeIdUri)){const g=getEmsgStartTime(d,i);let b=d.eventDuration===4294967295?Number.POSITIVE_INFINITY:d.eventDuration/d.timeScale;b<=.001&&(b=Number.POSITIVE_INFINITY);const _=d.payload;a.samples.push({data:_,len:_.byteLength,dts:g,pts:g,type:MetadataSchema.emsg,duration:b})}else if(this.config.enableEmsgKLVMetadata&&d.schemeIdUri.startsWith("urn:misb:KLV:bin:1910.1")){const g=getEmsgStartTime(d,i);a.samples.push({data:d.payload,len:d.payload.byteLength,dts:g,pts:g,type:MetadataSchema.misbklv,duration:Number.POSITIVE_INFINITY})}})}return a}demuxSampleAes(e,i,a){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){this.config=null,this.remainderData=null,this.videoTrack=this.audioTrack=this.id3Track=this.txtTrack=void 0}}function getEmsgStartTime(s,e){return isFiniteNumber(s.presentationTime)?s.presentationTime/s.timeScale:e+s.presentationTimeDelta/s.timeScale}class SampleAesDecrypter{constructor(e,i,a){this.keyData=void 0,this.decrypter=void 0,this.keyData=a,this.decrypter=new Decrypter(i,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer,DecrypterAesMode.cbc)}decryptAacSample(e,i,a){const o=e[i].unit;if(o.length<=16)return;const c=o.subarray(16,o.length-o.length%16),d=c.buffer.slice(c.byteOffset,c.byteOffset+c.length);this.decryptBuffer(d).then(g=>{const b=new Uint8Array(g);o.set(b,16),this.decrypter.isSync()||this.decryptAacSamples(e,i+1,a)}).catch(a)}decryptAacSamples(e,i,a){for(;;i++){if(i>=e.length){a();return}if(!(e[i].unit.length<32)&&(this.decryptAacSample(e,i,a),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){const i=Math.floor((e.length-48)/160)*16+16,a=new Int8Array(i);let o=0;for(let c=32;c<e.length-16;c+=160,o+=16)a.set(e.subarray(c,c+16),o);return a}getAvcDecryptedUnit(e,i){const a=new Uint8Array(i);let o=0;for(let c=32;c<e.length-16;c+=160,o+=16)e.set(a.subarray(o,o+16),c);return e}decryptAvcSample(e,i,a,o,c){const d=discardEPB(c.data),g=this.getAvcEncryptedData(d);this.decryptBuffer(g.buffer).then(b=>{c.data=this.getAvcDecryptedUnit(d,b),this.decrypter.isSync()||this.decryptAvcSamples(e,i,a+1,o)}).catch(o)}decryptAvcSamples(e,i,a,o){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;i++,a=0){if(i>=e.length){o();return}const c=e[i].units;for(;!(a>=c.length);a++){const d=c[a];if(!(d.data.length<=48||d.type!==1&&d.type!==5)&&(this.decryptAvcSample(e,i,a,o,d),!this.decrypter.isSync()))return}}}}class BaseVideoParser{constructor(){this.VideoSample=null}createVideoSample(e,i,a){return{key:e,frame:!1,pts:i,dts:a,units:[],length:0}}getLastNalUnit(e){var i;let a=this.VideoSample,o;if((!a||a.units.length===0)&&(a=e[e.length-1]),(i=a)!=null&&i.units){const c=a.units;o=c[c.length-1]}return o}pushAccessUnit(e,i){if(e.units.length&&e.frame){if(e.pts===void 0){const a=i.samples,o=a.length;if(o){const c=a[o-1];e.pts=c.pts,e.dts=c.dts}else{i.dropped++;return}}i.samples.push(e)}}parseNALu(e,i,a){const o=i.byteLength;let c=e.naluState||0;const d=c,g=[];let b=0,_,j,$,_e=-1,tt=0;for(c===-1&&(_e=0,tt=this.getNALuType(i,0),c=0,b=1);b<o;){if(_=i[b++],!c){c=_?0:1;continue}if(c===1){c=_?0:2;continue}if(!_)c=3;else if(_===1){if(j=b-c-1,_e>=0){const et={data:i.subarray(_e,j),type:tt};g.push(et)}else{const et=this.getLastNalUnit(e.samples);et&&(d&&b<=4-d&&et.state&&(et.data=et.data.subarray(0,et.data.byteLength-d)),j>0&&(et.data=appendUint8Array(et.data,i.subarray(0,j)),et.state=0))}b<o?($=this.getNALuType(i,b),_e=b,tt=$,c=0):c=-1}else c=0}if(_e>=0&&c>=0){const et={data:i.subarray(_e,o),type:tt,state:c};g.push(et)}if(g.length===0){const et=this.getLastNalUnit(e.samples);et&&(et.data=appendUint8Array(et.data,i))}return e.naluState=c,g}}class ExpGolomb{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,i=this.bytesAvailable,a=e.byteLength-i,o=new Uint8Array(4),c=Math.min(4,i);if(c===0)throw new Error("no bytes available");o.set(e.subarray(a,a+c)),this.word=new DataView(o.buffer).getUint32(0),this.bitsAvailable=c*8,this.bytesAvailable-=c}skipBits(e){let i;e=Math.min(e,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,i=e>>3,e-=i<<3,this.bytesAvailable-=i,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let i=Math.min(this.bitsAvailable,e);const a=this.word>>>32-i;if(e>32&&logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=i,this.bitsAvailable>0)this.word<<=i;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return i=e-i,i>0&&this.bitsAvailable?a<<i|this.readBits(i):a}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if(this.word&2147483648>>>e)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}}class AvcVideoParser extends BaseVideoParser{parsePES(e,i,a,o){const c=this.parseNALu(e,a.data,o);let d=this.VideoSample,g,b=!1;a.data=null,d&&c.length&&!e.audFound&&(this.pushAccessUnit(d,e),d=this.VideoSample=this.createVideoSample(!1,a.pts,a.dts)),c.forEach(_=>{var j,$;switch(_.type){case 1:{let st=!1;g=!0;const at=_.data;if(b&&at.length>4){const rt=this.readSliceType(at);(rt===2||rt===4||rt===7||rt===9)&&(st=!0)}if(st){var _e;(_e=d)!=null&&_e.frame&&!d.key&&(this.pushAccessUnit(d,e),d=this.VideoSample=null)}d||(d=this.VideoSample=this.createVideoSample(!0,a.pts,a.dts)),d.frame=!0,d.key=st;break}case 5:g=!0,(j=d)!=null&&j.frame&&!d.key&&(this.pushAccessUnit(d,e),d=this.VideoSample=null),d||(d=this.VideoSample=this.createVideoSample(!0,a.pts,a.dts)),d.key=!0,d.frame=!0;break;case 6:{g=!0,parseSEIMessageFromNALu(_.data,1,a.pts,i.samples);break}case 7:{var tt,et;g=!0,b=!0;const st=_.data,at=this.readSPS(st);if(!e.sps||e.width!==at.width||e.height!==at.height||((tt=e.pixelRatio)==null?void 0:tt[0])!==at.pixelRatio[0]||((et=e.pixelRatio)==null?void 0:et[1])!==at.pixelRatio[1]){e.width=at.width,e.height=at.height,e.pixelRatio=at.pixelRatio,e.sps=[st];const rt=st.subarray(1,4);let nt="avc1.";for(let it=0;it<3;it++){let ot=rt[it].toString(16);ot.length<2&&(ot="0"+ot),nt+=ot}e.codec=nt}break}case 8:g=!0,e.pps=[_.data];break;case 9:g=!0,e.audFound=!0,($=d)!=null&&$.frame&&(this.pushAccessUnit(d,e),d=null),d||(d=this.VideoSample=this.createVideoSample(!1,a.pts,a.dts));break;case 12:g=!0;break;default:g=!1;break}d&&g&&d.units.push(_)}),o&&d&&(this.pushAccessUnit(d,e),this.VideoSample=null)}getNALuType(e,i){return e[i]&31}readSliceType(e){const i=new ExpGolomb(e);return i.readUByte(),i.readUEG(),i.readUEG()}skipScalingList(e,i){let a=8,o=8,c;for(let d=0;d<e;d++)o!==0&&(c=i.readEG(),o=(a+c+256)%256),a=o===0?a:o}readSPS(e){const i=new ExpGolomb(e);let a=0,o=0,c=0,d=0,g,b,_;const j=i.readUByte.bind(i),$=i.readBits.bind(i),_e=i.readUEG.bind(i),tt=i.readBoolean.bind(i),et=i.skipBits.bind(i),st=i.skipEG.bind(i),at=i.skipUEG.bind(i),rt=this.skipScalingList.bind(this);j();const nt=j();if($(5),et(3),j(),at(),nt===100||nt===110||nt===122||nt===244||nt===44||nt===83||nt===86||nt===118||nt===128){const dt=_e();if(dt===3&&et(1),at(),at(),et(1),tt())for(b=dt!==3?8:12,_=0;_<b;_++)tt()&&(_<6?rt(16,i):rt(64,i))}at();const it=_e();if(it===0)_e();else if(it===1)for(et(1),st(),st(),g=_e(),_=0;_<g;_++)st();at(),et(1);const ot=_e(),lt=_e(),ct=$(1);ct===0&&et(1),et(1),tt()&&(a=_e(),o=_e(),c=_e(),d=_e());let ht=[1,1];if(tt()&&tt())switch(j()){case 1:ht=[1,1];break;case 2:ht=[12,11];break;case 3:ht=[10,11];break;case 4:ht=[16,11];break;case 5:ht=[40,33];break;case 6:ht=[24,11];break;case 7:ht=[20,11];break;case 8:ht=[32,11];break;case 9:ht=[80,33];break;case 10:ht=[18,11];break;case 11:ht=[15,11];break;case 12:ht=[64,33];break;case 13:ht=[160,99];break;case 14:ht=[4,3];break;case 15:ht=[3,2];break;case 16:ht=[2,1];break;case 255:{ht=[j()<<8|j(),j()<<8|j()];break}}return{width:Math.ceil((ot+1)*16-a*2-o*2),height:(2-ct)*(lt+1)*16-(ct?2:4)*(c+d),pixelRatio:ht}}}class HevcVideoParser extends BaseVideoParser{constructor(...e){super(...e),this.initVPS=null}parsePES(e,i,a,o){const c=this.parseNALu(e,a.data,o);let d=this.VideoSample,g,b=!1;a.data=null,d&&c.length&&!e.audFound&&(this.pushAccessUnit(d,e),d=this.VideoSample=this.createVideoSample(!1,a.pts,a.dts)),c.forEach(_=>{var j,$;switch(_.type){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:d||(d=this.VideoSample=this.createVideoSample(!1,a.pts,a.dts)),d.frame=!0,g=!0;break;case 16:case 17:case 18:case 21:if(g=!0,b){var _e;(_e=d)!=null&&_e.frame&&!d.key&&(this.pushAccessUnit(d,e),d=this.VideoSample=null)}d||(d=this.VideoSample=this.createVideoSample(!0,a.pts,a.dts)),d.key=!0,d.frame=!0;break;case 19:case 20:g=!0,(j=d)!=null&&j.frame&&!d.key&&(this.pushAccessUnit(d,e),d=this.VideoSample=null),d||(d=this.VideoSample=this.createVideoSample(!0,a.pts,a.dts)),d.key=!0,d.frame=!0;break;case 39:g=!0,parseSEIMessageFromNALu(_.data,2,a.pts,i.samples);break;case 32:g=!0,e.vps||(typeof e.params!="object"&&(e.params={}),e.params=_extends(e.params,this.readVPS(_.data)),this.initVPS=_.data),e.vps=[_.data];break;case 33:if(g=!0,b=!0,e.vps!==void 0&&e.vps[0]!==this.initVPS&&e.sps!==void 0&&!this.matchSPS(e.sps[0],_.data)&&(this.initVPS=e.vps[0],e.sps=e.pps=void 0),!e.sps){const tt=this.readSPS(_.data);e.width=tt.width,e.height=tt.height,e.pixelRatio=tt.pixelRatio,e.codec=tt.codecString,e.sps=[],typeof e.params!="object"&&(e.params={});for(const et in tt.params)e.params[et]=tt.params[et]}this.pushParameterSet(e.sps,_.data,e.vps),d||(d=this.VideoSample=this.createVideoSample(!0,a.pts,a.dts)),d.key=!0;break;case 34:if(g=!0,typeof e.params=="object"){if(!e.pps){e.pps=[];const tt=this.readPPS(_.data);for(const et in tt)e.params[et]=tt[et]}this.pushParameterSet(e.pps,_.data,e.vps)}break;case 35:g=!0,e.audFound=!0,($=d)!=null&&$.frame&&(this.pushAccessUnit(d,e),d=null),d||(d=this.VideoSample=this.createVideoSample(!1,a.pts,a.dts));break;default:g=!1;break}d&&g&&d.units.push(_)}),o&&d&&(this.pushAccessUnit(d,e),this.VideoSample=null)}pushParameterSet(e,i,a){(a&&a[0]===this.initVPS||!a&&!e.length)&&e.push(i)}getNALuType(e,i){return(e[i]&126)>>>1}ebsp2rbsp(e){const i=new Uint8Array(e.byteLength);let a=0;for(let o=0;o<e.byteLength;o++)o>=2&&e[o]===3&&e[o-1]===0&&e[o-2]===0||(i[a]=e[o],a++);return new Uint8Array(i.buffer,0,a)}pushAccessUnit(e,i){super.pushAccessUnit(e,i),this.initVPS&&(this.initVPS=null)}readVPS(e){const i=new ExpGolomb(e);i.readUByte(),i.readUByte(),i.readBits(4),i.skipBits(2),i.readBits(6);const a=i.readBits(3),o=i.readBoolean();return{numTemporalLayers:a+1,temporalIdNested:o}}readSPS(e){const i=new ExpGolomb(this.ebsp2rbsp(e));i.readUByte(),i.readUByte(),i.readBits(4);const a=i.readBits(3);i.readBoolean();const o=i.readBits(2),c=i.readBoolean(),d=i.readBits(5),g=i.readUByte(),b=i.readUByte(),_=i.readUByte(),j=i.readUByte(),$=i.readUByte(),_e=i.readUByte(),tt=i.readUByte(),et=i.readUByte(),st=i.readUByte(),at=i.readUByte(),rt=i.readUByte(),nt=[],it=[];for(let Nt=0;Nt<a;Nt++)nt.push(i.readBoolean()),it.push(i.readBoolean());if(a>0)for(let Nt=a;Nt<8;Nt++)i.readBits(2);for(let Nt=0;Nt<a;Nt++)nt[Nt]&&(i.readUByte(),i.readUByte(),i.readUByte(),i.readUByte(),i.readUByte(),i.readUByte(),i.readUByte(),i.readUByte(),i.readUByte(),i.readUByte(),i.readUByte()),it[Nt]&&i.readUByte();i.readUEG();const ot=i.readUEG();ot==3&&i.skipBits(1);const lt=i.readUEG(),ct=i.readUEG(),ht=i.readBoolean();let dt=0,gt=0,vt=0,St=0;ht&&(dt+=i.readUEG(),gt+=i.readUEG(),vt+=i.readUEG(),St+=i.readUEG());const Tt=i.readUEG(),Ct=i.readUEG(),Rt=i.readUEG(),bt=i.readBoolean();for(let Nt=bt?0:a;Nt<=a;Nt++)i.skipUEG(),i.skipUEG(),i.skipUEG();if(i.skipUEG(),i.skipUEG(),i.skipUEG(),i.skipUEG(),i.skipUEG(),i.skipUEG(),i.readBoolean()&&i.readBoolean())for(let Kt=0;Kt<4;Kt++)for(let Qt=0;Qt<(Kt===3?2:6);Qt++)if(!i.readBoolean())i.readUEG();else{const zt=Math.min(64,1<<4+(Kt<<1));Kt>1&&i.readEG();for(let Zt=0;Zt<zt;Zt++)i.readEG()}i.readBoolean(),i.readBoolean(),i.readBoolean()&&(i.readUByte(),i.skipUEG(),i.skipUEG(),i.readBoolean());const ut=i.readUEG();let ft=0;for(let Nt=0;Nt<ut;Nt++){let Kt=!1;if(Nt!==0&&(Kt=i.readBoolean()),Kt){Nt===ut&&i.readUEG(),i.readBoolean(),i.readUEG();let Qt=0;for(let tr=0;tr<=ft;tr++){const zt=i.readBoolean();let Zt=!1;zt||(Zt=i.readBoolean()),(zt||Zt)&&Qt++}ft=Qt}else{const Qt=i.readUEG(),tr=i.readUEG();ft=Qt+tr;for(let zt=0;zt<Qt;zt++)i.readUEG(),i.readBoolean();for(let zt=0;zt<tr;zt++)i.readUEG(),i.readBoolean()}}if(i.readBoolean()){const Nt=i.readUEG();for(let Kt=0;Kt<Nt;Kt++){for(let Qt=0;Qt<Rt+4;Qt++)i.readBits(1);i.readBits(1)}}let mt=0,Et=1,At=1,Pt=!0,wt=1,It=0;i.readBoolean(),i.readBoolean();let Mt=!1;if(i.readBoolean()){if(i.readBoolean()){const _t=i.readUByte(),$t=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],Ht=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];_t>0&&_t<16?(Et=$t[_t-1],At=Ht[_t-1]):_t===255&&(Et=i.readBits(16),At=i.readBits(16))}if(i.readBoolean()&&i.readBoolean(),i.readBoolean()&&(i.readBits(3),i.readBoolean(),i.readBoolean()&&(i.readUByte(),i.readUByte(),i.readUByte())),i.readBoolean()&&(i.readUEG(),i.readUEG()),i.readBoolean(),i.readBoolean(),i.readBoolean(),Mt=i.readBoolean(),Mt&&(i.skipUEG(),i.skipUEG(),i.skipUEG(),i.skipUEG()),i.readBoolean()&&(wt=i.readBits(32),It=i.readBits(32),i.readBoolean()&&i.readUEG(),i.readBoolean())){const Ht=i.readBoolean(),Vt=i.readBoolean();let jt=!1;(Ht||Vt)&&(jt=i.readBoolean(),jt&&(i.readUByte(),i.readBits(5),i.readBoolean(),i.readBits(5)),i.readBits(4),i.readBits(4),jt&&i.readBits(4),i.readBits(5),i.readBits(5),i.readBits(5));for(let er=0;er<=a;er++){Pt=i.readBoolean();const qt=Pt||i.readBoolean();let sr=!1;qt?i.readEG():sr=i.readBoolean();const nr=sr?1:i.readUEG()+1;if(Ht)for(let cr=0;cr<nr;cr++)i.readUEG(),i.readUEG(),jt&&(i.readUEG(),i.readUEG()),i.skipBits(1);if(Vt)for(let cr=0;cr<nr;cr++)i.readUEG(),i.readUEG(),jt&&(i.readUEG(),i.readUEG()),i.skipBits(1)}}i.readBoolean()&&(i.readBoolean(),i.readBoolean(),i.readBoolean(),mt=i.readUEG())}let Gt=lt,Ft=ct;if(ht){let Nt=1,Kt=1;ot===1?Nt=Kt=2:ot==2&&(Nt=2),Gt=lt-Nt*gt-Nt*dt,Ft=ct-Kt*St-Kt*vt}const Ut=o?["A","B","C"][o]:"",Xt=g<<24|b<<16|_<<8|j;let kt=0;for(let Nt=0;Nt<32;Nt++)kt=(kt|(Xt>>Nt&1)<<31-Nt)>>>0;let Lt=kt.toString(16);return d===1&&Lt==="2"&&(Lt="6"),{codecString:`hvc1.${Ut}${d}.${Lt}.${c?"H":"L"}${rt}.B0`,params:{general_tier_flag:c,general_profile_idc:d,general_profile_space:o,general_profile_compatibility_flags:[g,b,_,j],general_constraint_indicator_flags:[$,_e,tt,et,st,at],general_level_idc:rt,bit_depth:Tt+8,bit_depth_luma_minus8:Tt,bit_depth_chroma_minus8:Ct,min_spatial_segmentation_idc:mt,chroma_format_idc:ot,frame_rate:{fixed:Pt,fps:It/wt}},width:Gt,height:Ft,pixelRatio:[Et,At]}}readPPS(e){const i=new ExpGolomb(this.ebsp2rbsp(e));i.readUByte(),i.readUByte(),i.skipUEG(),i.skipUEG(),i.skipBits(2),i.skipBits(3),i.skipBits(2),i.skipUEG(),i.skipUEG(),i.skipEG(),i.skipBits(2),i.readBoolean()&&i.skipUEG(),i.skipEG(),i.skipEG(),i.skipBits(4);const o=i.readBoolean(),c=i.readBoolean();let d=1;return c&&o?d=0:c?d=3:o&&(d=2),{parallelismType:d}}matchSPS(e,i){return String.fromCharCode.apply(null,e).substr(3)===String.fromCharCode.apply(null,i).substr(3)}}const PACKET_LENGTH=188;class TSDemuxer{constructor(e,i,a,o){this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=e,this.config=i,this.typeSupported=a,this.logger=o,this.videoParser=null}static probe(e,i){const a=TSDemuxer.syncOffset(e);return a>0&&i.warn(`MPEG2-TS detected but first sync word found @ offset ${a}`),a!==-1}static syncOffset(e){const i=e.length;let a=Math.min(PACKET_LENGTH*5,i-PACKET_LENGTH)+1,o=0;for(;o<a;){let c=!1,d=-1,g=0;for(let b=o;b<i;b+=PACKET_LENGTH)if(e[b]===71&&(i-b===PACKET_LENGTH||e[b+PACKET_LENGTH]===71)){if(g++,d===-1&&(d=b,d!==0&&(a=Math.min(d+PACKET_LENGTH*99,e.length-PACKET_LENGTH)+1)),c||(c=parsePID(e,b)===0),c&&g>1&&(d===0&&g>2||b+PACKET_LENGTH>a))return d}else{if(g)return-1;break}o++}return-1}static createTrack(e,i){return{container:e==="video"||e==="audio"?"video/mp2t":void 0,type:e,id:RemuxerTrackIdConfig[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:e==="audio"?i:void 0}}resetInitSegment(e,i,a,o){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=TSDemuxer.createTrack("video"),this._videoTrack.duration=o,this._audioTrack=TSDemuxer.createTrack("audio",o),this._id3Track=TSDemuxer.createTrack("id3"),this._txtTrack=TSDemuxer.createTrack("text"),this._audioTrack.segmentCodec="aac",this.videoParser=null,this.aacOverFlow=null,this.remainderData=null,this.audioCodec=i,this.videoCodec=a}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_videoTrack:i,_id3Track:a}=this;e&&(e.pesData=null),i&&(i.pesData=null),a&&(a.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(e,i,a=!1,o=!1){a||(this.sampleAes=null);let c;const d=this._videoTrack,g=this._audioTrack,b=this._id3Track,_=this._txtTrack;let j=d.pid,$=d.pesData,_e=g.pid,tt=b.pid,et=g.pesData,st=b.pesData,at=null,rt=this.pmtParsed,nt=this._pmtId,it=e.length;if(this.remainderData&&(e=appendUint8Array(this.remainderData,e),it=e.length,this.remainderData=null),it<PACKET_LENGTH&&!o)return this.remainderData=e,{audioTrack:g,videoTrack:d,id3Track:b,textTrack:_};const ot=Math.max(0,TSDemuxer.syncOffset(e));it-=(it-ot)%PACKET_LENGTH,it<e.byteLength&&!o&&(this.remainderData=new Uint8Array(e.buffer,it,e.buffer.byteLength-it));let lt=0;for(let ht=ot;ht<it;ht+=PACKET_LENGTH)if(e[ht]===71){const dt=!!(e[ht+1]&64),gt=parsePID(e,ht),vt=(e[ht+3]&48)>>4;let St;if(vt>1){if(St=ht+5+e[ht+4],St===ht+PACKET_LENGTH)continue}else St=ht+4;switch(gt){case j:dt&&($&&(c=parsePES($,this.logger))&&(this.readyVideoParser(d.segmentCodec),this.videoParser!==null&&this.videoParser.parsePES(d,_,c,!1)),$={data:[],size:0}),$&&($.data.push(e.subarray(St,ht+PACKET_LENGTH)),$.size+=ht+PACKET_LENGTH-St);break;case _e:if(dt){if(et&&(c=parsePES(et,this.logger)))switch(g.segmentCodec){case"aac":this.parseAACPES(g,c);break;case"mp3":this.parseMPEGPES(g,c);break;case"ac3":this.parseAC3PES(g,c);break}et={data:[],size:0}}et&&(et.data.push(e.subarray(St,ht+PACKET_LENGTH)),et.size+=ht+PACKET_LENGTH-St);break;case tt:dt&&(st&&(c=parsePES(st,this.logger))&&this.parseID3PES(b,c),st={data:[],size:0}),st&&(st.data.push(e.subarray(St,ht+PACKET_LENGTH)),st.size+=ht+PACKET_LENGTH-St);break;case 0:dt&&(St+=e[St]+1),nt=this._pmtId=parsePAT(e,St);break;case nt:{dt&&(St+=e[St]+1);const Tt=parsePMT(e,St,this.typeSupported,a,this.observer,this.logger);j=Tt.videoPid,j>0&&(d.pid=j,d.segmentCodec=Tt.segmentVideoCodec),_e=Tt.audioPid,_e>0&&(g.pid=_e,g.segmentCodec=Tt.segmentAudioCodec),tt=Tt.id3Pid,tt>0&&(b.pid=tt),at!==null&&!rt&&(this.logger.warn(`MPEG-TS PMT found at ${ht} after unknown PID '${at}'. Backtracking to sync byte @${ot} to parse all TS packets.`),at=null,ht=ot-188),rt=this.pmtParsed=!0;break}case 17:case 8191:break;default:at=gt;break}}else lt++;lt>0&&emitParsingError(this.observer,new Error(`Found ${lt} TS packet/s that do not start with 0x47`),void 0,this.logger),d.pesData=$,g.pesData=et,b.pesData=st;const ct={audioTrack:g,videoTrack:d,id3Track:b,textTrack:_};return o&&this.extractRemainingSamples(ct),ct}flush(){const{remainderData:e}=this;this.remainderData=null;let i;return e?i=this.demux(e,-1,!1,!0):i={videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(i),this.sampleAes?this.decrypt(i,this.sampleAes):i}extractRemainingSamples(e){const{audioTrack:i,videoTrack:a,id3Track:o,textTrack:c}=e,d=a.pesData,g=i.pesData,b=o.pesData;let _;if(d&&(_=parsePES(d,this.logger))?(this.readyVideoParser(a.segmentCodec),this.videoParser!==null&&(this.videoParser.parsePES(a,c,_,!0),a.pesData=null)):a.pesData=d,g&&(_=parsePES(g,this.logger))){switch(i.segmentCodec){case"aac":this.parseAACPES(i,_);break;case"mp3":this.parseMPEGPES(i,_);break;case"ac3":this.parseAC3PES(i,_);break}i.pesData=null}else g!=null&&g.size&&this.logger.log("last AAC PES packet truncated,might overlap between fragments"),i.pesData=g;b&&(_=parsePES(b,this.logger))?(this.parseID3PES(o,_),o.pesData=null):o.pesData=b}demuxSampleAes(e,i,a){const o=this.demux(e,a,!0,!this.config.progressive),c=this.sampleAes=new SampleAesDecrypter(this.observer,this.config,i);return this.decrypt(o,c)}readyVideoParser(e){this.videoParser===null&&(e==="avc"?this.videoParser=new AvcVideoParser:e==="hevc"&&(this.videoParser=new HevcVideoParser))}decrypt(e,i){return new Promise(a=>{const{audioTrack:o,videoTrack:c}=e;o.samples&&o.segmentCodec==="aac"?i.decryptAacSamples(o.samples,0,()=>{c.samples?i.decryptAvcSamples(c.samples,0,0,()=>{a(e)}):a(e)}):c.samples&&i.decryptAvcSamples(c.samples,0,0,()=>{a(e)})})}destroy(){this.observer&&this.observer.removeAllListeners(),this.config=this.logger=this.observer=null,this.aacOverFlow=this.videoParser=this.remainderData=this.sampleAes=null,this._videoTrack=this._audioTrack=this._id3Track=this._txtTrack=void 0}parseAACPES(e,i){let a=0;const o=this.aacOverFlow;let c=i.data;if(o){this.aacOverFlow=null;const $=o.missing,_e=o.sample.unit.byteLength;if($===-1)c=appendUint8Array(o.sample.unit,c);else{const tt=_e-$;o.sample.unit.set(c.subarray(0,$),tt),e.samples.push(o.sample),a=o.missing}}let d,g;for(d=a,g=c.length;d<g-1&&!isHeader$1(c,d);d++);if(d!==a){let $;const _e=d<g-1;if(_e?$=`AAC PES did not start with ADTS header,offset:${d}`:$="No ADTS header found in AAC PES",emitParsingError(this.observer,new Error($),_e,this.logger),!_e)return}initTrackConfig(e,this.observer,c,d,this.audioCodec);let b;if(i.pts!==void 0)b=i.pts;else if(o){const $=getFrameDuration(e.samplerate);b=o.sample.pts+$}else{this.logger.warn("[tsdemuxer]: AAC PES unknown PTS");return}let _=0,j;for(;d<g;)if(j=appendFrame$2(e,c,d,b,_),d+=j.length,j.missing){this.aacOverFlow=j;break}else for(_++;d<g-1&&!isHeader$1(c,d);d++);}parseMPEGPES(e,i){const a=i.data,o=a.length;let c=0,d=0;const g=i.pts;if(g===void 0){this.logger.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;d<o;)if(isHeader(a,d)){const b=appendFrame$1(e,a,d,g,c);if(b)d+=b.length,c++;else break}else d++}parseAC3PES(e,i){{const a=i.data,o=i.pts;if(o===void 0){this.logger.warn("[tsdemuxer]: AC3 PES unknown PTS");return}const c=a.length;let d=0,g=0,b;for(;g<c&&(b=appendFrame(e,a,g,o,d++))>0;)g+=b}}parseID3PES(e,i){if(i.pts===void 0){this.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");return}const a=_extends({},i,{type:this._videoTrack?MetadataSchema.emsg:MetadataSchema.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(a)}}function parsePID(s,e){return((s[e+1]&31)<<8)+s[e+2]}function parsePAT(s,e){return(s[e+10]&31)<<8|s[e+11]}function parsePMT(s,e,i,a,o,c){const d={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},g=(s[e+1]&15)<<8|s[e+2],b=e+3+g-4,_=(s[e+10]&15)<<8|s[e+11];for(e+=12+_;e<b;){const j=parsePID(s,e),$=(s[e+3]&15)<<8|s[e+4];switch(s[e]){case 207:if(!a){logEncryptedSamplesFoundInUnencryptedStream("ADTS AAC",c);break}case 15:d.audioPid===-1&&(d.audioPid=j);break;case 21:d.id3Pid===-1&&(d.id3Pid=j);break;case 219:if(!a){logEncryptedSamplesFoundInUnencryptedStream("H.264",c);break}case 27:d.videoPid===-1&&(d.videoPid=j);break;case 3:case 4:!i.mpeg&&!i.mp3?c.log("MPEG audio found, not supported in this browser"):d.audioPid===-1&&(d.audioPid=j,d.segmentAudioCodec="mp3");break;case 193:if(!a){logEncryptedSamplesFoundInUnencryptedStream("AC-3",c);break}case 129:i.ac3?d.audioPid===-1&&(d.audioPid=j,d.segmentAudioCodec="ac3"):c.log("AC-3 audio found, not supported in this browser");break;case 6:if(d.audioPid===-1&&$>0){let _e=e+5,tt=$;for(;tt>2;){switch(s[_e]){case 106:i.ac3!==!0?c.log("AC-3 audio found, not supported in this browser for now"):(d.audioPid=j,d.segmentAudioCodec="ac3");break}const st=s[_e+1]+2;_e+=st,tt-=st}}break;case 194:case 135:return emitParsingError(o,new Error("Unsupported EC-3 in M2TS found"),void 0,c),d;case 36:d.videoPid===-1&&(d.videoPid=j,d.segmentVideoCodec="hevc",c.log("HEVC in M2TS found"));break}e+=$+5}return d}function emitParsingError(s,e,i,a){a.warn(`parsing error: ${e.message}`),s.emit(Events.ERROR,Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,levelRetry:i,error:e,reason:e.message})}function logEncryptedSamplesFoundInUnencryptedStream(s,e){e.log(`${s} with AES-128-CBC encryption found in unencrypted stream`)}function parsePES(s,e){let i=0,a,o,c,d,g;const b=s.data;if(!s||s.size===0)return null;for(;b[0].length<19&&b.length>1;)b[0]=appendUint8Array(b[0],b[1]),b.splice(1,1);if(a=b[0],(a[0]<<16)+(a[1]<<8)+a[2]===1){if(o=(a[4]<<8)+a[5],o&&o>s.size-6)return null;const j=a[7];j&192&&(d=(a[9]&14)*536870912+(a[10]&255)*4194304+(a[11]&254)*16384+(a[12]&255)*128+(a[13]&254)/2,j&64?(g=(a[14]&14)*536870912+(a[15]&255)*4194304+(a[16]&254)*16384+(a[17]&255)*128+(a[18]&254)/2,d-g>60*9e4&&(e.warn(`${Math.round((d-g)/9e4)}s delta between PTS and DTS, align them`),d=g)):g=d),c=a[8];let $=c+9;if(s.size<=$)return null;s.size-=$;const _e=new Uint8Array(s.size);for(let tt=0,et=b.length;tt<et;tt++){a=b[tt];let st=a.byteLength;if($)if($>st){$-=st;continue}else a=a.subarray($),st-=$,$=0;_e.set(a,i),i+=st}return o&&(o-=c+3),{data:_e,pts:d,dts:g,len:o}}return null}class AAC{static getSilentFrame(e,i){switch(e){case"mp4a.40.2":if(i===1)return new Uint8Array([0,200,0,128,35,128]);if(i===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(i===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(i===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(i===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(i===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(i===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(i===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(i===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const UINT32_MAX=Math.pow(2,32)-1;class MP4{static init(){MP4.types={avc1:[],avcC:[],hvc1:[],hvcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let e;for(e in MP4.types)MP4.types.hasOwnProperty(e)&&(MP4.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const i=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),a=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);MP4.HDLR_TYPES={video:i,audio:a};const o=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),c=new Uint8Array([0,0,0,0,0,0,0,0]);MP4.STTS=MP4.STSC=MP4.STCO=c,MP4.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),MP4.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),MP4.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),MP4.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const d=new Uint8Array([105,115,111,109]),g=new Uint8Array([97,118,99,49]),b=new Uint8Array([0,0,0,1]);MP4.FTYP=MP4.box(MP4.types.ftyp,d,b,d,g),MP4.DINF=MP4.box(MP4.types.dinf,MP4.box(MP4.types.dref,o))}static box(e,...i){let a=8,o=i.length;const c=o;for(;o--;)a+=i[o].byteLength;const d=new Uint8Array(a);for(d[0]=a>>24&255,d[1]=a>>16&255,d[2]=a>>8&255,d[3]=a&255,d.set(e,4),o=0,a=8;o<c;o++)d.set(i[o],a),a+=i[o].byteLength;return d}static hdlr(e){return MP4.box(MP4.types.hdlr,MP4.HDLR_TYPES[e])}static mdat(e){return MP4.box(MP4.types.mdat,e)}static mdhd(e,i){i*=e;const a=Math.floor(i/(UINT32_MAX+1)),o=Math.floor(i%(UINT32_MAX+1));return MP4.box(MP4.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,a>>24,a>>16&255,a>>8&255,a&255,o>>24,o>>16&255,o>>8&255,o&255,85,196,0,0]))}static mdia(e){return MP4.box(MP4.types.mdia,MP4.mdhd(e.timescale||0,e.duration||0),MP4.hdlr(e.type),MP4.minf(e))}static mfhd(e){return MP4.box(MP4.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,e&255]))}static minf(e){return e.type==="audio"?MP4.box(MP4.types.minf,MP4.box(MP4.types.smhd,MP4.SMHD),MP4.DINF,MP4.stbl(e)):MP4.box(MP4.types.minf,MP4.box(MP4.types.vmhd,MP4.VMHD),MP4.DINF,MP4.stbl(e))}static moof(e,i,a){return MP4.box(MP4.types.moof,MP4.mfhd(e),MP4.traf(a,i))}static moov(e){let i=e.length;const a=[];for(;i--;)a[i]=MP4.trak(e[i]);return MP4.box.apply(null,[MP4.types.moov,MP4.mvhd(e[0].timescale||0,e[0].duration||0)].concat(a).concat(MP4.mvex(e)))}static mvex(e){let i=e.length;const a=[];for(;i--;)a[i]=MP4.trex(e[i]);return MP4.box.apply(null,[MP4.types.mvex,...a])}static mvhd(e,i){i*=e;const a=Math.floor(i/(UINT32_MAX+1)),o=Math.floor(i%(UINT32_MAX+1)),c=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,a>>24,a>>16&255,a>>8&255,a&255,o>>24,o>>16&255,o>>8&255,o&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return MP4.box(MP4.types.mvhd,c)}static sdtp(e){const i=e.samples||[],a=new Uint8Array(4+i.length);let o,c;for(o=0;o<i.length;o++)c=i[o].flags,a[o+4]=c.dependsOn<<4|c.isDependedOn<<2|c.hasRedundancy;return MP4.box(MP4.types.sdtp,a)}static stbl(e){return MP4.box(MP4.types.stbl,MP4.stsd(e),MP4.box(MP4.types.stts,MP4.STTS),MP4.box(MP4.types.stsc,MP4.STSC),MP4.box(MP4.types.stsz,MP4.STSZ),MP4.box(MP4.types.stco,MP4.STCO))}static avc1(e){let i=[],a=[],o,c,d;for(o=0;o<e.sps.length;o++)c=e.sps[o],d=c.byteLength,i.push(d>>>8&255),i.push(d&255),i=i.concat(Array.prototype.slice.call(c));for(o=0;o<e.pps.length;o++)c=e.pps[o],d=c.byteLength,a.push(d>>>8&255),a.push(d&255),a=a.concat(Array.prototype.slice.call(c));const g=MP4.box(MP4.types.avcC,new Uint8Array([1,i[3],i[4],i[5],255,224|e.sps.length].concat(i).concat([e.pps.length]).concat(a))),b=e.width,_=e.height,j=e.pixelRatio[0],$=e.pixelRatio[1];return MP4.box(MP4.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,b>>8&255,b&255,_>>8&255,_&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),g,MP4.box(MP4.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),MP4.box(MP4.types.pasp,new Uint8Array([j>>24,j>>16&255,j>>8&255,j&255,$>>24,$>>16&255,$>>8&255,$&255])))}static esds(e){const i=e.config;return new Uint8Array([0,0,0,0,3,25,0,1,0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2,...i,6,1,2])}static audioStsd(e){const i=e.samplerate||0;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount||0,0,16,0,0,0,0,i>>8&255,i&255,0,0])}static mp4a(e){return MP4.box(MP4.types.mp4a,MP4.audioStsd(e),MP4.box(MP4.types.esds,MP4.esds(e)))}static mp3(e){return MP4.box(MP4.types[".mp3"],MP4.audioStsd(e))}static ac3(e){return MP4.box(MP4.types["ac-3"],MP4.audioStsd(e),MP4.box(MP4.types.dac3,e.config))}static stsd(e){const{segmentCodec:i}=e;if(e.type==="audio"){if(i==="aac")return MP4.box(MP4.types.stsd,MP4.STSD,MP4.mp4a(e));if(i==="ac3"&&e.config)return MP4.box(MP4.types.stsd,MP4.STSD,MP4.ac3(e));if(i==="mp3"&&e.codec==="mp3")return MP4.box(MP4.types.stsd,MP4.STSD,MP4.mp3(e))}else if(e.pps&&e.sps){if(i==="avc")return MP4.box(MP4.types.stsd,MP4.STSD,MP4.avc1(e));if(i==="hevc"&&e.vps)return MP4.box(MP4.types.stsd,MP4.STSD,MP4.hvc1(e))}else throw new Error("video track missing pps or sps");throw new Error(`unsupported ${e.type} segment codec (${i}/${e.codec})`)}static tkhd(e){const i=e.id,a=(e.duration||0)*(e.timescale||0),o=e.width||0,c=e.height||0,d=Math.floor(a/(UINT32_MAX+1)),g=Math.floor(a%(UINT32_MAX+1));return MP4.box(MP4.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,i>>24&255,i>>16&255,i>>8&255,i&255,0,0,0,0,d>>24,d>>16&255,d>>8&255,d&255,g>>24,g>>16&255,g>>8&255,g&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,o>>8&255,o&255,0,0,c>>8&255,c&255,0,0]))}static traf(e,i){const a=MP4.sdtp(e),o=e.id,c=Math.floor(i/(UINT32_MAX+1)),d=Math.floor(i%(UINT32_MAX+1));return MP4.box(MP4.types.traf,MP4.box(MP4.types.tfhd,new Uint8Array([0,0,0,0,o>>24,o>>16&255,o>>8&255,o&255])),MP4.box(MP4.types.tfdt,new Uint8Array([1,0,0,0,c>>24,c>>16&255,c>>8&255,c&255,d>>24,d>>16&255,d>>8&255,d&255])),MP4.trun(e,a.length+16+20+8+16+8+8),a)}static trak(e){return e.duration=e.duration||4294967295,MP4.box(MP4.types.trak,MP4.tkhd(e),MP4.mdia(e))}static trex(e){const i=e.id;return MP4.box(MP4.types.trex,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,i&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,i){const a=e.samples||[],o=a.length,c=12+16*o,d=new Uint8Array(c);let g,b,_,j,$,_e;for(i+=8+c,d.set([e.type==="video"?1:0,0,15,1,o>>>24&255,o>>>16&255,o>>>8&255,o&255,i>>>24&255,i>>>16&255,i>>>8&255,i&255],0),g=0;g<o;g++)b=a[g],_=b.duration,j=b.size,$=b.flags,_e=b.cts,d.set([_>>>24&255,_>>>16&255,_>>>8&255,_&255,j>>>24&255,j>>>16&255,j>>>8&255,j&255,$.isLeading<<2|$.dependsOn,$.isDependedOn<<6|$.hasRedundancy<<4|$.paddingValue<<1|$.isNonSync,$.degradPrio&61440,$.degradPrio&15,_e>>>24&255,_e>>>16&255,_e>>>8&255,_e&255],12+16*g);return MP4.box(MP4.types.trun,d)}static initSegment(e){MP4.types||MP4.init();const i=MP4.moov(e);return appendUint8Array(MP4.FTYP,i)}static hvc1(e){const i=e.params,a=[e.vps,e.sps,e.pps],o=4,c=new Uint8Array([1,i.general_profile_space<<6|(i.general_tier_flag?32:0)|i.general_profile_idc,i.general_profile_compatibility_flags[0],i.general_profile_compatibility_flags[1],i.general_profile_compatibility_flags[2],i.general_profile_compatibility_flags[3],i.general_constraint_indicator_flags[0],i.general_constraint_indicator_flags[1],i.general_constraint_indicator_flags[2],i.general_constraint_indicator_flags[3],i.general_constraint_indicator_flags[4],i.general_constraint_indicator_flags[5],i.general_level_idc,240|i.min_spatial_segmentation_idc>>8,255&i.min_spatial_segmentation_idc,252|i.parallelismType,252|i.chroma_format_idc,248|i.bit_depth_luma_minus8,248|i.bit_depth_chroma_minus8,0,parseInt(i.frame_rate.fps),o-1|i.temporal_id_nested<<2|i.num_temporal_layers<<3|(i.frame_rate.fixed?64:0),a.length]);let d=c.length;for(let et=0;et<a.length;et+=1){d+=3;for(let st=0;st<a[et].length;st+=1)d+=2+a[et][st].length}const g=new Uint8Array(d);g.set(c,0),d=c.length;const b=a.length-1;for(let et=0;et<a.length;et+=1){g.set(new Uint8Array([32+et|(et===b?128:0),0,a[et].length]),d),d+=3;for(let st=0;st<a[et].length;st+=1)g.set(new Uint8Array([a[et][st].length>>8,a[et][st].length&255]),d),d+=2,g.set(a[et][st],d),d+=a[et][st].length}const _=MP4.box(MP4.types.hvcC,g),j=e.width,$=e.height,_e=e.pixelRatio[0],tt=e.pixelRatio[1];return MP4.box(MP4.types.hvc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,j>>8&255,j&255,$>>8&255,$&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),_,MP4.box(MP4.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),MP4.box(MP4.types.pasp,new Uint8Array([_e>>24,_e>>16&255,_e>>8&255,_e&255,tt>>24,tt>>16&255,tt>>8&255,tt&255])))}}MP4.types=void 0;MP4.HDLR_TYPES=void 0;MP4.STTS=void 0;MP4.STSC=void 0;MP4.STCO=void 0;MP4.STSZ=void 0;MP4.VMHD=void 0;MP4.SMHD=void 0;MP4.STSD=void 0;MP4.FTYP=void 0;MP4.DINF=void 0;const MPEG_TS_CLOCK_FREQ_HZ=9e4;function toTimescaleFromBase(s,e,i=1,a=!1){const o=s*e*i;return a?Math.round(o):o}function toTimescaleFromScale(s,e,i=1,a=!1){return toTimescaleFromBase(s,e,1/i,a)}function toMsFromMpegTsClock(s,e=!1){return toTimescaleFromBase(s,1e3,1/MPEG_TS_CLOCK_FREQ_HZ,e)}function toMpegTsClockFromTimescale(s,e=1){return toTimescaleFromBase(s,MPEG_TS_CLOCK_FREQ_HZ,1/e)}function timestampToString(s){const{baseTime:e,timescale:i,trackId:a}=s;return`${e/i} (${e}/${i}) trackId: ${a}`}const MAX_SILENT_FRAME_DURATION=10*1e3,AAC_SAMPLES_PER_FRAME=1024,MPEG_AUDIO_SAMPLE_PER_FRAME=1152,AC3_SAMPLES_PER_FRAME=1536;let chromeVersion=null,safariWebkitVersion=null;function createMp4Sample(s,e,i,a){return{duration:e,size:i,cts:a,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:s?2:1,isNonSync:s?0:1}}}class MP4Remuxer extends Logger{constructor(e,i,a,o){if(super("mp4-remuxer",o),this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextVideoTs=null,this.nextAudioTs=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=e,this.config=i,this.typeSupported=a,this.ISGenerated=!1,chromeVersion===null){const d=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);chromeVersion=d?parseInt(d[1]):0}if(safariWebkitVersion===null){const c=navigator.userAgent.match(/Safari\/(\d+)/i);safariWebkitVersion=c?parseInt(c[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(e){const i=this._initPTS;(!i||!e||e.trackId!==i.trackId||e.baseTime!==i.baseTime||e.timescale!==i.timescale)&&this.log(`Reset initPTS: ${i&&timestampToString(i)} > ${e&&timestampToString(e)}`),this._initPTS=this._initDTS=e}resetNextTimestamp(){this.log("reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){this.log("ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(e){let i=!1;const a=e[0].pts,o=e.reduce((c,d)=>{let g=d.pts,b=g-c;return b<-4294967296&&(i=!0,g=normalizePts(g,a),b=g-c),b>0?c:g},a);return i&&this.debug("PTS rollover detected"),o}remux(e,i,a,o,c,d,g,b){let _,j,$,_e,tt,et,st=c,at=c;const rt=e.pid>-1,nt=i.pid>-1,it=i.samples.length,ot=e.samples.length>0,lt=g&&it>0||it>1;if((!rt||ot)&&(!nt||lt)||this.ISGenerated||g){if(this.ISGenerated){var ht,dt,gt,vt;const Rt=this.videoTrackConfig;(Rt&&(i.width!==Rt.width||i.height!==Rt.height||((ht=i.pixelRatio)==null?void 0:ht[0])!==((dt=Rt.pixelRatio)==null?void 0:dt[0])||((gt=i.pixelRatio)==null?void 0:gt[1])!==((vt=Rt.pixelRatio)==null?void 0:vt[1]))||!Rt&&lt||this.nextAudioTs===null&&ot)&&this.resetInitSegment()}this.ISGenerated||($=this.generateIS(e,i,c,d));const St=this.isVideoContiguous;let Tt=-1,Ct;if(lt&&(Tt=findKeyframeIndex(i.samples),!St&&this.config.forceKeyFrameOnDiscontinuity))if(et=!0,Tt>0){this.warn(`Dropped ${Tt} out of ${it} video samples due to a missing keyframe`);const Rt=this.getVideoStartPts(i.samples);i.samples=i.samples.slice(Tt),i.dropped+=Tt,at+=(i.samples[0].pts-Rt)/i.inputTimeScale,Ct=at}else Tt===-1&&(this.warn(`No keyframe found out of ${it} video samples`),et=!1);if(this.ISGenerated){if(ot&&lt){const Rt=this.getVideoStartPts(i.samples),pt=(normalizePts(e.samples[0].pts,Rt)-Rt)/i.inputTimeScale;st+=Math.max(0,pt),at+=Math.max(0,-pt)}if(ot){if(e.samplerate||(this.warn("regenerate InitSegment as audio detected"),$=this.generateIS(e,i,c,d)),j=this.remuxAudio(e,st,this.isAudioContiguous,d,nt||lt||b===PlaylistLevelType.AUDIO?at:void 0),lt){const Rt=j?j.endPTS-j.startPTS:0;i.inputTimeScale||(this.warn("regenerate InitSegment as video detected"),$=this.generateIS(e,i,c,d)),_=this.remuxVideo(i,at,St,Rt)}}else lt&&(_=this.remuxVideo(i,at,St,0));_&&(_.firstKeyFrame=Tt,_.independent=Tt!==-1,_.firstKeyFramePTS=Ct)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(a.samples.length&&(tt=flushTextTrackMetadataCueSamples(a,c,this._initPTS,this._initDTS)),o.samples.length&&(_e=flushTextTrackUserdataCueSamples(o,c,this._initPTS))),{audio:j,video:_,initSegment:$,independent:et,text:_e,id3:tt}}computeInitPts(e,i,a,o){const c=Math.round(a*i);let d=normalizePts(e,c);if(d<c+i)for(this.log(`Adjusting PTS for rollover in timeline near ${(c-d)/i} ${o}`);d<c+i;)d+=8589934592;return d-c}generateIS(e,i,a,o){const c=e.samples,d=i.samples,g=this.typeSupported,b={},_=this._initPTS;let j=!_||o,$="audio/mp4",_e,tt,et,st=-1;if(j&&(_e=tt=1/0),e.config&&c.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":g.mpeg?($="audio/mpeg",e.codec=""):g.mp3&&(e.codec="mp3");break;case"ac3":e.codec="ac-3";break}b.audio={id:"audio",container:$,codec:e.codec,initSegment:e.segmentCodec==="mp3"&&g.mpeg?new Uint8Array(0):MP4.initSegment([e]),metadata:{channelCount:e.channelCount}},j&&(st=e.id,et=e.inputTimeScale,!_||et!==_.timescale?_e=tt=this.computeInitPts(c[0].pts,et,a,"audio"):j=!1)}if(i.sps&&i.pps&&d.length){if(i.timescale=i.inputTimeScale,b.video={id:"main",container:"video/mp4",codec:i.codec,initSegment:MP4.initSegment([i]),metadata:{width:i.width,height:i.height}},j)if(st=i.id,et=i.inputTimeScale,!_||et!==_.timescale){const at=this.getVideoStartPts(d),rt=normalizePts(d[0].dts,at),nt=this.computeInitPts(rt,et,a,"video"),it=this.computeInitPts(at,et,a,"video");tt=Math.min(tt,nt),_e=Math.min(_e,it)}else j=!1;this.videoTrackConfig={width:i.width,height:i.height,pixelRatio:i.pixelRatio}}if(Object.keys(b).length)return this.ISGenerated=!0,j?(_&&this.warn(`Timestamps at playlist time: ${o?"":"~"}${a} ${_e/et} != initPTS: ${_.baseTime/_.timescale} (${_.baseTime}/${_.timescale}) trackId: ${_.trackId}`),this.log(`Found initPTS at playlist time: ${a} offset: ${_e/et} (${_e}/${et}) trackId: ${st}`),this._initPTS={baseTime:_e,timescale:et,trackId:st},this._initDTS={baseTime:tt,timescale:et,trackId:st}):_e=et=void 0,{tracks:b,initPTS:_e,timescale:et,trackId:st}}remuxVideo(e,i,a,o){const c=e.inputTimeScale,d=e.samples,g=[],b=d.length,_=this._initPTS,j=_.baseTime*c/_.timescale;let $=this.nextVideoTs,_e=8,tt=this.videoSampleDuration,et,st,at=Number.POSITIVE_INFINITY,rt=Number.NEGATIVE_INFINITY,nt=!1;if(!a||$===null){const mt=j+i*c,Et=d[0].pts-normalizePts(d[0].dts,d[0].pts);chromeVersion&&$!==null&&Math.abs(mt-Et-($+j))<15e3?a=!0:$=mt-Et-j}const it=$+j;for(let mt=0;mt<b;mt++){const Et=d[mt];Et.pts=normalizePts(Et.pts,it),Et.dts=normalizePts(Et.dts,it),Et.dts<d[mt>0?mt-1:mt].dts&&(nt=!0)}nt&&d.sort(function(mt,Et){const At=mt.dts-Et.dts,Pt=mt.pts-Et.pts;return At||Pt}),et=d[0].dts,st=d[d.length-1].dts;const ot=st-et,lt=ot?Math.round(ot/(b-1)):tt||e.inputTimeScale/30;if(a){const mt=et-it,Et=mt>lt,At=mt<-1;if((Et||At)&&(Et?this.warn(`${(e.segmentCodec||"").toUpperCase()}: ${toMsFromMpegTsClock(mt,!0)} ms (${mt}dts) hole between fragments detected at ${i.toFixed(3)}`):this.warn(`${(e.segmentCodec||"").toUpperCase()}: ${toMsFromMpegTsClock(-mt,!0)} ms (${mt}dts) overlapping between fragments detected at ${i.toFixed(3)}`),!At||it>=d[0].pts||chromeVersion)){et=it;const Pt=d[0].pts-mt;if(Et)d[0].dts=et,d[0].pts=Pt;else{let wt=!0;for(let It=0;It<d.length&&!(d[It].dts>Pt&&wt);It++){const Mt=d[It].pts;if(d[It].dts-=mt,d[It].pts-=mt,It<d.length-1){const Bt=d[It+1].pts,Gt=d[It].pts,Ft=Bt<=Gt,Ut=Bt<=Mt;wt=Ft==Ut}}}this.log(`Video: Initial PTS/DTS adjusted: ${toMsFromMpegTsClock(Pt,!0)}/${toMsFromMpegTsClock(et,!0)}, delta: ${toMsFromMpegTsClock(mt,!0)} ms`)}}et=Math.max(0,et);let ct=0,ht=0,dt=et;for(let mt=0;mt<b;mt++){const Et=d[mt],At=Et.units,Pt=At.length;let wt=0;for(let It=0;It<Pt;It++)wt+=At[It].data.length;ht+=wt,ct+=Pt,Et.length=wt,Et.dts<dt?(Et.dts=dt,dt+=lt/4|0||1):dt=Et.dts,at=Math.min(Et.pts,at),rt=Math.max(Et.pts,rt)}st=d[b-1].dts;const gt=ht+4*ct+8;let vt;try{vt=new Uint8Array(gt)}catch(mt){this.observer.emit(Events.ERROR,Events.ERROR,{type:ErrorTypes.MUX_ERROR,details:ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,error:mt,bytes:gt,reason:`fail allocating video mdat ${gt}`});return}const St=new DataView(vt.buffer);St.setUint32(0,gt),vt.set(MP4.types.mdat,4);let Tt=!1,Ct=Number.POSITIVE_INFINITY,Rt=Number.POSITIVE_INFINITY,bt=Number.NEGATIVE_INFINITY,pt=Number.NEGATIVE_INFINITY;for(let mt=0;mt<b;mt++){const Et=d[mt],At=Et.units;let Pt=0;for(let Mt=0,Bt=At.length;Mt<Bt;Mt++){const Gt=At[Mt],Ft=Gt.data,Ut=Gt.data.byteLength;St.setUint32(_e,Ut),_e+=4,vt.set(Ft,_e),_e+=Ut,Pt+=4+Ut}let wt;if(mt<b-1)tt=d[mt+1].dts-Et.dts,wt=d[mt+1].pts-Et.pts;else{const Mt=this.config,Bt=mt>0?Et.dts-d[mt-1].dts:lt;if(wt=mt>0?Et.pts-d[mt-1].pts:lt,Mt.stretchShortVideoTrack&&this.nextAudioTs!==null){const Gt=Math.floor(Mt.maxBufferHole*c),Ft=(o?at+o*c:this.nextAudioTs+j)-Et.pts;Ft>Gt?(tt=Ft-Bt,tt<0?tt=Bt:Tt=!0,this.log(`It is approximately ${Ft/90} ms to the next segment; using duration ${tt/90} ms for the last video frame.`)):tt=Bt}else tt=Bt}const It=Math.round(Et.pts-Et.dts);Ct=Math.min(Ct,tt),bt=Math.max(bt,tt),Rt=Math.min(Rt,wt),pt=Math.max(pt,wt),g.push(createMp4Sample(Et.key,tt,Pt,It))}if(g.length){if(chromeVersion){if(chromeVersion<70){const mt=g[0].flags;mt.dependsOn=2,mt.isNonSync=0}}else if(safariWebkitVersion&&pt-Rt<bt-Ct&&lt/bt<.025&&g[0].cts===0){this.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let mt=et;for(let Et=0,At=g.length;Et<At;Et++){const Pt=mt+g[Et].duration,wt=mt+g[Et].cts;if(Et<At-1){const It=Pt+g[Et+1].cts;g[Et].duration=It-wt}else g[Et].duration=Et?g[Et-1].duration:lt;g[Et].cts=0,mt=Pt}}}tt=Tt||!tt?lt:tt;const yt=st+tt;this.nextVideoTs=$=yt-j,this.videoSampleDuration=tt,this.isVideoContiguous=!0;const xt={data1:MP4.moof(e.sequenceNumber++,et,_extends(e,{samples:g})),data2:vt,startPTS:(at-j)/c,endPTS:(rt+tt-j)/c,startDTS:(et-j)/c,endDTS:$/c,type:"video",hasAudio:!1,hasVideo:!0,nb:g.length,dropped:e.dropped};return e.samples=[],e.dropped=0,xt}getSamplesPerFrame(e){switch(e.segmentCodec){case"mp3":return MPEG_AUDIO_SAMPLE_PER_FRAME;case"ac3":return AC3_SAMPLES_PER_FRAME;default:return AAC_SAMPLES_PER_FRAME}}remuxAudio(e,i,a,o,c){const d=e.inputTimeScale,g=e.samplerate?e.samplerate:d,b=d/g,_=this.getSamplesPerFrame(e),j=_*b,$=this._initPTS,_e=e.segmentCodec==="mp3"&&this.typeSupported.mpeg,tt=[],et=c!==void 0;let st=e.samples,at=_e?0:8,rt=this.nextAudioTs||-1;const nt=$.baseTime*d/$.timescale,it=nt+i*d;if(this.isAudioContiguous=a=a||st.length&&rt>0&&(o&&Math.abs(it-(rt+nt))<9e3||Math.abs(normalizePts(st[0].pts,it)-(rt+nt))<20*j),st.forEach(function(pt){pt.pts=normalizePts(pt.pts,it)}),!a||rt<0){const pt=st.length;if(st=st.filter(yt=>yt.pts>=0),pt!==st.length&&this.warn(`Removed ${st.length-pt} of ${pt} samples (initPTS ${nt} / ${d})`),!st.length)return;c===0?rt=0:o&&!et?rt=Math.max(0,it-nt):rt=st[0].pts-nt}if(e.segmentCodec==="aac"){const pt=this.config.maxAudioFramesDrift;for(let yt=0,ut=rt+nt;yt<st.length;yt++){const ft=st[yt],xt=ft.pts,mt=xt-ut,Et=Math.abs(1e3*mt/d);if(mt<=-pt*j&&et)yt===0&&(this.warn(`Audio frame @ ${(xt/d).toFixed(3)}s overlaps marker by ${Math.round(1e3*mt/d)} ms.`),this.nextAudioTs=rt=xt-nt,ut=xt);else if(mt>=pt*j&&Et<MAX_SILENT_FRAME_DURATION&&et){let At=Math.round(mt/j);for(ut=xt-At*j;ut<0&&At&&j;)At--,ut+=j;yt===0&&(this.nextAudioTs=rt=ut-nt),this.warn(`Injecting ${At} audio frames @ ${((ut-nt)/d).toFixed(3)}s due to ${Math.round(1e3*mt/d)} ms gap.`);for(let Pt=0;Pt<At;Pt++){let wt=AAC.getSilentFrame(e.parsedCodec||e.manifestCodec||e.codec,e.channelCount);wt||(this.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),wt=ft.unit.subarray()),st.splice(yt,0,{unit:wt,pts:ut}),ut+=j,yt++}}ft.pts=ut,ut+=j}}let ot=null,lt=null,ct,ht=0,dt=st.length;for(;dt--;)ht+=st[dt].unit.byteLength;for(let pt=0,yt=st.length;pt<yt;pt++){const ut=st[pt],ft=ut.unit;let xt=ut.pts;if(lt!==null){const Et=tt[pt-1];Et.duration=Math.round((xt-lt)/b)}else if(a&&e.segmentCodec==="aac"&&(xt=rt+nt),ot=xt,ht>0){ht+=at;try{ct=new Uint8Array(ht)}catch(Et){this.observer.emit(Events.ERROR,Events.ERROR,{type:ErrorTypes.MUX_ERROR,details:ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,error:Et,bytes:ht,reason:`fail allocating audio mdat ${ht}`});return}_e||(new DataView(ct.buffer).setUint32(0,ht),ct.set(MP4.types.mdat,4))}else return;ct.set(ft,at);const mt=ft.byteLength;at+=mt,tt.push(createMp4Sample(!0,_,mt,0)),lt=xt}const gt=tt.length;if(!gt)return;const vt=tt[tt.length-1];rt=lt-nt,this.nextAudioTs=rt+b*vt.duration;const St=_e?new Uint8Array(0):MP4.moof(e.sequenceNumber++,ot/b,_extends({},e,{samples:tt}));e.samples=[];const Tt=(ot-nt)/d,Ct=rt/d,bt={data1:St,data2:ct,startPTS:Tt,endPTS:Ct,startDTS:Tt,endDTS:Ct,type:"audio",hasAudio:!0,hasVideo:!1,nb:gt};return this.isAudioContiguous=!0,bt}}function normalizePts(s,e){let i;if(e===null)return s;for(e<s?i=-8589934592:i=8589934592;Math.abs(s-e)>4294967296;)s+=i;return s}function findKeyframeIndex(s){for(let e=0;e<s.length;e++)if(s[e].key)return e;return-1}function flushTextTrackMetadataCueSamples(s,e,i,a){const o=s.samples.length;if(!o)return;const c=s.inputTimeScale;for(let g=0;g<o;g++){const b=s.samples[g];b.pts=normalizePts(b.pts-i.baseTime*c/i.timescale,e*c)/c,b.dts=normalizePts(b.dts-a.baseTime*c/a.timescale,e*c)/c}const d=s.samples;return s.samples=[],{samples:d}}function flushTextTrackUserdataCueSamples(s,e,i){const a=s.samples.length;if(!a)return;const o=s.inputTimeScale;for(let d=0;d<a;d++){const g=s.samples[d];g.pts=normalizePts(g.pts-i.baseTime*o/i.timescale,e*o)/o}s.samples.sort((d,g)=>d.pts-g.pts);const c=s.samples;return s.samples=[],{samples:c}}class PassThroughRemuxer extends Logger{constructor(e,i,a,o){super("passthrough-remuxer",o),this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null,this.isVideoContiguous=!1}destroy(){}resetTimeStamp(e){this.lastEndTime=null;const i=this.initPTS;i&&e&&i.baseTime===e.baseTime&&i.timescale===e.timescale||(this.initPTS=e)}resetNextTimestamp(){this.isVideoContiguous=!1,this.lastEndTime=null}resetInitSegment(e,i,a,o){this.audioCodec=i,this.videoCodec=a,this.generateInitSegment(e,o),this.emitInitSegment=!0}generateInitSegment(e,i){let{audioCodec:a,videoCodec:o}=this;if(!(e!=null&&e.byteLength)){this.initTracks=void 0,this.initData=void 0;return}const{audio:c,video:d}=this.initData=parseInitSegment(e);if(i)patchEncyptionData(e,i);else{const b=c||d;b!=null&&b.encrypted&&this.warn(`Init segment with encrypted track with has no key ("${b.codec}")!`)}c&&(a=getParsedTrackCodec(c,ElementaryStreamTypes.AUDIO,this)),d&&(o=getParsedTrackCodec(d,ElementaryStreamTypes.VIDEO,this));const g={};c&&d?g.audiovideo={container:"video/mp4",codec:a+","+o,supplemental:d.supplemental,encrypted:d.encrypted,initSegment:e,id:"main"}:c?g.audio={container:"audio/mp4",codec:a,encrypted:c.encrypted,initSegment:e,id:"audio"}:d?g.video={container:"video/mp4",codec:o,supplemental:d.supplemental,encrypted:d.encrypted,initSegment:e,id:"main"}:this.warn("initSegment does not contain moov or trak boxes."),this.initTracks=g}remux(e,i,a,o,c,d){var g,b;let{initPTS:_,lastEndTime:j}=this;const $={audio:void 0,video:void 0,text:o,id3:a,initSegment:void 0};isFiniteNumber(j)||(j=this.lastEndTime=c||0);const _e=i.samples;if(!_e.length)return $;const tt={initPTS:void 0,timescale:void 0,trackId:void 0};let et=this.initData;if((g=et)!=null&&g.length||(this.generateInitSegment(_e),et=this.initData),!((b=et)!=null&&b.length))return this.warn("Failed to generate initSegment."),$;this.emitInitSegment&&(tt.tracks=this.initTracks,this.emitInitSegment=!1);const st=getSampleData(_e,et,this),at=et.audio?st[et.audio.id]:null,rt=et.video?st[et.video.id]:null,nt=toStartEndOrDefault(rt,1/0),it=toStartEndOrDefault(at,1/0),ot=toStartEndOrDefault(rt,0,!0),lt=toStartEndOrDefault(at,0,!0);let ct=c,ht=0;const dt=at&&(!rt||!_&&it<nt||_&&_.trackId===et.audio.id),gt=dt?at:rt;if(gt){const ut=gt.timescale,ft=gt.start-c*ut,xt=dt?et.audio.id:et.video.id;ct=gt.start/ut,ht=dt?lt-it:ot-nt,(d||!_)&&(isInvalidInitPts(_,ct,c,ht)||ut!==_.timescale)&&(_&&this.warn(`Timestamps at playlist time: ${d?"":"~"}${c} ${ft/ut} != initPTS: ${_.baseTime/_.timescale} (${_.baseTime}/${_.timescale}) trackId: ${_.trackId}`),this.log(`Found initPTS at playlist time: ${c} offset: ${ct-c} (${ft}/${ut}) trackId: ${xt}`),_=null,tt.initPTS=ft,tt.timescale=ut,tt.trackId=xt)}else this.warn(`No audio or video samples found for initPTS at playlist time: ${c}`);_?(tt.initPTS=_.baseTime,tt.timescale=_.timescale,tt.trackId=_.trackId):((!tt.timescale||tt.trackId===void 0||tt.initPTS===void 0)&&(this.warn("Could not set initPTS"),tt.initPTS=ct,tt.timescale=1,tt.trackId=-1),this.initPTS=_={baseTime:tt.initPTS,timescale:tt.timescale,trackId:tt.trackId});const vt=ct-_.baseTime/_.timescale,St=vt+ht;ht>0?this.lastEndTime=St:(this.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const Tt=!!et.audio,Ct=!!et.video;let Rt="";Tt&&(Rt+="audio"),Ct&&(Rt+="video");const bt=(et.audio?et.audio.encrypted:!1)||(et.video?et.video.encrypted:!1),pt={data1:_e,startPTS:vt,startDTS:vt,endPTS:St,endDTS:St,type:Rt,hasAudio:Tt,hasVideo:Ct,nb:1,dropped:0,encrypted:bt};$.audio=Tt&&!Ct?pt:void 0,$.video=Ct?pt:void 0;const yt=rt==null?void 0:rt.sampleCount;if(yt){const ut=rt.keyFrameIndex,ft=ut!==-1;pt.nb=yt,pt.dropped=ut===0||this.isVideoContiguous?0:ft?ut:yt,pt.independent=ft,pt.firstKeyFrame=ut,ft&&rt.keyFrameStart&&(pt.firstKeyFramePTS=(rt.keyFrameStart-_.baseTime)/_.timescale),this.isVideoContiguous||($.independent=ft),this.isVideoContiguous||(this.isVideoContiguous=ft),pt.dropped&&this.warn(`fmp4 does not start with IDR: firstIDR ${ut}/${yt} dropped: ${pt.dropped} start: ${pt.firstKeyFramePTS||"NA"}`)}return $.initSegment=tt,$.id3=flushTextTrackMetadataCueSamples(a,c,_,_),o.samples.length&&($.text=flushTextTrackUserdataCueSamples(o,c,_)),$}}function toStartEndOrDefault(s,e,i=!1){return(s==null?void 0:s.start)!==void 0?(s.start+(i?s.duration:0))/s.timescale:e}function isInvalidInitPts(s,e,i,a){if(s===null)return!0;const o=Math.max(a,1),c=e-s.baseTime/s.timescale;return Math.abs(c-i)>o}function getParsedTrackCodec(s,e,i){const a=s.codec;return a&&a.length>4?a:e===ElementaryStreamTypes.AUDIO?a==="ec-3"||a==="ac-3"||a==="alac"?a:a==="fLaC"||a==="Opus"?getCodecCompatibleName(a,!1):(i.warn(`Unhandled audio codec "${a}" in mp4 MAP`),a||"mp4a"):(i.warn(`Unhandled video codec "${a}" in mp4 MAP`),a||"avc1")}let now;try{now=self.performance.now.bind(self.performance)}catch(s){now=Date.now}const muxConfig=[{demux:MP4Demuxer,remux:PassThroughRemuxer},{demux:TSDemuxer,remux:MP4Remuxer},{demux:AACDemuxer,remux:MP4Remuxer},{demux:MP3Demuxer,remux:MP4Remuxer}];muxConfig.splice(2,0,{demux:AC3Demuxer,remux:MP4Remuxer});class Transmuxer{constructor(e,i,a,o,c,d){this.asyncResult=!1,this.logger=void 0,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=i,this.config=a,this.id=c,this.logger=d}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,i,a,o){const c=a.transmuxing;c.executeStart=now();let d=new Uint8Array(e);const{currentTransmuxState:g,transmuxConfig:b}=this;o&&(this.currentTransmuxState=o);const{contiguous:_,discontinuity:j,trackSwitch:$,accurateTimeOffset:_e,timeOffset:tt,initSegmentChange:et}=o||g,{audioCodec:st,videoCodec:at,defaultInitPts:rt,duration:nt,initSegmentData:it}=b,ot=getEncryptionType(d,i);if(ot&&isFullSegmentEncryption(ot.method)){const dt=this.getDecrypter(),gt=getAesModeFromFullSegmentMethod(ot.method);if(dt.isSync()){let vt=dt.softwareDecrypt(d,ot.key.buffer,ot.iv.buffer,gt);if(a.part>-1){const Tt=dt.flush();vt=Tt&&Tt.buffer}if(!vt)return c.executeEnd=now(),emptyResult(a);d=new Uint8Array(vt)}else return this.asyncResult=!0,this.decryptionPromise=dt.webCryptoDecrypt(d,ot.key.buffer,ot.iv.buffer,gt).then(vt=>{const St=this.push(vt,null,a);return this.decryptionPromise=null,St}),this.decryptionPromise}const lt=this.needsProbing(j,$);if(lt){const dt=this.configureTransmuxer(d);if(dt)return this.logger.warn(`[transmuxer] ${dt.message}`),this.observer.emit(Events.ERROR,Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,error:dt,reason:dt.message}),c.executeEnd=now(),emptyResult(a)}(j||$||et||lt)&&this.resetInitSegment(it,st,at,nt,i),(j||et||lt)&&this.resetInitialTimestamp(rt),_||this.resetContiguity();const ct=this.transmux(d,ot,tt,_e,a);this.asyncResult=isPromise(ct);const ht=this.currentTransmuxState;return ht.contiguous=!0,ht.discontinuity=!1,ht.trackSwitch=!1,c.executeEnd=now(),ct}flush(e){const i=e.transmuxing;i.executeStart=now();const{decrypter:a,currentTransmuxState:o,decryptionPromise:c}=this;if(c)return this.asyncResult=!0,c.then(()=>this.flush(e));const d=[],{timeOffset:g}=o;if(a){const $=a.flush();$&&d.push(this.push($.buffer,null,e))}const{demuxer:b,remuxer:_}=this;if(!b||!_){i.executeEnd=now();const $=[emptyResult(e)];return this.asyncResult?Promise.resolve($):$}const j=b.flush(g);return isPromise(j)?(this.asyncResult=!0,j.then($=>(this.flushRemux(d,$,e),d))):(this.flushRemux(d,j,e),this.asyncResult?Promise.resolve(d):d)}flushRemux(e,i,a){const{audioTrack:o,videoTrack:c,id3Track:d,textTrack:g}=i,{accurateTimeOffset:b,timeOffset:_}=this.currentTransmuxState;this.logger.log(`[transmuxer.ts]: Flushed ${this.id} sn: ${a.sn}${a.part>-1?" part: "+a.part:""} of ${this.id===PlaylistLevelType.MAIN?"level":"track"} ${a.level}`);const j=this.remuxer.remux(o,c,d,g,_,b,!0,this.id);e.push({remuxResult:j,chunkMeta:a}),a.transmuxing.executeEnd=now()}resetInitialTimestamp(e){const{demuxer:i,remuxer:a}=this;!i||!a||(i.resetTimeStamp(e),a.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:i}=this;!e||!i||(e.resetContiguity(),i.resetNextTimestamp())}resetInitSegment(e,i,a,o,c){const{demuxer:d,remuxer:g}=this;!d||!g||(d.resetInitSegment(e,i,a,o),g.resetInitSegment(e,i,a,c))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,i,a,o,c){let d;return i&&i.method==="SAMPLE-AES"?d=this.transmuxSampleAes(e,i,a,o,c):d=this.transmuxUnencrypted(e,a,o,c),d}transmuxUnencrypted(e,i,a,o){const{audioTrack:c,videoTrack:d,id3Track:g,textTrack:b}=this.demuxer.demux(e,i,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(c,d,g,b,i,a,!1,this.id),chunkMeta:o}}transmuxSampleAes(e,i,a,o,c){return this.demuxer.demuxSampleAes(e,i,a).then(d=>({remuxResult:this.remuxer.remux(d.audioTrack,d.videoTrack,d.id3Track,d.textTrack,a,o,!1,this.id),chunkMeta:c}))}configureTransmuxer(e){const{config:i,observer:a,typeSupported:o}=this;let c;for(let $=0,_e=muxConfig.length;$<_e;$++){var d;if((d=muxConfig[$].demux)!=null&&d.probe(e,this.logger)){c=muxConfig[$];break}}if(!c)return new Error("Failed to find demuxer by probing fragment data");const g=this.demuxer,b=this.remuxer,_=c.remux,j=c.demux;(!b||!(b instanceof _))&&(this.remuxer=new _(a,i,o,this.logger)),(!g||!(g instanceof j))&&(this.demuxer=new j(a,i,o,this.logger),this.probe=j.probe)}needsProbing(e,i){return!this.demuxer||!this.remuxer||e||i}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new Decrypter(this.config)),e}}function getEncryptionType(s,e){let i=null;return s.byteLength>0&&(e==null?void 0:e.key)!=null&&e.iv!==null&&e.method!=null&&(i=e),i}const emptyResult=s=>({remuxResult:{},chunkMeta:s});function isPromise(s){return"then"in s&&s.then instanceof Function}class TransmuxConfig{constructor(e,i,a,o,c){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=i,this.initSegmentData=a,this.duration=o,this.defaultInitPts=c||null}}class TransmuxState{constructor(e,i,a,o,c,d){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=i,this.accurateTimeOffset=a,this.trackSwitch=o,this.timeOffset=c,this.initSegmentChange=d}}let transmuxerInstanceCount=0;class TransmuxerInterface{constructor(e,i,a,o){this.error=null,this.hls=void 0,this.id=void 0,this.instanceNo=transmuxerInstanceCount++,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.onWorkerMessage=b=>{const _=b.data,j=this.hls;if(!(!j||!(_!=null&&_.event)||_.instanceNo!==this.instanceNo))switch(_.event){case"init":{var $;const _e=($=this.workerContext)==null?void 0:$.objectURL;_e&&self.URL.revokeObjectURL(_e);break}case"transmuxComplete":{this.handleTransmuxComplete(_.data);break}case"flush":{this.onFlush(_.data);break}case"workerLog":{j.logger[_.data.logType]&&j.logger[_.data.logType](_.data.message);break}default:{_.data=_.data||{},_.data.frag=this.frag,_.data.part=this.part,_.data.id=this.id,j.trigger(_.event,_.data);break}}},this.onWorkerError=b=>{if(!this.hls)return;const _=new Error(`${b.message}  (${b.filename}:${b.lineno})`);this.hls.config.enableWorker=!1,this.hls.logger.warn(`Error in "${this.id}" Web Worker, fallback to inline`),this.hls.trigger(Events.ERROR,{type:ErrorTypes.OTHER_ERROR,details:ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:_})};const c=e.config;this.hls=e,this.id=i,this.useWorker=!!c.enableWorker,this.onTransmuxComplete=a,this.onFlush=o;const d=(b,_)=>{_=_||{},_.frag=this.frag||void 0,b===Events.ERROR&&(_=_,_.parent=this.id,_.part=this.part,this.error=_.error),this.hls.trigger(b,_)};this.observer=new EventEmitter,this.observer.on(Events.FRAG_DECRYPTED,d),this.observer.on(Events.ERROR,d);const g=getM2TSSupportedAudioTypes(c.preferManagedMediaSource);if(this.useWorker&&typeof Worker<"u"){const b=this.hls.logger;if(c.workerPath||hasUMDWorker()){try{c.workerPath?(b.log(`loading Web Worker ${c.workerPath} for "${i}"`),this.workerContext=loadWorker(c.workerPath)):(b.log(`injecting Web Worker for "${i}"`),this.workerContext=injectWorker());const{worker:j}=this.workerContext;j.addEventListener("message",this.onWorkerMessage),j.addEventListener("error",this.onWorkerError),j.postMessage({instanceNo:this.instanceNo,cmd:"init",typeSupported:g,id:i,config:stringify(c)})}catch(j){b.warn(`Error setting up "${i}" Web Worker, fallback to inline`,j),this.terminateWorker(),this.error=null,this.transmuxer=new Transmuxer(this.observer,g,c,"",i,e.logger)}return}}this.transmuxer=new Transmuxer(this.observer,g,c,"",i,e.logger)}reset(){if(this.frag=null,this.part=null,this.workerContext){const e=this.instanceNo;this.instanceNo=transmuxerInstanceCount++;const i=this.hls.config,a=getM2TSSupportedAudioTypes(i.preferManagedMediaSource);this.workerContext.worker.postMessage({instanceNo:this.instanceNo,cmd:"reset",resetNo:e,typeSupported:a,id:this.id,config:stringify(i)})}}terminateWorker(){if(this.workerContext){const{worker:e}=this.workerContext;this.workerContext=null,e.removeEventListener("message",this.onWorkerMessage),e.removeEventListener("error",this.onWorkerError),removeWorkerFromStore(this.hls.config.workerPath)}}destroy(){if(this.workerContext)this.terminateWorker(),this.onWorkerMessage=this.onWorkerError=null;else{const i=this.transmuxer;i&&(i.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.part=null,this.observer=null,this.hls=null}push(e,i,a,o,c,d,g,b,_,j){var $,_e;_.transmuxing.start=self.performance.now();const{instanceNo:tt,transmuxer:et}=this,st=d?d.start:c.start,at=c.decryptdata,rt=this.frag,nt=!(rt&&c.cc===rt.cc),it=!(rt&&_.level===rt.level),ot=rt?_.sn-rt.sn:-1,lt=this.part?_.part-this.part.index:-1,ct=ot===0&&_.id>1&&_.id===(rt==null?void 0:rt.stats.chunkCount),ht=!it&&(ot===1||ot===0&&(lt===1||ct&&lt<=0)),dt=self.performance.now();(it||ot||c.stats.parsing.start===0)&&(c.stats.parsing.start=dt),d&&(lt||!ht)&&(d.stats.parsing.start=dt);const gt=!(rt&&(($=c.initSegment)==null?void 0:$.url)===((_e=rt.initSegment)==null?void 0:_e.url)),vt=new TransmuxState(nt,ht,b,it,st,gt);if(!ht||nt||gt){this.hls.logger.log(`[transmuxer-interface]: Starting new transmux session for ${c.type} sn: ${_.sn}${_.part>-1?" part: "+_.part:""} ${this.id===PlaylistLevelType.MAIN?"level":"track"}: ${_.level} id: ${_.id}
        discontinuity: ${nt}
        trackSwitch: ${it}
        contiguous: ${ht}
        accurateTimeOffset: ${b}
        timeOffset: ${st}
        initSegmentChange: ${gt}`);const St=new TransmuxConfig(a,o,i,g,j);this.configureTransmuxer(St)}if(this.frag=c,this.part=d,this.workerContext)this.workerContext.worker.postMessage({instanceNo:tt,cmd:"demux",data:e,decryptdata:at,chunkMeta:_,state:vt},e instanceof ArrayBuffer?[e]:[]);else if(et){const St=et.push(e,at,_,vt);isPromise(St)?St.then(Tt=>{this.handleTransmuxComplete(Tt)}).catch(Tt=>{this.transmuxerError(Tt,_,"transmuxer-interface push error")}):this.handleTransmuxComplete(St)}}flush(e){e.transmuxing.start=self.performance.now();const{instanceNo:i,transmuxer:a}=this;if(this.workerContext)this.workerContext.worker.postMessage({instanceNo:i,cmd:"flush",chunkMeta:e});else if(a){const o=a.flush(e);isPromise(o)?o.then(c=>{this.handleFlushResult(c,e)}).catch(c=>{this.transmuxerError(c,e,"transmuxer-interface flush error")}):this.handleFlushResult(o,e)}}transmuxerError(e,i,a){this.hls&&(this.error=e,this.hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_PARSING_ERROR,chunkMeta:i,frag:this.frag||void 0,part:this.part||void 0,fatal:!1,error:e,err:e,reason:a}))}handleFlushResult(e,i){e.forEach(a=>{this.handleTransmuxComplete(a)}),this.onFlush(i)}configureTransmuxer(e){const{instanceNo:i,transmuxer:a}=this;this.workerContext?this.workerContext.worker.postMessage({instanceNo:i,cmd:"configure",config:e}):a&&a.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}const TICK_INTERVAL$3=100;class AudioStreamController extends BaseStreamController{constructor(e,i,a){super(e,i,a,"audio-stream-controller",PlaylistLevelType.AUDIO),this.mainAnchor=null,this.mainFragLoading=null,this.audioOnly=!1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.resetItem()}resetItem(){this.mainDetails=this.mainAnchor=this.mainFragLoading=this.bufferedTrack=this.switchingTrack=this.waitingData=this.cachedTrackLoadedData=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(Events.LEVEL_LOADED,this.onLevelLoaded,this),e.on(Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(Events.BUFFER_RESET,this.onBufferReset,this),e.on(Events.BUFFER_CREATED,this.onBufferCreated,this),e.on(Events.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(Events.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(Events.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(Events.FRAG_LOADING,this.onFragLoading,this),e.on(Events.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){const{hls:e}=this;e&&(super.unregisterListeners(),e.off(Events.LEVEL_LOADED,this.onLevelLoaded,this),e.off(Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(Events.BUFFER_RESET,this.onBufferReset,this),e.off(Events.BUFFER_CREATED,this.onBufferCreated,this),e.off(Events.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(Events.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(Events.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(Events.FRAG_LOADING,this.onFragLoading,this),e.off(Events.FRAG_BUFFERED,this.onFragBuffered,this))}onInitPtsFound(e,{frag:i,id:a,initPTS:o,timescale:c,trackId:d}){if(a===PlaylistLevelType.MAIN){const g=i.cc,b=this.fragCurrent;if(this.initPTS[g]={baseTime:o,timescale:c,trackId:d},this.log(`InitPTS for cc: ${g} found from main: ${o/c} (${o}/${c}) trackId: ${d}`),this.mainAnchor=i,this.state===State.WAITING_INIT_PTS){const _=this.waitingData;(!_&&!this.loadingParts||_&&_.frag.cc!==g)&&this.syncWithAnchor(i,_==null?void 0:_.frag)}else!this.hls.hasEnoughToStart&&b&&b.cc!==g?(b.abortRequests(),this.syncWithAnchor(i,b)):this.state===State.IDLE&&this.tick()}}getLoadPosition(){return!this.startFragRequested&&this.nextLoadPosition>=0?this.nextLoadPosition:super.getLoadPosition()}syncWithAnchor(e,i){var a;const o=((a=this.mainFragLoading)==null?void 0:a.frag)||null;if(i&&(o==null?void 0:o.cc)===i.cc)return;const c=(o||e).cc,d=this.getLevelDetails(),g=this.getLoadPosition(),b=findNearestWithCC(d,c,g);b&&(this.log(`Syncing with main frag at ${b.start} cc ${b.cc}`),this.startFragRequested=!1,this.nextLoadPosition=b.start,this.resetLoadingState(),this.state===State.IDLE&&this.doTickIdle())}startLoad(e,i){if(!this.levels){this.startPosition=e,this.state=State.STOPPED;return}const a=this.lastCurrentTime;this.stopLoad(),this.setInterval(TICK_INTERVAL$3),a>0&&e===-1?(this.log(`Override startPosition with lastCurrentTime @${a.toFixed(3)}`),e=a,this.state=State.IDLE):this.state=State.WAITING_TRACK,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=i?-1:e,this.tick()}doTick(){switch(this.state){case State.IDLE:this.doTickIdle();break;case State.WAITING_TRACK:{const{levels:e,trackId:i}=this,a=e==null?void 0:e[i],o=a==null?void 0:a.details;if(o&&!this.waitForLive(a)){if(this.waitForCdnTuneIn(o))break;this.state=State.WAITING_INIT_PTS}break}case State.FRAG_LOADING_WAITING_RETRY:{this.checkRetryDate();break}case State.WAITING_INIT_PTS:{const e=this.waitingData;if(e){const{frag:i,part:a,cache:o,complete:c}=e,d=this.mainAnchor;if(this.initPTS[i.cc]!==void 0){this.waitingData=null,this.state=State.FRAG_LOADING;const g=o.flush().buffer,b={frag:i,part:a,payload:g,networkDetails:null};this._handleFragmentLoadProgress(b),c&&super._handleFragmentLoadComplete(b)}else d&&d.cc!==e.frag.cc&&this.syncWithAnchor(d,e.frag)}else this.state=State.IDLE}}this.onTickEnd()}resetLoadingState(){const e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null),super.resetLoadingState()}onTickEnd(){const{media:e}=this;e!=null&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){var e;const{hls:i,levels:a,media:o,trackId:c}=this,d=i.config;if(!this.buffering||!o&&!this.primaryPrefetch&&(this.startFragRequested||!d.startFragPrefetch)||!(a!=null&&a[c]))return;const g=a[c],b=g.details;if(!b||this.waitForLive(g)||this.waitForCdnTuneIn(b)){this.state=State.WAITING_TRACK,this.startFragRequested=!1;return}const _=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&_&&(this.bufferFlushed=!1,this.afterBufferFlushed(_,ElementaryStreamTypes.AUDIO,PlaylistLevelType.AUDIO));const j=this.getFwdBufferInfo(_,PlaylistLevelType.AUDIO);if(j===null)return;if(!this.switchingTrack&&this._streamEnded(j,b)){i.trigger(Events.BUFFER_EOS,{type:"audio"}),this.state=State.ENDED;return}const $=j.len,_e=i.maxBufferLength,tt=b.fragments,et=tt[0].start,st=this.getLoadPosition(),at=this.flushing?st:j.end;if(this.switchingTrack&&o){const it=st;b.PTSKnown&&it<et&&(j.end>et||j.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),o.currentTime=et+.05)}if($>=_e&&!this.switchingTrack&&at<tt[tt.length-1].start)return;let rt=this.getNextFragment(at,b);if(rt&&this.isLoopLoading(rt,at)&&(rt=this.getNextFragmentLoopLoading(rt,b,j,PlaylistLevelType.MAIN,_e)),!rt){this.bufferFlushed=!0;return}let nt=((e=this.mainFragLoading)==null?void 0:e.frag)||null;if(!this.audioOnly&&this.startFragRequested&&nt&&isMediaFragment(rt)&&!rt.endList&&(!b.live||!this.loadingParts&&at<this.hls.liveSyncPosition)&&(this.fragmentTracker.getState(nt)===FragmentState.OK&&(this.mainFragLoading=nt=null),nt&&isMediaFragment(nt))){if(rt.start>nt.end){const ot=this.fragmentTracker.getFragAtPos(at,PlaylistLevelType.MAIN);ot&&ot.end>nt.end&&(nt=ot,this.mainFragLoading={frag:ot,targetBufferTime:null})}if(rt.start>nt.end)return}this.loadFragment(rt,g,at)}onMediaDetaching(e,i){this.bufferFlushed=this.flushing=!1,super.onMediaDetaching(e,i)}onAudioTracksUpdated(e,{audioTracks:i}){this.resetTransmuxer(),this.levels=i.map(a=>new Level(a))}onAudioTrackSwitching(e,i){const a=!!i.url;this.trackId=i.id;const{fragCurrent:o}=this;o&&(o.abortRequests(),this.removeUnbufferedFrags(o.start)),this.resetLoadingState(),a?(this.switchingTrack=i,this.flushAudioIfNeeded(i),this.state!==State.STOPPED&&(this.setInterval(TICK_INTERVAL$3),this.state=State.IDLE,this.tick())):(this.resetTransmuxer(),this.switchingTrack=null,this.bufferedTrack=i,this.clearInterval())}onManifestLoading(){super.onManifestLoading(),this.bufferFlushed=this.flushing=this.audioOnly=!1,this.resetItem(),this.trackId=-1}onLevelLoaded(e,i){this.mainDetails=i.details;const a=this.cachedTrackLoadedData;a&&(this.cachedTrackLoadedData=null,this.onAudioTrackLoaded(Events.AUDIO_TRACK_LOADED,a))}onAudioTrackLoaded(e,i){var a;const{levels:o}=this,{details:c,id:d,groupId:g,track:b}=i;if(!o){this.warn(`Audio tracks reset while loading track ${d} "${b.name}" of "${g}"`);return}const _=this.mainDetails;if(!_||c.endCC>_.endCC||_.expired){this.cachedTrackLoadedData=i,this.state!==State.STOPPED&&(this.state=State.WAITING_TRACK);return}this.cachedTrackLoadedData=null,this.log(`Audio track ${d} "${b.name}" of "${g}" loaded [${c.startSN},${c.endSN}]${c.lastPartSn?`[part-${c.lastPartSn}-${c.lastPartIndex}]`:""},duration:${c.totalduration}`);const j=o[d];let $=0;if(c.live||(a=j.details)!=null&&a.live){if(this.checkLiveUpdate(c),c.deltaUpdateFailed)return;if(j.details){var _e;$=this.alignPlaylists(c,j.details,(_e=this.levelLastLoaded)==null?void 0:_e.details)}c.alignedSliding||(alignDiscontinuities(c,_),c.alignedSliding||alignMediaPlaylistByPDT(c,_),$=c.fragmentStart)}j.details=c,this.levelLastLoaded=j,this.startFragRequested||this.setStartPosition(_,$),this.hls.trigger(Events.AUDIO_TRACK_UPDATED,{details:c,id:d,groupId:i.groupId}),this.state===State.WAITING_TRACK&&!this.waitForCdnTuneIn(c)&&(this.state=State.IDLE),this.tick()}_handleFragmentLoadProgress(e){var i;const a=e.frag,{part:o,payload:c}=e,{config:d,trackId:g,levels:b}=this;if(!b){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${a.sn} of level ${a.level} will not be buffered`);return}const _=b[g];if(!_){this.warn("Audio track is undefined on fragment load progress");return}const j=_.details;if(!j){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(a.start);return}const $=d.defaultAudioCodec||_.audioCodec||"mp4a.40.2";let _e=this.transmuxer;_e||(_e=this.transmuxer=new TransmuxerInterface(this.hls,PlaylistLevelType.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const tt=this.initPTS[a.cc],et=(i=a.initSegment)==null?void 0:i.data;if(tt!==void 0){const at=o?o.index:-1,rt=at!==-1,nt=new ChunkMetadata(a.level,a.sn,a.stats.chunkCount,c.byteLength,at,rt);_e.push(c,et,$,"",a,o,j.totalduration,!1,nt,tt)}else{this.log(`Unknown video PTS for cc ${a.cc}, waiting for video PTS before demuxing audio frag ${a.sn} of [${j.startSN} ,${j.endSN}],track ${g}`);const{cache:st}=this.waitingData=this.waitingData||{frag:a,part:o,cache:new ChunkCache,complete:!1};st.push(new Uint8Array(c)),this.state!==State.STOPPED&&(this.state=State.WAITING_INIT_PTS)}}_handleFragmentLoadComplete(e){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=null}onBufferCreated(e,i){this.bufferFlushed=this.flushing=!1;const a=i.tracks.audio;a&&(this.mediaBuffer=a.buffer||null)}onFragLoading(e,i){!this.audioOnly&&i.frag.type===PlaylistLevelType.MAIN&&isMediaFragment(i.frag)&&(this.mainFragLoading=i,this.state===State.IDLE&&this.tick())}onFragBuffered(e,i){const{frag:a,part:o}=i;if(a.type!==PlaylistLevelType.AUDIO){!this.audioOnly&&a.type===PlaylistLevelType.MAIN&&!a.elementaryStreams.video&&!a.elementaryStreams.audiovideo&&(this.audioOnly=!0,this.mainFragLoading=null);return}if(this.fragContextChanged(a)){this.warn(`Fragment ${a.sn}${o?" p: "+o.index:""} of level ${a.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(isMediaFragment(a)){this.fragPrevious=a;const c=this.switchingTrack;c&&(this.bufferedTrack=c,this.switchingTrack=null,this.hls.trigger(Events.AUDIO_TRACK_SWITCHED,_objectSpread2({},c)))}this.fragBufferedComplete(a,o),this.media&&this.tick()}onError(e,i){var a;if(i.fatal){this.state=State.ERROR;return}switch(i.details){case ErrorDetails.FRAG_GAP:case ErrorDetails.FRAG_PARSING_ERROR:case ErrorDetails.FRAG_DECRYPT_ERROR:case ErrorDetails.FRAG_LOAD_ERROR:case ErrorDetails.FRAG_LOAD_TIMEOUT:case ErrorDetails.KEY_LOAD_ERROR:case ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(PlaylistLevelType.AUDIO,i);break;case ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:case ErrorDetails.LEVEL_PARSING_ERROR:!i.levelRetry&&this.state===State.WAITING_TRACK&&((a=i.context)==null?void 0:a.type)===PlaylistContextType.AUDIO_TRACK&&(this.state=State.IDLE);break;case ErrorDetails.BUFFER_ADD_CODEC_ERROR:case ErrorDetails.BUFFER_APPEND_ERROR:if(i.parent!=="audio")return;this.reduceLengthAndFlushBuffer(i)||this.resetLoadingState();break;case ErrorDetails.BUFFER_FULL_ERROR:if(i.parent!=="audio")return;this.reduceLengthAndFlushBuffer(i)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case ErrorDetails.INTERNAL_EXCEPTION:this.recoverWorkerError(i);break}}onBufferFlushing(e,{type:i}){i!==ElementaryStreamTypes.VIDEO&&(this.flushing=!0)}onBufferFlushed(e,{type:i}){if(i!==ElementaryStreamTypes.VIDEO){this.flushing=!1,this.bufferFlushed=!0,this.state===State.ENDED&&(this.state=State.IDLE);const a=this.mediaBuffer||this.media;a&&(this.afterBufferFlushed(a,i,PlaylistLevelType.AUDIO),this.tick())}}_handleTransmuxComplete(e){var i;const a="audio",{hls:o}=this,{remuxResult:c,chunkMeta:d}=e,g=this.getCurrentContext(d);if(!g){this.resetWhenMissingContext(d);return}const{frag:b,part:_,level:j}=g,{details:$}=j,{audio:_e,text:tt,id3:et,initSegment:st}=c;if(this.fragContextChanged(b)||!$){this.fragmentTracker.removeFragment(b);return}if(this.state=State.PARSING,this.switchingTrack&&_e&&this.completeAudioSwitch(this.switchingTrack),st!=null&&st.tracks){const at=b.initSegment||b;if(this.unhandledEncryptionError(st,b))return;this._bufferInitSegment(j,st.tracks,at,d),o.trigger(Events.FRAG_PARSING_INIT_SEGMENT,{frag:at,id:a,tracks:st.tracks})}if(_e){const{startPTS:at,endPTS:rt,startDTS:nt,endDTS:it}=_e;_&&(_.elementaryStreams[ElementaryStreamTypes.AUDIO]={startPTS:at,endPTS:rt,startDTS:nt,endDTS:it}),b.setElementaryStreamInfo(ElementaryStreamTypes.AUDIO,at,rt,nt,it),this.bufferFragmentData(_e,b,_,d)}if(et!=null&&(i=et.samples)!=null&&i.length){const at=_extends({id:a,frag:b,details:$},et);o.trigger(Events.FRAG_PARSING_METADATA,at)}if(tt){const at=_extends({id:a,frag:b,details:$},tt);o.trigger(Events.FRAG_PARSING_USERDATA,at)}}_bufferInitSegment(e,i,a,o){if(this.state!==State.PARSING||(i.video&&delete i.video,i.audiovideo&&delete i.audiovideo,!i.audio))return;const c=i.audio;c.id=PlaylistLevelType.AUDIO;const d=e.audioCodec;this.log(`Init audio buffer, container:${c.container}, codecs[level/parsed]=[${d}/${c.codec}]`),d&&d.split(",").length===1&&(c.levelCodec=d),this.hls.trigger(Events.BUFFER_CODECS,i);const g=c.initSegment;if(g!=null&&g.byteLength){const b={type:"audio",frag:a,part:null,chunkMeta:o,parent:a.type,data:g};this.hls.trigger(Events.BUFFER_APPENDING,b)}this.tickImmediate()}loadFragment(e,i,a){const o=this.fragmentTracker.getState(e);if(this.switchingTrack||o===FragmentState.NOT_LOADED||o===FragmentState.PARTIAL){var c;if(!isMediaFragment(e))this._loadInitSegment(e,i);else if((c=i.details)!=null&&c.live&&!this.initPTS[e.cc]){this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=State.WAITING_INIT_PTS;const d=this.mainDetails;d&&d.fragmentStart!==i.details.fragmentStart&&alignMediaPlaylistByPDT(i.details,d)}else super.loadFragment(e,i,a)}else this.clearTrackerIfNeeded(e)}flushAudioIfNeeded(e){if(this.media&&this.bufferedTrack){const{name:i,lang:a,assocLang:o,characteristics:c,audioCodec:d,channels:g}=this.bufferedTrack;matchesOption({name:i,lang:a,assocLang:o,characteristics:c,audioCodec:d,channels:g},e,audioMatchPredicate)||(useAlternateAudio(e.url,this.hls)?(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null):this.bufferedTrack=e)}}completeAudioSwitch(e){const{hls:i}=this;this.flushAudioIfNeeded(e),this.bufferedTrack=e,this.switchingTrack=null,i.trigger(Events.AUDIO_TRACK_SWITCHED,_objectSpread2({},e))}}class BasePlaylistController extends Logger{constructor(e,i){super(i,e.logger),this.hls=void 0,this.canLoad=!1,this.timer=-1,this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){this.timer!==-1&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,i,a){const o=i==null?void 0:i.renditionReports;if(o){let c=-1;for(let d=0;d<o.length;d++){const g=o[d];let b;try{b=new self.URL(g.URI,i.url).href}catch(_){this.warn(`Could not construct new URL for Rendition Report: ${_}`),b=g.URI||""}if(b===e){c=d;break}else b===e.substring(0,b.length)&&(c=d)}if(c!==-1){const d=o[c],g=parseInt(d["LAST-MSN"])||i.lastPartSn;let b=parseInt(d["LAST-PART"])||i.lastPartIndex;if(this.hls.config.lowLatencyMode){const j=Math.min(i.age-i.partTarget,i.targetduration);b>=0&&j>i.partTarget&&(b+=1)}const _=a&&getSkipValue(a);return new HlsUrlParameters(g,b>=0?b:void 0,_)}}}loadPlaylist(e){this.clearTimer()}loadingPlaylist(e,i){this.clearTimer()}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}getUrlWithDirectives(e,i){if(i)try{return i.addDirectives(e)}catch(a){this.warn(`Could not construct new URL with HLS Delivery Directives: ${a}`)}return e}playlistLoaded(e,i,a){const{details:o,stats:c}=i,d=self.performance.now(),g=c.loading.first?Math.max(0,d-c.loading.first):0;o.advancedDateTime=Date.now()-g;const b=this.hls.config.timelineOffset;if(b!==o.appliedTimelineOffset){const j=Math.max(b||0,0);o.appliedTimelineOffset=j,o.fragments.forEach($=>{$.setStart($.playlistOffset+j)})}if(o.live||a!=null&&a.live){const j="levelInfo"in i?i.levelInfo:i.track;if(o.reloaded(a),a&&o.fragments.length>0){mergeDetails(a,o,this);const nt=o.playlistParsingError;if(nt){this.warn(nt);const it=this.hls;if(!it.config.ignorePlaylistParsingErrors){var _;const{networkDetails:ot}=i;it.trigger(Events.ERROR,{type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.LEVEL_PARSING_ERROR,fatal:!1,url:o.url,error:nt,reason:nt.message,level:i.level||void 0,parent:(_=o.fragments[0])==null?void 0:_.type,networkDetails:ot,stats:c});return}o.playlistParsingError=null}}o.requestScheduled===-1&&(o.requestScheduled=c.loading.start);const $=this.hls.mainForwardBufferInfo,_e=$?$.end-$.len:0,tt=(o.edge-_e)*1e3,et=computeReloadInterval(o,tt);if(o.requestScheduled+et<d?o.requestScheduled=d:o.requestScheduled+=et,this.log(`live playlist ${e} ${o.advanced?"REFRESHED "+o.lastPartSn+"-"+o.lastPartIndex:o.updated?"UPDATED":"MISSED"}`),!this.canLoad||!o.live)return;let st,at,rt;if(o.canBlockReload&&o.endSN&&o.advanced){const nt=this.hls.config.lowLatencyMode,it=o.lastPartSn,ot=o.endSN,lt=o.lastPartIndex,ct=lt!==-1,ht=it===ot;ct?ht?(at=ot+1,rt=nt?0:lt):(at=it,rt=nt?lt+1:o.maxPartIndex):at=ot+1;const dt=o.age,gt=dt+o.ageHeader;let vt=Math.min(gt-o.partTarget,o.targetduration*1.5);if(vt>0){if(gt>o.targetduration*3)this.log(`Playlist last advanced ${dt.toFixed(2)}s ago. Omitting segment and part directives.`),at=void 0,rt=void 0;else if(a!=null&&a.tuneInGoal&&gt-o.partTarget>a.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${a.tuneInGoal} to: ${vt} with playlist age: ${o.age}`),vt=0;else{const St=Math.floor(vt/o.targetduration);if(at+=St,rt!==void 0){const Tt=Math.round(vt%o.targetduration/o.partTarget);rt+=Tt}this.log(`CDN Tune-in age: ${o.ageHeader}s last advanced ${dt.toFixed(2)}s goal: ${vt} skip sn ${St} to part ${rt}`)}o.tuneInGoal=vt}if(st=this.getDeliveryDirectives(o,i.deliveryDirectives,at,rt),nt||!ht){o.requestScheduled=d,this.loadingPlaylist(j,st);return}}else(o.canBlockReload||o.canSkipUntil)&&(st=this.getDeliveryDirectives(o,i.deliveryDirectives,at,rt));st&&at!==void 0&&o.canBlockReload&&(o.requestScheduled=c.loading.first+Math.max(et-g*2,et/2)),this.scheduleLoading(j,st,o)}else this.clearTimer()}scheduleLoading(e,i,a){const o=a||e.details;if(!o){this.loadingPlaylist(e,i);return}const c=self.performance.now(),d=o.requestScheduled;if(c>=d){this.loadingPlaylist(e,i);return}const g=d-c;this.log(`reload live playlist ${e.name||e.bitrate+"bps"} in ${Math.round(g)} ms`),this.clearTimer(),this.timer=self.setTimeout(()=>this.loadingPlaylist(e,i),g)}getDeliveryDirectives(e,i,a,o){let c=getSkipValue(e);return i!=null&&i.skip&&e.deltaUpdateFailed&&(a=i.msn,o=i.part,c=HlsSkip.No),new HlsUrlParameters(a,o,c)}checkRetry(e){const i=e.details,a=isTimeoutError(e),o=e.errorAction,{action:c,retryCount:d=0,retryConfig:g}=o||{},b=!!o&&!!g&&(c===NetworkErrorAction.RetryRequest||!o.resolved&&c===NetworkErrorAction.SendAlternateToPenaltyBox);if(b){var _;if(d>=g.maxNumRetry)return!1;if(a&&(_=e.context)!=null&&_.deliveryDirectives)this.warn(`Retrying playlist loading ${d+1}/${g.maxNumRetry} after "${i}" without delivery-directives`),this.loadPlaylist();else{const j=getRetryDelay(g,d);this.clearTimer(),this.timer=self.setTimeout(()=>this.loadPlaylist(),j),this.warn(`Retrying playlist loading ${d+1}/${g.maxNumRetry} after "${i}" in ${j}ms`)}e.levelRetry=!0,o.resolved=!0}return b}}function subtitleOptionsIdentical(s,e){if(s.length!==e.length)return!1;for(let i=0;i<s.length;i++)if(!mediaAttributesIdentical(s[i].attrs,e[i].attrs))return!1;return!0}function mediaAttributesIdentical(s,e,i){const a=s["STABLE-RENDITION-ID"];return a&&!i?a===e["STABLE-RENDITION-ID"]:!(i||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(o=>s[o]!==e[o])}function subtitleTrackMatchesTextTrack(s,e){return e.label.toLowerCase()===s.name.toLowerCase()&&(!e.language||e.language.toLowerCase()===(s.lang||"").toLowerCase())}class AudioTrackController extends BasePlaylistController{constructor(e){super(e,"audio-track-controller"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Events.MANIFEST_PARSED,this.onManifestParsed,this),e.on(Events.LEVEL_LOADING,this.onLevelLoading,this),e.on(Events.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(Events.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Events.MANIFEST_PARSED,this.onManifestParsed,this),e.off(Events.LEVEL_LOADING,this.onLevelLoading,this),e.off(Events.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(Events.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,i){this.tracks=i.audioTracks||[]}onAudioTrackLoaded(e,i){const{id:a,groupId:o,details:c}=i,d=this.tracksInGroup[a];if(!d||d.groupId!==o){this.warn(`Audio track with id:${a} and group:${o} not found in active group ${d==null?void 0:d.groupId}`);return}const g=d.details;d.details=i.details,this.log(`Audio track ${a} "${d.name}" lang:${d.lang} group:${o} loaded [${c.startSN}-${c.endSN}]`),a===this.trackId&&this.playlistLoaded(a,i,g)}onLevelLoading(e,i){this.switchLevel(i.level)}onLevelSwitching(e,i){this.switchLevel(i.level)}switchLevel(e){const i=this.hls.levels[e];if(!i)return;const a=i.audioGroups||null,o=this.groupIds;let c=this.currentTrack;if(!a||(o==null?void 0:o.length)!==(a==null?void 0:a.length)||a!=null&&a.some(g=>(o==null?void 0:o.indexOf(g))===-1)){this.groupIds=a,this.trackId=-1,this.currentTrack=null;const g=this.tracks.filter(_e=>!a||a.indexOf(_e.groupId)!==-1);if(g.length)this.selectDefaultTrack&&!g.some(_e=>_e.default)&&(this.selectDefaultTrack=!1),g.forEach((_e,tt)=>{_e.id=tt});else if(!c&&!this.tracksInGroup.length)return;this.tracksInGroup=g;const b=this.hls.config.audioPreference;if(!c&&b){const _e=findMatchingOption(b,g,audioMatchPredicate);if(_e>-1)c=g[_e];else{const tt=findMatchingOption(b,this.tracks);c=this.tracks[tt]}}let _=this.findTrackId(c);_===-1&&c&&(_=this.findTrackId(null));const j={audioTracks:g};this.log(`Updating audio tracks, ${g.length} track(s) found in group(s): ${a==null?void 0:a.join(",")}`),this.hls.trigger(Events.AUDIO_TRACKS_UPDATED,j);const $=this.trackId;if(_!==-1&&$===-1)this.setAudioTrack(_);else if(g.length&&$===-1){var d;const _e=new Error(`No audio track selected for current audio group-ID(s): ${(d=this.groupIds)==null?void 0:d.join(",")} track count: ${g.length}`);this.warn(_e.message),this.hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:_e})}}}onError(e,i){i.fatal||!i.context||i.context.type===PlaylistContextType.AUDIO_TRACK&&i.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(i.context.groupId)!==-1)&&this.checkRetry(i)}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioOption(e){const i=this.hls;if(i.config.audioPreference=e,e){const a=this.allAudioTracks;if(this.selectDefaultTrack=!1,a.length){const o=this.currentTrack;if(o&&matchesOption(e,o,audioMatchPredicate))return o;const c=findMatchingOption(e,this.tracksInGroup,audioMatchPredicate);if(c>-1){const d=this.tracksInGroup[c];return this.setAudioTrack(c),d}else if(o){let d=i.loadLevel;d===-1&&(d=i.firstAutoLevel);const g=findClosestLevelWithAudioGroup(e,i.levels,a,d,audioMatchPredicate);if(g===-1)return null;i.nextLoadLevel=g}if(e.channels||e.audioCodec){const d=findMatchingOption(e,a);if(d>-1)return a[d]}}}return null}setAudioTrack(e){const i=this.tracksInGroup;if(e<0||e>=i.length){this.warn(`Invalid audio track id: ${e}`);return}this.selectDefaultTrack=!1;const a=this.currentTrack,o=i[e],c=o.details&&!o.details.live;if(e===this.trackId&&o===a&&c||(this.log(`Switching to audio-track ${e} "${o.name}" lang:${o.lang} group:${o.groupId} channels:${o.channels}`),this.trackId=e,this.currentTrack=o,this.hls.trigger(Events.AUDIO_TRACK_SWITCHING,_objectSpread2({},o)),c))return;const d=this.switchParams(o.url,a==null?void 0:a.details,o.details);this.loadPlaylist(d)}findTrackId(e){const i=this.tracksInGroup;for(let a=0;a<i.length;a++){const o=i[a];if(!(this.selectDefaultTrack&&!o.default)&&(!e||matchesOption(e,o,audioMatchPredicate)))return a}if(e){const{name:a,lang:o,assocLang:c,characteristics:d,audioCodec:g,channels:b}=e;for(let _=0;_<i.length;_++){const j=i[_];if(matchesOption({name:a,lang:o,assocLang:c,characteristics:d,audioCodec:g,channels:b},j,audioMatchPredicate))return _}for(let _=0;_<i.length;_++){const j=i[_];if(mediaAttributesIdentical(e.attrs,j.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return _}for(let _=0;_<i.length;_++){const j=i[_];if(mediaAttributesIdentical(e.attrs,j.attrs,["LANGUAGE"]))return _}}return-1}loadPlaylist(e){super.loadPlaylist();const i=this.currentTrack;this.shouldLoadPlaylist(i)&&useAlternateAudio(i.url,this.hls)&&this.scheduleLoading(i,e)}loadingPlaylist(e,i){super.loadingPlaylist(e,i);const a=e.id,o=e.groupId,c=this.getUrlWithDirectives(e.url,i),d=e.details,g=d==null?void 0:d.age;this.log(`Loading audio-track ${a} "${e.name}" lang:${e.lang} group:${o}${(i==null?void 0:i.msn)!==void 0?" at sn "+i.msn+" part "+i.part:""}${g&&d.live?" age "+g.toFixed(1)+(d.type&&" "+d.type||""):""} ${c}`),this.hls.trigger(Events.AUDIO_TRACK_LOADING,{url:c,id:a,groupId:o,deliveryDirectives:i||null,track:e})}}class BufferOperationQueue{constructor(e){this.tracks=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.tracks=e}destroy(){this.tracks=this.queues=null}append(e,i,a){if(this.queues===null||this.tracks===null)return;const o=this.queues[i];o.push(e),o.length===1&&!a&&this.executeNext(i)}appendBlocker(e){return new Promise(i=>{const a={label:"async-blocker",execute:i,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.append(a,e)})}prependBlocker(e){return new Promise(i=>{if(this.queues){const a={label:"async-blocker-prepend",execute:i,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.queues[e].unshift(a)}})}removeBlockers(){this.queues!==null&&[this.queues.video,this.queues.audio,this.queues.audiovideo].forEach(e=>{var i;const a=(i=e[0])==null?void 0:i.label;(a==="async-blocker"||a==="async-blocker-prepend")&&(e[0].execute(),e.splice(0,1))})}unblockAudio(e){if(this.queues===null)return;this.queues.audio[0]===e&&this.shiftAndExecuteNext("audio")}executeNext(e){if(this.queues===null||this.tracks===null)return;const i=this.queues[e];if(i.length){const o=i[0];try{o.execute()}catch(c){var a;if(o.onError(c),this.queues===null||this.tracks===null)return;const d=(a=this.tracks[e])==null?void 0:a.buffer;d!=null&&d.updating||this.shiftAndExecuteNext(e)}}}shiftAndExecuteNext(e){this.queues!==null&&(this.queues[e].shift(),this.executeNext(e))}current(e){var i;return((i=this.queues)==null?void 0:i[e][0])||null}toString(){const{queues:e,tracks:i}=this;return e===null||i===null?"<destroyed>":`
${this.list("video")}
${this.list("audio")}
${this.list("audiovideo")}}`}list(e){var i,a;return(i=this.queues)!=null&&i[e]||(a=this.tracks)!=null&&a[e]?`${e}: (${this.listSbInfo(e)}) ${this.listOps(e)}`:""}listSbInfo(e){var i;const a=(i=this.tracks)==null?void 0:i[e],o=a==null?void 0:a.buffer;return o?`SourceBuffer${o.updating?" updating":""}${a.ended?" ended":""}${a.ending?" ending":""}`:"none"}listOps(e){var i;return((i=this.queues)==null?void 0:i[e].map(a=>a.label).join(", "))||""}}const VIDEO_CODEC_PROFILE_REPLACE=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/,TRACK_REMOVED_ERROR_NAME="HlsJsTrackRemovedError";class HlsJsTrackRemovedError extends Error{constructor(e){super(e),this.name=TRACK_REMOVED_ERROR_NAME}}class BufferController extends Logger{constructor(e,i){super("buffer-controller",e.logger),this.hls=void 0,this.fragmentTracker=void 0,this.details=null,this._objectUrl=null,this.operationQueue=null,this.bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.blockedAudioAppend=null,this.lastVideoAppendEnd=0,this.appendSource=void 0,this.transferData=void 0,this.overrides=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.sourceBuffers=[[null,null],[null,null]],this._onEndStreaming=a=>{var o;this.hls&&((o=this.mediaSource)==null?void 0:o.readyState)==="open"&&this.hls.pauseBuffering()},this._onStartStreaming=a=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=a=>{const{media:o,mediaSource:c}=this;a&&this.log("Media source opened"),!(!o||!c)&&(c.removeEventListener("sourceopen",this._onMediaSourceOpen),o.removeEventListener("emptied",this._onMediaEmptied),this.updateDuration(),this.hls.trigger(Events.MEDIA_ATTACHED,{media:o,mediaSource:c}),this.mediaSource!==null&&this.checkPendingTracks())},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:a,_objectUrl:o}=this;a!==o&&this.error(`Media element src was set while attaching MediaSource (${o} > ${a})`)},this.hls=e,this.fragmentTracker=i,this.appendSource=isManagedMediaSource(getMediaSource(e.config.preferManagedMediaSource)),this.initTracks(),this.registerListeners()}hasSourceTypes(){return Object.keys(this.tracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.transferData=this.overrides=void 0,this.operationQueue&&(this.operationQueue.destroy(),this.operationQueue=null),this.hls=this.fragmentTracker=null,this._onMediaSourceOpen=this._onMediaSourceClose=null,this._onMediaSourceEnded=null,this._onStartStreaming=this._onEndStreaming=null}registerListeners(){const{hls:e}=this;e.on(Events.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Events.MANIFEST_PARSED,this.onManifestParsed,this),e.on(Events.BUFFER_RESET,this.onBufferReset,this),e.on(Events.BUFFER_APPENDING,this.onBufferAppending,this),e.on(Events.BUFFER_CODECS,this.onBufferCodecs,this),e.on(Events.BUFFER_EOS,this.onBufferEos,this),e.on(Events.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(Events.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(Events.FRAG_PARSED,this.onFragParsed,this),e.on(Events.FRAG_CHANGED,this.onFragChanged,this),e.on(Events.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(Events.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Events.MANIFEST_PARSED,this.onManifestParsed,this),e.off(Events.BUFFER_RESET,this.onBufferReset,this),e.off(Events.BUFFER_APPENDING,this.onBufferAppending,this),e.off(Events.BUFFER_CODECS,this.onBufferCodecs,this),e.off(Events.BUFFER_EOS,this.onBufferEos,this),e.off(Events.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(Events.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(Events.FRAG_PARSED,this.onFragParsed,this),e.off(Events.FRAG_CHANGED,this.onFragChanged,this),e.off(Events.ERROR,this.onError,this)}transferMedia(){const{media:e,mediaSource:i}=this;if(!e)return null;const a={};if(this.operationQueue){const c=this.isUpdating();c||this.operationQueue.removeBlockers();const d=this.isQueued();(c||d)&&this.warn(`Transfering MediaSource with${d?" operations in queue":""}${c?" updating SourceBuffer(s)":""} ${this.operationQueue}`),this.operationQueue.destroy()}const o=this.transferData;return!this.sourceBufferCount&&o&&o.mediaSource===i?_extends(a,o.tracks):this.sourceBuffers.forEach(c=>{const[d]=c;d&&(a[d]=_extends({},this.tracks[d]),this.removeBuffer(d)),c[0]=c[1]=null}),{media:e,mediaSource:i,tracks:a}}initTracks(){const e={};this.sourceBuffers=[[null,null],[null,null]],this.tracks=e,this.resetQueue(),this.resetAppendErrors(),this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.lastVideoAppendEnd=0}onManifestLoading(){this.bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,i){var a;let o=2;(i.audio&&!i.video||!i.altAudio)&&(o=1),this.bufferCodecEventsTotal=o,this.log(`${o} bufferCodec event(s) expected.`),(a=this.transferData)!=null&&a.mediaSource&&this.sourceBufferCount&&o&&this.bufferCreated()}onMediaAttaching(e,i){const a=this.media=i.media;this.transferData=this.overrides=void 0;const o=getMediaSource(this.appendSource);if(o){const c=!!i.mediaSource;(c||i.overrides)&&(this.transferData=i,this.overrides=i.overrides);const d=this.mediaSource=i.mediaSource||new o;if(this.assignMediaSource(d),c)this._objectUrl=a.src,this.attachTransferred();else{const g=this._objectUrl=self.URL.createObjectURL(d);if(this.appendSource)try{a.removeAttribute("src");const b=self.ManagedMediaSource;a.disableRemotePlayback=a.disableRemotePlayback||b&&d instanceof b,removeSourceChildren(a),addSource(a,g),a.load()}catch{a.src=g}else a.src=g}a.addEventListener("emptied",this._onMediaEmptied)}}assignMediaSource(e){var i,a;this.log(`${((i=this.transferData)==null?void 0:i.mediaSource)===e?"transferred":"created"} media source: ${(a=e.constructor)==null?void 0:a.name}`),e.addEventListener("sourceopen",this._onMediaSourceOpen),e.addEventListener("sourceended",this._onMediaSourceEnded),e.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(e.addEventListener("startstreaming",this._onStartStreaming),e.addEventListener("endstreaming",this._onEndStreaming))}attachTransferred(){const e=this.media,i=this.transferData;if(!i||!e)return;const a=this.tracks,o=i.tracks,c=o?Object.keys(o):null,d=c?c.length:0,g=()=>{Promise.resolve().then(()=>{this.media&&this.mediaSourceOpenOrEnded&&this._onMediaSourceOpen()})};if(o&&c&&d){if(!this.tracksReady){this.hls.config.startFragPrefetch=!0,this.log("attachTransferred: waiting for SourceBuffer track info");return}if(this.log(`attachTransferred: (bufferCodecEventsTotal ${this.bufferCodecEventsTotal})
required tracks: ${stringify(a,(b,_)=>b==="initSegment"?void 0:_)};
transfer tracks: ${stringify(o,(b,_)=>b==="initSegment"?void 0:_)}}`),!isCompatibleTrackChange(o,a)){i.mediaSource=null,i.tracks=void 0;const b=e.currentTime,_=this.details,j=Math.max(b,(_==null?void 0:_.fragments[0].start)||0);if(j-b>1){this.log(`attachTransferred: waiting for playback to reach new tracks start time ${b} -> ${j}`);return}this.warn(`attachTransferred: resetting MediaSource for incompatible tracks ("${Object.keys(o)}"->"${Object.keys(a)}") start time: ${j} currentTime: ${b}`),this.onMediaDetaching(Events.MEDIA_DETACHING,{}),this.onMediaAttaching(Events.MEDIA_ATTACHING,i),e.currentTime=j;return}this.transferData=void 0,c.forEach(b=>{const _=b,j=o[_];if(j){const $=j.buffer;if($){const _e=this.fragmentTracker,tt=j.id;if(_e.hasFragments(tt)||_e.hasParts(tt)){const at=BufferHelper.getBuffered($);_e.detectEvictedFragments(_,at,tt,null,!0)}const et=sourceBufferNameToIndex(_),st=[_,$];this.sourceBuffers[et]=st,$.updating&&this.operationQueue&&this.operationQueue.prependBlocker(_),this.trackSourceBuffer(_,j)}}}),g(),this.bufferCreated()}else this.log("attachTransferred: MediaSource w/o SourceBuffers"),g()}get mediaSourceOpenOrEnded(){var e;const i=(e=this.mediaSource)==null?void 0:e.readyState;return i==="open"||i==="ended"}onMediaDetaching(e,i){const a=!!i.transferMedia;this.transferData=this.overrides=void 0;const{media:o,mediaSource:c,_objectUrl:d}=this;if(c){if(this.log(`media source ${a?"transferring":"detaching"}`),a)this.sourceBuffers.forEach(([g])=>{g&&this.removeBuffer(g)}),this.resetQueue();else{if(this.mediaSourceOpenOrEnded){const g=c.readyState==="open";try{const b=c.sourceBuffers;for(let _=b.length;_--;)g&&b[_].abort(),c.removeSourceBuffer(b[_]);g&&c.endOfStream()}catch(b){this.warn(`onMediaDetaching: ${b.message} while calling endOfStream`)}}this.sourceBufferCount&&this.onBufferReset()}c.removeEventListener("sourceopen",this._onMediaSourceOpen),c.removeEventListener("sourceended",this._onMediaSourceEnded),c.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(c.removeEventListener("startstreaming",this._onStartStreaming),c.removeEventListener("endstreaming",this._onEndStreaming)),this.mediaSource=null,this._objectUrl=null}o&&(o.removeEventListener("emptied",this._onMediaEmptied),a||(d&&self.URL.revokeObjectURL(d),this.mediaSrc===d?(o.removeAttribute("src"),this.appendSource&&removeSourceChildren(o),o.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.media=null),this.hls.trigger(Events.MEDIA_DETACHED,i)}onBufferReset(){this.sourceBuffers.forEach(([e])=>{e&&this.resetBuffer(e)}),this.initTracks()}resetBuffer(e){var i;const a=(i=this.tracks[e])==null?void 0:i.buffer;if(this.removeBuffer(e),a)try{var o;(o=this.mediaSource)!=null&&o.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(a)}catch(c){this.warn(`onBufferReset ${e}`,c)}delete this.tracks[e]}removeBuffer(e){this.removeBufferListeners(e),this.sourceBuffers[sourceBufferNameToIndex(e)]=[null,null];const i=this.tracks[e];i&&(i.buffer=void 0)}resetQueue(){this.operationQueue&&this.operationQueue.destroy(),this.operationQueue=new BufferOperationQueue(this.tracks)}onBufferCodecs(e,i){var a;const o=this.tracks,c=Object.keys(i);this.log(`BUFFER_CODECS: "${c}" (current SB count ${this.sourceBufferCount})`);const d="audiovideo"in i&&(o.audio||o.video)||o.audiovideo&&("audio"in i||"video"in i),g=!d&&this.sourceBufferCount&&this.media&&c.some(b=>!o[b]);if(d||g){this.warn(`Unsupported transition between "${Object.keys(o)}" and "${c}" SourceBuffers`);return}c.forEach(b=>{var _,j;const $=i[b],{id:_e,codec:tt,levelCodec:et,container:st,metadata:at,supplemental:rt}=$;let nt=o[b];const it=(_=this.transferData)==null||(_=_.tracks)==null?void 0:_[b],ot=it!=null&&it.buffer?it:nt,lt=(ot==null?void 0:ot.pendingCodec)||(ot==null?void 0:ot.codec),ct=ot==null?void 0:ot.levelCodec;nt||(nt=o[b]={buffer:void 0,listeners:[],codec:tt,supplemental:rt,container:st,levelCodec:et,metadata:at,id:_e});const ht=pickMostCompleteCodecName(lt,ct),dt=ht==null?void 0:ht.replace(VIDEO_CODEC_PROFILE_REPLACE,"$1");let gt=pickMostCompleteCodecName(tt,et);const vt=(j=gt)==null?void 0:j.replace(VIDEO_CODEC_PROFILE_REPLACE,"$1");gt&&ht&&dt!==vt&&(b.slice(0,5)==="audio"&&(gt=getCodecCompatibleName(gt,this.appendSource)),this.log(`switching codec ${lt} to ${gt}`),gt!==(nt.pendingCodec||nt.codec)&&(nt.pendingCodec=gt),nt.container=st,this.appendChangeType(b,st,gt))}),(this.tracksReady||this.sourceBufferCount)&&(i.tracks=this.sourceBufferTracks),!this.sourceBufferCount&&(this.bufferCodecEventsTotal>1&&!this.tracks.video&&!i.video&&((a=i.audio)==null?void 0:a.id)==="main"&&(this.log("Main audio-only"),this.bufferCodecEventsTotal=1),this.mediaSourceOpenOrEnded&&this.checkPendingTracks())}get sourceBufferTracks(){return Object.keys(this.tracks).reduce((e,i)=>{const a=this.tracks[i];return e[i]={id:a.id,container:a.container,codec:a.codec,levelCodec:a.levelCodec},e},{})}appendChangeType(e,i,a){const o=`${i};codecs=${a}`,c={label:`change-type=${o}`,execute:()=>{const d=this.tracks[e];if(d){const g=d.buffer;g!=null&&g.changeType&&(this.log(`changing ${e} sourceBuffer type to ${o}`),g.changeType(o),d.codec=a,d.container=i)}this.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:d=>{this.warn(`Failed to change ${e} SourceBuffer type`,d)}};this.append(c,e,this.isPending(this.tracks[e]))}blockAudio(e){var i;const a=e.start,o=a+e.duration*.05;if(((i=this.fragmentTracker.getAppendedFrag(a,PlaylistLevelType.MAIN))==null?void 0:i.gap)===!0)return;const d={label:"block-audio",execute:()=>{var g;const b=this.tracks.video;(this.lastVideoAppendEnd>o||b!=null&&b.buffer&&BufferHelper.isBuffered(b.buffer,o)||((g=this.fragmentTracker.getAppendedFrag(o,PlaylistLevelType.MAIN))==null?void 0:g.gap)===!0)&&(this.blockedAudioAppend=null,this.shiftAndExecuteNext("audio"))},onStart:()=>{},onComplete:()=>{},onError:g=>{this.warn("Error executing block-audio operation",g)}};this.blockedAudioAppend={op:d,frag:e},this.append(d,"audio",!0)}unblockAudio(){const{blockedAudioAppend:e,operationQueue:i}=this;e&&i&&(this.blockedAudioAppend=null,i.unblockAudio(e.op))}onBufferAppending(e,i){const{tracks:a}=this,{data:o,type:c,parent:d,frag:g,part:b,chunkMeta:_,offset:j}=i,$=_.buffering[c],{sn:_e,cc:tt}=g,et=self.performance.now();$.start=et;const st=g.stats.buffering,at=b?b.stats.buffering:null;st.start===0&&(st.start=et),at&&at.start===0&&(at.start=et);const rt=a.audio;let nt=!1;c==="audio"&&(rt==null?void 0:rt.container)==="audio/mpeg"&&(nt=!this.lastMpegAudioChunk||_.id===1||this.lastMpegAudioChunk.sn!==_.sn,this.lastMpegAudioChunk=_);const it=a.video,ot=it==null?void 0:it.buffer;if(ot&&_e!=="initSegment"){const ht=b||g,dt=this.blockedAudioAppend;if(c==="audio"&&d!=="main"&&!this.blockedAudioAppend&&!(it.ending||it.ended)){const vt=ht.start+ht.duration*.05,St=ot.buffered,Tt=this.currentOp("video");!St.length&&!Tt?this.blockAudio(ht):!Tt&&!BufferHelper.isBuffered(ot,vt)&&this.lastVideoAppendEnd<vt&&this.blockAudio(ht)}else if(c==="video"){const gt=ht.end;if(dt){const vt=dt.frag.start;(gt>vt||gt<this.lastVideoAppendEnd||BufferHelper.isBuffered(ot,vt))&&this.unblockAudio()}this.lastVideoAppendEnd=gt}}const lt=(b||g).start,ct={label:`append-${c}`,execute:()=>{var ht;$.executeStart=self.performance.now();const dt=(ht=this.tracks[c])==null?void 0:ht.buffer;dt&&(nt?this.updateTimestampOffset(dt,lt,.1,c,_e,tt):j!==void 0&&isFiniteNumber(j)&&this.updateTimestampOffset(dt,j,1e-6,c,_e,tt)),this.appendExecutor(o,c)},onStart:()=>{},onComplete:()=>{const ht=self.performance.now();$.executeEnd=$.end=ht,st.first===0&&(st.first=ht),at&&at.first===0&&(at.first=ht);const dt={};this.sourceBuffers.forEach(([gt,vt])=>{gt&&(dt[gt]=BufferHelper.getBuffered(vt))}),this.appendErrors[c]=0,c==="audio"||c==="video"?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(Events.BUFFER_APPENDED,{type:c,frag:g,part:b,chunkMeta:_,parent:g.type,timeRanges:dt})},onError:ht=>{var dt;const gt={type:ErrorTypes.MEDIA_ERROR,parent:g.type,details:ErrorDetails.BUFFER_APPEND_ERROR,sourceBufferName:c,frag:g,part:b,chunkMeta:_,error:ht,err:ht,fatal:!1},vt=(dt=this.media)==null?void 0:dt.error;if(ht.code===DOMException.QUOTA_EXCEEDED_ERR||ht.name=="QuotaExceededError"||"quota"in ht)gt.details=ErrorDetails.BUFFER_FULL_ERROR;else if(ht.code===DOMException.INVALID_STATE_ERR&&this.mediaSourceOpenOrEnded&&!vt)gt.errorAction=createDoNothingErrorAction(!0);else if(ht.name===TRACK_REMOVED_ERROR_NAME&&this.sourceBufferCount===0)gt.errorAction=createDoNothingErrorAction(!0);else{const St=++this.appendErrors[c];this.warn(`Failed ${St}/${this.hls.config.appendErrorMaxRetry} times to append segment in "${c}" sourceBuffer (${vt||"no media error"})`),(St>=this.hls.config.appendErrorMaxRetry||vt)&&(gt.fatal=!0)}this.hls.trigger(Events.ERROR,gt)}};this.log(`queuing "${c}" append sn: ${_e}${b?" p: "+b.index:""} of ${g.type===PlaylistLevelType.MAIN?"level":"track"} ${g.level} cc: ${tt}`),this.append(ct,c,this.isPending(this.tracks[c]))}getFlushOp(e,i,a){return this.log(`queuing "${e}" remove ${i}-${a}`),{label:"remove",execute:()=>{this.removeExecutor(e,i,a)},onStart:()=>{},onComplete:()=>{this.hls.trigger(Events.BUFFER_FLUSHED,{type:e})},onError:o=>{this.warn(`Failed to remove ${i}-${a} from "${e}" SourceBuffer`,o)}}}onBufferFlushing(e,i){const{type:a,startOffset:o,endOffset:c}=i;a?this.append(this.getFlushOp(a,o,c),a):this.sourceBuffers.forEach(([d])=>{d&&this.append(this.getFlushOp(d,o,c),d)})}onFragParsed(e,i){const{frag:a,part:o}=i,c=[],d=o?o.elementaryStreams:a.elementaryStreams;d[ElementaryStreamTypes.AUDIOVIDEO]?c.push("audiovideo"):(d[ElementaryStreamTypes.AUDIO]&&c.push("audio"),d[ElementaryStreamTypes.VIDEO]&&c.push("video"));const g=()=>{const b=self.performance.now();a.stats.buffering.end=b,o&&(o.stats.buffering.end=b);const _=o?o.stats:a.stats;this.hls.trigger(Events.FRAG_BUFFERED,{frag:a,part:o,stats:_,id:a.type})};c.length===0&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${a.type} level: ${a.level} sn: ${a.sn}`),this.blockBuffers(g,c).catch(b=>{this.warn(`Fragment buffered callback ${b}`),this.stepOperationQueue(this.sourceBufferTypes)})}onFragChanged(e,i){this.trimBuffers()}get bufferedToEnd(){return this.sourceBufferCount>0&&!this.sourceBuffers.some(([e])=>{if(e){const i=this.tracks[e];if(i)return!i.ended||i.ending}return!1})}onBufferEos(e,i){var a;this.sourceBuffers.forEach(([d])=>{if(d){const g=this.tracks[d];(!i.type||i.type===d)&&(g.ending=!0,g.ended||(g.ended=!0,this.log(`${d} buffer reached EOS`)))}});const o=((a=this.overrides)==null?void 0:a.endOfStream)!==!1;this.sourceBufferCount>0&&!this.sourceBuffers.some(([d])=>{var g;return d&&!((g=this.tracks[d])!=null&&g.ended)})?o?(this.log("Queueing EOS"),this.blockUntilOpen(()=>{this.tracksEnded();const{mediaSource:d}=this;if(!d||d.readyState!=="open"){d&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${d.readyState}`);return}this.log("Calling mediaSource.endOfStream()"),d.endOfStream(),this.hls.trigger(Events.BUFFERED_TO_END,void 0)})):(this.tracksEnded(),this.hls.trigger(Events.BUFFERED_TO_END,void 0)):i.type==="video"&&this.unblockAudio()}tracksEnded(){this.sourceBuffers.forEach(([e])=>{if(e!==null){const i=this.tracks[e];i&&(i.ending=!1)}})}onLevelUpdated(e,{details:i}){i.fragments.length&&(this.details=i,this.updateDuration())}updateDuration(){this.blockUntilOpen(()=>{const e=this.getDurationAndRange();e&&this.updateMediaSource(e)})}onError(e,i){if(i.details===ErrorDetails.BUFFER_APPEND_ERROR&&i.frag){var a;const o=(a=i.errorAction)==null?void 0:a.nextAutoLevel;isFiniteNumber(o)&&o!==i.frag.level&&this.resetAppendErrors()}}resetAppendErrors(){this.appendErrors={audio:0,video:0,audiovideo:0}}trimBuffers(){const{hls:e,details:i,media:a}=this;if(!a||i===null||!this.sourceBufferCount)return;const o=e.config,c=a.currentTime,d=i.levelTargetDuration,g=i.live&&o.liveBackBufferLength!==null?o.liveBackBufferLength:o.backBufferLength;if(isFiniteNumber(g)&&g>=0){const _=Math.max(g,d),j=Math.floor(c/d)*d-_;this.flushBackBuffer(c,d,j)}const b=o.frontBufferFlushThreshold;if(isFiniteNumber(b)&&b>0){const _=Math.max(o.maxBufferLength,b),j=Math.max(_,d),$=Math.floor(c/d)*d+j;this.flushFrontBuffer(c,d,$)}}flushBackBuffer(e,i,a){this.sourceBuffers.forEach(([o,c])=>{if(c){const g=BufferHelper.getBuffered(c);if(g.length>0&&a>g.start(0)){var d;this.hls.trigger(Events.BACK_BUFFER_REACHED,{bufferEnd:a});const b=this.tracks[o];if((d=this.details)!=null&&d.live)this.hls.trigger(Events.LIVE_BACK_BUFFER_REACHED,{bufferEnd:a});else if(b!=null&&b.ended){this.log(`Cannot flush ${o} back buffer while SourceBuffer is in ended state`);return}this.hls.trigger(Events.BUFFER_FLUSHING,{startOffset:0,endOffset:a,type:o})}}})}flushFrontBuffer(e,i,a){this.sourceBuffers.forEach(([o,c])=>{if(c){const d=BufferHelper.getBuffered(c),g=d.length;if(g<2)return;const b=d.start(g-1),_=d.end(g-1);if(a>b||e>=b&&e<=_)return;this.hls.trigger(Events.BUFFER_FLUSHING,{startOffset:b,endOffset:1/0,type:o})}})}getDurationAndRange(){var e;const{details:i,mediaSource:a}=this;if(!i||!this.media||(a==null?void 0:a.readyState)!=="open")return null;const o=i.edge;if(i.live&&this.hls.config.liveDurationInfinity){if(i.fragments.length&&a.setLiveSeekableRange){const _=Math.max(0,i.fragmentStart),j=Math.max(_,o);return{duration:1/0,start:_,end:j}}return{duration:1/0}}const c=(e=this.overrides)==null?void 0:e.duration;if(c)return isFiniteNumber(c)?{duration:c}:null;const d=this.media.duration,g=isFiniteNumber(a.duration)?a.duration:0;return o>g&&o>d||!isFiniteNumber(d)?{duration:o}:null}updateMediaSource({duration:e,start:i,end:a}){const o=this.mediaSource;!this.media||!o||o.readyState!=="open"||(o.duration!==e&&(isFiniteNumber(e)&&this.log(`Updating MediaSource duration to ${e.toFixed(3)}`),o.duration=e),i!==void 0&&a!==void 0&&(this.log(`MediaSource duration is set to ${o.duration}. Setting seekable range to ${i}-${a}.`),o.setLiveSeekableRange(i,a)))}get tracksReady(){const e=this.pendingTrackCount;return e>0&&(e>=this.bufferCodecEventsTotal||this.isPending(this.tracks.audiovideo))}checkPendingTracks(){const{bufferCodecEventsTotal:e,pendingTrackCount:i,tracks:a}=this;if(this.log(`checkPendingTracks (pending: ${i} codec events expected: ${e}) ${stringify(a)}`),this.tracksReady){var o;const c=(o=this.transferData)==null?void 0:o.tracks;c&&Object.keys(c).length?this.attachTransferred():this.createSourceBuffers()}}bufferCreated(){if(this.sourceBufferCount){const e={};this.sourceBuffers.forEach(([i,a])=>{if(i){const o=this.tracks[i];e[i]={buffer:a,container:o.container,codec:o.codec,supplemental:o.supplemental,levelCodec:o.levelCodec,id:o.id,metadata:o.metadata}}}),this.hls.trigger(Events.BUFFER_CREATED,{tracks:e}),this.log(`SourceBuffers created. Running queue: ${this.operationQueue}`),this.sourceBuffers.forEach(([i])=>{this.executeNext(i)})}else{const e=new Error("could not create source buffer for media codec(s)");this.hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:e,reason:e.message})}}createSourceBuffers(){const{tracks:e,sourceBuffers:i,mediaSource:a}=this;if(!a)throw new Error("createSourceBuffers called when mediaSource was null");for(const c in e){const d=c,g=e[d];if(this.isPending(g)){const b=this.getTrackCodec(g,d),_=`${g.container};codecs=${b}`;g.codec=b,this.log(`creating sourceBuffer(${_})${this.currentOp(d)?" Queued":""} ${stringify(g)}`);try{const j=a.addSourceBuffer(_),$=sourceBufferNameToIndex(d),_e=[d,j];i[$]=_e,g.buffer=j}catch(j){var o;this.error(`error while trying to add sourceBuffer: ${j.message}`),this.shiftAndExecuteNext(d),(o=this.operationQueue)==null||o.removeBlockers(),delete this.tracks[d],this.hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:j,sourceBufferName:d,mimeType:_,parent:g.id});return}this.trackSourceBuffer(d,g)}}this.bufferCreated()}getTrackCodec(e,i){const a=e.supplemental;let o=e.codec;a&&(i==="video"||i==="audiovideo")&&areCodecsMediaSourceSupported(a,"video")&&(o=replaceVideoCodec(o,a));const c=pickMostCompleteCodecName(o,e.levelCodec);return c?i.slice(0,5)==="audio"?getCodecCompatibleName(c,this.appendSource):c:""}trackSourceBuffer(e,i){const a=i.buffer;if(!a)return;const o=this.getTrackCodec(i,e);this.tracks[e]={buffer:a,codec:o,container:i.container,levelCodec:i.levelCodec,supplemental:i.supplemental,metadata:i.metadata,id:i.id,listeners:[]},this.removeBufferListeners(e),this.addBufferListener(e,"updatestart",this.onSBUpdateStart),this.addBufferListener(e,"updateend",this.onSBUpdateEnd),this.addBufferListener(e,"error",this.onSBUpdateError),this.appendSource&&this.addBufferListener(e,"bufferedchange",(c,d)=>{const g=d.removedRanges;g!=null&&g.length&&this.hls.trigger(Events.BUFFER_FLUSHED,{type:c})})}get mediaSrc(){var e,i;const a=((e=this.media)==null||(i=e.querySelector)==null?void 0:i.call(e,"source"))||this.media;return a==null?void 0:a.src}onSBUpdateStart(e){const i=this.currentOp(e);i&&i.onStart()}onSBUpdateEnd(e){var i;if(((i=this.mediaSource)==null?void 0:i.readyState)==="closed"){this.resetBuffer(e);return}const a=this.currentOp(e);a&&(a.onComplete(),this.shiftAndExecuteNext(e))}onSBUpdateError(e,i){var a;const o=new Error(`${e} SourceBuffer error. MediaSource readyState: ${(a=this.mediaSource)==null?void 0:a.readyState}`);this.error(`${o}`,i),this.hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:o,fatal:!1});const c=this.currentOp(e);c&&c.onError(o)}updateTimestampOffset(e,i,a,o,c,d){const g=i-e.timestampOffset;Math.abs(g)>=a&&(this.log(`Updating ${o} SourceBuffer timestampOffset to ${i} (sn: ${c} cc: ${d})`),e.timestampOffset=i)}removeExecutor(e,i,a){const{media:o,mediaSource:c}=this,d=this.tracks[e],g=d==null?void 0:d.buffer;if(!o||!c||!g){this.warn(`Attempting to remove from the ${e} SourceBuffer, but it does not exist`),this.shiftAndExecuteNext(e);return}const b=isFiniteNumber(o.duration)?o.duration:1/0,_=isFiniteNumber(c.duration)?c.duration:1/0,j=Math.max(0,i),$=Math.min(a,b,_);$>j&&(!d.ending||d.ended)?(d.ended=!1,this.log(`Removing [${j},${$}] from the ${e} SourceBuffer`),g.remove(j,$)):this.shiftAndExecuteNext(e)}appendExecutor(e,i){const a=this.tracks[i],o=a==null?void 0:a.buffer;if(!o)throw new HlsJsTrackRemovedError(`Attempting to append to the ${i} SourceBuffer, but it does not exist`);a.ending=!1,a.ended=!1,o.appendBuffer(e)}blockUntilOpen(e){if(this.isUpdating()||this.isQueued())this.blockBuffers(e).catch(i=>{this.warn(`SourceBuffer blocked callback ${i}`),this.stepOperationQueue(this.sourceBufferTypes)});else try{e()}catch(i){this.warn(`Callback run without blocking ${this.operationQueue} ${i}`)}}isUpdating(){return this.sourceBuffers.some(([e,i])=>e&&i.updating)}isQueued(){return this.sourceBuffers.some(([e])=>e&&!!this.currentOp(e))}isPending(e){return!!e&&!e.buffer}blockBuffers(e,i=this.sourceBufferTypes){if(!i.length)return this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);const{operationQueue:a}=this,o=i.map(d=>this.appendBlocker(d));return i.length>1&&!!this.blockedAudioAppend&&this.unblockAudio(),Promise.all(o).then(d=>{a===this.operationQueue&&(e(),this.stepOperationQueue(this.sourceBufferTypes))})}stepOperationQueue(e){e.forEach(i=>{var a;const o=(a=this.tracks[i])==null?void 0:a.buffer;!o||o.updating||this.shiftAndExecuteNext(i)})}append(e,i,a){this.operationQueue&&this.operationQueue.append(e,i,a)}appendBlocker(e){if(this.operationQueue)return this.operationQueue.appendBlocker(e)}currentOp(e){return this.operationQueue?this.operationQueue.current(e):null}executeNext(e){e&&this.operationQueue&&this.operationQueue.executeNext(e)}shiftAndExecuteNext(e){this.operationQueue&&this.operationQueue.shiftAndExecuteNext(e)}get pendingTrackCount(){return Object.keys(this.tracks).reduce((e,i)=>e+(this.isPending(this.tracks[i])?1:0),0)}get sourceBufferCount(){return this.sourceBuffers.reduce((e,[i])=>e+(i?1:0),0)}get sourceBufferTypes(){return this.sourceBuffers.map(([e])=>e).filter(e=>!!e)}addBufferListener(e,i,a){const o=this.tracks[e];if(!o)return;const c=o.buffer;if(!c)return;const d=a.bind(this,e);o.listeners.push({event:i,listener:d}),c.addEventListener(i,d)}removeBufferListeners(e){const i=this.tracks[e];if(!i)return;const a=i.buffer;a&&(i.listeners.forEach(o=>{a.removeEventListener(o.event,o.listener)}),i.listeners.length=0)}}function removeSourceChildren(s){const e=s.querySelectorAll("source");[].slice.call(e).forEach(i=>{s.removeChild(i)})}function addSource(s,e){const i=self.document.createElement("source");i.type="video/mp4",i.src=e,s.appendChild(i)}function sourceBufferNameToIndex(s){return s==="audio"?1:0}class CapLevelController{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(Events.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(Events.MANIFEST_PARSED,this.onManifestParsed,this),e.on(Events.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(Events.BUFFER_CODECS,this.onBufferCodecs,this),e.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(Events.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(Events.MANIFEST_PARSED,this.onManifestParsed,this),e.off(Events.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(Events.BUFFER_CODECS,this.onBufferCodecs,this),e.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,i){const a=this.hls.levels[i.droppedLevel];this.isLevelAllowed(a)&&this.restrictedLevels.push({bitrate:a.bitrate,height:a.height,width:a.width})}onMediaAttaching(e,i){this.media=i.media instanceof HTMLVideoElement?i.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(e,i){const a=this.hls;this.restrictedLevels=[],this.firstLevel=i.firstLevel,a.config.capLevelToPlayerSize&&i.video&&this.startCapping()}onLevelsUpdated(e,i){this.timer&&isFiniteNumber(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(e,i){this.hls.config.capLevelToPlayerSize&&i.video&&this.startCapping()}onMediaDetaching(){this.stopCapping(),this.media=null}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0){this.clientRect=null;return}const e=this.hls.levels;if(e.length){const i=this.hls,a=this.getMaxLevel(e.length-1);a!==this.autoLevelCapping&&i.logger.log(`Setting autoLevelCapping to ${a}: ${e[a].height}p@${e[a].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),i.autoLevelCapping=a,i.autoLevelEnabled&&i.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=i.autoLevelCapping}}}getMaxLevel(e){const i=this.hls.levels;if(!i.length)return-1;const a=i.filter((o,c)=>this.isLevelAllowed(o)&&c<=e);return this.clientRect=null,CapLevelController.getMaxLevelByMediaSize(a,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,i={width:0,height:0};if(e){const a=e.getBoundingClientRect();i.width=a.width,i.height=a.height,!i.width&&!i.height&&(i.width=a.right-a.left||e.width||0,i.height=a.bottom-a.top||e.height||0)}return this.clientRect=i,i}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch{}return Math.min(e,this.hls.config.maxDevicePixelRatio)}isLevelAllowed(e){return!this.restrictedLevels.some(a=>e.bitrate===a.bitrate&&e.width===a.width&&e.height===a.height)}static getMaxLevelByMediaSize(e,i,a){if(!(e!=null&&e.length))return-1;const o=(g,b)=>b?g.width!==b.width||g.height!==b.height:!0;let c=e.length-1;const d=Math.max(i,a);for(let g=0;g<e.length;g+=1){const b=e[g];if((b.width>=d||b.height>=d)&&o(b,e[g+1])){c=g;break}}return c}}const CmObjectType={MANIFEST:"m",AUDIO:"a",VIDEO:"v",MUXED:"av",INIT:"i",CAPTION:"c",TIMED_TEXT:"tt",KEY:"k",OTHER:"o"},CmcdObjectType=CmObjectType,CmStreamingFormat={HLS:"h"},CmcdStreamingFormat=CmStreamingFormat;class SfItem{constructor(e,i){Array.isArray(e)&&(e=e.map(a=>a instanceof SfItem?a:new SfItem(a))),this.value=e,this.params=i}}const DICT="Dict";function format(s){return Array.isArray(s)?JSON.stringify(s):s instanceof Map?"Map{}":s instanceof Set?"Set{}":typeof s=="object"?JSON.stringify(s):String(s)}function throwError(s,e,i,a){return new Error(`failed to ${s} "${format(e)}" as ${i}`,{cause:a})}function serializeError(s,e,i){return throwError("serialize",s,e,i)}class SfToken{constructor(e){this.description=e}}const BARE_ITEM="Bare Item",BOOLEAN="Boolean";function serializeBoolean(s){if(typeof s!="boolean")throw serializeError(s,BOOLEAN);return s?"?1":"?0"}function encodeBase64(s){return btoa(String.fromCharCode(...s))}const BYTES="Byte Sequence";function serializeByteSequence(s){if(ArrayBuffer.isView(s)===!1)throw serializeError(s,BYTES);return`:${encodeBase64(s)}:`}const INTEGER="Integer";function isInvalidInt(s){return s<-999999999999999||999999999999999<s}function serializeInteger(s){if(isInvalidInt(s))throw serializeError(s,INTEGER);return s.toString()}function serializeDate(s){return`@${serializeInteger(s.getTime()/1e3)}`}function roundToEven(s,e){if(s<0)return-roundToEven(-s,e);const i=Math.pow(10,e);if(Math.abs(s*i%1-.5)<Number.EPSILON){const o=Math.floor(s*i);return(o%2===0?o:o+1)/i}else return Math.round(s*i)/i}const DECIMAL="Decimal";function serializeDecimal(s){const e=roundToEven(s,3);if(Math.floor(Math.abs(e)).toString().length>12)throw serializeError(s,DECIMAL);const i=e.toString();return i.includes(".")?i:`${i}.0`}const STRING="String",STRING_REGEX=/[\x00-\x1f\x7f]+/;function serializeString(s){if(STRING_REGEX.test(s))throw serializeError(s,STRING);return`"${s.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}function symbolToStr(s){return s.description||s.toString().slice(7,-1)}const TOKEN="Token";function serializeToken(s){const e=symbolToStr(s);if(/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(e)===!1)throw serializeError(e,TOKEN);return e}function serializeBareItem(s){switch(typeof s){case"number":if(!isFiniteNumber(s))throw serializeError(s,BARE_ITEM);return Number.isInteger(s)?serializeInteger(s):serializeDecimal(s);case"string":return serializeString(s);case"symbol":return serializeToken(s);case"boolean":return serializeBoolean(s);case"object":if(s instanceof Date)return serializeDate(s);if(s instanceof Uint8Array)return serializeByteSequence(s);if(s instanceof SfToken)return serializeToken(s);default:throw serializeError(s,BARE_ITEM)}}const KEY="Key";function serializeKey(s){if(/^[a-z*][a-z0-9\-_.*]*$/.test(s)===!1)throw serializeError(s,KEY);return s}function serializeParams(s){return s==null?"":Object.entries(s).map(([e,i])=>i===!0?`;${serializeKey(e)}`:`;${serializeKey(e)}=${serializeBareItem(i)}`).join("")}function serializeItem(s){return s instanceof SfItem?`${serializeBareItem(s.value)}${serializeParams(s.params)}`:serializeBareItem(s)}function serializeInnerList(s){return`(${s.value.map(serializeItem).join(" ")})${serializeParams(s.params)}`}function serializeDict(s,e={whitespace:!0}){if(typeof s!="object"||s==null)throw serializeError(s,DICT);const i=s instanceof Map?s.entries():Object.entries(s),a=e!=null&&e.whitespace?" ":"";return Array.from(i).map(([o,c])=>{c instanceof SfItem||(c=new SfItem(c));let d=serializeKey(o);return c.value===!0?d+=serializeParams(c.params):(d+="=",Array.isArray(c.value)?d+=serializeInnerList(c):d+=serializeItem(c)),d}).join(`,${a}`)}function encodeSfDict(s,e){return serializeDict(s,e)}const CMCD_OBJECT="CMCD-Object",CMCD_REQUEST="CMCD-Request",CMCD_SESSION="CMCD-Session",CMCD_STATUS="CMCD-Status",CMCD_HEADER_MAP={br:CMCD_OBJECT,ab:CMCD_OBJECT,d:CMCD_OBJECT,ot:CMCD_OBJECT,tb:CMCD_OBJECT,tpb:CMCD_OBJECT,lb:CMCD_OBJECT,tab:CMCD_OBJECT,lab:CMCD_OBJECT,url:CMCD_OBJECT,pb:CMCD_REQUEST,bl:CMCD_REQUEST,tbl:CMCD_REQUEST,dl:CMCD_REQUEST,ltc:CMCD_REQUEST,mtp:CMCD_REQUEST,nor:CMCD_REQUEST,nrr:CMCD_REQUEST,rc:CMCD_REQUEST,sn:CMCD_REQUEST,sta:CMCD_REQUEST,su:CMCD_REQUEST,ttfb:CMCD_REQUEST,ttfbb:CMCD_REQUEST,ttlb:CMCD_REQUEST,cmsdd:CMCD_REQUEST,cmsds:CMCD_REQUEST,smrt:CMCD_REQUEST,df:CMCD_REQUEST,cs:CMCD_REQUEST,ts:CMCD_REQUEST,cid:CMCD_SESSION,pr:CMCD_SESSION,sf:CMCD_SESSION,sid:CMCD_SESSION,st:CMCD_SESSION,v:CMCD_SESSION,msd:CMCD_SESSION,bs:CMCD_STATUS,bsd:CMCD_STATUS,cdn:CMCD_STATUS,rtp:CMCD_STATUS,bg:CMCD_STATUS,pt:CMCD_STATUS,ec:CMCD_STATUS,e:CMCD_STATUS},CmcdHeaderField={REQUEST:CMCD_REQUEST};function createHeaderMap(s){return Object.keys(s).reduce((e,i)=>{var a;return(a=s[i])===null||a===void 0||a.forEach(o=>e[o]=i),e},{})}function groupCmcdHeaders(s,e){const i={};if(!s)return i;const a=Object.keys(s),o=e?createHeaderMap(e):{};return a.reduce((c,d)=>{var g;const b=CMCD_HEADER_MAP[d]||o[d]||CmcdHeaderField.REQUEST,_=(g=c[b])!==null&&g!==void 0?g:c[b]={};return _[d]=s[d],c},i)}function isTokenField(s){return["ot","sf","st","e","sta"].includes(s)}function isValid(s){return typeof s=="number"?isFiniteNumber(s):s!=null&&s!==""&&s!==!1}const CMCD_EVENT_MODE="event";function urlToRelativePath(s,e){const i=new URL(s),a=new URL(e);if(i.origin!==a.origin)return s;const o=i.pathname.split("/").slice(1),c=a.pathname.split("/").slice(1,-1);for(;o[0]===c[0];)o.shift(),c.shift();for(;c.length;)c.shift(),o.unshift("..");return o.join("/")+i.search+i.hash}const toRounded=s=>Math.round(s),toUrlSafe=(s,e)=>Array.isArray(s)?s.map(i=>toUrlSafe(i,e)):s instanceof SfItem&&typeof s.value=="string"?new SfItem(toUrlSafe(s.value,e),s.params):(e.baseUrl&&(s=urlToRelativePath(s,e.baseUrl)),e.version===1?encodeURIComponent(s):s),toHundred=s=>toRounded(s/100)*100,nor=(s,e)=>{let i=s;return e.version>=2&&(s instanceof SfItem&&typeof s.value=="string"?i=new SfItem([s]):typeof s=="string"&&(i=[s])),toUrlSafe(i,e)},CMCD_FORMATTER_MAP={br:toRounded,d:toRounded,bl:toHundred,dl:toHundred,mtp:toHundred,nor,rtp:toHundred,tb:toRounded},CMCD_REQUEST_MODE="request",CMCD_RESPONSE_MODE="response",CMCD_COMMON_KEYS=["ab","bg","bl","br","bs","bsd","cdn","cid","cs","df","ec","lab","lb","ltc","msd","mtp","pb","pr","pt","sf","sid","sn","st","sta","tab","tb","tbl","tpb","ts","v"],CMCD_EVENT_KEYS=["e"],CUSTOM_KEY_REGEX=/^[a-zA-Z0-9-.]+-[a-zA-Z0-9-.]+$/;function isCmcdCustomKey(s){return CUSTOM_KEY_REGEX.test(s)}function isCmcdEventKey(s){return CMCD_COMMON_KEYS.includes(s)||CMCD_EVENT_KEYS.includes(s)||isCmcdCustomKey(s)}const CMCD_REQUEST_KEYS=["d","dl","nor","ot","rtp","su"];function isCmcdRequestKey(s){return CMCD_COMMON_KEYS.includes(s)||CMCD_REQUEST_KEYS.includes(s)||isCmcdCustomKey(s)}const CMCD_RESPONSE_KEYS=["cmsdd","cmsds","rc","smrt","ttfb","ttfbb","ttlb","url"];function isCmcdResponseKey(s){return CMCD_COMMON_KEYS.includes(s)||CMCD_REQUEST_KEYS.includes(s)||CMCD_RESPONSE_KEYS.includes(s)||isCmcdCustomKey(s)}const CMCD_V1_KEYS=["bl","br","bs","cid","d","dl","mtp","nor","nrr","ot","pr","rtp","sf","sid","st","su","tb","v"];function isCmcdV1Key(s){return CMCD_V1_KEYS.includes(s)||isCmcdCustomKey(s)}const filterMap={[CMCD_RESPONSE_MODE]:isCmcdResponseKey,[CMCD_EVENT_MODE]:isCmcdEventKey,[CMCD_REQUEST_MODE]:isCmcdRequestKey};function prepareCmcdData(s,e={}){const i={};if(s==null||typeof s!="object")return i;const a=e.version||s.v||1,o=e.reportingMode||CMCD_REQUEST_MODE,c=a===1?isCmcdV1Key:filterMap[o];let d=Object.keys(s).filter(c);const g=e.filter;typeof g=="function"&&(d=d.filter(g));const b=o===CMCD_RESPONSE_MODE||o===CMCD_EVENT_MODE;b&&!d.includes("ts")&&d.push("ts"),a>1&&!d.includes("v")&&d.push("v");const _=_extends({},CMCD_FORMATTER_MAP,e.formatters),j={version:a,reportingMode:o,baseUrl:e.baseUrl};return d.sort().forEach($=>{let _e=s[$];const tt=_[$];if(typeof tt=="function"&&(_e=tt(_e,j)),$==="v"){if(a===1)return;_e=a}$=="pr"&&_e===1||(b&&$==="ts"&&!isFiniteNumber(_e)&&(_e=Date.now()),isValid(_e)&&(isTokenField($)&&typeof _e=="string"&&(_e=new SfToken(_e)),i[$]=_e))}),i}function toCmcdHeaders(s,e={}){const i={};if(!s)return i;const a=prepareCmcdData(s,e),o=groupCmcdHeaders(a,e==null?void 0:e.customHeaderMap);return Object.entries(o).reduce((c,[d,g])=>{const b=encodeSfDict(g,{whitespace:!1});return b&&(c[d]=b),c},i)}function appendCmcdHeaders(s,e,i){return _extends(s,toCmcdHeaders(e,i))}const CMCD_PARAM="CMCD";function encodeCmcd(s,e={}){return s?encodeSfDict(prepareCmcdData(s,e),{whitespace:!1}):""}function toCmcdUrl(s,e={}){if(!s)return"";const i=encodeCmcd(s,e);return encodeURIComponent(i)}function toCmcdQuery(s,e={}){if(!s)return"";const i=toCmcdUrl(s,e);return`${CMCD_PARAM}=${i}`}const REGEX=/CMCD=[^&#]+/;function appendCmcdQuery(s,e,i){const a=toCmcdQuery(e,i);if(!a)return s;if(REGEX.test(s))return s.replace(REGEX,a);const o=s.includes("?")?"&":"?";return`${s}${o}${a}`}class CMCDController{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=o=>{try{this.apply(o,{ot:CmcdObjectType.MANIFEST,su:!this.initialized})}catch(c){this.hls.logger.warn("Could not generate manifest CMCD data.",c)}},this.applyFragmentData=o=>{try{const{frag:c,part:d}=o,g=this.hls.levels[c.level],b=this.getObjectType(c),_={d:(d||c).duration*1e3,ot:b};(b===CmcdObjectType.VIDEO||b===CmcdObjectType.AUDIO||b==CmcdObjectType.MUXED)&&(_.br=g.bitrate/1e3,_.tb=this.getTopBandwidth(b)/1e3,_.bl=this.getBufferLength(b));const j=d?this.getNextPart(d):this.getNextFrag(c);j!=null&&j.url&&j.url!==c.url&&(_.nor=j.url),this.apply(o,_)}catch(c){this.hls.logger.warn("Could not generate segment CMCD data.",c)}},this.hls=e;const i=this.config=e.config,{cmcd:a}=i;a!=null&&(i.pLoader=this.createPlaylistLoader(),i.fLoader=this.createFragmentLoader(),this.sid=a.sessionId||e.sessionId,this.cid=a.contentId,this.useHeaders=a.useHeaders===!0,this.includeKeys=a.includeKeys,this.registerListeners())}registerListeners(){const e=this.hls;e.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(Events.MEDIA_DETACHED,this.onMediaDetached,this),e.on(Events.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(Events.MEDIA_DETACHED,this.onMediaDetached,this),e.off(Events.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=this.media=null}onMediaAttached(e,i){this.media=i.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,i){var a,o;this.audioBuffer=(a=i.tracks.audio)==null?void 0:a.buffer,this.videoBuffer=(o=i.tracks.video)==null?void 0:o.buffer}createData(){var e;return{v:1,sf:CmcdStreamingFormat.HLS,sid:this.sid,cid:this.cid,pr:(e=this.media)==null?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,i={}){_extends(i,this.createData());const a=i.ot===CmcdObjectType.INIT||i.ot===CmcdObjectType.VIDEO||i.ot===CmcdObjectType.MUXED;this.starved&&a&&(i.bs=!0,i.su=!0,this.starved=!1),i.su==null&&(i.su=this.buffering);const{includeKeys:o}=this;o&&(i=Object.keys(i).reduce((d,g)=>(o.includes(g)&&(d[g]=i[g]),d),{}));const c={baseUrl:e.url};this.useHeaders?(e.headers||(e.headers={}),appendCmcdHeaders(e.headers,i,c)):e.url=appendCmcdQuery(e.url,i,c)}getNextFrag(e){var i;const a=(i=this.hls.levels[e.level])==null?void 0:i.details;if(a){const o=e.sn-a.startSN;return a.fragments[o+1]}}getNextPart(e){var i;const{index:a,fragment:o}=e,c=(i=this.hls.levels[o.level])==null||(i=i.details)==null?void 0:i.partList;if(c){const{sn:d}=o;for(let g=c.length-1;g>=0;g--){const b=c[g];if(b.index===a&&b.fragment.sn===d)return c[g+1]}}}getObjectType(e){const{type:i}=e;if(i==="subtitle")return CmcdObjectType.TIMED_TEXT;if(e.sn==="initSegment")return CmcdObjectType.INIT;if(i==="audio")return CmcdObjectType.AUDIO;if(i==="main")return this.hls.audioTracks.length?CmcdObjectType.VIDEO:CmcdObjectType.MUXED}getTopBandwidth(e){let i=0,a;const o=this.hls;if(e===CmcdObjectType.AUDIO)a=o.audioTracks;else{const c=o.maxAutoLevel,d=c>-1?c+1:o.levels.length;a=o.levels.slice(0,d)}return a.forEach(c=>{c.bitrate>i&&(i=c.bitrate)}),i>0?i:NaN}getBufferLength(e){const i=this.media,a=e===CmcdObjectType.AUDIO?this.audioBuffer:this.videoBuffer;return!a||!i?NaN:BufferHelper.bufferInfo(a,i.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){const{pLoader:e}=this.config,i=this.applyPlaylistData,a=e||this.config.loader;return class{constructor(c){this.loader=void 0,this.loader=new a(c)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(c,d,g){i(c),this.loader.load(c,d,g)}}}createFragmentLoader(){const{fLoader:e}=this.config,i=this.applyFragmentData,a=e||this.config.loader;return class{constructor(c){this.loader=void 0,this.loader=new a(c)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(c,d,g){i(c),this.loader.load(c,d,g)}}}}const PATHWAY_PENALTY_DURATION_MS=3e5;class ContentSteeringController extends Logger{constructor(e){super("content-steering",e.logger),this.hls=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this._pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Events.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(Events.MANIFEST_PARSED,this.onManifestParsed,this),e.on(Events.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;e&&(e.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Events.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(Events.MANIFEST_PARSED,this.onManifestParsed,this),e.off(Events.ERROR,this.onError,this))}pathways(){return(this.levels||[]).reduce((e,i)=>(e.indexOf(i.pathwayId)===-1&&e.push(i.pathwayId),e),[])}get pathwayPriority(){return this._pathwayPriority}set pathwayPriority(e){this.updatePathwayPriority(e)}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const e=this.timeToLoad*1e3-(performance.now()-this.updated);if(e>0){this.scheduleRefresh(this.uri,e);return}}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){this.reloadTimer!==-1&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const i=this.levels;i&&(this.levels=i.filter(a=>a!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,i){const{contentSteering:a}=i;a!==null&&(this.pathwayId=a.pathwayId,this.uri=a.uri,this.started&&this.startLoad())}onManifestParsed(e,i){this.audioTracks=i.audioTracks,this.subtitleTracks=i.subtitleTracks}onError(e,i){const{errorAction:a}=i;if((a==null?void 0:a.action)===NetworkErrorAction.SendAlternateToPenaltyBox&&a.flags===ErrorActionFlags.MoveAllAlternatesMatchingHost){const o=this.levels;let c=this._pathwayPriority,d=this.pathwayId;if(i.context){const{groupId:g,pathwayId:b,type:_}=i.context;g&&o?d=this.getPathwayForGroupId(g,_,d):b&&(d=b)}d in this.penalizedPathways||(this.penalizedPathways[d]=performance.now()),!c&&o&&(c=this.pathways()),c&&c.length>1&&(this.updatePathwayPriority(c),a.resolved=this.pathwayId!==d),i.details===ErrorDetails.BUFFER_APPEND_ERROR&&!i.fatal?a.resolved=!0:a.resolved||this.warn(`Could not resolve ${i.details} ("${i.error.message}") with content-steering for Pathway: ${d} levels: ${o&&o.length} priorities: ${stringify(c)} penalized: ${stringify(this.penalizedPathways)}`)}}filterParsedLevels(e){this.levels=e;let i=this.getLevelsForPathway(this.pathwayId);if(i.length===0){const a=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${a}"`),i=this.getLevelsForPathway(a),this.pathwayId=a}return i.length!==e.length&&this.log(`Found ${i.length}/${e.length} levels in Pathway "${this.pathwayId}"`),i}getLevelsForPathway(e){return this.levels===null?[]:this.levels.filter(i=>e===i.pathwayId)}updatePathwayPriority(e){this._pathwayPriority=e;let i;const a=this.penalizedPathways,o=performance.now();Object.keys(a).forEach(c=>{o-a[c]>PATHWAY_PENALTY_DURATION_MS&&delete a[c]});for(let c=0;c<e.length;c++){const d=e[c];if(d in a)continue;if(d===this.pathwayId)return;const g=this.hls.nextLoadLevel,b=this.hls.levels[g];if(i=this.getLevelsForPathway(d),i.length>0){this.log(`Setting Pathway to "${d}"`),this.pathwayId=d,reassignFragmentLevelIndexes(i),this.hls.trigger(Events.LEVELS_UPDATED,{levels:i});const _=this.hls.levels[g];b&&_&&this.levels&&(_.attrs["STABLE-VARIANT-ID"]!==b.attrs["STABLE-VARIANT-ID"]&&_.bitrate!==b.bitrate&&this.log(`Unstable Pathways change from bitrate ${b.bitrate} to ${_.bitrate}`),this.hls.nextLoadLevel=g);break}}}getPathwayForGroupId(e,i,a){const o=this.getLevelsForPathway(a).concat(this.levels||[]);for(let c=0;c<o.length;c++)if(i===PlaylistContextType.AUDIO_TRACK&&o[c].hasAudioGroup(e)||i===PlaylistContextType.SUBTITLE_TRACK&&o[c].hasSubtitleGroup(e))return o[c].pathwayId;return a}clonePathways(e){const i=this.levels;if(!i)return;const a={},o={};e.forEach(c=>{const{ID:d,"BASE-ID":g,"URI-REPLACEMENT":b}=c;if(i.some(j=>j.pathwayId===d))return;const _=this.getLevelsForPathway(g).map(j=>{const $=new AttrList(j.attrs);$["PATHWAY-ID"]=d;const _e=$.AUDIO&&`${$.AUDIO}_clone_${d}`,tt=$.SUBTITLES&&`${$.SUBTITLES}_clone_${d}`;_e&&(a[$.AUDIO]=_e,$.AUDIO=_e),tt&&(o[$.SUBTITLES]=tt,$.SUBTITLES=tt);const et=performUriReplacement(j.uri,$["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",b),st=new Level({attrs:$,audioCodec:j.audioCodec,bitrate:j.bitrate,height:j.height,name:j.name,url:et,videoCodec:j.videoCodec,width:j.width});if(j.audioGroups)for(let at=1;at<j.audioGroups.length;at++)st.addGroupId("audio",`${j.audioGroups[at]}_clone_${d}`);if(j.subtitleGroups)for(let at=1;at<j.subtitleGroups.length;at++)st.addGroupId("text",`${j.subtitleGroups[at]}_clone_${d}`);return st});i.push(..._),cloneRenditionGroups(this.audioTracks,a,b,d),cloneRenditionGroups(this.subtitleTracks,o,b,d)})}loadSteeringManifest(e){const i=this.hls.config,a=i.loader;this.loader&&this.loader.destroy(),this.loader=new a(i);let o;try{o=new self.URL(e)}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${e}`);return}if(o.protocol!=="data:"){const j=(this.hls.bandwidthEstimate||i.abrEwmaDefaultEstimate)|0;o.searchParams.set("_HLS_pathway",this.pathwayId),o.searchParams.set("_HLS_throughput",""+j)}const c={responseType:"json",url:o.href},d=i.steeringManifestLoadPolicy.default,g=d.errorRetry||d.timeoutRetry||{},b={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:g.maxNumRetry||0,retryDelay:g.retryDelayMs||0,maxRetryDelay:g.maxRetryDelayMs||0},_={onSuccess:(j,$,_e,tt)=>{this.log(`Loaded steering manifest: "${o}"`);const et=j.data;if((et==null?void 0:et.VERSION)!==1){this.log(`Steering VERSION ${et.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=et.TTL;const{"RELOAD-URI":st,"PATHWAY-CLONES":at,"PATHWAY-PRIORITY":rt}=et;if(st)try{this.uri=new self.URL(st,o).href}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${st}`);return}this.scheduleRefresh(this.uri||_e.url),at&&this.clonePathways(at);const nt={steeringManifest:et,url:o.toString()};this.hls.trigger(Events.STEERING_MANIFEST_LOADED,nt),rt&&this.updatePathwayPriority(rt)},onError:(j,$,_e,tt)=>{if(this.log(`Error loading steering manifest: ${j.code} ${j.text} (${$.url})`),this.stopLoad(),j.code===410){this.enabled=!1,this.log(`Steering manifest ${$.url} no longer available`);return}let et=this.timeToLoad*1e3;if(j.code===429){const st=this.loader;if(typeof(st==null?void 0:st.getResponseHeader)=="function"){const at=st.getResponseHeader("Retry-After");at&&(et=parseFloat(at)*1e3)}this.log(`Steering manifest ${$.url} rate limited`);return}this.scheduleRefresh(this.uri||$.url,et)},onTimeout:(j,$,_e)=>{this.log(`Timeout loading steering manifest (${$.url})`),this.scheduleRefresh(this.uri||$.url)}};this.log(`Requesting steering manifest: ${o}`),this.loader.load(c,b,_)}scheduleRefresh(e,i=this.timeToLoad*1e3){this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var a;const o=(a=this.hls)==null?void 0:a.media;if(o&&!o.ended){this.loadSteeringManifest(e);return}this.scheduleRefresh(e,this.timeToLoad*1e3)},i)}}function cloneRenditionGroups(s,e,i,a){s&&Object.keys(e).forEach(o=>{const c=s.filter(d=>d.groupId===o).map(d=>{const g=_extends({},d);return g.details=void 0,g.attrs=new AttrList(g.attrs),g.url=g.attrs.URI=performUriReplacement(d.url,d.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",i),g.groupId=g.attrs["GROUP-ID"]=e[o],g.attrs["PATHWAY-ID"]=a,g});s.push(...c)})}function performUriReplacement(s,e,i,a){const{HOST:o,PARAMS:c,[i]:d}=a;let g;e&&(g=d==null?void 0:d[e],g&&(s=g));const b=new self.URL(s);return o&&!g&&(b.host=o),c&&Object.keys(c).sort().forEach(_=>{_&&b.searchParams.set(_,c[_])}),b.href}class EMEController extends Logger{constructor(e){super("eme",e.logger),this.hls=void 0,this.config=void 0,this.media=null,this.mediaResolved=void 0,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.mediaKeys=null,this.setMediaKeysQueue=EMEController.CDMCleanupPromise?[EMEController.CDMCleanupPromise]:[],this.bannedKeyIds={},this.onMediaEncrypted=i=>{const{initDataType:a,initData:o}=i,c=`"${i.type}" event: init data type: "${a}"`;if(this.debug(c),o!==null){if(!this.keyFormatPromise){let d=Object.keys(this.keySystemAccessPromises);d.length||(d=getKeySystemsForConfig(this.config));const g=d.map(keySystemDomainToKeySystemFormat).filter(b=>!!b);this.keyFormatPromise=this.getKeyFormatPromise(g)}this.keyFormatPromise.then(d=>{const g=keySystemFormatToKeySystemDomain(d);if(a!=="sinf"||g!==KeySystems.FAIRPLAY){this.log(`Ignoring "${i.type}" event with init data type: "${a}" for selected key-system ${g}`);return}let b;try{const tt=bin2str(new Uint8Array(o)),et=base64Decode(JSON.parse(tt).sinf),st=parseSinf(et);if(!st)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");b=new Uint8Array(st.subarray(8,24))}catch(tt){this.warn(`${c} Failed to parse sinf: ${tt}`);return}const _=arrayToHex(b),{keyIdToKeySessionPromise:j,mediaKeySessions:$}=this;let _e=j[_];for(let tt=0;tt<$.length;tt++){const et=$[tt],st=et.decryptdata;if(!st.keyId)continue;const at=arrayToHex(st.keyId);if(arrayValuesMatch(b,st.keyId)||st.uri.replace(/-/g,"").indexOf(_)!==-1){if(_e=j[at],!_e)continue;if(st.pssh)break;delete j[at],st.pssh=new Uint8Array(o),st.keyId=b,_e=j[_]=_e.then(()=>this.generateRequestWithPreferredKeySession(et,a,o,"encrypted-event-key-match")),_e.catch(rt=>this.handleError(rt));break}}_e||this.handleError(new Error(`Key ID ${_} not encountered in playlist. Key-system sessions ${$.length}.`))}).catch(d=>this.handleError(d))}},this.onWaitingForKey=i=>{this.log(`"${i.type}" event`)},this.hls=e,this.config=e.config,this.registerListeners()}destroy(){this.onDestroying(),this.onMediaDetached();const e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.config=this.keyIdToKeySessionPromise=null,this.onMediaEncrypted=this.onWaitingForKey=null}registerListeners(){this.hls.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(Events.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.on(Events.DESTROYING,this.onDestroying,this)}unregisterListeners(){this.hls.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(Events.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.off(Events.DESTROYING,this.onDestroying,this)}getLicenseServerUrl(e){const{drmSystems:i,widevineLicenseUrl:a}=this.config,o=i==null?void 0:i[e];if(o)return o.licenseUrl;if(e===KeySystems.WIDEVINE&&a)return a}getLicenseServerUrlOrThrow(e){const i=this.getLicenseServerUrl(e);if(i===void 0)throw new Error(`no license server URL configured for key-system "${e}"`);return i}getServerCertificateUrl(e){const{drmSystems:i}=this.config,a=i==null?void 0:i[e];if(a)return a.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const i=this.hls.levels,a=(d,g,b)=>!!d&&b.indexOf(d)===g,o=i.map(d=>d.audioCodec).filter(a),c=i.map(d=>d.videoCodec).filter(a);return o.length+c.length===0&&c.push("avc1.42e01e"),new Promise((d,g)=>{const b=_=>{const j=_.shift();this.getMediaKeysPromise(j,o,c).then($=>d({keySystem:j,mediaKeys:$})).catch($=>{_.length?b(_):$ instanceof EMEKeyError?g($):g(new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_NO_ACCESS,error:$,fatal:!0},$.message))})};b(e)})}requestMediaKeySystemAccess(e,i){const{requestMediaKeySystemAccessFunc:a}=this.config;if(typeof a!="function"){let o=`Configured requestMediaKeySystemAccess is not a function ${a}`;return requestMediaKeySystemAccess===null&&self.location.protocol==="http:"&&(o=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(o))}return a(e,i)}getMediaKeysPromise(e,i,a){var o;const c=getSupportedMediaKeySystemConfigurations(e,i,a,this.config.drmSystemOptions||{});let d=this.keySystemAccessPromises[e],g=(o=d)==null?void 0:o.keySystemAccess;if(!g){this.log(`Requesting encrypted media "${e}" key-system access with config: ${stringify(c)}`),g=this.requestMediaKeySystemAccess(e,c);const b=d=this.keySystemAccessPromises[e]={keySystemAccess:g};return g.catch(_=>{this.log(`Failed to obtain access to key-system "${e}": ${_}`)}),g.then(_=>{this.log(`Access for key-system "${_.keySystem}" obtained`);const j=this.fetchServerCertificate(e);this.log(`Create media-keys for "${e}"`);const $=b.mediaKeys=_.createMediaKeys().then(_e=>(this.log(`Media-keys created for "${e}"`),b.hasMediaKeys=!0,j.then(tt=>tt?this.setMediaKeysServerCertificate(_e,e,tt):_e)));return $.catch(_e=>{this.error(`Failed to create media-keys for "${e}"}: ${_e}`)}),$})}return g.then(()=>d.mediaKeys)}createMediaKeySessionContext({decryptdata:e,keySystem:i,mediaKeys:a}){this.log(`Creating key-system session "${i}" keyId: ${arrayToHex(e.keyId||[])} keyUri: ${e.uri}`);const o=a.createSession(),c={decryptdata:e,keySystem:i,mediaKeys:a,mediaKeysSession:o,keyStatus:"status-pending"};return this.mediaKeySessions.push(c),c}renewKeySession(e){const i=e.decryptdata;if(i.pssh){const a=this.createMediaKeySessionContext(e),o=getKeyIdString(i),c="cenc";this.keyIdToKeySessionPromise[o]=this.generateRequestWithPreferredKeySession(a,c,i.pssh.buffer,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}updateKeySession(e,i){const a=e.mediaKeysSession;return this.log(`Updating key-session "${a.sessionId}" for keyId ${arrayToHex(e.decryptdata.keyId||[])}
      } (data length: ${i.byteLength})`),a.update(i)}getSelectedKeySystemFormats(){return Object.keys(this.keySystemAccessPromises).map(e=>({keySystem:e,hasMediaKeys:this.keySystemAccessPromises[e].hasMediaKeys})).filter(({hasMediaKeys:e})=>!!e).map(({keySystem:e})=>keySystemDomainToKeySystemFormat(e)).filter(e=>!!e)}getKeySystemAccess(e){return this.getKeySystemSelectionPromise(e).then(({keySystem:i,mediaKeys:a})=>this.attemptSetMediaKeys(i,a))}selectKeySystem(e){return new Promise((i,a)=>{this.getKeySystemSelectionPromise(e).then(({keySystem:o})=>{const c=keySystemDomainToKeySystemFormat(o);c?i(c):a(new Error(`Unable to find format for key-system "${o}"`))}).catch(a)})}selectKeySystemFormat(e){const i=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${i.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(i)),this.keyFormatPromise}getKeyFormatPromise(e){const i=getKeySystemsForConfig(this.config),a=e.map(keySystemFormatToKeySystemDomain).filter(o=>!!o&&i.indexOf(o)!==-1);return this.selectKeySystem(a)}getKeyStatus(e){const{mediaKeySessions:i}=this;for(let a=0;a<i.length;a++){const o=getKeyStatus(e,i[a]);if(o)return o}}loadKey(e){const i=e.keyInfo.decryptdata,a=getKeyIdString(i),o=this.bannedKeyIds[a];if(o||this.getKeyStatus(i)==="internal-error"){const g=getKeyStatusError(o||"internal-error",i);return this.handleError(g,e.frag),Promise.reject(g)}const c=`(keyId: ${a} format: "${i.keyFormat}" method: ${i.method} uri: ${i.uri})`;this.log(`Starting session for key ${c}`);const d=this.keyIdToKeySessionPromise[a];if(!d){const g=this.getKeySystemForKeyPromise(i).then(({keySystem:b,mediaKeys:_})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${c}`),this.attemptSetMediaKeys(b,_).then(()=>(this.throwIfDestroyed(),this.createMediaKeySessionContext({keySystem:b,mediaKeys:_,decryptdata:i}))))).then(b=>{const _="cenc",j=i.pssh?i.pssh.buffer:null;return this.generateRequestWithPreferredKeySession(b,_,j,"playlist-key")});return g.catch(b=>this.handleError(b,e.frag)),this.keyIdToKeySessionPromise[a]=g,g}return d.catch(g=>{if(g instanceof EMEKeyError){const b=_objectSpread2({},g.data);this.getKeyStatus(i)==="internal-error"&&(b.decryptdata=i);const _=new EMEKeyError(b,g.message);this.handleError(_,e.frag)}}),d}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e,i){if(this.hls)if(e instanceof EMEKeyError){i&&(e.data.frag=i);const a=e.data.decryptdata;this.error(`${e.message}${a?` (${arrayToHex(a.keyId||[])})`:""}`),this.hls.trigger(Events.ERROR,e.data)}else this.error(e.message),this.hls.trigger(Events.ERROR,{type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0})}getKeySystemForKeyPromise(e){const i=getKeyIdString(e),a=this.keyIdToKeySessionPromise[i];if(!a){const o=keySystemFormatToKeySystemDomain(e.keyFormat),c=o?[o]:getKeySystemsForConfig(this.config);return this.attemptKeySystemAccess(c)}return a}getKeySystemSelectionPromise(e){if(e.length||(e=getKeySystemsForConfig(this.config)),e.length===0)throw new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${stringify({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}attemptSetMediaKeys(e,i){if(this.mediaResolved=void 0,this.mediaKeys===i)return Promise.resolve();const a=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const o=Promise.all(a).then(()=>this.media?this.media.setMediaKeys(i):new Promise((c,d)=>{this.mediaResolved=()=>{if(this.mediaResolved=void 0,!this.media)return d(new Error("Attempted to set mediaKeys without media element attached"));this.mediaKeys=i,this.media.setMediaKeys(i).then(c).catch(d)}}));return this.mediaKeys=i,this.setMediaKeysQueue.push(o),o.then(()=>{this.log(`Media-keys set for "${e}"`),a.push(o),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(c=>a.indexOf(c)===-1)})}generateRequestWithPreferredKeySession(e,i,a,o){var c;const d=(c=this.config.drmSystems)==null||(c=c[e.keySystem])==null?void 0:c.generateRequest;if(d)try{const et=d.call(this.hls,i,a,e);if(!et)throw new Error("Invalid response from configured generateRequest filter");i=et.initDataType,a=et.initData?et.initData:null,e.decryptdata.pssh=a?new Uint8Array(a):null}catch(et){if(this.warn(et.message),this.hls&&this.hls.config.debug)throw et}if(a===null)return this.log(`Skipping key-session request for "${o}" (no initData)`),Promise.resolve(e);const g=getKeyIdString(e.decryptdata),b=e.decryptdata.uri;this.log(`Generating key-session request for "${o}" keyId: ${g} URI: ${b} (init data type: ${i} length: ${a.byteLength})`);const _=new EventEmitter,j=e._onmessage=et=>{const st=e.mediaKeysSession;if(!st){_.emit("error",new Error("invalid state"));return}const{messageType:at,message:rt}=et;this.log(`"${at}" message event for session "${st.sessionId}" message size: ${rt.byteLength}`),at==="license-request"||at==="license-renewal"?this.renewLicense(e,rt).catch(nt=>{_.eventNames().length?_.emit("error",nt):this.handleError(nt)}):at==="license-release"?e.keySystem===KeySystems.FAIRPLAY&&this.updateKeySession(e,strToUtf8array("acknowledged")).then(()=>this.removeSession(e)).catch(nt=>this.handleError(nt)):this.warn(`unhandled media key message type "${at}"`)},$=(et,st)=>{st.keyStatus=et;let at;et.startsWith("usable")?_.emit("resolved"):et==="internal-error"||et==="output-restricted"||et==="output-downscaled"?at=getKeyStatusError(et,st.decryptdata):et==="expired"?at=new Error(`key expired (keyId: ${g})`):et==="released"?at=new Error("key released"):et==="status-pending"||this.warn(`unhandled key status change "${et}" (keyId: ${g})`),at&&(_.eventNames().length?_.emit("error",at):this.handleError(at))},_e=e._onkeystatuseschange=et=>{if(!e.mediaKeysSession){_.emit("error",new Error("invalid state"));return}const at=this.getKeyStatuses(e);if(!Object.keys(at).some(ot=>at[ot]!=="status-pending"))return;if(at[g]==="expired"){this.log(`Expired key ${stringify(at)} in key-session "${e.mediaKeysSession.sessionId}"`),this.renewKeySession(e);return}let nt=at[g];if(nt)$(nt,e);else{var it;e.keyStatusTimeouts||(e.keyStatusTimeouts={}),(it=e.keyStatusTimeouts)[g]||(it[g]=self.setTimeout(()=>{if(!e.mediaKeysSession||!this.mediaKeys)return;const lt=this.getKeyStatus(e.decryptdata);if(lt&&lt!=="status-pending")return this.log(`No status for keyId ${g} in key-session "${e.mediaKeysSession.sessionId}". Using session key-status ${lt} from other session.`),$(lt,e);this.log(`key status for ${g} in key-session "${e.mediaKeysSession.sessionId}" timed out after 1000ms`),nt="internal-error",$(nt,e)},1e3)),this.log(`No status for keyId ${g} (${stringify(at)}).`)}};addEventListener(e.mediaKeysSession,"message",j),addEventListener(e.mediaKeysSession,"keystatuseschange",_e);const tt=new Promise((et,st)=>{_.on("error",st),_.on("resolved",et)});return e.mediaKeysSession.generateRequest(i,a).then(()=>{this.log(`Request generated for key-session "${e.mediaKeysSession.sessionId}" keyId: ${g} URI: ${b}`)}).catch(et=>{throw new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_NO_SESSION,error:et,decryptdata:e.decryptdata,fatal:!1},`Error generating key-session request: ${et}`)}).then(()=>tt).catch(et=>(_.removeAllListeners(),this.removeSession(e).then(()=>{throw et}))).then(()=>(_.removeAllListeners(),e))}getKeyStatuses(e){const i={};return e.mediaKeysSession.keyStatuses.forEach((a,o)=>{if(typeof o=="string"&&typeof a=="object"){const g=o;o=a,a=g}const c="buffer"in o?new Uint8Array(o.buffer,o.byteOffset,o.byteLength):new Uint8Array(o);e.keySystem===KeySystems.PLAYREADY&&c.length===16&&changeEndianness(c);const d=arrayToHex(c);a==="internal-error"&&(this.bannedKeyIds[d]=a),this.log(`key status change "${a}" for keyStatuses keyId: ${d} key-session "${e.mediaKeysSession.sessionId}"`),i[d]=a}),i}fetchServerCertificate(e){const i=this.config,a=i.loader,o=new a(i),c=this.getServerCertificateUrl(e);return c?(this.log(`Fetching server certificate for "${e}"`),new Promise((d,g)=>{const b={responseType:"arraybuffer",url:c},_=i.certLoadPolicy.default,j={loadPolicy:_,timeout:_.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},$={onSuccess:(_e,tt,et,st)=>{d(_e.data)},onError:(_e,tt,et,st)=>{g(new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:et,response:_objectSpread2({url:b.url,data:void 0},_e)},`"${e}" certificate request failed (${c}). Status: ${_e.code} (${_e.text})`))},onTimeout:(_e,tt,et)=>{g(new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:et,response:{url:b.url,data:void 0}},`"${e}" certificate request timed out (${c})`))},onAbort:(_e,tt,et)=>{g(new Error("aborted"))}};o.load(b,j,$)})):Promise.resolve()}setMediaKeysServerCertificate(e,i,a){return new Promise((o,c)=>{e.setServerCertificate(a).then(d=>{this.log(`setServerCertificate ${d?"success":"not supported by CDM"} (${a.byteLength}) on "${i}"`),o(e)}).catch(d=>{c(new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:d,fatal:!0},d.message))})})}renewLicense(e,i){return this.requestLicense(e,new Uint8Array(i)).then(a=>this.updateKeySession(e,new Uint8Array(a)).catch(o=>{throw new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_SESSION_UPDATE_FAILED,decryptdata:e.decryptdata,error:o,fatal:!1},o.message)}))}unpackPlayReadyKeyMessage(e,i){const a=String.fromCharCode.apply(null,new Uint16Array(i.buffer));if(!a.includes("PlayReadyKeyMessage"))return e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),i;const o=new DOMParser().parseFromString(a,"application/xml"),c=o.querySelectorAll("HttpHeader");if(c.length>0){let j;for(let $=0,_e=c.length;$<_e;$++){var d,g;j=c[$];const tt=(d=j.querySelector("name"))==null?void 0:d.textContent,et=(g=j.querySelector("value"))==null?void 0:g.textContent;tt&&et&&e.setRequestHeader(tt,et)}}const b=o.querySelector("Challenge"),_=b==null?void 0:b.textContent;if(!_)throw new Error("Cannot find <Challenge> in key message");return strToUtf8array(atob(_))}setupLicenseXHR(e,i,a,o){const c=this.config.licenseXhrSetup;return c?Promise.resolve().then(()=>{if(!a.decryptdata)throw new Error("Key removed");return c.call(this.hls,e,i,a,o)}).catch(d=>{if(!a.decryptdata)throw d;return e.open("POST",i,!0),c.call(this.hls,e,i,a,o)}).then(d=>(e.readyState||e.open("POST",i,!0),{xhr:e,licenseChallenge:d||o})):(e.open("POST",i,!0),Promise.resolve({xhr:e,licenseChallenge:o}))}requestLicense(e,i){const a=this.config.keyLoadPolicy.default;return new Promise((o,c)=>{const d=this.getLicenseServerUrlOrThrow(e.keySystem);this.log(`Sending license request to URL: ${d}`);const g=new XMLHttpRequest;g.responseType="arraybuffer",g.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return c(new Error("invalid state"));if(g.readyState===4)if(g.status===200){this._requestLicenseFailureCount=0;let b=g.response;this.log(`License received ${b instanceof ArrayBuffer?b.byteLength:b}`);const _=this.config.licenseResponseCallback;if(_)try{b=_.call(this.hls,g,d,e)}catch(j){this.error(j)}o(b)}else{const b=a.errorRetry,_=b?b.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>_||g.status>=400&&g.status<500)c(new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,decryptdata:e.decryptdata,fatal:!0,networkDetails:g,response:{url:d,data:void 0,code:g.status,text:g.statusText}},`License Request XHR failed (${d}). Status: ${g.status} (${g.statusText})`));else{const j=_-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${j} attempts left`),this.requestLicense(e,i).then(o,c)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=g,this.setupLicenseXHR(g,d,e,i).then(({xhr:b,licenseChallenge:_})=>{e.keySystem==KeySystems.PLAYREADY&&(_=this.unpackPlayReadyKeyMessage(b,_)),b.send(_)}).catch(c)})}onDestroying(){this.unregisterListeners(),this._clear()}onMediaAttached(e,i){if(!this.config.emeEnabled)return;const a=i.media;this.media=a,addEventListener(a,"encrypted",this.onMediaEncrypted),addEventListener(a,"waitingforkey",this.onWaitingForKey);const o=this.mediaResolved;o?o():this.mediaKeys=a.mediaKeys}onMediaDetached(){const e=this.media;e&&(removeEventListener(e,"encrypted",this.onMediaEncrypted),removeEventListener(e,"waitingforkey",this.onWaitingForKey),this.media=null,this.mediaKeys=null)}_clear(){var e;this._requestLicenseFailureCount=0,this.keyIdToKeySessionPromise={},this.bannedKeyIds={};const i=this.mediaResolved;if(i&&i(),!this.mediaKeys&&!this.mediaKeySessions.length)return;const a=this.media,o=this.mediaKeySessions.slice();this.mediaKeySessions=[],this.mediaKeys=null,LevelKey.clearKeyUriToKeyIdMap();const c=o.length;EMEController.CDMCleanupPromise=Promise.all(o.map(d=>this.removeSession(d)).concat((a==null||(e=a.setMediaKeys(null))==null?void 0:e.catch(d=>{this.log(`Could not clear media keys: ${d}`),this.hls&&this.hls.trigger(Events.ERROR,{type:ErrorTypes.OTHER_ERROR,details:ErrorDetails.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR,fatal:!1,error:new Error(`Could not clear media keys: ${d}`)})}))||Promise.resolve())).catch(d=>{this.log(`Could not close sessions and clear media keys: ${d}`),this.hls&&this.hls.trigger(Events.ERROR,{type:ErrorTypes.OTHER_ERROR,details:ErrorDetails.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close sessions and clear media keys: ${d}`)})}).then(()=>{c&&this.log("finished closing key sessions and clearing media keys")})}onManifestLoading(){this._clear()}onManifestLoaded(e,{sessionKeys:i}){if(!(!i||!this.config.emeEnabled)&&!this.keyFormatPromise){const a=i.reduce((o,c)=>(o.indexOf(c.keyFormat)===-1&&o.push(c.keyFormat),o),[]);this.log(`Selecting key-system from session-keys ${a.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(a)}}removeSession(e){const{mediaKeysSession:i,licenseXhr:a,decryptdata:o}=e;if(i){this.log(`Remove licenses and keys and close session "${i.sessionId}" keyId: ${arrayToHex((o==null?void 0:o.keyId)||[])}`),e._onmessage&&(i.removeEventListener("message",e._onmessage),e._onmessage=void 0),e._onkeystatuseschange&&(i.removeEventListener("keystatuseschange",e._onkeystatuseschange),e._onkeystatuseschange=void 0),a&&a.readyState!==XMLHttpRequest.DONE&&a.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const c=this.mediaKeySessions.indexOf(e);c>-1&&this.mediaKeySessions.splice(c,1);const{keyStatusTimeouts:d}=e;d&&Object.keys(d).forEach(_=>self.clearTimeout(d[_]));const{drmSystemOptions:g}=this.config;return(isPersistentSessionType(g)?new Promise((_,j)=>{self.setTimeout(()=>j(new Error("MediaKeySession.remove() timeout")),8e3),i.remove().then(_).catch(j)}):Promise.resolve()).catch(_=>{this.log(`Could not remove session: ${_}`),this.hls&&this.hls.trigger(Events.ERROR,{type:ErrorTypes.OTHER_ERROR,details:ErrorDetails.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR,fatal:!1,error:new Error(`Could not remove session: ${_}`)})}).then(()=>i.close()).catch(_=>{this.log(`Could not close session: ${_}`),this.hls&&this.hls.trigger(Events.ERROR,{type:ErrorTypes.OTHER_ERROR,details:ErrorDetails.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close session: ${_}`)})})}return Promise.resolve()}}EMEController.CDMCleanupPromise=void 0;function getKeyIdString(s){if(!s)throw new Error("Could not read keyId of undefined decryptdata");if(s.keyId===null)throw new Error("keyId is null");return arrayToHex(s.keyId)}function getKeyStatus(s,e){if(s.keyId&&e.mediaKeysSession.keyStatuses.has(s.keyId))return e.mediaKeysSession.keyStatuses.get(s.keyId);if(s.matches(e.decryptdata))return e.keyStatus}class EMEKeyError extends Error{constructor(e,i){super(i),this.data=void 0,e.error||(e.error=new Error(i)),this.data=e,e.err=e.error}}function getKeyStatusError(s,e){const i=s==="output-restricted",a=i?ErrorDetails.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:ErrorDetails.KEY_SYSTEM_STATUS_INTERNAL_ERROR;return new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:a,fatal:!1,decryptdata:e},i?"HDCP level output restricted":`key status changed to "${s}"`)}class FPSController{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(Events.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListeners(){this.hls.off(Events.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,i){const a=this.hls.config;if(a.capLevelOnFPSDrop){const o=i.media instanceof self.HTMLVideoElement?i.media:null;this.media=o,o&&typeof o.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),a.fpsDroppedMonitoringPeriod)}}onMediaDetaching(){this.media=null}checkFPS(e,i,a){const o=performance.now();if(i){if(this.lastTime){const c=o-this.lastTime,d=a-this.lastDroppedFrames,g=i-this.lastDecodedFrames,b=1e3*d/c,_=this.hls;if(_.trigger(Events.FPS_DROP,{currentDropped:d,currentDecoded:g,totalDroppedFrames:a}),b>0&&d>_.config.fpsDroppedMonitoringThreshold*g){let j=_.currentLevel;_.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+j),j>0&&(_.autoLevelCapping===-1||_.autoLevelCapping>=j)&&(j=j-1,_.trigger(Events.FPS_DROP_LEVEL_CAPPING,{level:j,droppedLevel:_.currentLevel}),_.autoLevelCapping=j,this.streamController.nextLevelSwitch())}}this.lastTime=o,this.lastDroppedFrames=a,this.lastDecodedFrames=i}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const i=e.getVideoPlaybackQuality();this.checkFPS(e,i.totalVideoFrames,i.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}function sendAddTrackEvent(s,e){let i;try{i=new Event("addtrack")}catch{i=document.createEvent("Event"),i.initEvent("addtrack",!1,!1)}i.track=s,e.dispatchEvent(i)}function addCueToTrack(s,e){const i=s.mode;if(i==="disabled"&&(s.mode="hidden"),s.cues&&!s.cues.getCueById(e.id))try{if(s.addCue(e),!s.cues.getCueById(e.id))throw new Error(`addCue is failed for: ${e}`)}catch(a){logger.debug(`[texttrack-utils]: ${a}`);try{const o=new self.TextTrackCue(e.startTime,e.endTime,e.text);o.id=e.id,s.addCue(o)}catch(o){logger.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${o}`)}}i==="disabled"&&(s.mode=i)}function clearCurrentCues(s,e){const i=s.mode;if(i==="disabled"&&(s.mode="hidden"),s.cues)for(let a=s.cues.length;a--;)e&&s.cues[a].removeEventListener("enter",e),s.removeCue(s.cues[a]);i==="disabled"&&(s.mode=i)}function removeCuesInRange(s,e,i,a){const o=s.mode;if(o==="disabled"&&(s.mode="hidden"),s.cues&&s.cues.length>0){const c=getCuesInRange(s.cues,e,i);for(let d=0;d<c.length;d++)(!a||a(c[d]))&&s.removeCue(c[d])}o==="disabled"&&(s.mode=o)}function getFirstCueIndexFromTime(s,e){if(e<=s[0].startTime)return 0;const i=s.length-1;if(e>s[i].endTime)return-1;let a=0,o=i,c;for(;a<=o;)if(c=Math.floor((o+a)/2),e<s[c].startTime)o=c-1;else if(e>s[c].startTime&&a<i)a=c+1;else return c;return s[a].startTime-e<e-s[o].startTime?a:o}function getCuesInRange(s,e,i){const a=[],o=getFirstCueIndexFromTime(s,e);if(o>-1)for(let c=o,d=s.length;c<d;c++){const g=s[c];if(g.startTime>=e&&g.endTime<=i)a.push(g);else if(g.startTime>i)return a}return a}function filterSubtitleTracks(s){const e=[];for(let i=0;i<s.length;i++){const a=s[i];(a.kind==="subtitles"||a.kind==="captions")&&a.label&&e.push(s[i])}return e}class SubtitleTrackController extends BasePlaylistController{constructor(e){super(e,"subtitle-track-controller"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let i=null;const a=filterSubtitleTracks(this.media.textTracks);for(let c=0;c<a.length;c++)if(a[c].mode==="hidden")i=a[c];else if(a[c].mode==="showing"){i=a[c];break}const o=this.findTrackForTextTrack(i);this.subtitleTrack!==o&&this.setSubtitleTrack(o)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:e}=this;e.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Events.MANIFEST_PARSED,this.onManifestParsed,this),e.on(Events.LEVEL_LOADING,this.onLevelLoading,this),e.on(Events.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(Events.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Events.MANIFEST_PARSED,this.onManifestParsed,this),e.off(Events.LEVEL_LOADING,this.onLevelLoading,this),e.off(Events.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(Events.ERROR,this.onError,this)}onMediaAttached(e,i){this.media=i.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,e)}onMediaDetaching(e,i){const a=this.media;if(!a)return;const o=!!i.transferMedia;if(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||a.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),this.subtitleTrack=-1,this.media=null,o)return;filterSubtitleTracks(a.textTracks).forEach(d=>{clearCurrentCues(d)})}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,i){this.tracks=i.subtitleTracks}onSubtitleTrackLoaded(e,i){const{id:a,groupId:o,details:c}=i,d=this.tracksInGroup[a];if(!d||d.groupId!==o){this.warn(`Subtitle track with id:${a} and group:${o} not found in active group ${d==null?void 0:d.groupId}`);return}const g=d.details;d.details=i.details,this.log(`Subtitle track ${a} "${d.name}" lang:${d.lang} group:${o} loaded [${c.startSN}-${c.endSN}]`),a===this.trackId&&this.playlistLoaded(a,i,g)}onLevelLoading(e,i){this.switchLevel(i.level)}onLevelSwitching(e,i){this.switchLevel(i.level)}switchLevel(e){const i=this.hls.levels[e];if(!i)return;const a=i.subtitleGroups||null,o=this.groupIds;let c=this.currentTrack;if(!a||(o==null?void 0:o.length)!==(a==null?void 0:a.length)||a!=null&&a.some(d=>(o==null?void 0:o.indexOf(d))===-1)){this.groupIds=a,this.trackId=-1,this.currentTrack=null;const d=this.tracks.filter(j=>!a||a.indexOf(j.groupId)!==-1);if(d.length)this.selectDefaultTrack&&!d.some(j=>j.default)&&(this.selectDefaultTrack=!1),d.forEach((j,$)=>{j.id=$});else if(!c&&!this.tracksInGroup.length)return;this.tracksInGroup=d;const g=this.hls.config.subtitlePreference;if(!c&&g){this.selectDefaultTrack=!1;const j=findMatchingOption(g,d);if(j>-1)c=d[j];else{const $=findMatchingOption(g,this.tracks);c=this.tracks[$]}}let b=this.findTrackId(c);b===-1&&c&&(b=this.findTrackId(null));const _={subtitleTracks:d};this.log(`Updating subtitle tracks, ${d.length} track(s) found in "${a==null?void 0:a.join(",")}" group-id`),this.hls.trigger(Events.SUBTITLE_TRACKS_UPDATED,_),b!==-1&&this.trackId===-1&&this.setSubtitleTrack(b)}}findTrackId(e){const i=this.tracksInGroup,a=this.selectDefaultTrack;for(let o=0;o<i.length;o++){const c=i[o];if(!(a&&!c.default||!a&&!e)&&(!e||matchesOption(c,e)))return o}if(e){for(let o=0;o<i.length;o++){const c=i[o];if(mediaAttributesIdentical(e.attrs,c.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return o}for(let o=0;o<i.length;o++){const c=i[o];if(mediaAttributesIdentical(e.attrs,c.attrs,["LANGUAGE"]))return o}}return-1}findTrackForTextTrack(e){if(e){const i=this.tracksInGroup;for(let a=0;a<i.length;a++){const o=i[a];if(subtitleTrackMatchesTextTrack(o,e))return a}}return-1}onError(e,i){i.fatal||!i.context||i.context.type===PlaylistContextType.SUBTITLE_TRACK&&i.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(i.context.groupId)!==-1)&&this.checkRetry(i)}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e)}setSubtitleOption(e){if(this.hls.config.subtitlePreference=e,e){if(e.id===-1)return this.setSubtitleTrack(-1),null;const i=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,i.length){const a=this.currentTrack;if(a&&matchesOption(e,a))return a;const o=findMatchingOption(e,this.tracksInGroup);if(o>-1){const c=this.tracksInGroup[o];return this.setSubtitleTrack(o),c}else{if(a)return null;{const c=findMatchingOption(e,i);if(c>-1)return i[c]}}}}return null}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentTrack)&&this.scheduleLoading(this.currentTrack,e)}loadingPlaylist(e,i){super.loadingPlaylist(e,i);const a=e.id,o=e.groupId,c=this.getUrlWithDirectives(e.url,i),d=e.details,g=d==null?void 0:d.age;this.log(`Loading subtitle ${a} "${e.name}" lang:${e.lang} group:${o}${(i==null?void 0:i.msn)!==void 0?" at sn "+i.msn+" part "+i.part:""}${g&&d.live?" age "+g.toFixed(1)+(d.type&&" "+d.type||""):""} ${c}`),this.hls.trigger(Events.SUBTITLE_TRACK_LOADING,{url:c,id:a,groupId:o,deliveryDirectives:i||null,track:e})}toggleTrackModes(){const{media:e}=this;if(!e)return;const i=filterSubtitleTracks(e.textTracks),a=this.currentTrack;let o;if(a&&(o=i.filter(c=>subtitleTrackMatchesTextTrack(a,c))[0],o||this.warn(`Unable to find subtitle TextTrack with name "${a.name}" and language "${a.lang}"`)),[].slice.call(i).forEach(c=>{c.mode!=="disabled"&&c!==o&&(c.mode="disabled")}),o){const c=this.subtitleDisplay?"showing":"hidden";o.mode!==c&&(o.mode=c)}}setSubtitleTrack(e){const i=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=e;return}if(e<-1||e>=i.length||!isFiniteNumber(e)){this.warn(`Invalid subtitle track id: ${e}`);return}this.selectDefaultTrack=!1;const a=this.currentTrack,o=i[e]||null;if(this.trackId=e,this.currentTrack=o,this.toggleTrackModes(),!o){this.hls.trigger(Events.SUBTITLE_TRACK_SWITCH,{id:e});return}const c=!!o.details&&!o.details.live;if(e===this.trackId&&o===a&&c)return;this.log(`Switching to subtitle-track ${e}`+(o?` "${o.name}" lang:${o.lang} group:${o.groupId}`:""));const{id:d,groupId:g="",name:b,type:_,url:j}=o;this.hls.trigger(Events.SUBTITLE_TRACK_SWITCH,{id:d,groupId:g,name:b,type:_,url:j});const $=this.switchParams(o.url,a==null?void 0:a.details,o.details);this.loadPlaylist($)}}function uuid(){try{return crypto.randomUUID()}catch{try{const e=URL.createObjectURL(new Blob),i=e.toString();return URL.revokeObjectURL(e),i.slice(i.lastIndexOf("/")+1)}catch{let i=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,o=>{const c=(i+Math.random()*16)%16|0;return i=Math.floor(i/16),(o=="x"?c:c&3|8).toString(16)})}}}function hash(s){let e=5381,i=s.length;for(;i;)e=e*33^s.charCodeAt(--i);return(e>>>0).toString()}const ALIGNED_END_THRESHOLD_SECONDS=.025;let TimelineOccupancy=function(s){return s[s.Point=0]="Point",s[s.Range=1]="Range",s}({});function generateAssetIdentifier(s,e,i){return`${s.identifier}-${i+1}-${hash(e)}`}class InterstitialEvent{constructor(e,i){this.base=void 0,this._duration=null,this._timelineStart=null,this.appendInPlaceDisabled=void 0,this.appendInPlaceStarted=void 0,this.dateRange=void 0,this.hasPlayed=!1,this.cumulativeDuration=0,this.resumeOffset=NaN,this.playoutLimit=NaN,this.restrictions={skip:!1,jump:!1},this.snapOptions={out:!1,in:!1},this.assetList=[],this.assetListLoader=void 0,this.assetListResponse=null,this.resumeAnchor=void 0,this.error=void 0,this.resetOnResume=void 0,this.base=i,this.dateRange=e,this.setDateRange(e)}setDateRange(e){this.dateRange=e,this.resumeOffset=e.attr.optionalFloat("X-RESUME-OFFSET",this.resumeOffset),this.playoutLimit=e.attr.optionalFloat("X-PLAYOUT-LIMIT",this.playoutLimit),this.restrictions=e.attr.enumeratedStringList("X-RESTRICT",this.restrictions),this.snapOptions=e.attr.enumeratedStringList("X-SNAP",this.snapOptions)}reset(){var e;this.appendInPlaceStarted=!1,(e=this.assetListLoader)==null||e.destroy(),this.assetListLoader=void 0,this.supplementsPrimary||(this.assetListResponse=null,this.assetList=[],this._duration=null)}isAssetPastPlayoutLimit(e){var i;if(e>0&&e>=this.assetList.length)return!0;const a=this.playoutLimit;return e<=0||isNaN(a)?!1:a===0?!0:(((i=this.assetList[e])==null?void 0:i.startOffset)||0)>a}findAssetIndex(e){return this.assetList.indexOf(e)}get identifier(){return this.dateRange.id}get startDate(){return this.dateRange.startDate}get startTime(){const e=this.dateRange.startTime;if(this.snapOptions.out){const i=this.dateRange.tagAnchor;if(i)return getSnapToFragmentTime(e,i)}return e}get startOffset(){return this.cue.pre?0:this.startTime}get startIsAligned(){if(this.startTime===0||this.snapOptions.out)return!0;const e=this.dateRange.tagAnchor;if(e){const i=this.dateRange.startTime,a=getSnapToFragmentTime(i,e);return i-a<.1}return!1}get resumptionOffset(){const e=this.resumeOffset,i=isFiniteNumber(e)?e:this.duration;return this.cumulativeDuration+i}get resumeTime(){const e=this.startOffset+this.resumptionOffset;if(this.snapOptions.in){const i=this.resumeAnchor;if(i)return getSnapToFragmentTime(e,i)}return e}get appendInPlace(){return this.appendInPlaceStarted?!0:this.appendInPlaceDisabled?!1:!!(!this.cue.once&&!this.cue.pre&&this.startIsAligned&&(isNaN(this.playoutLimit)&&isNaN(this.resumeOffset)||this.resumeOffset&&this.duration&&Math.abs(this.resumeOffset-this.duration)<ALIGNED_END_THRESHOLD_SECONDS))}set appendInPlace(e){if(this.appendInPlaceStarted){this.resetOnResume=!e;return}this.appendInPlaceDisabled=!e}get timelineStart(){return this._timelineStart!==null?this._timelineStart:this.startTime}set timelineStart(e){this._timelineStart=e}get duration(){const e=this.playoutLimit;let i;return this._duration!==null?i=this._duration:this.dateRange.duration?i=this.dateRange.duration:i=this.dateRange.plannedDuration||0,!isNaN(e)&&e<i&&(i=e),i}set duration(e){this._duration=e}get cue(){return this.dateRange.cue}get timelineOccupancy(){return this.dateRange.attr["X-TIMELINE-OCCUPIES"]==="RANGE"?TimelineOccupancy.Range:TimelineOccupancy.Point}get supplementsPrimary(){return this.dateRange.attr["X-TIMELINE-STYLE"]==="PRIMARY"}get contentMayVary(){return this.dateRange.attr["X-CONTENT-MAY-VARY"]!=="NO"}get assetUrl(){return this.dateRange.attr["X-ASSET-URI"]}get assetListUrl(){return this.dateRange.attr["X-ASSET-LIST"]}get baseUrl(){return this.base.url}get assetListLoaded(){return this.assetList.length>0||this.assetListResponse!==null}toString(){return eventToString(this)}}function getSnapToFragmentTime(s,e){return s-e.start<e.duration/2&&!(Math.abs(s-(e.start+e.duration))<ALIGNED_END_THRESHOLD_SECONDS)?e.start:e.start+e.duration}function getInterstitialUrl(s,e,i){const a=new self.URL(s,i);return a.protocol!=="data:"&&a.searchParams.set("_HLS_primary_id",e),a}function getNextAssetIndex(s,e){for(;(i=s.assetList[++e])!=null&&i.error;)var i;return e}function eventToString(s){return`["${s.identifier}" ${s.cue.pre?"<pre>":s.cue.post?"<post>":""}${s.timelineStart.toFixed(2)}-${s.resumeTime.toFixed(2)}]`}function eventAssetToString(s){const e=s.timelineStart,i=s.duration||0;return`["${s.identifier}" ${e.toFixed(2)}-${(e+i).toFixed(2)}]`}class HlsAssetPlayer{constructor(e,i,a,o){this.hls=void 0,this.interstitial=void 0,this.assetItem=void 0,this.tracks=null,this.hasDetails=!1,this.mediaAttached=null,this._currentTime=void 0,this._bufferedEosTime=void 0,this.checkPlayout=()=>{this.reachedPlayout(this.currentTime)&&this.hls&&this.hls.trigger(Events.PLAYOUT_LIMIT_REACHED,{})};const c=this.hls=new e(i);this.interstitial=a,this.assetItem=o;const d=()=>{this.hasDetails=!0};c.once(Events.LEVEL_LOADED,d),c.once(Events.AUDIO_TRACK_LOADED,d),c.once(Events.SUBTITLE_TRACK_LOADED,d),c.on(Events.MEDIA_ATTACHING,(g,{media:b})=>{this.removeMediaListeners(),this.mediaAttached=b,this.interstitial.playoutLimit&&(b.addEventListener("timeupdate",this.checkPlayout),this.appendInPlace&&c.on(Events.BUFFER_APPENDED,()=>{const j=this.bufferedEnd;this.reachedPlayout(j)&&(this._bufferedEosTime=j,c.trigger(Events.BUFFERED_TO_END,void 0))}))})}get appendInPlace(){return this.interstitial.appendInPlace}loadSource(){const e=this.hls;if(e)if(e.url)e.levels.length&&!e.started&&e.startLoad(-1,!0);else{let i=this.assetItem.uri;try{i=getInterstitialUrl(i,e.config.primarySessionId||"").href}catch{}e.loadSource(i)}}bufferedInPlaceToEnd(e){var i;if(!this.appendInPlace)return!1;if((i=this.hls)!=null&&i.bufferedToEnd)return!0;if(!e)return!1;const a=Math.min(this._bufferedEosTime||1/0,this.duration),o=this.timelineOffset,c=BufferHelper.bufferInfo(e,o,0);return this.getAssetTime(c.end)>=a-.02}reachedPlayout(e){const a=this.interstitial.playoutLimit;return this.startOffset+e>=a}get destroyed(){var e;return!((e=this.hls)!=null&&e.userConfig)}get assetId(){return this.assetItem.identifier}get interstitialId(){return this.assetItem.parentIdentifier}get media(){var e;return((e=this.hls)==null?void 0:e.media)||null}get bufferedEnd(){const e=this.media||this.mediaAttached;if(!e)return this._bufferedEosTime?this._bufferedEosTime:this.currentTime;const i=BufferHelper.bufferInfo(e,e.currentTime,.001);return this.getAssetTime(i.end)}get currentTime(){const e=this.media||this.mediaAttached;return e?this.getAssetTime(e.currentTime):this._currentTime||0}get duration(){const e=this.assetItem.duration;if(!e)return 0;const i=this.interstitial.playoutLimit;if(i){const a=i-this.startOffset;if(a>0&&a<e)return a}return e}get remaining(){const e=this.duration;return e?Math.max(0,e-this.currentTime):0}get startOffset(){return this.assetItem.startOffset}get timelineOffset(){var e;return((e=this.hls)==null?void 0:e.config.timelineOffset)||0}set timelineOffset(e){const i=this.timelineOffset;if(e!==i){const a=e-i;if(Math.abs(a)>1/9e4&&this.hls){if(this.hasDetails)throw new Error("Cannot set timelineOffset after playlists are loaded");this.hls.config.timelineOffset=e}}}getAssetTime(e){const i=this.timelineOffset,a=this.duration;return Math.min(Math.max(0,e-i),a)}removeMediaListeners(){const e=this.mediaAttached;e&&(this._currentTime=e.currentTime,this.bufferSnapShot(),e.removeEventListener("timeupdate",this.checkPlayout))}bufferSnapShot(){if(this.mediaAttached){var e;(e=this.hls)!=null&&e.bufferedToEnd&&(this._bufferedEosTime=this.bufferedEnd)}}destroy(){this.removeMediaListeners(),this.hls&&this.hls.destroy(),this.hls=null,this.tracks=this.mediaAttached=this.checkPlayout=null}attachMedia(e){var i;this.loadSource(),(i=this.hls)==null||i.attachMedia(e)}detachMedia(){var e;this.removeMediaListeners(),this.mediaAttached=null,(e=this.hls)==null||e.detachMedia()}resumeBuffering(){var e;(e=this.hls)==null||e.resumeBuffering()}pauseBuffering(){var e;(e=this.hls)==null||e.pauseBuffering()}transferMedia(){var e;return this.bufferSnapShot(),((e=this.hls)==null?void 0:e.transferMedia())||null}resetDetails(){const e=this.hls;if(e&&this.hasDetails){e.stopLoad();const i=a=>delete a.details;e.levels.forEach(i),e.allAudioTracks.forEach(i),e.allSubtitleTracks.forEach(i),this.hasDetails=!1}}on(e,i,a){var o;(o=this.hls)==null||o.on(e,i)}once(e,i,a){var o;(o=this.hls)==null||o.once(e,i)}off(e,i,a){var o;(o=this.hls)==null||o.off(e,i)}toString(){var e;return`HlsAssetPlayer: ${eventAssetToString(this.assetItem)} ${(e=this.hls)==null?void 0:e.sessionId} ${this.appendInPlace?"append-in-place":""}`}}const ABUTTING_THRESHOLD_SECONDS=.033;class InterstitialsSchedule extends Logger{constructor(e,i){super("interstitials-sched",i),this.onScheduleUpdate=void 0,this.eventMap={},this.events=null,this.items=null,this.durations={primary:0,playout:0,integrated:0},this.onScheduleUpdate=e}destroy(){this.reset(),this.onScheduleUpdate=null}reset(){this.eventMap={},this.setDurations(0,0,0),this.events&&this.events.forEach(e=>e.reset()),this.events=this.items=null}resetErrorsInRange(e,i){return this.events?this.events.reduce((a,o)=>e<=o.startOffset&&i>o.startOffset?(delete o.error,a+1):a,0):0}get duration(){const e=this.items;return e?e[e.length-1].end:0}get length(){return this.items?this.items.length:0}getEvent(e){return e&&this.eventMap[e]||null}hasEvent(e){return e in this.eventMap}findItemIndex(e,i){if(e.event)return this.findEventIndex(e.event.identifier);let a=-1;e.nextEvent?a=this.findEventIndex(e.nextEvent.identifier)-1:e.previousEvent&&(a=this.findEventIndex(e.previousEvent.identifier)+1);const o=this.items;if(o)for(o[a]||(i===void 0&&(i=e.start),a=this.findItemIndexAtTime(i));a>=0&&(c=o[a])!=null&&c.event;){var c;a--}return a}findItemIndexAtTime(e,i){const a=this.items;if(a)for(let o=0;o<a.length;o++){let c=a[o];if(i&&i!=="primary"&&(c=c[i]),e===c.start||e>c.start&&e<c.end)return o}return-1}findJumpRestrictedIndex(e,i){const a=this.items;if(a)for(let o=e;o<=i&&a[o];o++){const c=a[o].event;if(c!=null&&c.restrictions.jump&&!c.appendInPlace)return o}return-1}findEventIndex(e){const i=this.items;if(i)for(let o=i.length;o--;){var a;if(((a=i[o].event)==null?void 0:a.identifier)===e)return o}return-1}findAssetIndex(e,i){const a=e.assetList,o=a.length;if(o>1)for(let c=0;c<o;c++){const d=a[c];if(!d.error){const g=d.timelineStart;if(i===g||i>g&&(i<g+(d.duration||0)||c===o-1))return c}}return 0}get assetIdAtEnd(){var e;const i=(e=this.items)==null||(e=e[this.length-1])==null?void 0:e.event;if(i){const a=i.assetList,o=a[a.length-1];if(o)return o.identifier}return null}parseInterstitialDateRanges(e,i){const a=e.main.details,{dateRanges:o}=a,c=this.events,d=this.parseDateRanges(o,{url:a.url},i),g=Object.keys(o),b=c?c.filter(_=>!g.includes(_.identifier)):[];d.length&&d.sort((_,j)=>{const $=_.cue.pre,_e=_.cue.post,tt=j.cue.pre,et=j.cue.post;if($&&!tt)return-1;if(tt&&!$||_e&&!et)return 1;if(et&&!_e)return-1;if(!$&&!tt&&!_e&&!et){const st=_.startTime,at=j.startTime;if(st!==at)return st-at}return _.dateRange.tagOrder-j.dateRange.tagOrder}),this.events=d,b.forEach(_=>{this.removeEvent(_)}),this.updateSchedule(e,b)}updateSchedule(e,i=[],a=!1){const o=this.events||[];if(o.length||i.length||this.length<2){const c=this.items,d=this.parseSchedule(o,e);(a||i.length||(c==null?void 0:c.length)!==d.length||d.some((b,_)=>Math.abs(b.playout.start-c[_].playout.start)>.005||Math.abs(b.playout.end-c[_].playout.end)>.005))&&(this.items=d,this.onScheduleUpdate(i,c))}}parseDateRanges(e,i,a){const o=[],c=Object.keys(e);for(let d=0;d<c.length;d++){const g=c[d],b=e[g];if(b.isInterstitial){let _=this.eventMap[g];_?_.setDateRange(b):(_=new InterstitialEvent(b,i),this.eventMap[g]=_,a===!1&&(_.appendInPlace=a)),o.push(_)}}return o}parseSchedule(e,i){const a=[],o=i.main.details,c=o.live?1/0:o.edge;let d=0;if(e=e.filter(b=>!b.error&&!(b.cue.once&&b.hasPlayed)),e.length){this.resolveOffsets(e,i);let b=0,_=0;if(e.forEach((j,$)=>{const _e=j.cue.pre,tt=j.cue.post,et=e[$-1]||null,st=j.appendInPlace,at=tt?c:j.startOffset,rt=j.duration,nt=j.timelineOccupancy===TimelineOccupancy.Range?rt:0,it=j.resumptionOffset,ot=(et==null?void 0:et.startTime)===at,lt=at+j.cumulativeDuration;let ct=st?lt+rt:at+it;if(_e||!tt&&at<=0){const dt=_;_+=nt,j.timelineStart=lt;const gt=d;d+=rt,a.push({event:j,start:lt,end:ct,playout:{start:gt,end:d},integrated:{start:dt,end:_}})}else if(at<=c){if(!ot){const vt=at-b;if(vt>ABUTTING_THRESHOLD_SECONDS){const St=b,Tt=_;_+=vt;const Ct=d;d+=vt;const Rt={previousEvent:e[$-1]||null,nextEvent:j,start:St,end:St+vt,playout:{start:Ct,end:d},integrated:{start:Tt,end:_}};a.push(Rt)}else vt>0&&et&&(et.cumulativeDuration+=vt,a[a.length-1].end=at)}tt&&(ct=lt),j.timelineStart=lt;const dt=_;_+=nt;const gt=d;d+=rt,a.push({event:j,start:lt,end:ct,playout:{start:gt,end:d},integrated:{start:dt,end:_}})}else return;const ht=j.resumeTime;tt||ht>c?b=c:b=ht}),b<c){var g;const j=b,$=_,_e=c-b;_+=_e;const tt=d;d+=_e,a.push({previousEvent:((g=a[a.length-1])==null?void 0:g.event)||null,nextEvent:null,start:b,end:j+_e,playout:{start:tt,end:d},integrated:{start:$,end:_}})}this.setDurations(c,d,_)}else a.push({previousEvent:null,nextEvent:null,start:0,end:c,playout:{start:0,end:c},integrated:{start:0,end:c}}),this.setDurations(c,c,c);return a}setDurations(e,i,a){this.durations={primary:e,playout:i,integrated:a}}resolveOffsets(e,i){const a=i.main.details,o=a.live?1/0:a.edge;let c=0,d=-1;e.forEach((g,b)=>{const _=g.cue.pre,j=g.cue.post,$=_?0:j?o:g.startTime;this.updateAssetDurations(g),d===$?g.cumulativeDuration=c:(c=0,d=$),!j&&g.snapOptions.in&&(g.resumeAnchor=findFragmentByPTS(null,a.fragments,g.startOffset+g.resumptionOffset,0,0)||void 0),g.appendInPlace&&!g.appendInPlaceStarted&&(this.primaryCanResumeInPlaceAt(g,i)||(g.appendInPlace=!1)),!g.appendInPlace&&b+1<e.length&&e[b+1].startTime-e[b].resumeTime<ABUTTING_THRESHOLD_SECONDS&&(e[b+1].appendInPlace=!1,e[b+1].appendInPlace&&this.warn(`Could not change append strategy for abutting event ${g}`));const tt=isFiniteNumber(g.resumeOffset)?g.resumeOffset:g.duration;c+=tt})}primaryCanResumeInPlaceAt(e,i){const a=e.resumeTime,o=e.startTime+e.resumptionOffset;return Math.abs(a-o)>ALIGNED_END_THRESHOLD_SECONDS?(this.log(`"${e.identifier}" resumption ${a} not aligned with estimated timeline end ${o}`),!1):!Object.keys(i).some(d=>{const g=i[d].details,b=g.edge;if(a>=b)return this.log(`"${e.identifier}" resumption ${a} past ${d} playlist end ${b}`),!1;const _=findFragmentByPTS(null,g.fragments,a);if(!_)return this.log(`"${e.identifier}" resumption ${a} does not align with any fragments in ${d} playlist (${g.fragStart}-${g.fragmentEnd})`),!0;const j=d==="audio"?.175:0;return Math.abs(_.start-a)<ALIGNED_END_THRESHOLD_SECONDS+j||Math.abs(_.end-a)<ALIGNED_END_THRESHOLD_SECONDS+j?!1:(this.log(`"${e.identifier}" resumption ${a} not aligned with ${d} fragment bounds (${_.start}-${_.end} sn: ${_.sn} cc: ${_.cc})`),!0)})}updateAssetDurations(e){if(!e.assetListLoaded)return;const i=e.timelineStart;let a=0,o=!1,c=!1;for(let d=0;d<e.assetList.length;d++){const g=e.assetList[d],b=i+a;g.startOffset=a,g.timelineStart=b,o||(o=g.duration===null),c||(c=!!g.error);const _=g.error?0:g.duration||0;a+=_}o&&!c?e.duration=Math.max(a,e.duration):e.duration=a}removeEvent(e){e.reset(),delete this.eventMap[e.identifier]}}function segmentToString(s){return`[${s.event?'"'+s.event.identifier+'"':"primary"}: ${s.start.toFixed(2)}-${s.end.toFixed(2)}]`}class AssetListLoader{constructor(e){this.hls=void 0,this.hls=e}destroy(){this.hls=null}loadAssetList(e,i){const a=e.assetListUrl;let o;try{o=getInterstitialUrl(a,this.hls.sessionId,e.baseUrl)}catch(_e){const tt=this.assignAssetListError(e,ErrorDetails.ASSET_LIST_LOAD_ERROR,_e,a);this.hls.trigger(Events.ERROR,tt);return}i&&o.protocol!=="data:"&&o.searchParams.set("_HLS_start_offset",""+i);const c=this.hls.config,d=c.loader,g=new d(c),b={responseType:"json",url:o.href},_=c.interstitialAssetListLoadPolicy.default,j={loadPolicy:_,timeout:_.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},$={onSuccess:(_e,tt,et,st)=>{const at=_e.data,rt=at==null?void 0:at.ASSETS;if(!Array.isArray(rt)){const nt=this.assignAssetListError(e,ErrorDetails.ASSET_LIST_PARSING_ERROR,new Error("Invalid interstitial asset list"),et.url,tt,st);this.hls.trigger(Events.ERROR,nt);return}e.assetListResponse=at,this.hls.trigger(Events.ASSET_LIST_LOADED,{event:e,assetListResponse:at,networkDetails:st})},onError:(_e,tt,et,st)=>{const at=this.assignAssetListError(e,ErrorDetails.ASSET_LIST_LOAD_ERROR,new Error(`Error loading X-ASSET-LIST: HTTP status ${_e.code} ${_e.text} (${tt.url})`),tt.url,st,et);this.hls.trigger(Events.ERROR,at)},onTimeout:(_e,tt,et)=>{const st=this.assignAssetListError(e,ErrorDetails.ASSET_LIST_LOAD_TIMEOUT,new Error(`Timeout loading X-ASSET-LIST (${tt.url})`),tt.url,_e,et);this.hls.trigger(Events.ERROR,st)}};return g.load(b,j,$),this.hls.trigger(Events.ASSET_LIST_LOADING,{event:e}),g}assignAssetListError(e,i,a,o,c,d){return e.error=a,{type:ErrorTypes.NETWORK_ERROR,details:i,fatal:!1,interstitial:e,url:o,error:a,networkDetails:d,stats:c}}}function playWithCatch(s){var e;s==null||(e=s.play())==null||e.catch(()=>{})}function timelineMessage(s,e){return`[${s}] Advancing timeline position to ${e}`}class InterstitialsController extends Logger{constructor(e,i){super("interstitials",e.logger),this.HlsPlayerClass=void 0,this.hls=void 0,this.assetListLoader=void 0,this.mediaSelection=null,this.altSelection=null,this.media=null,this.detachedData=null,this.requiredTracks=null,this.manager=null,this.playerQueue=[],this.bufferedPos=-1,this.timelinePos=-1,this.schedule=void 0,this.playingItem=null,this.bufferingItem=null,this.waitingItem=null,this.endedItem=null,this.playingAsset=null,this.endedAsset=null,this.bufferingAsset=null,this.shouldPlay=!1,this.onPlay=()=>{this.shouldPlay=!0},this.onPause=()=>{this.shouldPlay=!1},this.onSeeking=()=>{const a=this.currentTime;if(a===void 0||this.playbackDisabled||!this.schedule)return;const o=a-this.timelinePos;if(Math.abs(o)<1/7056e5)return;const d=o<=-.01;this.timelinePos=a,this.bufferedPos=a;const g=this.playingItem;if(!g){this.checkBuffer();return}if(d&&this.schedule.resetErrorsInRange(a,a-o)&&this.updateSchedule(!0),this.checkBuffer(),d&&a<g.start||a>=g.end){var b;const tt=this.findItemIndex(g);let et=this.schedule.findItemIndexAtTime(a);if(et===-1&&(et=tt+(d?-1:1),this.log(`seeked ${d?"back ":""}to position not covered by schedule ${a} (resolving from ${tt} to ${et})`)),!this.isInterstitial(g)&&(b=this.media)!=null&&b.paused&&(this.shouldPlay=!1),!d&&et>tt){const st=this.schedule.findJumpRestrictedIndex(tt+1,et);if(st>tt){this.setSchedulePosition(st);return}}this.setSchedulePosition(et);return}const _=this.playingAsset;if(!_){if(this.playingLastItem&&this.isInterstitial(g)){const tt=g.event.assetList[0];tt&&(this.endedItem=this.playingItem,this.playingItem=null,this.setScheduleToAssetAtTime(a,tt))}return}const j=_.timelineStart,$=_.duration||0;if(d&&a<j||a>=j+$){var _e;(_e=g.event)!=null&&_e.appendInPlace&&(this.clearInterstitial(g.event,g),this.flushFrontBuffer(a)),this.setScheduleToAssetAtTime(a,_)}},this.onTimeupdate=()=>{const a=this.currentTime;if(a===void 0||this.playbackDisabled)return;if(a>this.timelinePos)this.timelinePos=a,a>this.bufferedPos&&this.checkBuffer();else return;const o=this.playingItem;if(!o||this.playingLastItem)return;if(a>=o.end){this.timelinePos=o.end;const g=this.findItemIndex(o);this.setSchedulePosition(g+1)}const c=this.playingAsset;if(!c)return;const d=c.timelineStart+(c.duration||0);a>=d&&this.setScheduleToAssetAtTime(a,c)},this.onScheduleUpdate=(a,o)=>{const c=this.schedule;if(!c)return;const d=this.playingItem,g=c.events||[],b=c.items||[],_=c.durations,j=a.map(st=>st.identifier),$=!!(g.length||j.length);($||o)&&this.log(`INTERSTITIALS_UPDATED (${g.length}): ${g}
Schedule: ${b.map(st=>segmentToString(st))} pos: ${this.timelinePos}`),j.length&&this.log(`Removed events ${j}`);let _e=null,tt=null;d&&(_e=this.updateItem(d,this.timelinePos),this.itemsMatch(d,_e)?this.playingItem=_e:this.waitingItem=this.endedItem=null),this.waitingItem=this.updateItem(this.waitingItem),this.endedItem=this.updateItem(this.endedItem);const et=this.bufferingItem;if(et&&(tt=this.updateItem(et,this.bufferedPos),this.itemsMatch(et,tt)?this.bufferingItem=tt:et.event&&(this.bufferingItem=this.playingItem,this.clearInterstitial(et.event,null))),a.forEach(st=>{st.assetList.forEach(at=>{this.clearAssetPlayer(at.identifier,null)})}),this.playerQueue.forEach(st=>{if(st.interstitial.appendInPlace){const at=st.assetItem.timelineStart,rt=st.timelineOffset-at;if(rt)try{st.timelineOffset=at}catch(nt){Math.abs(rt)>ALIGNED_END_THRESHOLD_SECONDS&&this.warn(`${nt} ("${st.assetId}" ${st.timelineOffset}->${at})`)}}}),$||o){if(this.hls.trigger(Events.INTERSTITIALS_UPDATED,{events:g.slice(0),schedule:b.slice(0),durations:_,removedIds:j}),this.isInterstitial(d)&&j.includes(d.event.identifier)){this.warn(`Interstitial "${d.event.identifier}" removed while playing`),this.primaryFallback(d.event);return}d&&this.trimInPlace(_e,d),et&&tt!==_e&&this.trimInPlace(tt,et),this.checkBuffer()}},this.hls=e,this.HlsPlayerClass=i,this.assetListLoader=new AssetListLoader(e),this.schedule=new InterstitialsSchedule(this.onScheduleUpdate,e.logger),this.registerListeners()}registerListeners(){const e=this.hls;e&&(e.on(Events.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Events.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(Events.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.on(Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(Events.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.on(Events.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.on(Events.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.on(Events.BUFFER_APPENDED,this.onBufferAppended,this),e.on(Events.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(Events.BUFFERED_TO_END,this.onBufferedToEnd,this),e.on(Events.MEDIA_ENDED,this.onMediaEnded,this),e.on(Events.ERROR,this.onError,this),e.on(Events.DESTROYING,this.onDestroying,this))}unregisterListeners(){const e=this.hls;e&&(e.off(Events.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Events.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(Events.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.off(Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(Events.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.off(Events.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.off(Events.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.off(Events.BUFFER_CODECS,this.onBufferCodecs,this),e.off(Events.BUFFER_APPENDED,this.onBufferAppended,this),e.off(Events.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(Events.BUFFERED_TO_END,this.onBufferedToEnd,this),e.off(Events.MEDIA_ENDED,this.onMediaEnded,this),e.off(Events.ERROR,this.onError,this),e.off(Events.DESTROYING,this.onDestroying,this))}startLoad(){this.resumeBuffering()}stopLoad(){this.pauseBuffering()}resumeBuffering(){var e;(e=this.getBufferingPlayer())==null||e.resumeBuffering()}pauseBuffering(){var e;(e=this.getBufferingPlayer())==null||e.pauseBuffering()}destroy(){this.unregisterListeners(),this.stopLoad(),this.assetListLoader&&this.assetListLoader.destroy(),this.emptyPlayerQueue(),this.clearScheduleState(),this.schedule&&this.schedule.destroy(),this.media=this.detachedData=this.mediaSelection=this.requiredTracks=this.altSelection=this.schedule=this.manager=null,this.hls=this.HlsPlayerClass=this.log=null,this.assetListLoader=null,this.onPlay=this.onPause=this.onSeeking=this.onTimeupdate=null,this.onScheduleUpdate=null}onDestroying(){const e=this.primaryMedia||this.media;e&&this.removeMediaListeners(e)}removeMediaListeners(e){removeEventListener(e,"play",this.onPlay),removeEventListener(e,"pause",this.onPause),removeEventListener(e,"seeking",this.onSeeking),removeEventListener(e,"timeupdate",this.onTimeupdate)}onMediaAttaching(e,i){const a=this.media=i.media;addEventListener(a,"seeking",this.onSeeking),addEventListener(a,"timeupdate",this.onTimeupdate),addEventListener(a,"play",this.onPlay),addEventListener(a,"pause",this.onPause)}onMediaAttached(e,i){const a=this.effectivePlayingItem,o=this.detachedData;if(this.detachedData=null,a===null)this.checkStart();else if(!o){this.clearScheduleState();const c=this.findItemIndex(a);this.setSchedulePosition(c)}}clearScheduleState(){this.log("clear schedule state"),this.playingItem=this.bufferingItem=this.waitingItem=this.endedItem=this.playingAsset=this.endedAsset=this.bufferingAsset=null}onMediaDetaching(e,i){const a=!!i.transferMedia,o=this.media;if(this.media=null,!a&&(o&&this.removeMediaListeners(o),this.detachedData)){const c=this.getBufferingPlayer();c&&(this.log(`Removing schedule state for detachedData and ${c}`),this.playingAsset=this.endedAsset=this.bufferingAsset=this.bufferingItem=this.waitingItem=this.detachedData=null,c.detachMedia()),this.shouldPlay=!1}}get interstitialsManager(){if(!this.hls)return null;if(this.manager)return this.manager;const e=this,i=()=>e.bufferingItem||e.waitingItem,a=$=>$&&e.getAssetPlayer($.identifier),o=($,_e,tt,et,st)=>{if($){let at=$[_e].start;const rt=$.event;if(rt){if(_e==="playout"||rt.timelineOccupancy!==TimelineOccupancy.Point){const nt=a(tt);(nt==null?void 0:nt.interstitial)===rt&&(at+=nt.assetItem.startOffset+nt[st])}}else{const nt=et==="bufferedPos"?d():e[et];at+=nt-$.start}return at}return 0},c=($,_e)=>{var tt;if($!==0&&_e!=="primary"&&(tt=e.schedule)!=null&&tt.length){var et;const st=e.schedule.findItemIndexAtTime($),at=(et=e.schedule.items)==null?void 0:et[st];if(at){const rt=at[_e].start-at.start;return $+rt}}return $},d=()=>{const $=e.bufferedPos;return $===Number.MAX_VALUE?g("primary"):Math.max($,0)},g=$=>{var _e,tt;return(_e=e.primaryDetails)!=null&&_e.live?e.primaryDetails.edge:((tt=e.schedule)==null?void 0:tt.durations[$])||0},b=($,_e)=>{var tt,et;const st=e.effectivePlayingItem;if(st!=null&&(tt=st.event)!=null&&tt.restrictions.skip||!e.schedule)return;e.log(`seek to ${$} "${_e}"`);const at=e.effectivePlayingItem,rt=e.schedule.findItemIndexAtTime($,_e),nt=(et=e.schedule.items)==null?void 0:et[rt],it=e.getBufferingPlayer(),ot=it==null?void 0:it.interstitial,lt=ot==null?void 0:ot.appendInPlace,ct=at&&e.itemsMatch(at,nt);if(at&&(lt||ct)){const ht=a(e.playingAsset),dt=(ht==null?void 0:ht.media)||e.primaryMedia;if(dt){const gt=_e==="primary"?dt.currentTime:o(at,_e,e.playingAsset,"timelinePos","currentTime"),vt=$-gt,St=(lt?gt:dt.currentTime)+vt;if(St>=0&&(!ht||lt||St<=ht.duration)){dt.currentTime=St;return}}}if(nt){let ht=$;if(_e!=="primary"){const gt=nt[_e].start,vt=$-gt;ht=nt.start+vt}const dt=!e.isInterstitial(nt);if((!e.isInterstitial(at)||at.event.appendInPlace)&&(dt||nt.event.appendInPlace)){const gt=e.media||(lt?it==null?void 0:it.media:null);gt&&(gt.currentTime=ht)}else if(at){const gt=e.findItemIndex(at);if(rt>gt){const St=e.schedule.findJumpRestrictedIndex(gt+1,rt);if(St>gt){e.setSchedulePosition(St);return}}let vt=0;if(dt)e.timelinePos=ht,e.checkBuffer();else{const St=nt.event.assetList,Tt=$-(nt[_e]||nt).start;for(let Ct=St.length;Ct--;){const Rt=St[Ct];if(Rt.duration&&Tt>=Rt.startOffset&&Tt<Rt.startOffset+Rt.duration){vt=Ct;break}}}e.setSchedulePosition(rt,vt)}}},_=()=>{const $=e.effectivePlayingItem;if(e.isInterstitial($))return $;const _e=i();return e.isInterstitial(_e)?_e:null},j={get bufferedEnd(){const $=i(),_e=e.bufferingItem;if(_e&&_e===$){var tt;return o(_e,"playout",e.bufferingAsset,"bufferedPos","bufferedEnd")-_e.playout.start||((tt=e.bufferingAsset)==null?void 0:tt.startOffset)||0}return 0},get currentTime(){const $=_(),_e=e.effectivePlayingItem;return _e&&_e===$?o(_e,"playout",e.effectivePlayingAsset,"timelinePos","currentTime")-_e.playout.start:0},set currentTime($){const _e=_(),tt=e.effectivePlayingItem;tt&&tt===_e&&b($+tt.playout.start,"playout")},get duration(){const $=_();return $?$.playout.end-$.playout.start:0},get assetPlayers(){var $;const _e=($=_())==null?void 0:$.event.assetList;return _e?_e.map(tt=>e.getAssetPlayer(tt.identifier)):[]},get playingIndex(){var $;const _e=($=_())==null?void 0:$.event;return _e&&e.effectivePlayingAsset?_e.findAssetIndex(e.effectivePlayingAsset):-1},get scheduleItem(){return _()}};return this.manager={get events(){var $;return(($=e.schedule)==null||($=$.events)==null?void 0:$.slice(0))||[]},get schedule(){var $;return(($=e.schedule)==null||($=$.items)==null?void 0:$.slice(0))||[]},get interstitialPlayer(){return _()?j:null},get playerQueue(){return e.playerQueue.slice(0)},get bufferingAsset(){return e.bufferingAsset},get bufferingItem(){return i()},get bufferingIndex(){const $=i();return e.findItemIndex($)},get playingAsset(){return e.effectivePlayingAsset},get playingItem(){return e.effectivePlayingItem},get playingIndex(){const $=e.effectivePlayingItem;return e.findItemIndex($)},primary:{get bufferedEnd(){return d()},get currentTime(){const $=e.timelinePos;return $>0?$:0},set currentTime($){b($,"primary")},get duration(){return g("primary")},get seekableStart(){var $;return(($=e.primaryDetails)==null?void 0:$.fragmentStart)||0}},integrated:{get bufferedEnd(){return o(i(),"integrated",e.bufferingAsset,"bufferedPos","bufferedEnd")},get currentTime(){return o(e.effectivePlayingItem,"integrated",e.effectivePlayingAsset,"timelinePos","currentTime")},set currentTime($){b($,"integrated")},get duration(){return g("integrated")},get seekableStart(){var $;return c((($=e.primaryDetails)==null?void 0:$.fragmentStart)||0,"integrated")}},skip:()=>{const $=e.effectivePlayingItem,_e=$==null?void 0:$.event;if(_e&&!_e.restrictions.skip){const tt=e.findItemIndex($);if(_e.appendInPlace){const et=$.playout.start+$.event.duration;b(et+.001,"playout")}else e.advanceAfterAssetEnded(_e,tt,1/0)}}}}get effectivePlayingItem(){return this.waitingItem||this.playingItem||this.endedItem}get effectivePlayingAsset(){return this.playingAsset||this.endedAsset}get playingLastItem(){var e;const i=this.playingItem,a=(e=this.schedule)==null?void 0:e.items;return!this.playbackStarted||!i||!a?!1:this.findItemIndex(i)===a.length-1}get playbackStarted(){return this.effectivePlayingItem!==null}get currentTime(){var e,i;if(this.mediaSelection===null)return;const a=this.waitingItem||this.playingItem;if(this.isInterstitial(a)&&!a.event.appendInPlace)return;let o=this.media;!o&&(e=this.bufferingItem)!=null&&(e=e.event)!=null&&e.appendInPlace&&(o=this.primaryMedia);const c=(i=o)==null?void 0:i.currentTime;if(!(c===void 0||!isFiniteNumber(c)))return c}get primaryMedia(){var e;return this.media||((e=this.detachedData)==null?void 0:e.media)||null}isInterstitial(e){return!!(e!=null&&e.event)}retreiveMediaSource(e,i){const a=this.getAssetPlayer(e);a&&this.transferMediaFromPlayer(a,i)}transferMediaFromPlayer(e,i){const a=e.interstitial.appendInPlace,o=e.media;if(a&&o===this.primaryMedia){if(this.bufferingAsset=null,(!i||this.isInterstitial(i)&&!i.event.appendInPlace)&&i&&o){this.detachedData={media:o};return}const c=e.transferMedia();this.log(`transfer MediaSource from ${e} ${stringify(c)}`),this.detachedData=c}else i&&o&&(this.shouldPlay||(this.shouldPlay=!o.paused))}transferMediaTo(e,i){var a,o;if(e.media===i)return;let c=null;const d=this.hls,g=e!==d,b=g&&e.interstitial.appendInPlace,_=(a=this.detachedData)==null?void 0:a.mediaSource;let j;if(d.media)b&&(c=d.transferMedia(),this.detachedData=c),j="Primary";else if(_){const et=this.getBufferingPlayer();et?(c=et.transferMedia(),j=`${et}`):j="detached MediaSource"}else j="detached media";if(!c){if(_)c=this.detachedData,this.log(`using detachedData: MediaSource ${stringify(c)}`);else if(!this.detachedData||d.media===i){const et=this.playerQueue;et.length>1&&et.forEach(st=>{if(g&&st.interstitial.appendInPlace!==b){const at=st.interstitial;this.clearInterstitial(st.interstitial,null),at.appendInPlace=!1,at.appendInPlace&&this.warn(`Could not change append strategy for queued assets ${at}`)}}),this.hls.detachMedia(),this.detachedData={media:i}}}const $=c&&"mediaSource"in c&&((o=c.mediaSource)==null?void 0:o.readyState)!=="closed",_e=$&&c?c:i;this.log(`${$?"transfering MediaSource":"attaching media"} to ${g?e:"Primary"} from ${j} (media.currentTime: ${i.currentTime})`);const tt=this.schedule;if(_e===c&&tt){const et=g&&e.assetId===tt.assetIdAtEnd;_e.overrides={duration:tt.duration,endOfStream:!g||et,cueRemoval:!g}}e.attachMedia(_e)}onInterstitialCueEnter(){this.onTimeupdate()}checkStart(){const e=this.schedule,i=e==null?void 0:e.events;if(!i||this.playbackDisabled||!this.media)return;this.bufferedPos===-1&&(this.bufferedPos=0);const a=this.timelinePos,o=this.effectivePlayingItem;if(a===-1){const c=this.hls.startPosition;if(this.log(timelineMessage("checkStart",c)),this.timelinePos=c,i.length&&i[0].cue.pre){const d=e.findEventIndex(i[0].identifier);this.setSchedulePosition(d)}else if(c>=0||!this.primaryLive){const d=this.timelinePos=c>0?c:0,g=e.findItemIndexAtTime(d);this.setSchedulePosition(g)}}else if(o&&!this.playingItem){const c=e.findItemIndex(o);this.setSchedulePosition(c)}}advanceAssetBuffering(e,i){const a=e.event,o=a.findAssetIndex(i),c=getNextAssetIndex(a,o);if(!a.isAssetPastPlayoutLimit(c))this.bufferedToEvent(e,c);else if(this.schedule){var d;const g=(d=this.schedule.items)==null?void 0:d[this.findItemIndex(e)+1];g&&this.bufferedToItem(g)}}advanceAfterAssetEnded(e,i,a){const o=getNextAssetIndex(e,a);if(e.isAssetPastPlayoutLimit(o)){if(this.schedule){const c=this.schedule.items;if(c){const d=i+1,g=c.length;if(d>=g){this.setSchedulePosition(-1);return}const b=e.resumeTime;this.timelinePos<b&&(this.log(timelineMessage("advanceAfterAssetEnded",b)),this.timelinePos=b,e.appendInPlace&&this.advanceInPlace(b),this.checkBuffer(this.bufferedPos<b)),this.setSchedulePosition(d)}}}else{if(e.appendInPlace){const c=e.assetList[o];c&&this.advanceInPlace(c.timelineStart)}this.setSchedulePosition(i,o)}}setScheduleToAssetAtTime(e,i){const a=this.schedule;if(!a)return;const o=i.parentIdentifier,c=a.getEvent(o);if(c){const d=a.findEventIndex(o),g=a.findAssetIndex(c,e);this.advanceAfterAssetEnded(c,d,g-1)}}setSchedulePosition(e,i){var a;const o=(a=this.schedule)==null?void 0:a.items;if(!o||this.playbackDisabled)return;const c=e>=0?o[e]:null;this.log(`setSchedulePosition ${e}, ${i} (${c&&segmentToString(c)}) pos: ${this.timelinePos}`);const d=this.waitingItem||this.playingItem,g=this.playingLastItem;if(this.isInterstitial(d)){const j=d.event,$=this.playingAsset,_e=$==null?void 0:$.identifier,tt=_e?this.getAssetPlayer(_e):null;if(tt&&_e&&(!this.eventItemsMatch(d,c)||i!==void 0&&_e!==j.assetList[i].identifier)){var b;const et=j.findAssetIndex($);if(this.log(`INTERSTITIAL_ASSET_ENDED ${et+1}/${j.assetList.length} ${eventAssetToString($)}`),this.endedAsset=$,this.playingAsset=null,this.hls.trigger(Events.INTERSTITIAL_ASSET_ENDED,{asset:$,assetListIndex:et,event:j,schedule:o.slice(0),scheduleIndex:e,player:tt}),d!==this.playingItem){this.itemsMatch(d,this.playingItem)&&!this.playingAsset&&this.advanceAfterAssetEnded(j,this.findItemIndex(this.playingItem),et);return}this.retreiveMediaSource(_e,c),tt.media&&!((b=this.detachedData)!=null&&b.mediaSource)&&tt.detachMedia()}if(!this.eventItemsMatch(d,c)&&(this.endedItem=d,this.playingItem=null,this.log(`INTERSTITIAL_ENDED ${j} ${segmentToString(d)}`),j.hasPlayed=!0,this.hls.trigger(Events.INTERSTITIAL_ENDED,{event:j,schedule:o.slice(0),scheduleIndex:e}),j.cue.once)){var _;this.updateSchedule();const et=(_=this.schedule)==null?void 0:_.items;if(c&&et){const st=this.findItemIndex(c);this.advanceSchedule(st,et,i,d,g)}return}}this.advanceSchedule(e,o,i,d,g)}advanceSchedule(e,i,a,o,c){const d=this.schedule;if(!d)return;const g=i[e]||null,b=this.primaryMedia,_=this.playerQueue;if(_.length&&_.forEach(j=>{const $=j.interstitial,_e=d.findEventIndex($.identifier);(_e<e||_e>e+1)&&this.clearInterstitial($,g)}),this.isInterstitial(g)){this.timelinePos=Math.min(Math.max(this.timelinePos,g.start),g.end);const j=g.event;if(a===void 0){a=d.findAssetIndex(j,this.timelinePos);const et=getNextAssetIndex(j,a-1);if(j.isAssetPastPlayoutLimit(et)||j.appendInPlace&&this.timelinePos===g.end){this.advanceAfterAssetEnded(j,e,a);return}a=et}const $=this.waitingItem;this.assetsBuffered(g,b)||this.setBufferingItem(g);let _e=this.preloadAssets(j,a);if(this.eventItemsMatch(g,$||o)||(this.waitingItem=g,this.log(`INTERSTITIAL_STARTED ${segmentToString(g)} ${j.appendInPlace?"append in place":""}`),this.hls.trigger(Events.INTERSTITIAL_STARTED,{event:j,schedule:i.slice(0),scheduleIndex:e})),!j.assetListLoaded){this.log(`Waiting for ASSET-LIST to complete loading ${j}`);return}if(j.assetListLoader&&(j.assetListLoader.destroy(),j.assetListLoader=void 0),!b){this.log(`Waiting for attachMedia to start Interstitial ${j}`);return}this.waitingItem=this.endedItem=null,this.playingItem=g;const tt=j.assetList[a];if(!tt){this.advanceAfterAssetEnded(j,e,a||0);return}if(_e||(_e=this.getAssetPlayer(tt.identifier)),_e===null||_e.destroyed){const et=j.assetList.length;this.warn(`asset ${a+1}/${et} player destroyed ${j}`),_e=this.createAssetPlayer(j,tt,a),_e.loadSource()}if(!this.eventItemsMatch(g,this.bufferingItem)&&j.appendInPlace&&this.isAssetBuffered(tt))return;this.startAssetPlayer(_e,a,i,e,b),this.shouldPlay&&playWithCatch(_e.media)}else g?(this.resumePrimary(g,e,o),this.shouldPlay&&playWithCatch(this.hls.media)):c&&this.isInterstitial(o)&&(this.endedItem=null,this.playingItem=o,o.event.appendInPlace||this.attachPrimary(d.durations.primary,null))}get playbackDisabled(){return this.hls.config.enableInterstitialPlayback===!1}get primaryDetails(){var e;return(e=this.mediaSelection)==null?void 0:e.main.details}get primaryLive(){var e;return!!((e=this.primaryDetails)!=null&&e.live)}resumePrimary(e,i,a){var o,c;if(this.playingItem=e,this.playingAsset=this.endedAsset=null,this.waitingItem=this.endedItem=null,this.bufferedToItem(e),this.log(`resuming ${segmentToString(e)}`),!((o=this.detachedData)!=null&&o.mediaSource)){let g=this.timelinePos;(g<e.start||g>=e.end)&&(g=this.getPrimaryResumption(e,i),this.log(timelineMessage("resumePrimary",g)),this.timelinePos=g),this.attachPrimary(g,e)}if(!a)return;const d=(c=this.schedule)==null?void 0:c.items;d&&(this.log(`INTERSTITIALS_PRIMARY_RESUMED ${segmentToString(e)}`),this.hls.trigger(Events.INTERSTITIALS_PRIMARY_RESUMED,{schedule:d.slice(0),scheduleIndex:i}),this.checkBuffer())}getPrimaryResumption(e,i){const a=e.start;if(this.primaryLive){const o=this.primaryDetails;if(i===0)return this.hls.startPosition;if(o&&(a<o.fragmentStart||a>o.edge))return this.hls.liveSyncPosition||-1}return a}isAssetBuffered(e){const i=this.getAssetPlayer(e.identifier);return i!=null&&i.hls?i.hls.bufferedToEnd:BufferHelper.bufferInfo(this.primaryMedia,this.timelinePos,0).end+1>=e.timelineStart+(e.duration||0)}attachPrimary(e,i,a){i?this.setBufferingItem(i):this.bufferingItem=this.playingItem,this.bufferingAsset=null;const o=this.primaryMedia;if(!o)return;const c=this.hls;c.media?this.checkBuffer():(this.transferMediaTo(c,o),a&&this.startLoadingPrimaryAt(e,a)),a||(this.log(timelineMessage("attachPrimary",e)),this.timelinePos=e,this.startLoadingPrimaryAt(e,a))}startLoadingPrimaryAt(e,i){var a;const o=this.hls;!o.loadingEnabled||!o.media||Math.abs((((a=o.mainForwardBufferInfo)==null?void 0:a.start)||o.media.currentTime)-e)>.5?o.startLoad(e,i):o.bufferingEnabled||o.resumeBuffering()}onManifestLoading(){var e;this.stopLoad(),(e=this.schedule)==null||e.reset(),this.emptyPlayerQueue(),this.clearScheduleState(),this.shouldPlay=!1,this.bufferedPos=this.timelinePos=-1,this.mediaSelection=this.altSelection=this.manager=this.requiredTracks=null,this.hls.off(Events.BUFFER_CODECS,this.onBufferCodecs,this),this.hls.on(Events.BUFFER_CODECS,this.onBufferCodecs,this)}onLevelUpdated(e,i){if(i.level===-1||!this.schedule)return;const a=this.hls.levels[i.level];if(!a.details)return;const o=_objectSpread2(_objectSpread2({},this.mediaSelection||this.altSelection),{},{main:a});this.mediaSelection=o,this.schedule.parseInterstitialDateRanges(o,this.hls.config.interstitialAppendInPlace),!this.effectivePlayingItem&&this.schedule.items&&this.checkStart()}onAudioTrackUpdated(e,i){const a=this.hls.audioTracks[i.id],o=this.mediaSelection;if(!o){this.altSelection=_objectSpread2(_objectSpread2({},this.altSelection),{},{audio:a});return}const c=_objectSpread2(_objectSpread2({},o),{},{audio:a});this.mediaSelection=c}onSubtitleTrackUpdated(e,i){const a=this.hls.subtitleTracks[i.id],o=this.mediaSelection;if(!o){this.altSelection=_objectSpread2(_objectSpread2({},this.altSelection),{},{subtitles:a});return}const c=_objectSpread2(_objectSpread2({},o),{},{subtitles:a});this.mediaSelection=c}onAudioTrackSwitching(e,i){const a=getBasicSelectionOption(i);this.playerQueue.forEach(({hls:o})=>o&&(o.setAudioOption(i)||o.setAudioOption(a)))}onSubtitleTrackSwitch(e,i){const a=getBasicSelectionOption(i);this.playerQueue.forEach(({hls:o})=>o&&(o.setSubtitleOption(i)||i.id!==-1&&o.setSubtitleOption(a)))}onBufferCodecs(e,i){const a=i.tracks;a&&(this.requiredTracks=a)}onBufferAppended(e,i){this.checkBuffer()}onBufferFlushed(e,i){const a=this.playingItem;if(a&&!this.itemsMatch(a,this.bufferingItem)&&!this.isInterstitial(a)){const o=this.timelinePos;this.bufferedPos=o,this.checkBuffer()}}onBufferedToEnd(e){if(!this.schedule)return;const i=this.schedule.events;if(this.bufferedPos<Number.MAX_VALUE&&i){for(let o=0;o<i.length;o++){const c=i[o];if(c.cue.post){var a;const d=this.schedule.findEventIndex(c.identifier),g=(a=this.schedule.items)==null?void 0:a[d];this.isInterstitial(g)&&this.eventItemsMatch(g,this.bufferingItem)&&this.bufferedToItem(g,0);break}}this.bufferedPos=Number.MAX_VALUE}}onMediaEnded(e){const i=this.playingItem;if(!this.playingLastItem&&i){const a=this.findItemIndex(i);this.setSchedulePosition(a+1)}else this.shouldPlay=!1}updateItem(e,i){var a;const o=(a=this.schedule)==null?void 0:a.items;if(e&&o){const c=this.findItemIndex(e,i);return o[c]||null}return null}trimInPlace(e,i){if(this.isInterstitial(e)&&e.event.appendInPlace&&i.end-e.end>.25){e.event.assetList.forEach((c,d)=>{e.event.isAssetPastPlayoutLimit(d)&&this.clearAssetPlayer(c.identifier,null)});const a=e.end+.25,o=BufferHelper.bufferInfo(this.primaryMedia,a,0);(o.end>a||(o.nextStart||0)>a)&&(this.log(`trim buffered interstitial ${segmentToString(e)} (was ${segmentToString(i)})`),this.attachPrimary(a,null,!0),this.flushFrontBuffer(a))}}itemsMatch(e,i){return!!i&&(e===i||e.event&&i.event&&this.eventItemsMatch(e,i)||!e.event&&!i.event&&this.findItemIndex(e)===this.findItemIndex(i))}eventItemsMatch(e,i){var a;return!!i&&(e===i||e.event.identifier===((a=i.event)==null?void 0:a.identifier))}findItemIndex(e,i){return e&&this.schedule?this.schedule.findItemIndex(e,i):-1}updateSchedule(e=!1){var i;const a=this.mediaSelection;a&&((i=this.schedule)==null||i.updateSchedule(a,[],e))}checkBuffer(e){var i;const a=(i=this.schedule)==null?void 0:i.items;if(!a)return;const o=BufferHelper.bufferInfo(this.primaryMedia,this.timelinePos,0);e&&(this.bufferedPos=this.timelinePos),e||(e=o.len<1),this.updateBufferedPos(o.end,a,e)}updateBufferedPos(e,i,a){const o=this.schedule,c=this.bufferingItem;if(this.bufferedPos>e||!o)return;if(i.length===1&&this.itemsMatch(i[0],c)){this.bufferedPos=e;return}const d=this.playingItem,g=this.findItemIndex(d);let b=o.findItemIndexAtTime(e);if(this.bufferedPos<e){var _;const j=this.findItemIndex(c),$=Math.min(j+1,i.length-1),_e=i[$];if((b===-1&&c&&e>=c.end||(_=_e.event)!=null&&_.appendInPlace&&e+.01>=_e.start)&&(b=$),this.isInterstitial(c)){const tt=c.event;if($-g>1&&tt.appendInPlace===!1||tt.assetList.length===0&&tt.assetListLoader)return}if(this.bufferedPos=e,b>j&&b>g)this.bufferedToItem(_e);else{const tt=this.primaryDetails;this.primaryLive&&tt&&e>tt.edge-tt.targetduration&&_e.start<tt.edge+this.hls.config.interstitialLiveLookAhead&&this.isInterstitial(_e)&&this.preloadAssets(_e.event,0)}}else a&&d&&!this.itemsMatch(d,c)&&(b===g?this.bufferedToItem(d):b===g+1&&this.bufferedToItem(i[b]))}assetsBuffered(e,i){return e.event.assetList.length===0?!1:!e.event.assetList.some(o=>{const c=this.getAssetPlayer(o.identifier);return!(c!=null&&c.bufferedInPlaceToEnd(i))})}setBufferingItem(e){const i=this.bufferingItem,a=this.schedule;if(!this.itemsMatch(e,i)&&a){const{items:o,events:c}=a;if(!o||!c)return i;const d=this.isInterstitial(e),g=this.getBufferingPlayer();this.bufferingItem=e,this.bufferedPos=Math.max(e.start,Math.min(e.end,this.timelinePos));const b=g?g.remaining:i?i.end-this.timelinePos:0;if(this.log(`INTERSTITIALS_BUFFERED_TO_BOUNDARY ${segmentToString(e)}`+(i?` (${b.toFixed(2)} remaining)`:"")),!this.playbackDisabled)if(d){const _=a.findAssetIndex(e.event,this.bufferedPos);e.event.assetList.forEach((j,$)=>{const _e=this.getAssetPlayer(j.identifier);_e&&($===_&&_e.loadSource(),_e.resumeBuffering())})}else this.hls.resumeBuffering(),this.playerQueue.forEach(_=>_.pauseBuffering());this.hls.trigger(Events.INTERSTITIALS_BUFFERED_TO_BOUNDARY,{events:c.slice(0),schedule:o.slice(0),bufferingIndex:this.findItemIndex(e),playingIndex:this.findItemIndex(this.playingItem)})}else this.bufferingItem!==e&&(this.bufferingItem=e);return i}bufferedToItem(e,i=0){const a=this.setBufferingItem(e);if(!this.playbackDisabled){if(this.isInterstitial(e))this.bufferedToEvent(e,i);else if(a!==null){this.bufferingAsset=null;const o=this.detachedData;o?o.mediaSource?this.attachPrimary(e.start,e,!0):this.preloadPrimary(e):this.preloadPrimary(e)}}}preloadPrimary(e){const i=this.findItemIndex(e),a=this.getPrimaryResumption(e,i);this.startLoadingPrimaryAt(a)}bufferedToEvent(e,i){const a=e.event,o=a.assetList.length===0&&!a.assetListLoader,c=a.cue.once;if(o||!c){const d=this.preloadAssets(a,i);if(d!=null&&d.interstitial.appendInPlace){const g=this.primaryMedia;g&&this.bufferAssetPlayer(d,g)}}}preloadAssets(e,i){const a=e.assetUrl,o=e.assetList.length,c=o===0&&!e.assetListLoader,d=e.cue.once;if(c){const b=e.timelineStart;if(e.appendInPlace){var g;const _e=this.playingItem;!this.isInterstitial(_e)&&(_e==null||(g=_e.nextEvent)==null?void 0:g.identifier)===e.identifier&&this.flushFrontBuffer(b+.25)}let _,j=0;if(!this.playingItem&&this.primaryLive&&(j=this.hls.startPosition,j===-1&&(j=this.hls.liveSyncPosition||0)),j&&!(e.cue.pre||e.cue.post)){const _e=j-b;_e>0&&(_=Math.round(_e*1e3)/1e3)}if(this.log(`Load interstitial asset ${i+1}/${a?1:o} ${e}${_?` live-start: ${j} start-offset: ${_}`:""}`),a)return this.createAsset(e,0,0,b,e.duration,a);const $=this.assetListLoader.loadAssetList(e,_);$&&(e.assetListLoader=$)}else if(!d&&o){for(let _=i;_<o;_++){const j=e.assetList[_],$=this.getAssetPlayerQueueIndex(j.identifier);($===-1||this.playerQueue[$].destroyed)&&!j.error&&this.createAssetPlayer(e,j,_)}const b=e.assetList[i];if(b){const _=this.getAssetPlayer(b.identifier);return _&&_.loadSource(),_}}return null}flushFrontBuffer(e){const i=this.requiredTracks;if(!i)return;this.log(`Removing front buffer starting at ${e}`),Object.keys(i).forEach(o=>{this.hls.trigger(Events.BUFFER_FLUSHING,{startOffset:e,endOffset:1/0,type:o})})}getAssetPlayerQueueIndex(e){const i=this.playerQueue;for(let a=0;a<i.length;a++)if(e===i[a].assetId)return a;return-1}getAssetPlayer(e){const i=this.getAssetPlayerQueueIndex(e);return this.playerQueue[i]||null}getBufferingPlayer(){const{playerQueue:e,primaryMedia:i}=this;if(i){for(let a=0;a<e.length;a++)if(e[a].media===i)return e[a]}return null}createAsset(e,i,a,o,c,d){const g={parentIdentifier:e.identifier,identifier:generateAssetIdentifier(e,d,i),duration:c,startOffset:a,timelineStart:o,uri:d};return this.createAssetPlayer(e,g,i)}createAssetPlayer(e,i,a){const o=this.hls,c=o.userConfig;let d=c.videoPreference;const g=o.loadLevelObj||o.levels[o.currentLevel];(d||g)&&(d=_extends({},d),g.videoCodec&&(d.videoCodec=g.videoCodec),g.videoRange&&(d.allowedVideoRanges=[g.videoRange]));const b=o.audioTracks[o.audioTrack],_=o.subtitleTracks[o.subtitleTrack];let j=0;if(this.primaryLive||e.appendInPlace){const ot=this.timelinePos-i.timelineStart;if(ot>1){const lt=i.duration;lt&&ot<lt&&(j=ot)}}const $=i.identifier,_e=_objectSpread2(_objectSpread2({},c),{},{maxMaxBufferLength:Math.min(180,o.config.maxMaxBufferLength),autoStartLoad:!0,startFragPrefetch:!0,primarySessionId:o.sessionId,assetPlayerId:$,abrEwmaDefaultEstimate:o.bandwidthEstimate,interstitialsController:void 0,startPosition:j,liveDurationInfinity:!1,testBandwidth:!1,videoPreference:d,audioPreference:b||c.audioPreference,subtitlePreference:_||c.subtitlePreference});e.appendInPlace&&(e.appendInPlaceStarted=!0,i.timelineStart&&(_e.timelineOffset=i.timelineStart));const tt=_e.cmcd;tt!=null&&tt.sessionId&&tt.contentId&&(_e.cmcd=_extends({},tt,{contentId:hash(i.uri)})),this.getAssetPlayer($)&&this.warn(`Duplicate date range identifier ${e} and asset ${$}`);const et=new HlsAssetPlayer(this.HlsPlayerClass,_e,e,i);this.playerQueue.push(et),e.assetList[a]=i;let st=!0;const at=ot=>{if(ot.live){var lt;const dt=new Error(`Interstitials MUST be VOD assets ${e}`),gt={fatal:!0,type:ErrorTypes.OTHER_ERROR,details:ErrorDetails.INTERSTITIAL_ASSET_ITEM_ERROR,error:dt},vt=((lt=this.schedule)==null?void 0:lt.findEventIndex(e.identifier))||-1;this.handleAssetItemError(gt,e,vt,a,dt.message);return}const ct=ot.edge-ot.fragmentStart,ht=i.duration;(st||ht===null||ct>ht)&&(st=!1,this.log(`Interstitial asset "${$}" duration change ${ht} > ${ct}`),i.duration=ct,this.updateSchedule())};et.on(Events.LEVEL_UPDATED,(ot,{details:lt})=>at(lt)),et.on(Events.LEVEL_PTS_UPDATED,(ot,{details:lt})=>at(lt)),et.on(Events.EVENT_CUE_ENTER,()=>this.onInterstitialCueEnter());const rt=(ot,lt)=>{const ct=this.getAssetPlayer($);if(ct&&lt.tracks){ct.off(Events.BUFFER_CODECS,rt),ct.tracks=lt.tracks;const ht=this.primaryMedia;this.bufferingAsset===ct.assetItem&&ht&&!ct.media&&this.bufferAssetPlayer(ct,ht)}};et.on(Events.BUFFER_CODECS,rt);const nt=()=>{var ot;const lt=this.getAssetPlayer($);if(this.log(`buffered to end of asset ${lt}`),!lt||!this.schedule)return;const ct=this.schedule.findEventIndex(e.identifier),ht=(ot=this.schedule.items)==null?void 0:ot[ct];this.isInterstitial(ht)&&this.advanceAssetBuffering(ht,i)};et.on(Events.BUFFERED_TO_END,nt);const it=ot=>()=>{if(!this.getAssetPlayer($)||!this.schedule)return;this.shouldPlay=!0;const ct=this.schedule.findEventIndex(e.identifier);this.advanceAfterAssetEnded(e,ct,ot)};return et.once(Events.MEDIA_ENDED,it(a)),et.once(Events.PLAYOUT_LIMIT_REACHED,it(1/0)),et.on(Events.ERROR,(ot,lt)=>{if(!this.schedule)return;const ct=this.getAssetPlayer($);if(lt.details===ErrorDetails.BUFFER_STALLED_ERROR){if(ct!=null&&ct.appendInPlace){this.handleInPlaceStall(e);return}this.onTimeupdate(),this.checkBuffer(!0);return}this.handleAssetItemError(lt,e,this.schedule.findEventIndex(e.identifier),a,`Asset player error ${lt.error} ${e}`)}),et.on(Events.DESTROYING,()=>{if(!this.getAssetPlayer($)||!this.schedule)return;const lt=new Error(`Asset player destroyed unexpectedly ${$}`),ct={fatal:!0,type:ErrorTypes.OTHER_ERROR,details:ErrorDetails.INTERSTITIAL_ASSET_ITEM_ERROR,error:lt};this.handleAssetItemError(ct,e,this.schedule.findEventIndex(e.identifier),a,lt.message)}),this.log(`INTERSTITIAL_ASSET_PLAYER_CREATED ${eventAssetToString(i)}`),this.hls.trigger(Events.INTERSTITIAL_ASSET_PLAYER_CREATED,{asset:i,assetListIndex:a,event:e,player:et}),et}clearInterstitial(e,i){e.assetList.forEach(a=>{this.clearAssetPlayer(a.identifier,i)}),e.reset()}resetAssetPlayer(e){const i=this.getAssetPlayerQueueIndex(e);if(i!==-1){this.log(`reset asset player "${e}" after error`);const a=this.playerQueue[i];this.transferMediaFromPlayer(a,null),a.resetDetails()}}clearAssetPlayer(e,i){const a=this.getAssetPlayerQueueIndex(e);if(a!==-1){const o=this.playerQueue[a];this.log(`clear ${o} toSegment: ${i&&segmentToString(i)}`),this.transferMediaFromPlayer(o,i),this.playerQueue.splice(a,1),o.destroy()}}emptyPlayerQueue(){let e;for(;e=this.playerQueue.pop();)e.destroy();this.playerQueue=[]}startAssetPlayer(e,i,a,o,c){const{interstitial:d,assetItem:g,assetId:b}=e,_=d.assetList.length,j=this.playingAsset;this.endedAsset=null,this.playingAsset=g,(!j||j.identifier!==b)&&(j&&(this.clearAssetPlayer(j.identifier,a[o]),delete j.error),this.log(`INTERSTITIAL_ASSET_STARTED ${i+1}/${_} ${eventAssetToString(g)}`),this.hls.trigger(Events.INTERSTITIAL_ASSET_STARTED,{asset:g,assetListIndex:i,event:d,schedule:a.slice(0),scheduleIndex:o,player:e})),this.bufferAssetPlayer(e,c)}bufferAssetPlayer(e,i){var a,o;if(!this.schedule)return;const{interstitial:c,assetItem:d}=e,g=this.schedule.findEventIndex(c.identifier),b=(a=this.schedule.items)==null?void 0:a[g];if(!b)return;e.loadSource(),this.setBufferingItem(b),this.bufferingAsset=d;const _=this.getBufferingPlayer();if(_===e)return;const j=c.appendInPlace;if(j&&(_==null?void 0:_.interstitial.appendInPlace)===!1)return;const $=(_==null?void 0:_.tracks)||((o=this.detachedData)==null?void 0:o.tracks)||this.requiredTracks;if(j&&d!==this.playingAsset){if(!e.tracks){this.log(`Waiting for track info before buffering ${e}`);return}if($&&!isCompatibleTrackChange($,e.tracks)){const _e=new Error(`Asset ${eventAssetToString(d)} SourceBuffer tracks ('${Object.keys(e.tracks)}') are not compatible with primary content tracks ('${Object.keys($)}')`),tt={fatal:!0,type:ErrorTypes.OTHER_ERROR,details:ErrorDetails.INTERSTITIAL_ASSET_ITEM_ERROR,error:_e},et=c.findAssetIndex(d);this.handleAssetItemError(tt,c,g,et,_e.message);return}}this.transferMediaTo(e,i)}handleInPlaceStall(e){const i=this.schedule,a=this.primaryMedia;if(!i||!a)return;const o=a.currentTime,c=i.findAssetIndex(e,o),d=e.assetList[c];if(d){const g=this.getAssetPlayer(d.identifier);if(g){const b=g.currentTime||o-d.timelineStart,_=g.duration-b;if(this.warn(`Stalled at ${b} of ${b+_} in ${g} ${e} (media.currentTime: ${o})`),b&&(_/a.playbackRate<.5||g.bufferedInPlaceToEnd(a))&&g.hls){const j=i.findEventIndex(e.identifier);this.advanceAfterAssetEnded(e,j,c)}}}}advanceInPlace(e){const i=this.primaryMedia;i&&i.currentTime<e&&(i.currentTime=e)}handleAssetItemError(e,i,a,o,c){if(e.details===ErrorDetails.BUFFER_STALLED_ERROR)return;const d=i.assetList[o]||null;if(this.warn(`INTERSTITIAL_ASSET_ERROR ${d&&eventAssetToString(d)} ${e.error}`),!this.schedule)return;const g=(d==null?void 0:d.identifier)||"",b=this.getAssetPlayerQueueIndex(g),_=this.playerQueue[b]||null,j=this.schedule.items,$=_extends({},e,{fatal:!1,errorAction:createDoNothingErrorAction(!0),asset:d,assetListIndex:o,event:i,schedule:j,scheduleIndex:a,player:_});if(this.hls.trigger(Events.INTERSTITIAL_ASSET_ERROR,$),!e.fatal)return;const _e=this.playingAsset,tt=this.bufferingAsset,et=new Error(c);if(d&&(this.clearAssetPlayer(g,null),d.error=et),!i.assetList.some(st=>!st.error))i.error=et;else for(let st=o;st<i.assetList.length;st++)this.resetAssetPlayer(i.assetList[st].identifier);this.updateSchedule(!0),i.error?this.primaryFallback(i):_e&&_e.identifier===g?this.advanceAfterAssetEnded(i,a,o):tt&&tt.identifier===g&&this.isInterstitial(this.bufferingItem)&&this.advanceAssetBuffering(this.bufferingItem,tt)}primaryFallback(e){const i=e.timelineStart,a=this.effectivePlayingItem;if(a){this.log(`Fallback to primary from event "${e.identifier}" start: ${i} pos: ${this.timelinePos} playing: ${segmentToString(a)} error: ${e.error}`);let o=this.timelinePos;o===-1&&(o=this.hls.startPosition);const c=this.updateItem(a,o);if(this.itemsMatch(a,c)&&this.clearInterstitial(e,null),e.appendInPlace&&(this.attachPrimary(i,null),this.flushFrontBuffer(i)),!this.schedule)return;const d=this.schedule.findItemIndexAtTime(o);this.setSchedulePosition(d)}else this.checkStart()}onAssetListLoaded(e,i){var a,o;const c=i.event,d=c.identifier,g=i.assetListResponse.ASSETS;if(!((a=this.schedule)!=null&&a.hasEvent(d)))return;const b=c.timelineStart,_=c.duration;let j=0;g.forEach((st,at)=>{const rt=parseFloat(st.DURATION);this.createAsset(c,at,j,b+j,rt,st.URI),j+=rt}),c.duration=j,this.log(`Loaded asset-list with duration: ${j} (was: ${_}) ${c}`);const $=this.waitingItem,_e=($==null?void 0:$.event.identifier)===d;this.updateSchedule();const tt=(o=this.bufferingItem)==null?void 0:o.event;if(_e){var et;const st=this.schedule.findEventIndex(d),at=(et=this.schedule.items)==null?void 0:et[st];if(at){if(!this.playingItem&&this.timelinePos>at.end&&this.schedule.findItemIndexAtTime(this.timelinePos)!==st){c.error=new Error(`Interstitial no longer within playback range ${this.timelinePos} ${c}`),this.updateSchedule(!0),this.primaryFallback(c);return}this.setBufferingItem(at)}this.setSchedulePosition(st)}else if((tt==null?void 0:tt.identifier)===d){const st=c.assetList[0];if(st){const at=this.getAssetPlayer(st.identifier);if(tt.appendInPlace){const rt=this.primaryMedia;at&&rt&&this.bufferAssetPlayer(at,rt)}else at&&at.loadSource()}}}onError(e,i){if(this.schedule)switch(i.details){case ErrorDetails.ASSET_LIST_PARSING_ERROR:case ErrorDetails.ASSET_LIST_LOAD_ERROR:case ErrorDetails.ASSET_LIST_LOAD_TIMEOUT:{const a=i.interstitial;a&&(this.updateSchedule(!0),this.primaryFallback(a));break}case ErrorDetails.BUFFER_STALLED_ERROR:{const a=this.endedItem||this.waitingItem||this.playingItem;if(this.isInterstitial(a)&&a.event.appendInPlace){this.handleInPlaceStall(a.event);return}this.log(`Primary player stall @${this.timelinePos} bufferedPos: ${this.bufferedPos}`),this.onTimeupdate(),this.checkBuffer(!0);break}}}}const TICK_INTERVAL$2=500;class SubtitleStreamController extends BaseStreamController{constructor(e,i,a){super(e,i,a,"subtitle-stream-controller",PlaylistLevelType.SUBTITLE),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(Events.LEVEL_LOADED,this.onLevelLoaded,this),e.on(Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(Events.BUFFER_FLUSHING,this.onBufferFlushing,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(Events.LEVEL_LOADED,this.onLevelLoaded,this),e.off(Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(Events.BUFFER_FLUSHING,this.onBufferFlushing,this)}startLoad(e,i){this.stopLoad(),this.state=State.IDLE,this.setInterval(TICK_INTERVAL$2),this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=i?-1:e,this.tick()}onManifestLoading(){super.onManifestLoading(),this.mainDetails=null}onMediaDetaching(e,i){this.tracksBuffered=[],super.onMediaDetaching(e,i)}onLevelLoaded(e,i){this.mainDetails=i.details}onSubtitleFragProcessed(e,i){const{frag:a,success:o}=i;if(this.fragContextChanged(a)||(isMediaFragment(a)&&(this.fragPrevious=a),this.state=State.IDLE),!o)return;const c=this.tracksBuffered[this.currentTrackId];if(!c)return;let d;const g=a.start;for(let _=0;_<c.length;_++)if(g>=c[_].start&&g<=c[_].end){d=c[_];break}const b=a.start+a.duration;d?d.end=b:(d={start:g,end:b},c.push(d)),this.fragmentTracker.fragBuffered(a),this.fragBufferedComplete(a,null),this.media&&this.tick()}onBufferFlushing(e,i){const{startOffset:a,endOffset:o}=i;if(a===0&&o!==Number.POSITIVE_INFINITY){const c=o-1;if(c<=0)return;i.endOffsetSubtitles=Math.max(0,c),this.tracksBuffered.forEach(d=>{for(let g=0;g<d.length;){if(d[g].end<=c){d.shift();continue}else if(d[g].start<c)d[g].start=c;else break;g++}}),this.fragmentTracker.removeFragmentsInRange(a,c,PlaylistLevelType.SUBTITLE)}}onError(e,i){const a=i.frag;(a==null?void 0:a.type)===PlaylistLevelType.SUBTITLE&&(i.details===ErrorDetails.FRAG_GAP&&this.fragmentTracker.fragBuffered(a,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==State.STOPPED&&(this.state=State.IDLE))}onSubtitleTracksUpdated(e,{subtitleTracks:i}){if(this.levels&&subtitleOptionsIdentical(this.levels,i)){this.levels=i.map(a=>new Level(a));return}this.tracksBuffered=[],this.levels=i.map(a=>{const o=new Level(a);return this.tracksBuffered[o.id]=[],o}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,PlaylistLevelType.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(e,i){var a;if(this.currentTrackId=i.id,!((a=this.levels)!=null&&a.length)||this.currentTrackId===-1){this.clearInterval();return}const o=this.levels[this.currentTrackId];o!=null&&o.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,o&&this.state!==State.STOPPED&&this.setInterval(TICK_INTERVAL$2)}onSubtitleTrackLoaded(e,i){var a;const{currentTrackId:o,levels:c}=this,{details:d,id:g}=i;if(!c){this.warn(`Subtitle tracks were reset while loading level ${g}`);return}const b=c[g];if(g>=c.length||!b)return;this.log(`Subtitle track ${g} loaded [${d.startSN},${d.endSN}]${d.lastPartSn?`[part-${d.lastPartSn}-${d.lastPartIndex}]`:""},duration:${d.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let _=0;if(d.live||(a=b.details)!=null&&a.live){if(d.deltaUpdateFailed)return;const $=this.mainDetails;if(!$){this.startFragRequested=!1;return}const _e=$.fragments[0];if(!b.details)d.hasProgramDateTime&&$.hasProgramDateTime?(alignMediaPlaylistByPDT(d,$),_=d.fragmentStart):_e&&(_=_e.start,addSliding(d,_));else{var j;_=this.alignPlaylists(d,b.details,(j=this.levelLastLoaded)==null?void 0:j.details),_===0&&_e&&(_=_e.start,addSliding(d,_))}$&&!this.startFragRequested&&this.setStartPosition($,_)}b.details=d,this.levelLastLoaded=b,g===o&&(this.hls.trigger(Events.SUBTITLE_TRACK_UPDATED,{details:d,id:g,groupId:i.groupId}),this.tick(),d.live&&!this.fragCurrent&&this.media&&this.state===State.IDLE&&(findFragmentByPTS(null,d.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),b.details=void 0)))}_handleFragmentLoadComplete(e){const{frag:i,payload:a}=e,o=i.decryptdata,c=this.hls;if(!this.fragContextChanged(i)&&a&&a.byteLength>0&&o!=null&&o.key&&o.iv&&isFullSegmentEncryption(o.method)){const d=performance.now();this.decrypter.decrypt(new Uint8Array(a),o.key.buffer,o.iv.buffer,getAesModeFromFullSegmentMethod(o.method)).catch(g=>{throw c.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_DECRYPT_ERROR,fatal:!1,error:g,reason:g.message,frag:i}),g}).then(g=>{const b=performance.now();c.trigger(Events.FRAG_DECRYPTED,{frag:i,payload:g,stats:{tstart:d,tdecrypt:b}})}).catch(g=>{this.warn(`${g.name}: ${g.message}`),this.state=State.IDLE})}}doTick(){if(!this.media){this.state=State.IDLE;return}if(this.state===State.IDLE){const{currentTrackId:e,levels:i}=this,a=i==null?void 0:i[e];if(!a||!i.length||!a.details||this.waitForLive(a))return;const{config:o}=this,c=this.getLoadPosition(),d=BufferHelper.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],c,o.maxBufferHole),{end:g,len:b}=d,_=a.details,j=this.hls.maxBufferLength+_.levelTargetDuration;if(b>j)return;const $=_.fragments,_e=$.length,tt=_.edge;let et=null;const st=this.fragPrevious;if(g<tt){const nt=o.maxFragLookUpTolerance,it=g>tt-nt?0:nt;et=findFragmentByPTS(st,$,Math.max($[0].start,g),it),!et&&st&&st.start<$[0].start&&(et=$[0])}else et=$[_e-1];if(et=this.filterReplacedPrimary(et,a.details),!et)return;const at=et.sn-_.startSN,rt=$[at-1];if(rt&&rt.cc===et.cc&&this.fragmentTracker.getState(rt)===FragmentState.NOT_LOADED&&(et=rt),this.fragmentTracker.getState(et)===FragmentState.NOT_LOADED){const nt=this.mapToInitFragWhenRequired(et);nt&&this.loadFragment(nt,a,g)}}}loadFragment(e,i,a){isMediaFragment(e)?super.loadFragment(e,i,a):this._loadInitSegment(e,i)}get mediaBufferTimeRanges(){return new BufferableInstance(this.tracksBuffered[this.currentTrackId]||[])}}class BufferableInstance{constructor(e){this.buffered=void 0;const i=(a,o,c)=>{if(o=o>>>0,o>c-1)throw new DOMException(`Failed to execute '${a}' on 'TimeRanges': The index provided (${o}) is greater than the maximum bound (${c})`);return e[o][a]};this.buffered={get length(){return e.length},end(a){return i("end",a,e.length)},start(a){return i("start",a,e.length)}}}}const specialCea608CharsCodes={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},getCharForByte=s=>String.fromCharCode(specialCea608CharsCodes[s]||s),NR_ROWS=15,NR_COLS=100,rowsLowCh1={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},rowsHighCh1={17:2,18:4,21:6,22:8,23:10,19:13,20:15},rowsLowCh2={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},rowsHighCh2={25:2,26:4,29:6,30:8,31:10,27:13,28:15},backgroundColors=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class CaptionsLogger{constructor(){this.time=null,this.verboseLevel=0}log(e,i){if(this.verboseLevel>=e){const a=typeof i=="function"?i():i;logger.log(`${this.time} [${e}] ${a}`)}}}const numArrayToHexArray=function s(e){const i=[];for(let a=0;a<e.length;a++)i.push(e[a].toString(16));return i};class PenState{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const i=["foreground","underline","italics","background","flash"];for(let a=0;a<i.length;a++){const o=i[a];e.hasOwnProperty(o)&&(this[o]=e[o])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class StyledUnicodeChar{constructor(){this.uchar=" ",this.penState=new PenState}reset(){this.uchar=" ",this.penState.reset()}setChar(e,i){this.uchar=e,this.penState.copy(i)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}}class Row{constructor(e){this.chars=[],this.pos=0,this.currPenState=new PenState,this.cueStartTime=null,this.logger=void 0;for(let i=0;i<NR_COLS;i++)this.chars.push(new StyledUnicodeChar);this.logger=e}equals(e){for(let i=0;i<NR_COLS;i++)if(!this.chars[i].equals(e.chars[i]))return!1;return!0}copy(e){for(let i=0;i<NR_COLS;i++)this.chars[i].copy(e.chars[i])}isEmpty(){let e=!0;for(let i=0;i<NR_COLS;i++)if(!this.chars[i].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>NR_COLS&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=NR_COLS)}moveCursor(e){const i=this.pos+e;if(e>1)for(let a=this.pos+1;a<i+1;a++)this.chars[a].setPenState(this.currPenState);this.setCursor(i)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const i=getCharForByte(e);if(this.pos>=NR_COLS){this.logger.log(0,()=>"Cannot insert "+e.toString(16)+" ("+i+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(i,this.currPenState),this.moveCursor(1)}clearFromPos(e){let i;for(i=e;i<NR_COLS;i++)this.chars[i].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let i=!0;for(let a=0;a<NR_COLS;a++){const o=this.chars[a].uchar;o!==" "&&(i=!1),e.push(o)}return i?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}}class CaptionScreen{constructor(e){this.rows=[],this.currRow=NR_ROWS-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let i=0;i<NR_ROWS;i++)this.rows.push(new Row(e));this.logger=e}reset(){for(let e=0;e<NR_ROWS;e++)this.rows[e].clear();this.currRow=NR_ROWS-1}equals(e){let i=!0;for(let a=0;a<NR_ROWS;a++)if(!this.rows[a].equals(e.rows[a])){i=!1;break}return i}copy(e){for(let i=0;i<NR_ROWS;i++)this.rows[i].copy(e.rows[i])}isEmpty(){let e=!0;for(let i=0;i<NR_ROWS;i++)if(!this.rows[i].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,()=>"pacData = "+stringify(e));let i=e.row-1;if(this.nrRollUpRows&&i<this.nrRollUpRows-1&&(i=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==i){for(let g=0;g<NR_ROWS;g++)this.rows[g].clear();const c=this.currRow+1-this.nrRollUpRows,d=this.lastOutputScreen;if(d){const g=d.rows[c].cueStartTime,b=this.logger.time;if(g!==null&&b!==null&&g<b)for(let _=0;_<this.nrRollUpRows;_++)this.rows[i-this.nrRollUpRows+_+1].copy(d.rows[c+_])}}this.currRow=i;const a=this.rows[this.currRow];if(e.indent!==null){const c=e.indent,d=Math.max(c-1,0);a.setCursor(e.indent),e.color=a.chars[d].penState.foreground}const o={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(o)}setBkgData(e){this.logger.log(2,()=>"bkgData = "+stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());const e=this.currRow+1-this.nrRollUpRows,i=this.rows.splice(e,1)[0];i.clear(),this.rows.splice(this.currRow,0,i),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const i=[];let a="",o=-1;for(let c=0;c<NR_ROWS;c++){const d=this.rows[c].getTextString();d&&(o=c+1,e?i.push("Row "+o+": '"+d+"'"):i.push(d.trim()))}return i.length>0&&(e?a="["+i.join(" | ")+"]":a=i.join(`
`)),a}getTextAndFormat(){return this.rows}}class Cea608Channel{constructor(e,i,a){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=i,this.mode=null,this.verbose=0,this.displayedMemory=new CaptionScreen(a),this.nonDisplayedMemory=new CaptionScreen(a),this.lastOutputScreen=new CaptionScreen(a),this.currRollUpRow=this.displayedMemory.rows[NR_ROWS-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=a}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[NR_ROWS-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>"MODE="+e),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let a=0;a<e.length;a++)this.writeScreen.insertChar(e[a]);const i=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>i+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const i={flash:!1};if(i.underline=e%2===1,i.italics=e>=46,i.italics)i.foreground="white";else{const a=Math.floor(e/2)-16,o=["white","green","blue","cyan","red","yellow","magenta"];i.foreground=o[a]}this.logger.log(2,"MIDROW: "+stringify(i)),this.writeScreen.setPen(i)}outputDataUpdate(e=!1){const i=this.logger.time;i!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=i:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,i,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:i),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class Cea608Parser{constructor(e,i,a){this.channels=void 0,this.currentChannel=0,this.cmdHistory=createCmdHistory(),this.logger=void 0;const o=this.logger=new CaptionsLogger;this.channels=[null,new Cea608Channel(e,i,o),new Cea608Channel(e+1,a,o)]}getHandler(e){return this.channels[e].getHandler()}setHandler(e,i){this.channels[e].setHandler(i)}addData(e,i){this.logger.time=e;for(let a=0;a<i.length;a+=2){const o=i[a]&127,c=i[a+1]&127;let d=!1,g=null;if(o===0&&c===0)continue;this.logger.log(3,()=>"["+numArrayToHexArray([i[a],i[a+1]])+"] -> ("+numArrayToHexArray([o,c])+")");const b=this.cmdHistory;if(o>=16&&o<=31){if(hasCmdRepeated(o,c,b)){setLastCmd(null,null,b),this.logger.log(3,()=>"Repeated command ("+numArrayToHexArray([o,c])+") is dropped");continue}setLastCmd(o,c,this.cmdHistory),d=this.parseCmd(o,c),d||(d=this.parseMidrow(o,c)),d||(d=this.parsePAC(o,c)),d||(d=this.parseBackgroundAttributes(o,c))}else setLastCmd(null,null,b);if(!d&&(g=this.parseChars(o,c),g)){const j=this.currentChannel;j&&j>0?this.channels[j].insertChars(g):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!d&&!g&&this.logger.log(2,()=>"Couldn't parse cleaned data "+numArrayToHexArray([o,c])+" orig: "+numArrayToHexArray([i[a],i[a+1]]))}}parseCmd(e,i){const a=(e===20||e===28||e===21||e===29)&&i>=32&&i<=47,o=(e===23||e===31)&&i>=33&&i<=35;if(!(a||o))return!1;const c=e===20||e===21||e===23?1:2,d=this.channels[c];return e===20||e===21||e===28||e===29?i===32?d.ccRCL():i===33?d.ccBS():i===34?d.ccAOF():i===35?d.ccAON():i===36?d.ccDER():i===37?d.ccRU(2):i===38?d.ccRU(3):i===39?d.ccRU(4):i===40?d.ccFON():i===41?d.ccRDC():i===42?d.ccTR():i===43?d.ccRTD():i===44?d.ccEDM():i===45?d.ccCR():i===46?d.ccENM():i===47&&d.ccEOC():d.ccTO(i-32),this.currentChannel=c,!0}parseMidrow(e,i){let a=0;if((e===17||e===25)&&i>=32&&i<=47){if(e===17?a=1:a=2,a!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const o=this.channels[a];return o?(o.ccMIDROW(i),this.logger.log(3,()=>"MIDROW ("+numArrayToHexArray([e,i])+")"),!0):!1}return!1}parsePAC(e,i){let a;const o=(e>=17&&e<=23||e>=25&&e<=31)&&i>=64&&i<=127,c=(e===16||e===24)&&i>=64&&i<=95;if(!(o||c))return!1;const d=e<=23?1:2;i>=64&&i<=95?a=d===1?rowsLowCh1[e]:rowsLowCh2[e]:a=d===1?rowsHighCh1[e]:rowsHighCh2[e];const g=this.channels[d];return g?(g.setPAC(this.interpretPAC(a,i)),this.currentChannel=d,!0):!1}interpretPAC(e,i){let a;const o={color:null,italics:!1,indent:null,underline:!1,row:e};return i>95?a=i-96:a=i-64,o.underline=(a&1)===1,a<=13?o.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(a/2)]:a<=15?(o.italics=!0,o.color="white"):o.indent=Math.floor((a-16)/2)*4,o}parseChars(e,i){let a,o=null,c=null;if(e>=25?(a=2,c=e-8):(a=1,c=e),c>=17&&c<=19){let d;c===17?d=i+80:c===18?d=i+112:d=i+144,this.logger.log(2,()=>"Special char '"+getCharForByte(d)+"' in channel "+a),o=[d]}else e>=32&&e<=127&&(o=i===0?[e]:[e,i]);return o&&this.logger.log(3,()=>"Char codes =  "+numArrayToHexArray(o).join(",")),o}parseBackgroundAttributes(e,i){const a=(e===16||e===24)&&i>=32&&i<=47,o=(e===23||e===31)&&i>=45&&i<=47;if(!(a||o))return!1;let c;const d={};e===16||e===24?(c=Math.floor((i-32)/2),d.background=backgroundColors[c],i%2===1&&(d.background=d.background+"_semi")):i===45?d.background="transparent":(d.foreground="black",i===47&&(d.underline=!0));const g=e<=23?1:2;return this.channels[g].setBkgData(d),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const i=this.channels[e];i&&i.reset()}setLastCmd(null,null,this.cmdHistory)}cueSplitAtTime(e){for(let i=0;i<this.channels.length;i++){const a=this.channels[i];a&&a.cueSplitAtTime(e)}}}function setLastCmd(s,e,i){i.a=s,i.b=e}function hasCmdRepeated(s,e,i){return i.a===s&&i.b===e}function createCmdHistory(){return{a:null,b:null}}var VTTCue=function(){if(optionalSelf!=null&&optionalSelf.VTTCue)return self.VTTCue;const s=["","lr","rl"],e=["start","middle","end","left","right"];function i(g,b){if(typeof b!="string"||!Array.isArray(g))return!1;const _=b.toLowerCase();return~g.indexOf(_)?_:!1}function a(g){return i(s,g)}function o(g){return i(e,g)}function c(g,...b){let _=1;for(;_<arguments.length;_++){const j=arguments[_];for(const $ in j)g[$]=j[$]}return g}function d(g,b,_){const j=this,$={enumerable:!0};j.hasBeenReset=!1;let _e="",tt=!1,et=g,st=b,at=_,rt=null,nt="",it=!0,ot="auto",lt="start",ct=50,ht="middle",dt=50,gt="middle";Object.defineProperty(j,"id",c({},$,{get:function(){return _e},set:function(vt){_e=""+vt}})),Object.defineProperty(j,"pauseOnExit",c({},$,{get:function(){return tt},set:function(vt){tt=!!vt}})),Object.defineProperty(j,"startTime",c({},$,{get:function(){return et},set:function(vt){if(typeof vt!="number")throw new TypeError("Start time must be set to a number.");et=vt,this.hasBeenReset=!0}})),Object.defineProperty(j,"endTime",c({},$,{get:function(){return st},set:function(vt){if(typeof vt!="number")throw new TypeError("End time must be set to a number.");st=vt,this.hasBeenReset=!0}})),Object.defineProperty(j,"text",c({},$,{get:function(){return at},set:function(vt){at=""+vt,this.hasBeenReset=!0}})),Object.defineProperty(j,"region",c({},$,{get:function(){return rt},set:function(vt){rt=vt,this.hasBeenReset=!0}})),Object.defineProperty(j,"vertical",c({},$,{get:function(){return nt},set:function(vt){const St=a(vt);if(St===!1)throw new SyntaxError("An invalid or illegal string was specified.");nt=St,this.hasBeenReset=!0}})),Object.defineProperty(j,"snapToLines",c({},$,{get:function(){return it},set:function(vt){it=!!vt,this.hasBeenReset=!0}})),Object.defineProperty(j,"line",c({},$,{get:function(){return ot},set:function(vt){if(typeof vt!="number"&&vt!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");ot=vt,this.hasBeenReset=!0}})),Object.defineProperty(j,"lineAlign",c({},$,{get:function(){return lt},set:function(vt){const St=o(vt);if(!St)throw new SyntaxError("An invalid or illegal string was specified.");lt=St,this.hasBeenReset=!0}})),Object.defineProperty(j,"position",c({},$,{get:function(){return ct},set:function(vt){if(vt<0||vt>100)throw new Error("Position must be between 0 and 100.");ct=vt,this.hasBeenReset=!0}})),Object.defineProperty(j,"positionAlign",c({},$,{get:function(){return ht},set:function(vt){const St=o(vt);if(!St)throw new SyntaxError("An invalid or illegal string was specified.");ht=St,this.hasBeenReset=!0}})),Object.defineProperty(j,"size",c({},$,{get:function(){return dt},set:function(vt){if(vt<0||vt>100)throw new Error("Size must be between 0 and 100.");dt=vt,this.hasBeenReset=!0}})),Object.defineProperty(j,"align",c({},$,{get:function(){return gt},set:function(vt){const St=o(vt);if(!St)throw new SyntaxError("An invalid or illegal string was specified.");gt=St,this.hasBeenReset=!0}})),j.displayState=void 0}return d.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},d}();class StringDecoder{decode(e,i){if(!e)return"";if(typeof e!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function parseTimeStamp(s){function e(a,o,c,d){return(a|0)*3600+(o|0)*60+(c|0)+parseFloat(d||0)}const i=s.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return i?parseFloat(i[2])>59?e(i[2],i[3],0,i[4]):e(i[1],i[2],i[3],i[4]):null}class Settings{constructor(){this.values=Object.create(null)}set(e,i){!this.get(e)&&i!==""&&(this.values[e]=i)}get(e,i,a){return a?this.has(e)?this.values[e]:i[a]:this.has(e)?this.values[e]:i}has(e){return e in this.values}alt(e,i,a){for(let o=0;o<a.length;++o)if(i===a[o]){this.set(e,i);break}}integer(e,i){/^-?\d+$/.test(i)&&this.set(e,parseInt(i,10))}percent(e,i){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(i)){const a=parseFloat(i);if(a>=0&&a<=100)return this.set(e,a),!0}return!1}}function parseOptions(s,e,i,a){const o=a?s.split(a):[s];for(const c in o){if(typeof o[c]!="string")continue;const d=o[c].split(i);if(d.length!==2)continue;const g=d[0],b=d[1];e(g,b)}}const defaults=new VTTCue(0,0,""),center=defaults.align==="middle"?"middle":"center";function parseCue(s,e,i){const a=s;function o(){const g=parseTimeStamp(s);if(g===null)throw new Error("Malformed timestamp: "+a);return s=s.replace(/^[^\sa-zA-Z-]+/,""),g}function c(g,b){const _=new Settings;parseOptions(g,function(_e,tt){let et;switch(_e){case"region":for(let st=i.length-1;st>=0;st--)if(i[st].id===tt){_.set(_e,i[st].region);break}break;case"vertical":_.alt(_e,tt,["rl","lr"]);break;case"line":et=tt.split(","),_.integer(_e,et[0]),_.percent(_e,et[0])&&_.set("snapToLines",!1),_.alt(_e,et[0],["auto"]),et.length===2&&_.alt("lineAlign",et[1],["start",center,"end"]);break;case"position":et=tt.split(","),_.percent(_e,et[0]),et.length===2&&_.alt("positionAlign",et[1],["start",center,"end","line-left","line-right","auto"]);break;case"size":_.percent(_e,tt);break;case"align":_.alt(_e,tt,["start",center,"end","left","right"]);break}},/:/,/\s/),b.region=_.get("region",null),b.vertical=_.get("vertical","");let j=_.get("line","auto");j==="auto"&&defaults.line===-1&&(j=-1),b.line=j,b.lineAlign=_.get("lineAlign","start"),b.snapToLines=_.get("snapToLines",!0),b.size=_.get("size",100),b.align=_.get("align",center);let $=_.get("position","auto");$==="auto"&&defaults.position===50&&($=b.align==="start"||b.align==="left"?0:b.align==="end"||b.align==="right"?100:50),b.position=$}function d(){s=s.replace(/^\s+/,"")}if(d(),e.startTime=o(),d(),s.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+a);s=s.slice(3),d(),e.endTime=o(),d(),c(s,e)}function fixLineBreaks(s){return s.replace(/<br(?: \/)?>/gi,`
`)}class VTTParser{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new StringDecoder,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const i=this;e&&(i.buffer+=i.decoder.decode(e,{stream:!0}));function a(){let c=i.buffer,d=0;for(c=fixLineBreaks(c);d<c.length&&c[d]!=="\r"&&c[d]!==`
`;)++d;const g=c.slice(0,d);return c[d]==="\r"&&++d,c[d]===`
`&&++d,i.buffer=c.slice(d),g}function o(c){parseOptions(c,function(d,g){},/:/)}try{let c="";if(i.state==="INITIAL"){if(!/\r\n|\n/.test(i.buffer))return this;c=a();const g=c.match(/^()?WEBVTT([ \t].*)?$/);if(!(g!=null&&g[0]))throw new Error("Malformed WebVTT signature.");i.state="HEADER"}let d=!1;for(;i.buffer;){if(!/\r\n|\n/.test(i.buffer))return this;switch(d?d=!1:c=a(),i.state){case"HEADER":/:/.test(c)?o(c):c||(i.state="ID");continue;case"NOTE":c||(i.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(c)){i.state="NOTE";break}if(!c)continue;if(i.cue=new VTTCue(0,0,""),i.state="CUE",c.indexOf("-->")===-1){i.cue.id=c;continue}case"CUE":if(!i.cue){i.state="BADCUE";continue}try{parseCue(c,i.cue,i.regionList)}catch{i.cue=null,i.state="BADCUE";continue}i.state="CUETEXT";continue;case"CUETEXT":{const g=c.indexOf("-->")!==-1;if(!c||g&&(d=!0)){i.oncue&&i.cue&&i.oncue(i.cue),i.cue=null,i.state="ID";continue}if(i.cue===null)continue;i.cue.text&&(i.cue.text+=`
`),i.cue.text+=c}continue;case"BADCUE":c||(i.state="ID")}}}catch{i.state==="CUETEXT"&&i.cue&&i.oncue&&i.oncue(i.cue),i.cue=null,i.state=i.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||e.state==="HEADER")&&(e.buffer+=`

`,e.parse()),e.state==="INITIAL"||e.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(i){e.onparsingerror&&e.onparsingerror(i)}return e.onflush&&e.onflush(),this}}const LINEBREAKS=/\r\n|\n\r|\n|\r/g,startsWith=function s(e,i,a=0){return e.slice(a,a+i.length)===i},cueString2millis=function s(e){let i=parseInt(e.slice(-3));const a=parseInt(e.slice(-6,-4)),o=parseInt(e.slice(-9,-7)),c=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!isFiniteNumber(i)||!isFiniteNumber(a)||!isFiniteNumber(o)||!isFiniteNumber(c))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return i+=1e3*a,i+=60*1e3*o,i+=60*60*1e3*c,i};function generateCueId(s,e,i){return hash(s.toString())+hash(e.toString())+hash(i)}const calculateOffset=function s(e,i,a){let o=e[i],c=e[o.prevCC];if(!c||!c.new&&o.new){e.ccOffset=e.presentationOffset=o.start,o.new=!1;return}for(;(d=c)!=null&&d.new;){var d;e.ccOffset+=o.start-c.start,o.new=!1,o=c,c=e[o.prevCC]}e.presentationOffset=a};function parseWebVTT(s,e,i,a,o,c,d){const g=new VTTParser,b=utf8ArrayToStr(new Uint8Array(s)).trim().replace(LINEBREAKS,`
`).split(`
`),_=[],j=e?toMpegTsClockFromTimescale(e.baseTime,e.timescale):0;let $="00:00.000",_e=0,tt=0,et,st=!0;g.oncue=function(at){const rt=i[a];let nt=i.ccOffset;const it=(_e-j)/9e4;if(rt!=null&&rt.new&&(tt!==void 0?nt=i.ccOffset=rt.start:calculateOffset(i,a,it)),it){if(!e){et=new Error("Missing initPTS for VTT MPEGTS");return}nt=it-i.presentationOffset}const ot=at.endTime-at.startTime,lt=normalizePts((at.startTime+nt-tt)*9e4,o*9e4)/9e4;at.startTime=Math.max(lt,0),at.endTime=Math.max(lt+ot,0);const ct=at.text.trim();at.text=decodeURIComponent(encodeURIComponent(ct)),at.id||(at.id=generateCueId(at.startTime,at.endTime,ct)),at.endTime>0&&_.push(at)},g.onparsingerror=function(at){et=at},g.onflush=function(){if(et){d(et);return}c(_)},b.forEach(at=>{if(st)if(startsWith(at,"X-TIMESTAMP-MAP=")){st=!1,at.slice(16).split(",").forEach(rt=>{startsWith(rt,"LOCAL:")?$=rt.slice(6):startsWith(rt,"MPEGTS:")&&(_e=parseInt(rt.slice(7)))});try{tt=cueString2millis($)/1e3}catch(rt){et=rt}return}else at===""&&(st=!1);g.parse(at+`
`)}),g.flush()}const IMSC1_CODEC="stpp.ttml.im1t",HMSF_REGEX=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,TIME_UNIT_REGEX=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,textAlignToLineAlign={left:"start",center:"center",right:"end",start:"start",end:"end"};function parseIMSC1(s,e,i,a){const o=findBox(new Uint8Array(s),["mdat"]);if(o.length===0){a(new Error("Could not parse IMSC1 mdat"));return}const c=o.map(g=>utf8ArrayToStr(g)),d=toTimescaleFromScale(e.baseTime,1,e.timescale);try{c.forEach(g=>i(parseTTML(g,d)))}catch(g){a(g)}}function parseTTML(s,e){const o=new DOMParser().parseFromString(s,"text/xml").getElementsByTagName("tt")[0];if(!o)throw new Error("Invalid ttml");const c={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},d=Object.keys(c).reduce(($,_e)=>($[_e]=o.getAttribute(`ttp:${_e}`)||c[_e],$),{}),g=o.getAttribute("xml:space")!=="preserve",b=collectionToDictionary(getElementCollection(o,"styling","style")),_=collectionToDictionary(getElementCollection(o,"layout","region")),j=getElementCollection(o,"body","[begin]");return[].map.call(j,$=>{const _e=getTextContent($,g);if(!_e||!$.hasAttribute("begin"))return null;const tt=parseTtmlTime($.getAttribute("begin"),d),et=parseTtmlTime($.getAttribute("dur"),d);let st=parseTtmlTime($.getAttribute("end"),d);if(tt===null)throw timestampParsingError($);if(st===null){if(et===null)throw timestampParsingError($);st=tt+et}const at=new VTTCue(tt-e,st-e,_e);at.id=generateCueId(at.startTime,at.endTime,at.text);const rt=_[$.getAttribute("region")],nt=b[$.getAttribute("style")],it=getTtmlStyles(rt,nt,b),{textAlign:ot}=it;if(ot){const lt=textAlignToLineAlign[ot];lt&&(at.lineAlign=lt),at.align=ot}return _extends(at,it),at}).filter($=>$!==null)}function getElementCollection(s,e,i){const a=s.getElementsByTagName(e)[0];return a?[].slice.call(a.querySelectorAll(i)):[]}function collectionToDictionary(s){return s.reduce((e,i)=>{const a=i.getAttribute("xml:id");return a&&(e[a]=i),e},{})}function getTextContent(s,e){return[].slice.call(s.childNodes).reduce((i,a,o)=>{var c;return a.nodeName==="br"&&o?i+`
`:(c=a.childNodes)!=null&&c.length?getTextContent(a,e):e?i+a.textContent.trim().replace(/\s+/g," "):i+a.textContent},"")}function getTtmlStyles(s,e,i){const a="http://www.w3.org/ns/ttml#styling";let o=null;const c=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],d=s!=null&&s.hasAttribute("style")?s.getAttribute("style"):null;return d&&i.hasOwnProperty(d)&&(o=i[d]),c.reduce((g,b)=>{const _=getAttributeNS(e,a,b)||getAttributeNS(s,a,b)||getAttributeNS(o,a,b);return _&&(g[b]=_),g},{})}function getAttributeNS(s,e,i){return s&&s.hasAttributeNS(e,i)?s.getAttributeNS(e,i):null}function timestampParsingError(s){return new Error(`Could not parse ttml timestamp ${s}`)}function parseTtmlTime(s,e){if(!s)return null;let i=parseTimeStamp(s);return i===null&&(HMSF_REGEX.test(s)?i=parseHoursMinutesSecondsFrames(s,e):TIME_UNIT_REGEX.test(s)&&(i=parseTimeUnits(s,e))),i}function parseHoursMinutesSecondsFrames(s,e){const i=HMSF_REGEX.exec(s),a=(i[4]|0)+(i[5]|0)/e.subFrameRate;return(i[1]|0)*3600+(i[2]|0)*60+(i[3]|0)+a/e.frameRate}function parseTimeUnits(s,e){const i=TIME_UNIT_REGEX.exec(s),a=Number(i[1]);switch(i[2]){case"h":return a*3600;case"m":return a*60;case"ms":return a*1e3;case"f":return a/e.frameRate;case"t":return a/e.tickRate}return a}class OutputFilter{constructor(e,i){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=i}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,i,a){(this.startTime===null||this.startTime>e)&&(this.startTime=e),this.endTime=i,this.screen=a,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}class TimelineController{constructor(e){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=newVTTCCs(),this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},e.on(Events.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Events.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(Events.FRAG_LOADING,this.onFragLoading,this),e.on(Events.FRAG_LOADED,this.onFragLoaded,this),e.on(Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(Events.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(Events.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(Events.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(Events.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Events.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(Events.FRAG_LOADING,this.onFragLoading,this),e.off(Events.FRAG_LOADED,this.onFragLoaded,this),e.off(Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(Events.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(Events.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(Events.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.media=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){const e=new OutputFilter(this,"textTrack1"),i=new OutputFilter(this,"textTrack2"),a=new OutputFilter(this,"textTrack3"),o=new OutputFilter(this,"textTrack4");this.cea608Parser1=new Cea608Parser(1,e,i),this.cea608Parser2=new Cea608Parser(3,a,o)}addCues(e,i,a,o,c){let d=!1;for(let g=c.length;g--;){const b=c[g],_=intersection(b[0],b[1],i,a);if(_>=0&&(b[0]=Math.min(b[0],i),b[1]=Math.max(b[1],a),d=!0,_/(a-i)>.5))return}if(d||c.push([i,a]),this.config.renderTextTracksNatively){const g=this.captionsTracks[e];this.Cues.newCue(g,i,a,o)}else{const g=this.Cues.newCue(null,i,a,o);this.hls.trigger(Events.CUES_PARSED,{type:"captions",cues:g,track:e})}}onInitPtsFound(e,{frag:i,id:a,initPTS:o,timescale:c,trackId:d}){const{unparsedVttFrags:g}=this;a===PlaylistLevelType.MAIN&&(this.initPTS[i.cc]={baseTime:o,timescale:c,trackId:d}),g.length&&(this.unparsedVttFrags=[],g.forEach(b=>{this.initPTS[b.frag.cc]?this.onFragLoaded(Events.FRAG_LOADED,b):this.hls.trigger(Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:b.frag,error:new Error("Subtitle discontinuity domain does not match main")})}))}getExistingTrack(e,i){const{media:a}=this;if(a)for(let o=0;o<a.textTracks.length;o++){const c=a.textTracks[o];if(canReuseVttTextTrack(c,{name:e,lang:i,characteristics:"transcribes-spoken-dialog,describes-music-and-sound"}))return c}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:i,captionsTracks:a,media:o}=this,{label:c,languageCode:d}=i[e],g=this.getExistingTrack(c,d);if(g)a[e]=g,clearCurrentCues(a[e]),sendAddTrackEvent(a[e],o);else{const b=this.createTextTrack("captions",c,d);b&&(b[e]=!0,a[e]=b)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const i=this.captionsProperties[e];if(!i)return;const a=i.label,o={_id:e,label:a,kind:"captions",default:i.media?!!i.media.default:!1,closedCaptions:i.media};this.nonNativeCaptionsTracks[e]=o,this.hls.trigger(Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[o]})}createTextTrack(e,i,a){const o=this.media;if(o)return o.addTextTrack(e,i,a)}onMediaAttaching(e,i){this.media=i.media,i.mediaSource||this._cleanTracks()}onMediaDetaching(e,i){const a=!!i.transferMedia;if(this.media=null,a)return;const{captionsTracks:o}=this;Object.keys(o).forEach(c=>{clearCurrentCues(o[c]),delete o[c]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=newVTTCCs(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const i=e.textTracks;if(i)for(let a=0;a<i.length;a++)clearCurrentCues(i[a])}onSubtitleTracksUpdated(e,i){const a=i.subtitleTracks||[],o=a.some(c=>c.textCodec===IMSC1_CODEC);if(this.config.enableWebVTT||o&&this.config.enableIMSC1){if(subtitleOptionsIdentical(this.tracks,a)){this.tracks=a;return}if(this.textTracks=[],this.tracks=a,this.config.renderTextTracksNatively){const d=this.media,g=d?filterSubtitleTracks(d.textTracks):null;if(this.tracks.forEach((b,_)=>{let j;if(g){let $=null;for(let _e=0;_e<g.length;_e++)if(g[_e]&&canReuseVttTextTrack(g[_e],b)){$=g[_e],g[_e]=null;break}$&&(j=$)}if(j)clearCurrentCues(j);else{const $=captionsOrSubtitlesFromCharacteristics(b);j=this.createTextTrack($,b.name,b.lang),j&&(j.mode="disabled")}j&&this.textTracks.push(j)}),g!=null&&g.length){const b=g.filter(_=>_!==null).map(_=>_.label);b.length&&this.hls.logger.warn(`Media element contains unused subtitle tracks: ${b.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const d=this.tracks.map(g=>({label:g.name,kind:g.type.toLowerCase(),default:g.default,subtitleTrack:g}));this.hls.trigger(Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:d})}}}onManifestLoaded(e,i){this.config.enableCEA708Captions&&i.captions&&i.captions.forEach(a=>{const o=/(?:CC|SERVICE)([1-4])/.exec(a.instreamId);if(!o)return;const c=`textTrack${o[1]}`,d=this.captionsProperties[c];d&&(d.label=a.name,a.lang&&(d.languageCode=a.lang),d.media=a)})}closedCaptionsForLevel(e){const i=this.hls.levels[e.level];return i==null?void 0:i.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,i){if(this.enabled&&i.frag.type===PlaylistLevelType.MAIN){var a,o;const{cea608Parser1:c,cea608Parser2:d,lastSn:g}=this,{cc:b,sn:_}=i.frag,j=(a=(o=i.part)==null?void 0:o.index)!=null?a:-1;c&&d&&(_!==g+1||_===g&&j!==this.lastPartIndex+1||b!==this.lastCc)&&(c.reset(),d.reset()),this.lastCc=b,this.lastSn=_,this.lastPartIndex=j}}onFragLoaded(e,i){const{frag:a,payload:o}=i;if(a.type===PlaylistLevelType.SUBTITLE)if(o.byteLength){const c=a.decryptdata,d="stats"in i;if(c==null||!c.encrypted||d){const g=this.tracks[a.level],b=this.vttCCs;b[a.cc]||(b[a.cc]={start:a.start,prevCC:this.prevCC,new:!0},this.prevCC=a.cc),g&&g.textCodec===IMSC1_CODEC?this._parseIMSC1(a,o):this._parseVTTs(i)}}else this.hls.trigger(Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:a,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,i){const a=this.hls;parseIMSC1(i,this.initPTS[e.cc],o=>{this._appendCues(o,e.level),a.trigger(Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},o=>{a.logger.log(`Failed to parse IMSC1: ${o}`),a.trigger(Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:o})})}_parseVTTs(e){var i;const{frag:a,payload:o}=e,{initPTS:c,unparsedVttFrags:d}=this,g=c.length-1;if(!c[a.cc]&&g===-1){d.push(e);return}const b=this.hls,_=(i=a.initSegment)!=null&&i.data?appendUint8Array(a.initSegment.data,new Uint8Array(o)).buffer:o;parseWebVTT(_,this.initPTS[a.cc],this.vttCCs,a.cc,a.start,j=>{this._appendCues(j,a.level),b.trigger(Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:a})},j=>{const $=j.message==="Missing initPTS for VTT MPEGTS";$?d.push(e):this._fallbackToIMSC1(a,o),b.logger.log(`Failed to parse VTT cue: ${j}`),!($&&g>a.cc)&&b.trigger(Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:a,error:j})})}_fallbackToIMSC1(e,i){const a=this.tracks[e.level];a.textCodec||parseIMSC1(i,this.initPTS[e.cc],()=>{a.textCodec=IMSC1_CODEC,this._parseIMSC1(e,i)},()=>{a.textCodec="wvtt"})}_appendCues(e,i){const a=this.hls;if(this.config.renderTextTracksNatively){const o=this.textTracks[i];if(!o||o.mode==="disabled")return;e.forEach(c=>addCueToTrack(o,c))}else{const o=this.tracks[i];if(!o)return;const c=o.default?"default":"subtitles"+i;a.trigger(Events.CUES_PARSED,{type:"subtitles",cues:e,track:c})}}onFragDecrypted(e,i){const{frag:a}=i;a.type===PlaylistLevelType.SUBTITLE&&this.onFragLoaded(Events.FRAG_LOADED,i)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,i){if(!this.enabled||!this.config.enableCEA708Captions)return;const{frag:a,samples:o}=i;if(!(a.type===PlaylistLevelType.MAIN&&this.closedCaptionsForLevel(a)==="NONE"))for(let c=0;c<o.length;c++){const d=o[c].bytes;if(d){this.cea608Parser1||this.initCea608Parsers();const g=this.extractCea608Data(d);this.cea608Parser1.addData(o[c].pts,g[0]),this.cea608Parser2.addData(o[c].pts,g[1])}}}onBufferFlushing(e,{startOffset:i,endOffset:a,endOffsetSubtitles:o,type:c}){const{media:d}=this;if(!(!d||d.currentTime<a)){if(!c||c==="video"){const{captionsTracks:g}=this;Object.keys(g).forEach(b=>removeCuesInRange(g[b],i,a))}if(this.config.renderTextTracksNatively&&i===0&&o!==void 0){const{textTracks:g}=this;Object.keys(g).forEach(b=>removeCuesInRange(g[b],i,o))}}}extractCea608Data(e){const i=[[],[]],a=e[0]&31;let o=2;for(let c=0;c<a;c++){const d=e[o++],g=127&e[o++],b=127&e[o++];if(g===0&&b===0)continue;if((4&d)!==0){const j=3&d;(j===0||j===1)&&(i[j].push(g),i[j].push(b))}}return i}}function captionsOrSubtitlesFromCharacteristics(s){return s.characteristics&&/transcribes-spoken-dialog/gi.test(s.characteristics)&&/describes-music-and-sound/gi.test(s.characteristics)?"captions":"subtitles"}function canReuseVttTextTrack(s,e){return!!s&&s.kind===captionsOrSubtitlesFromCharacteristics(e)&&subtitleTrackMatchesTextTrack(e,s)}function intersection(s,e,i,a){return Math.min(e,a)-Math.max(s,i)}function newVTTCCs(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}const WHITESPACE_CHAR=/\s/,Cues={newCue(s,e,i,a){const o=[];let c,d,g,b,_;const j=self.VTTCue||self.TextTrackCue;for(let _e=0;_e<a.rows.length;_e++)if(c=a.rows[_e],g=!0,b=0,_="",!c.isEmpty()){var $;for(let st=0;st<c.chars.length;st++)WHITESPACE_CHAR.test(c.chars[st].uchar)&&g?b++:(_+=c.chars[st].uchar,g=!1);c.cueStartTime=e,e===i&&(i+=1e-4),b>=16?b--:b++;const tt=fixLineBreaks(_.trim()),et=generateCueId(e,i,tt);s!=null&&($=s.cues)!=null&&$.getCueById(et)||(d=new j(e,i,tt),d.id=et,d.line=_e+1,d.align="left",d.position=10+Math.min(80,Math.floor(b*8/32)*10),o.push(d))}return s&&o.length&&(o.sort((_e,tt)=>_e.line==="auto"||tt.line==="auto"?0:_e.line>8&&tt.line>8?tt.line-_e.line:_e.line-tt.line),o.forEach(_e=>addCueToTrack(s,_e))),o}};function fetchSupported(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}const BYTERANGE=/(\d+)-(\d+)\/(\d+)/;class FetchLoader{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||getRequest,this.controller=new self.AbortController,this.stats=new LoadStats}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,i,a){const o=this.stats;if(o.loading.start)throw new Error("Loader can only be used once.");o.loading.start=self.performance.now();const c=getRequestParameters(e,this.controller.signal),d=e.responseType==="arraybuffer",g=d?"byteLength":"length",{maxTimeToFirstByteMs:b,maxLoadTimeMs:_}=i.loadPolicy;this.context=e,this.config=i,this.callbacks=a,this.request=this.fetchSetup(e,c),self.clearTimeout(this.requestTimeout),i.timeout=b&&isFiniteNumber(b)?b:_,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(o,e,this.response))},i.timeout),(isPromise(this.request)?this.request.then(self.fetch):self.fetch(this.request)).then($=>{var _e;this.response=this.loader=$;const tt=Math.max(self.performance.now(),o.loading.start);if(self.clearTimeout(this.requestTimeout),i.timeout=_,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(o,e,this.response))},_-(tt-o.loading.start)),!$.ok){const{status:st,statusText:at}=$;throw new FetchError(at||"fetch, bad network response",st,$)}o.loading.first=tt,o.total=getContentLength($.headers)||o.total;const et=(_e=this.callbacks)==null?void 0:_e.onProgress;return et&&isFiniteNumber(i.highWaterMark)?this.loadProgressively($,o,e,i.highWaterMark,et):d?$.arrayBuffer():e.responseType==="json"?$.json():$.text()}).then($=>{var _e,tt;const et=this.response;if(!et)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),o.loading.end=Math.max(self.performance.now(),o.loading.first);const st=$[g];st&&(o.loaded=o.total=st);const at={url:et.url,data:$,code:et.status},rt=(_e=this.callbacks)==null?void 0:_e.onProgress;rt&&!isFiniteNumber(i.highWaterMark)&&rt(o,e,$,et),(tt=this.callbacks)==null||tt.onSuccess(at,o,e,et)}).catch($=>{var _e;if(self.clearTimeout(this.requestTimeout),o.aborted)return;const tt=$&&$.code||0,et=$?$.message:null;(_e=this.callbacks)==null||_e.onError({code:tt,text:et},e,$?$.details:null,o)})}getCacheAge(){let e=null;if(this.response){const i=this.response.headers.get("age");e=i?parseFloat(i):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,i,a,o=0,c){const d=new ChunkCache,g=e.body.getReader(),b=()=>g.read().then(_=>{if(_.done)return d.dataLength&&c(i,a,d.flush().buffer,e),Promise.resolve(new ArrayBuffer(0));const j=_.value,$=j.length;return i.loaded+=$,$<o||d.dataLength?(d.push(j),d.dataLength>=o&&c(i,a,d.flush().buffer,e)):c(i,a,j.buffer,e),b()}).catch(()=>Promise.reject());return b()}}function getRequestParameters(s,e){const i={method:"GET",mode:"cors",credentials:"same-origin",signal:e,headers:new self.Headers(_extends({},s.headers))};return s.rangeEnd&&i.headers.set("Range","bytes="+s.rangeStart+"-"+String(s.rangeEnd-1)),i}function getByteRangeLength(s){const e=BYTERANGE.exec(s);if(e)return parseInt(e[2])-parseInt(e[1])+1}function getContentLength(s){const e=s.get("Content-Range");if(e){const a=getByteRangeLength(e);if(isFiniteNumber(a))return a}const i=s.get("Content-Length");if(i)return parseInt(i)}function getRequest(s,e){return new self.Request(s.url,e)}class FetchError extends Error{constructor(e,i,a){super(e),this.code=void 0,this.details=void 0,this.code=i,this.details=a}}const AGE_HEADER_LINE_REGEX=/^age:\s*[\d.]+\s*$/im;class XhrLoader{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new LoadStats,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,e.readyState!==4&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,i,a){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=i,this.callbacks=a,this.loadInternal()}loadInternal(){const{config:e,context:i}=this;if(!e||!i)return;const a=this.loader=new self.XMLHttpRequest,o=this.stats;o.loading.first=0,o.loaded=0,o.aborted=!1;const c=this.xhrSetup;c?Promise.resolve().then(()=>{if(!(this.loader!==a||this.stats.aborted))return c(a,i.url)}).catch(d=>{if(!(this.loader!==a||this.stats.aborted))return a.open("GET",i.url,!0),c(a,i.url)}).then(()=>{this.loader!==a||this.stats.aborted||this.openAndSendXhr(a,i,e)}).catch(d=>{var g;(g=this.callbacks)==null||g.onError({code:a.status,text:d.message},i,a,o)}):this.openAndSendXhr(a,i,e)}openAndSendXhr(e,i,a){e.readyState||e.open("GET",i.url,!0);const o=i.headers,{maxTimeToFirstByteMs:c,maxLoadTimeMs:d}=a.loadPolicy;if(o)for(const g in o)e.setRequestHeader(g,o[g]);i.rangeEnd&&e.setRequestHeader("Range","bytes="+i.rangeStart+"-"+(i.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=i.responseType,self.clearTimeout(this.requestTimeout),a.timeout=c&&isFiniteNumber(c)?c:d,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),a.timeout),e.send()}readystatechange(){const{context:e,loader:i,stats:a}=this;if(!e||!i)return;const o=i.readyState,c=this.config;if(!a.aborted&&o>=2&&(a.loading.first===0&&(a.loading.first=Math.max(self.performance.now(),a.loading.start),c.timeout!==c.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),c.timeout=c.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),c.loadPolicy.maxLoadTimeMs-(a.loading.first-a.loading.start)))),o===4)){self.clearTimeout(this.requestTimeout),i.onreadystatechange=null,i.onprogress=null;const _=i.status,j=i.responseType==="text"?i.responseText:null;if(_>=200&&_<300){const et=j??i.response;if(et!=null){var d,g;a.loading.end=Math.max(self.performance.now(),a.loading.first);const st=i.responseType==="arraybuffer"?et.byteLength:et.length;a.loaded=a.total=st,a.bwEstimate=a.total*8e3/(a.loading.end-a.loading.first);const at=(d=this.callbacks)==null?void 0:d.onProgress;at&&at(a,e,et,i);const rt={url:i.responseURL,data:et,code:_};(g=this.callbacks)==null||g.onSuccess(rt,a,e,i);return}}const $=c.loadPolicy.errorRetry,_e=a.retry,tt={url:e.url,data:void 0,code:_};if(shouldRetry($,_e,!1,tt))this.retry($);else{var b;logger.error(`${_} while loading ${e.url}`),(b=this.callbacks)==null||b.onError({code:_,text:i.statusText},e,i,a)}}}loadtimeout(){if(!this.config)return;const e=this.config.loadPolicy.timeoutRetry,i=this.stats.retry;if(shouldRetry(e,i,!0))this.retry(e);else{var a;logger.warn(`timeout while loading ${(a=this.context)==null?void 0:a.url}`);const o=this.callbacks;o&&(this.abortInternal(),o.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:i,stats:a}=this;this.retryDelay=getRetryDelay(e,a.retry),a.retry++,logger.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${i==null?void 0:i.url}, retrying ${a.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const i=this.stats;i.loaded=e.loaded,e.lengthComputable&&(i.total=e.total)}getCacheAge(){let e=null;if(this.loader&&AGE_HEADER_LINE_REGEX.test(this.loader.getAllResponseHeaders())){const i=this.loader.getResponseHeader("age");e=i?parseFloat(i):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}const defaultLoadPolicy={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},hlsDefaultConfig=_objectSpread2(_objectSpread2({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,maxDevicePixelRatio:Number.POSITIVE_INFINITY,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,startOnSegmentBoundary:!1,maxBufferSize:60*1e3*1e3,maxFragLookUpTolerance:.25,maxBufferHole:.1,detectStallWithCurrentTimeMs:1250,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,nudgeOnVideoHole:!0,liveSyncMode:"edge",liveSyncDurationCount:3,liveSyncOnStallIncrease:1,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,ignorePlaylistParsingErrors:!1,loader:XhrLoader,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:AbrController,bufferController:BufferController,capLevelController:CapLevelController,errorController:ErrorController,fpsController:FPSController,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:requestMediaKeySystemAccess,requireKeySystemAccessOnStart:!1,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableEmsgKLVMetadata:!1,enableID3MetadataCues:!0,enableInterstitialPlayback:!0,interstitialAppendInPlace:!0,interstitialLiveLookAhead:10,useMediaCapabilities:!0,preserveManualLevelOnError:!1,certLoadPolicy:{default:defaultLoadPolicy},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},interstitialAssetListLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:3e4,timeoutRetry:{maxNumRetry:0,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:0,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},timelineConfig()),{},{subtitleStreamController:SubtitleStreamController,subtitleTrackController:SubtitleTrackController,timelineController:TimelineController,audioStreamController:AudioStreamController,audioTrackController:AudioTrackController,emeController:EMEController,cmcdController:CMCDController,contentSteeringController:ContentSteeringController,interstitialsController:InterstitialsController});function timelineConfig(){return{cueHandler:Cues,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function mergeConfig(s,e,i){if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(e.liveMaxLatencyDurationCount!==void 0&&(e.liveSyncDurationCount===void 0||e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(e.liveMaxLatencyDuration!==void 0&&(e.liveSyncDuration===void 0||e.liveMaxLatencyDuration<=e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const a=deepCpy(s),o=["manifest","level","frag"],c=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return o.forEach(d=>{const g=`${d==="level"?"playlist":d}LoadPolicy`,b=e[g]===void 0,_=[];c.forEach(j=>{const $=`${d}Loading${j}`,_e=e[$];if(_e!==void 0&&b){_.push($);const tt=a[g].default;switch(e[g]={default:tt},j){case"TimeOut":tt.maxLoadTimeMs=_e,tt.maxTimeToFirstByteMs=_e;break;case"MaxRetry":tt.errorRetry.maxNumRetry=_e,tt.timeoutRetry.maxNumRetry=_e;break;case"RetryDelay":tt.errorRetry.retryDelayMs=_e,tt.timeoutRetry.retryDelayMs=_e;break;case"MaxRetryTimeout":tt.errorRetry.maxRetryDelayMs=_e,tt.timeoutRetry.maxRetryDelayMs=_e;break}}}),_.length&&i.warn(`hls.js config: "${_.join('", "')}" setting(s) are deprecated, use "${g}": ${stringify(e[g])}`)}),_objectSpread2(_objectSpread2({},a),e)}function deepCpy(s){return s&&typeof s=="object"?Array.isArray(s)?s.map(deepCpy):Object.keys(s).reduce((e,i)=>(e[i]=deepCpy(s[i]),e),{}):s}function enableStreamingMode(s,e){const i=s.loader;i!==FetchLoader&&i!==XhrLoader?(e.log("[config]: Custom loader detected, cannot enable progressive streaming"),s.progressive=!1):fetchSupported()&&(s.loader=FetchLoader,s.progressive=!0,s.enableSoftwareAES=!0,e.log("[config]: Progressive streaming enabled, using FetchLoader"))}const MAX_START_GAP_JUMP=2,SKIP_BUFFER_HOLE_STEP_SECONDS=.1,SKIP_BUFFER_RANGE_START=.05,TICK_INTERVAL$1=100;class GapController extends TaskLoop{constructor(e,i){super("gap-controller",e.logger),this.hls=void 0,this.fragmentTracker=void 0,this.media=null,this.mediaSource=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.buffered={},this.lastCurrentTime=0,this.ended=0,this.waiting=0,this.onMediaPlaying=()=>{this.ended=0,this.waiting=0},this.onMediaWaiting=()=>{var a;(a=this.media)!=null&&a.seeking||(this.waiting=self.performance.now(),this.tick())},this.onMediaEnded=()=>{if(this.hls){var a;this.ended=((a=this.media)==null?void 0:a.currentTime)||1,this.hls.trigger(Events.MEDIA_ENDED,{stalled:!1})}},this.hls=e,this.fragmentTracker=i,this.registerListeners()}registerListeners(){const{hls:e}=this;e&&(e.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(Events.BUFFER_APPENDED,this.onBufferAppended,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(Events.BUFFER_APPENDED,this.onBufferAppended,this))}destroy(){super.destroy(),this.unregisterListeners(),this.media=this.hls=this.fragmentTracker=null,this.mediaSource=void 0}onMediaAttached(e,i){this.setInterval(TICK_INTERVAL$1),this.mediaSource=i.mediaSource;const a=this.media=i.media;addEventListener(a,"playing",this.onMediaPlaying),addEventListener(a,"waiting",this.onMediaWaiting),addEventListener(a,"ended",this.onMediaEnded)}onMediaDetaching(e,i){this.clearInterval();const{media:a}=this;a&&(removeEventListener(a,"playing",this.onMediaPlaying),removeEventListener(a,"waiting",this.onMediaWaiting),removeEventListener(a,"ended",this.onMediaEnded),this.media=null),this.mediaSource=void 0}onBufferAppended(e,i){this.buffered=i.timeRanges}get hasBuffered(){return Object.keys(this.buffered).length>0}tick(){var e;if(!((e=this.media)!=null&&e.readyState)||!this.hasBuffered)return;const i=this.media.currentTime;this.poll(i,this.lastCurrentTime),this.lastCurrentTime=i}poll(e,i){var a,o;const c=(a=this.hls)==null?void 0:a.config;if(!c)return;const d=this.media;if(!d)return;const{seeking:g}=d,b=this.seeking&&!g,_=!this.seeking&&g,j=d.paused&&!g||d.ended||d.playbackRate===0;if(this.seeking=g,e!==i){i&&(this.ended=0),this.moved=!0,g||(this.nudgeRetry=0,c.nudgeOnVideoHole&&!j&&e>i&&this.nudgeOnVideoHole(e,i)),this.waiting===0&&this.stallResolved(e);return}if(_||b){b&&this.stallResolved(e);return}if(j){this.nudgeRetry=0,this.stallResolved(e),!this.ended&&d.ended&&this.hls&&(this.ended=e||1,this.hls.trigger(Events.MEDIA_ENDED,{stalled:!1}));return}if(!BufferHelper.getBuffered(d).length){this.nudgeRetry=0;return}const $=BufferHelper.bufferInfo(d,e,0),_e=$.nextStart||0,tt=this.fragmentTracker;if(g&&tt&&this.hls){const ct=getInFlightDependency(this.hls.inFlightFragments,e),ht=$.len>MAX_START_GAP_JUMP,dt=!_e||ct||_e-e>MAX_START_GAP_JUMP&&!tt.getPartialFragment(e);if(ht||dt)return;this.moved=!1}const et=(o=this.hls)==null?void 0:o.latestLevelDetails;if(!this.moved&&this.stalled!==null&&tt){if(!($.len>0)&&!_e)return;const ht=Math.max(_e,$.start||0)-e,gt=!!(et!=null&&et.live)?et.targetduration*2:MAX_START_GAP_JUMP,vt=appendedFragAtPosition(e,tt);if(ht>0&&(ht<=gt||vt)){d.paused||this._trySkipBufferHole(vt);return}}const st=c.detectStallWithCurrentTimeMs,at=self.performance.now(),rt=this.waiting;let nt=this.stalled;if(nt===null)if(rt>0&&at-rt<st)nt=this.stalled=rt;else{this.stalled=at;return}const it=at-nt;if(!g&&(it>=st||rt)&&this.hls){var ot;if(((ot=this.mediaSource)==null?void 0:ot.readyState)==="ended"&&!(et!=null&&et.live)&&Math.abs(e-((et==null?void 0:et.edge)||0))<1){if(this.ended)return;this.ended=e||1,this.hls.trigger(Events.MEDIA_ENDED,{stalled:!0});return}if(this._reportStall($),!this.media||!this.hls)return}const lt=BufferHelper.bufferInfo(d,e,c.maxBufferHole);this._tryFixBufferStall(lt,it,e)}stallResolved(e){const i=this.stalled;if(i&&this.hls&&(this.stalled=null,this.stallReported)){const a=self.performance.now()-i;this.log(`playback not stuck anymore @${e}, after ${Math.round(a)}ms`),this.stallReported=!1,this.waiting=0,this.hls.trigger(Events.STALL_RESOLVED,{})}}nudgeOnVideoHole(e,i){var a;const o=this.buffered.video;if(this.hls&&this.media&&this.fragmentTracker&&(a=this.buffered.audio)!=null&&a.length&&o&&o.length>1&&e>o.end(0)){const c=BufferHelper.bufferedInfo(BufferHelper.timeRangesToArray(this.buffered.audio),e,0);if(c.len>1&&i>=c.start){const d=BufferHelper.timeRangesToArray(o),g=BufferHelper.bufferedInfo(d,i,0).bufferedIndex;if(g>-1&&g<d.length-1){const b=BufferHelper.bufferedInfo(d,e,0).bufferedIndex,_=d[g].end,j=d[g+1].start;if((b===-1||b>g)&&j-_<1&&e-_<2){const $=new Error(`nudging playhead to flush pipeline after video hole. currentTime: ${e} hole: ${_} -> ${j} buffered index: ${b}`);this.warn($.message),this.media.currentTime+=1e-6;let _e=appendedFragAtPosition(e,this.fragmentTracker);_e&&"fragment"in _e?_e=_e.fragment:_e||(_e=void 0);const tt=BufferHelper.bufferInfo(this.media,e,0);this.hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:$,reason:$.message,frag:_e,buffer:tt.len,bufferInfo:tt})}}}}}_tryFixBufferStall(e,i,a){var o,c;const{fragmentTracker:d,media:g}=this,b=(o=this.hls)==null?void 0:o.config;if(!g||!d||!b)return;const _=(c=this.hls)==null?void 0:c.latestLevelDetails,j=appendedFragAtPosition(a,d);if((j||_!=null&&_.live&&a<_.fragmentStart)&&(this._trySkipBufferHole(j)||!this.media))return;const $=e.buffered,_e=this.adjacentTraversal(e,a);($&&$.length>1&&e.len>b.maxBufferHole||e.nextStart&&(e.nextStart-a<b.maxBufferHole||_e))&&(i>b.highBufferWatchdogPeriod*1e3||this.waiting)&&(this.warn("Trying to nudge playhead over buffer-hole"),this._tryNudgeBuffer(e))}adjacentTraversal(e,i){const a=this.fragmentTracker,o=e.nextStart;if(a&&o){const c=a.getFragAtPos(i,PlaylistLevelType.MAIN),d=a.getFragAtPos(o,PlaylistLevelType.MAIN);if(c&&d)return d.sn-c.sn<2}return!1}_reportStall(e){const{hls:i,media:a,stallReported:o,stalled:c}=this;if(!o&&c!==null&&a&&i){this.stallReported=!0;const d=new Error(`Playback stalling at @${a.currentTime} due to low buffer (${stringify(e)})`);this.warn(d.message),i.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,error:d,buffer:e.len,bufferInfo:e,stalled:{start:c}})}}_trySkipBufferHole(e){var i;const{fragmentTracker:a,media:o}=this,c=(i=this.hls)==null?void 0:i.config;if(!o||!a||!c)return 0;const d=o.currentTime,g=BufferHelper.bufferInfo(o,d,0),b=d<g.start?g.start:g.nextStart;if(b&&this.hls){const j=g.len<=c.maxBufferHole,$=g.len>0&&g.len<1&&o.readyState<3,_e=b-d;if(_e>0&&(j||$)){if(_e>c.maxBufferHole){let et=!1;if(d===0){const st=a.getAppendedFrag(0,PlaylistLevelType.MAIN);st&&b<st.end&&(et=!0)}if(!et&&e){var _;if(!((_=this.hls.loadLevelObj)!=null&&_.details)||getInFlightDependency(this.hls.inFlightFragments,b))return 0;let at=!1,rt=e.end;for(;rt<b;){const nt=appendedFragAtPosition(rt,a);if(nt)rt+=nt.duration;else{at=!0;break}}if(at)return 0}}const tt=Math.max(b+SKIP_BUFFER_RANGE_START,d+SKIP_BUFFER_HOLE_STEP_SECONDS);if(this.warn(`skipping hole, adjusting currentTime from ${d} to ${tt}`),this.moved=!0,o.currentTime=tt,!(e!=null&&e.gap)){const et=new Error(`fragment loaded with buffer holes, seeking from ${d} to ${tt}`),st={type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:et,reason:et.message,buffer:g.len,bufferInfo:g};e&&("fragment"in e?st.part=e:st.frag=e),this.hls.trigger(Events.ERROR,st)}return tt}}return 0}_tryNudgeBuffer(e){const{hls:i,media:a,nudgeRetry:o}=this,c=i==null?void 0:i.config;if(!a||!c)return 0;const d=a.currentTime;if(this.nudgeRetry++,o<c.nudgeMaxRetry){const g=d+(o+1)*c.nudgeOffset,b=new Error(`Nudging 'currentTime' from ${d} to ${g}`);this.warn(b.message),a.currentTime=g,i.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.BUFFER_NUDGE_ON_STALL,error:b,fatal:!1,buffer:e.len,bufferInfo:e})}else{const g=new Error(`Playhead still not moving while enough data buffered @${d} after ${c.nudgeMaxRetry} nudges`);this.error(g.message),i.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.BUFFER_STALLED_ERROR,error:g,fatal:!0,buffer:e.len,bufferInfo:e})}}}function getInFlightDependency(s,e){const i=inFlight(s.main);if(i&&i.start<=e)return i;const a=inFlight(s.audio);return a&&a.start<=e?a:null}function inFlight(s){if(!s)return null;switch(s.state){case State.IDLE:case State.STOPPED:case State.ENDED:case State.ERROR:return null}return s.frag}function appendedFragAtPosition(s,e){return e.getAppendedFrag(s,PlaylistLevelType.MAIN)||e.getPartialFragment(s)}const MIN_CUE_DURATION=.25;function getCueClass(){if(!(typeof self>"u"))return self.VTTCue||self.TextTrackCue}function createCueWithDataFields(s,e,i,a,o){let c=new s(e,i,"");try{c.value=a,o&&(c.type=o)}catch{c=new s(e,i,stringify(o?_objectSpread2({type:o},a):a))}return c}const MAX_CUE_ENDTIME=(()=>{const s=getCueClass();try{s&&new s(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();class ID3TrackController{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.removeCues=!0,this.assetCue=void 0,this.onEventCueEnter=()=>{this.hls&&this.hls.trigger(Events.EVENT_CUE_ENTER,{})},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=this.onEventCueEnter=null}_registerListeners(){const{hls:e}=this;e&&(e.on(Events.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(Events.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(Events.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(Events.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))}_unregisterListeners(){const{hls:e}=this;e&&(e.off(Events.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(Events.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(Events.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(Events.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))}onMediaAttaching(e,i){var a;this.media=i.media,((a=i.overrides)==null?void 0:a.cueRemoval)===!1&&(this.removeCues=!1)}onMediaAttached(){var e;const i=(e=this.hls)==null?void 0:e.latestLevelDetails;i&&this.updateDateRangeCues(i)}onMediaDetaching(e,i){this.media=null,!i.transferMedia&&(this.id3Track&&(this.removeCues&&clearCurrentCues(this.id3Track,this.onEventCueEnter),this.id3Track=null),this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const i=this.getID3Track(e.textTracks);return i.mode="hidden",i}getID3Track(e){if(this.media){for(let i=0;i<e.length;i++){const a=e[i];if(a.kind==="metadata"&&a.label==="id3")return sendAddTrackEvent(a,this.media),a}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,i){if(!this.media||!this.hls)return;const{enableEmsgMetadataCues:a,enableID3MetadataCues:o}=this.hls.config;if(!a&&!o)return;const{samples:c}=i;this.id3Track||(this.id3Track=this.createTrack(this.media));const d=getCueClass();if(d)for(let g=0;g<c.length;g++){const b=c[g].type;if(b===MetadataSchema.emsg&&!a||!o)continue;const _=getId3Frames(c[g].data),j=c[g].pts;let $=j+c[g].duration;$>MAX_CUE_ENDTIME&&($=MAX_CUE_ENDTIME),$-j<=0&&($=j+MIN_CUE_DURATION);for(let tt=0;tt<_.length;tt++){const et=_[tt];if(!isId3TimestampFrame(et)){this.updateId3CueEnds(j,b);const st=createCueWithDataFields(d,j,$,et,b);st&&this.id3Track.addCue(st)}}}}updateId3CueEnds(e,i){var a;const o=(a=this.id3Track)==null?void 0:a.cues;if(o)for(let c=o.length;c--;){const d=o[c];d.type===i&&d.startTime<e&&d.endTime===MAX_CUE_ENDTIME&&(d.endTime=e)}}onBufferFlushing(e,{startOffset:i,endOffset:a,type:o}){const{id3Track:c,hls:d}=this;if(!d)return;const{config:{enableEmsgMetadataCues:g,enableID3MetadataCues:b}}=d;if(c&&(g||b)){let _;o==="audio"?_=j=>j.type===MetadataSchema.audioId3&&b:o==="video"?_=j=>j.type===MetadataSchema.emsg&&g:_=j=>j.type===MetadataSchema.audioId3&&b||j.type===MetadataSchema.emsg&&g,removeCuesInRange(c,i,a,_)}}onLevelUpdated(e,{details:i}){this.updateDateRangeCues(i,!0)}onLevelPtsUpdated(e,i){Math.abs(i.drift)>.01&&this.updateDateRangeCues(i.details)}updateDateRangeCues(e,i){if(!this.hls||!this.media)return;const{assetPlayerId:a,timelineOffset:o,enableDateRangeMetadataCues:c,interstitialsController:d}=this.hls.config;if(!c)return;const g=getCueClass();if(a&&o&&!d){const{fragmentStart:st,fragmentEnd:at}=e;let rt=this.assetCue;rt?(rt.startTime=st,rt.endTime=at):g&&(rt=this.assetCue=createCueWithDataFields(g,st,at,{assetPlayerId:this.hls.config.assetPlayerId},"hlsjs.interstitial.asset"),rt&&(rt.id=a,this.id3Track||(this.id3Track=this.createTrack(this.media)),this.id3Track.addCue(rt),rt.addEventListener("enter",this.onEventCueEnter)))}if(!e.hasProgramDateTime)return;const{id3Track:b}=this,{dateRanges:_}=e,j=Object.keys(_);let $=this.dateRangeCuesAppended;if(b&&i){var _e;if((_e=b.cues)!=null&&_e.length){const st=Object.keys($).filter(at=>!j.includes(at));for(let at=st.length;at--;){var tt;const rt=st[at],nt=(tt=$[rt])==null?void 0:tt.cues;delete $[rt],nt&&Object.keys(nt).forEach(it=>{const ot=nt[it];if(ot){ot.removeEventListener("enter",this.onEventCueEnter);try{b.removeCue(ot)}catch{}}})}}else $=this.dateRangeCuesAppended={}}const et=e.fragments[e.fragments.length-1];if(!(j.length===0||!isFiniteNumber(et==null?void 0:et.programDateTime))){this.id3Track||(this.id3Track=this.createTrack(this.media));for(let st=0;st<j.length;st++){const at=j[st],rt=_[at],nt=rt.startTime,it=$[at],ot=(it==null?void 0:it.cues)||{};let lt=(it==null?void 0:it.durationKnown)||!1,ct=MAX_CUE_ENDTIME;const{duration:ht,endDate:dt}=rt;if(dt&&ht!==null)ct=nt+ht,lt=!0;else if(rt.endOnNext&&!lt){const vt=j.reduce((St,Tt)=>{if(Tt!==rt.id){const Ct=_[Tt];if(Ct.class===rt.class&&Ct.startDate>rt.startDate&&(!St||rt.startDate<St.startDate))return Ct}return St},null);vt&&(ct=vt.startTime,lt=!0)}const gt=Object.keys(rt.attr);for(let vt=0;vt<gt.length;vt++){const St=gt[vt];if(!isDateRangeCueAttribute(St))continue;const Tt=ot[St];if(Tt)lt&&!(it!=null&&it.durationKnown)?Tt.endTime=ct:Math.abs(Tt.startTime-nt)>.01&&(Tt.startTime=nt,Tt.endTime=ct);else if(g){let Ct=rt.attr[St];isSCTE35Attribute(St)&&(Ct=hexToArrayBuffer(Ct));const bt=createCueWithDataFields(g,nt,ct,{key:St,data:Ct},MetadataSchema.dateRange);bt&&(bt.id=at,this.id3Track.addCue(bt),ot[St]=bt,d&&(St==="X-ASSET-LIST"||St==="X-ASSET-URL")&&bt.addEventListener("enter",this.onEventCueEnter))}}$[at]={cues:ot,dateRange:rt,durationKnown:lt}}}}}class LatencyController{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.currentTime=0,this.stallCount=0,this._latency=null,this._targetLatencyUpdated=!1,this.onTimeupdate=()=>{const{media:i}=this,a=this.levelDetails;if(!i||!a)return;this.currentTime=i.currentTime;const o=this.computeLatency();if(o===null)return;this._latency=o;const{lowLatencyMode:c,maxLiveSyncPlaybackRate:d}=this.config;if(!c||d===1||!a.live)return;const g=this.targetLatency;if(g===null)return;const b=o-g,_=Math.min(this.maxLatency,g+a.targetduration);if(b<_&&b>.05&&this.forwardBufferLength>1){const $=Math.min(2,Math.max(1,d)),_e=Math.round(2/(1+Math.exp(-.75*b-this.edgeStalled))*20)/20,tt=Math.min($,Math.max(1,_e));this.changeMediaPlaybackRate(i,tt)}else i.playbackRate!==1&&i.playbackRate!==0&&this.changeMediaPlaybackRate(i,1)},this.hls=e,this.config=e.config,this.registerListeners()}get levelDetails(){var e;return((e=this.hls)==null?void 0:e.latestLevelDetails)||null}get latency(){return this._latency||0}get maxLatency(){const{config:e}=this;if(e.liveMaxLatencyDuration!==void 0)return e.liveMaxLatencyDuration;const i=this.levelDetails;return i?e.liveMaxLatencyDurationCount*i.targetduration:0}get targetLatency(){const e=this.levelDetails;if(e===null||this.hls===null)return null;const{holdBack:i,partHoldBack:a,targetduration:o}=e,{liveSyncDuration:c,liveSyncDurationCount:d,lowLatencyMode:g}=this.config,b=this.hls.userConfig;let _=g&&a||i;(this._targetLatencyUpdated||b.liveSyncDuration||b.liveSyncDurationCount||_===0)&&(_=c!==void 0?c:d*o);const j=o;return _+Math.min(this.stallCount*this.config.liveSyncOnStallIncrease,j)}set targetLatency(e){this.stallCount=0,this.config.liveSyncDuration=e,this._targetLatencyUpdated=!0}get liveSyncPosition(){const e=this.estimateLiveEdge(),i=this.targetLatency;if(e===null||i===null)return null;const a=this.levelDetails;if(a===null)return null;const o=a.edge,c=e-i-this.edgeStalled,d=o-a.totalduration,g=o-(this.config.lowLatencyMode&&a.partTarget||a.targetduration);return Math.min(Math.max(d,c),g)}get drift(){const e=this.levelDetails;return e===null?1:e.drift}get edgeStalled(){const e=this.levelDetails;if(e===null)return 0;const i=(this.config.lowLatencyMode&&e.partTarget||e.targetduration)*3;return Math.max(e.age-i,0)}get forwardBufferLength(){const{media:e}=this,i=this.levelDetails;if(!e||!i)return 0;const a=e.buffered.length;return(a?e.buffered.end(a-1):i.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.hls=null}registerListeners(){const{hls:e}=this;e&&(e.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Events.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(Events.ERROR,this.onError,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Events.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(Events.ERROR,this.onError,this))}onMediaAttached(e,i){this.media=i.media,this.media.addEventListener("timeupdate",this.onTimeupdate)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.onTimeupdate),this.media=null)}onManifestLoading(){this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:i}){i.advanced&&this.onTimeupdate(),!i.live&&this.media&&this.media.removeEventListener("timeupdate",this.onTimeupdate)}onError(e,i){var a;i.details===ErrorDetails.BUFFER_STALLED_ERROR&&(this.stallCount++,this.hls&&(a=this.levelDetails)!=null&&a.live&&this.hls.logger.warn("[latency-controller]: Stall detected, adjusting target latency"))}changeMediaPlaybackRate(e,i){var a,o;e.playbackRate!==i&&((a=this.hls)==null||a.logger.debug(`[latency-controller]: latency=${this.latency.toFixed(3)}, targetLatency=${(o=this.targetLatency)==null?void 0:o.toFixed(3)}, forwardBufferLength=${this.forwardBufferLength.toFixed(3)}: adjusting playback rate from ${e.playbackRate} to ${i}`),e.playbackRate=i)}estimateLiveEdge(){const e=this.levelDetails;return e===null?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return e===null?null:e-this.currentTime}}class LevelController extends BasePlaylistController{constructor(e,i){super(e,"level-controller"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=i,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Events.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(Events.LEVEL_LOADED,this.onLevelLoaded,this),e.on(Events.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(Events.FRAG_BUFFERED,this.onFragBuffered,this),e.on(Events.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Events.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(Events.LEVEL_LOADED,this.onLevelLoaded,this),e.off(Events.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(Events.FRAG_BUFFERED,this.onFragBuffered,this),e.off(Events.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach(i=>{i.loadError=0,i.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(e,i){this.resetLevels()}onManifestLoaded(e,i){const a=this.hls.config.preferManagedMediaSource,o=[],c={},d={};let g=!1,b=!1,_=!1;i.levels.forEach(j=>{const $=j.attrs;let{audioCodec:_e,videoCodec:tt}=j;_e&&(j.audioCodec=_e=getCodecCompatibleName(_e,a)||void 0),tt&&(tt=j.videoCodec=convertAVC1ToAVCOTI(tt));const{width:et,height:st,unknownCodecs:at}=j,rt=(at==null?void 0:at.length)||0;if(g||(g=!!(et&&st)),b||(b=!!tt),_||(_=!!_e),rt||_e&&!this.isAudioSupported(_e)||tt&&!this.isVideoSupported(tt)){this.log(`Some or all CODECS not supported "${$.CODECS}"`);return}const{CODECS:nt,"FRAME-RATE":it,"HDCP-LEVEL":ot,"PATHWAY-ID":lt,RESOLUTION:ct,"VIDEO-RANGE":ht}=$,gt=`${`${lt||"."}-`}${j.bitrate}-${ct}-${it}-${nt}-${ht}-${ot}`;if(c[gt])if(c[gt].uri!==j.url&&!j.attrs["PATHWAY-ID"]){const vt=d[gt]+=1;j.attrs["PATHWAY-ID"]=new Array(vt+1).join(".");const St=this.createLevel(j);c[gt]=St,o.push(St)}else c[gt].addGroupId("audio",$.AUDIO),c[gt].addGroupId("text",$.SUBTITLES);else{const vt=this.createLevel(j);c[gt]=vt,d[gt]=1,o.push(vt)}}),this.filterAndSortMediaOptions(o,i,g,b,_)}createLevel(e){const i=new Level(e),a=e.supplemental;if(a!=null&&a.videoCodec&&!this.isVideoSupported(a.videoCodec)){const o=new Error(`SUPPLEMENTAL-CODECS not supported "${a.videoCodec}"`);this.log(o.message),i.supportedResult=getUnsupportedResult(o,[])}return i}isAudioSupported(e){return areCodecsMediaSourceSupported(e,"audio",this.hls.config.preferManagedMediaSource)}isVideoSupported(e){return areCodecsMediaSourceSupported(e,"video",this.hls.config.preferManagedMediaSource)}filterAndSortMediaOptions(e,i,a,o,c){var d;let g=[],b=[],_=e;const j=((d=i.stats)==null?void 0:d.parsing)||{};if((a||o)&&c&&(_=_.filter(({videoCodec:nt,videoRange:it,width:ot,height:lt})=>(!!nt||!!(ot&&lt))&&isVideoRange(it))),_.length===0){Promise.resolve().then(()=>{if(this.hls){let nt="no level with compatible codecs found in manifest",it=nt;i.levels.length&&(it=`one or more CODECS in variant not supported: ${stringify(i.levels.map(lt=>lt.attrs.CODECS).filter((lt,ct,ht)=>ht.indexOf(lt)===ct))}`,this.warn(it),nt+=` (${it})`);const ot=new Error(nt);this.hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:i.url,error:ot,reason:it})}}),j.end=performance.now();return}i.audioTracks&&(g=i.audioTracks.filter(nt=>!nt.audioCodec||this.isAudioSupported(nt.audioCodec)),assignTrackIdsByGroup(g)),i.subtitles&&(b=i.subtitles,assignTrackIdsByGroup(b));const $=_.slice(0);_.sort((nt,it)=>{if(nt.attrs["HDCP-LEVEL"]!==it.attrs["HDCP-LEVEL"])return(nt.attrs["HDCP-LEVEL"]||"")>(it.attrs["HDCP-LEVEL"]||"")?1:-1;if(a&&nt.height!==it.height)return nt.height-it.height;if(nt.frameRate!==it.frameRate)return nt.frameRate-it.frameRate;if(nt.videoRange!==it.videoRange)return VideoRangeValues.indexOf(nt.videoRange)-VideoRangeValues.indexOf(it.videoRange);if(nt.videoCodec!==it.videoCodec){const ot=videoCodecPreferenceValue(nt.videoCodec),lt=videoCodecPreferenceValue(it.videoCodec);if(ot!==lt)return lt-ot}if(nt.uri===it.uri&&nt.codecSet!==it.codecSet){const ot=codecsSetSelectionPreferenceValue(nt.codecSet),lt=codecsSetSelectionPreferenceValue(it.codecSet);if(ot!==lt)return lt-ot}return nt.averageBitrate!==it.averageBitrate?nt.averageBitrate-it.averageBitrate:0});let _e=$[0];if(this.steering&&(_=this.steering.filterParsedLevels(_),_.length!==$.length)){for(let nt=0;nt<$.length;nt++)if($[nt].pathwayId===_[0].pathwayId){_e=$[nt];break}}this._levels=_;for(let nt=0;nt<_.length;nt++)if(_[nt]===_e){var tt;this._firstLevel=nt;const it=_e.bitrate,ot=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${_.length} level(s) found, first bitrate: ${it}`),((tt=this.hls.userConfig)==null?void 0:tt.abrEwmaDefaultEstimate)===void 0){const lt=Math.min(it,this.hls.config.abrEwmaDefaultEstimateMax);lt>ot&&ot===this.hls.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=lt)}break}const et=c&&!o,st=this.hls.config,at=!!(st.audioStreamController&&st.audioTrackController),rt={levels:_,audioTracks:g,subtitleTracks:b,sessionData:i.sessionData,sessionKeys:i.sessionKeys,firstLevel:this._firstLevel,stats:i.stats,audio:c,video:o,altAudio:at&&!et&&g.some(nt=>!!nt.url)};j.end=performance.now(),this.hls.trigger(Events.MANIFEST_PARSED,rt)}get levels(){return this._levels.length===0?null:this._levels}get loadLevelObj(){return this.currentLevel}get level(){return this.currentLevelIndex}set level(e){const i=this._levels;if(i.length===0)return;if(e<0||e>=i.length){const j=new Error("invalid level idx"),$=e<0;if(this.hls.trigger(Events.ERROR,{type:ErrorTypes.OTHER_ERROR,details:ErrorDetails.LEVEL_SWITCH_ERROR,level:e,fatal:$,error:j,reason:j.message}),$)return;e=Math.min(e,i.length-1)}const a=this.currentLevelIndex,o=this.currentLevel,c=o?o.attrs["PATHWAY-ID"]:void 0,d=i[e],g=d.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=d,a===e&&o&&c===g)return;this.log(`Switching to level ${e} (${d.height?d.height+"p ":""}${d.videoRange?d.videoRange+" ":""}${d.codecSet?d.codecSet+" ":""}@${d.bitrate})${g?" with Pathway "+g:""} from level ${a}${c?" with Pathway "+c:""}`);const b={level:e,attrs:d.attrs,details:d.details,bitrate:d.bitrate,averageBitrate:d.averageBitrate,maxBitrate:d.maxBitrate,realBitrate:d.realBitrate,width:d.width,height:d.height,codecSet:d.codecSet,audioCodec:d.audioCodec,videoCodec:d.videoCodec,audioGroups:d.audioGroups,subtitleGroups:d.subtitleGroups,loaded:d.loaded,loadError:d.loadError,fragmentError:d.fragmentError,name:d.name,id:d.id,uri:d.uri,url:d.url,urlId:0,audioGroupIds:d.audioGroupIds,textGroupIds:d.textGroupIds};this.hls.trigger(Events.LEVEL_SWITCHING,b);const _=d.details;if(!_||_.live){const j=this.switchParams(d.uri,o==null?void 0:o.details,_);this.loadPlaylist(j)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,this._startLevel===void 0&&(this._startLevel=e),e!==-1&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(this._startLevel===void 0){const e=this.hls.config.startLevel;return e!==void 0?e:this.hls.firstAutoLevel}return this._startLevel}set startLevel(e){this._startLevel=e}get pathways(){return this.steering?this.steering.pathways():[]}get pathwayPriority(){return this.steering?this.steering.pathwayPriority:null}set pathwayPriority(e){if(this.steering){const i=this.steering.pathways(),a=e.filter(o=>i.indexOf(o)!==-1);if(e.length<1){this.warn(`pathwayPriority ${e} should contain at least one pathway from list: ${i}`);return}this.steering.pathwayPriority=a}}onError(e,i){i.fatal||!i.context||i.context.type===PlaylistContextType.LEVEL&&i.context.level===this.level&&this.checkRetry(i)}onFragBuffered(e,{frag:i}){if(i!==void 0&&i.type===PlaylistLevelType.MAIN){const a=i.elementaryStreams;if(!Object.keys(a).some(c=>!!a[c]))return;const o=this._levels[i.level];o!=null&&o.loadError&&(this.log(`Resetting level error count of ${o.loadError} on frag buffered`),o.loadError=0)}}onLevelLoaded(e,i){var a;const{level:o,details:c}=i,d=i.levelInfo;if(!d){var g;this.warn(`Invalid level index ${o}`),(g=i.deliveryDirectives)!=null&&g.skip&&(c.deltaUpdateFailed=!0);return}if(d===this.currentLevel||i.withoutMultiVariant){d.fragmentError===0&&(d.loadError=0);let b=d.details;b===i.details&&b.advanced&&(b=void 0),this.playlistLoaded(o,i,b)}else(a=i.deliveryDirectives)!=null&&a.skip&&(c.deltaUpdateFailed=!0)}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentLevel)&&this.scheduleLoading(this.currentLevel,e)}loadingPlaylist(e,i){super.loadingPlaylist(e,i);const a=this.getUrlWithDirectives(e.uri,i),o=this.currentLevelIndex,c=e.attrs["PATHWAY-ID"],d=e.details,g=d==null?void 0:d.age;this.log(`Loading level index ${o}${(i==null?void 0:i.msn)!==void 0?" at sn "+i.msn+" part "+i.part:""}${c?" Pathway "+c:""}${g&&d.live?" age "+g.toFixed(1)+(d.type&&" "+d.type||""):""} ${a}`),this.hls.trigger(Events.LEVEL_LOADING,{url:a,level:o,levelInfo:e,pathwayId:e.attrs["PATHWAY-ID"],id:0,deliveryDirectives:i||null})}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=e)}removeLevel(e){var i;if(this._levels.length===1)return;const a=this._levels.filter((c,d)=>d!==e?!0:(this.steering&&this.steering.removeLevel(c),c===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,c.details&&c.details.fragments.forEach(g=>g.level=-1)),!1));reassignFragmentLevelIndexes(a),this._levels=a,this.currentLevelIndex>-1&&(i=this.currentLevel)!=null&&i.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.manualLevelIndex>-1&&(this.manualLevelIndex=this.currentLevelIndex);const o=a.length-1;this._firstLevel=Math.min(this._firstLevel,o),this._startLevel&&(this._startLevel=Math.min(this._startLevel,o)),this.hls.trigger(Events.LEVELS_UPDATED,{levels:a})}onLevelsUpdated(e,{levels:i}){this._levels=i}checkMaxAutoUpdated(){const{autoLevelCapping:e,maxAutoLevel:i,maxHdcpLevel:a}=this.hls;this._maxAutoLevel!==i&&(this._maxAutoLevel=i,this.hls.trigger(Events.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:e,levels:this.levels,maxAutoLevel:i,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:a}))}}function assignTrackIdsByGroup(s){const e={};s.forEach(i=>{const a=i.groupId||"";i.id=e[a]=e[a]||0,e[a]++})}function getSourceBuffer(){return self.SourceBuffer||self.WebKitSourceBuffer}function isMSESupported(){if(!getMediaSource())return!1;const e=getSourceBuffer();return!e||e.prototype&&typeof e.prototype.appendBuffer=="function"&&typeof e.prototype.remove=="function"}function isSupported(){if(!isMSESupported())return!1;const s=getMediaSource();return typeof(s==null?void 0:s.isTypeSupported)=="function"&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(e=>s.isTypeSupported(mimeTypeForCodec(e,"video")))||["mp4a.40.2","fLaC"].some(e=>s.isTypeSupported(mimeTypeForCodec(e,"audio"))))}function changeTypeSupported(){var s;const e=getSourceBuffer();return typeof(e==null||(s=e.prototype)==null?void 0:s.changeType)=="function"}const TICK_INTERVAL=100;class StreamController extends BaseStreamController{constructor(e,i,a){super(e,i,a,"stream-controller",PlaylistLevelType.MAIN),this.audioCodecSwap=!1,this.level=-1,this._forceStartLoad=!1,this._hasEnoughToStart=!1,this.altAudio=0,this.audioOnly=!1,this.fragPlaying=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this.onMediaPlaying=()=>{this.tick()},this.onMediaSeeked=()=>{const o=this.media,c=o?o.currentTime:null;if(c===null||!isFiniteNumber(c)||(this.log(`Media seeked to ${c.toFixed(3)}`),!this.getBufferedFrag(c)))return;const d=this.getFwdBufferInfoAtPos(o,c,PlaylistLevelType.MAIN,0);if(d===null||d.len===0){this.warn(`Main forward buffer length at ${c} on "seeked" event ${d?d.len:"empty"})`);return}this.tick()},this.registerListeners()}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(Events.MANIFEST_PARSED,this.onManifestParsed,this),e.on(Events.LEVEL_LOADING,this.onLevelLoading,this),e.on(Events.LEVEL_LOADED,this.onLevelLoaded,this),e.on(Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(Events.BUFFER_CREATED,this.onBufferCreated,this),e.on(Events.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(Events.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(Events.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(Events.MANIFEST_PARSED,this.onManifestParsed,this),e.off(Events.LEVEL_LOADED,this.onLevelLoaded,this),e.off(Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(Events.BUFFER_CREATED,this.onBufferCreated,this),e.off(Events.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(Events.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(Events.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this.onMediaPlaying=this.onMediaSeeked=null,this.unregisterListeners(),super.onHandlerDestroying()}startLoad(e,i){if(this.levels){const{lastCurrentTime:a,hls:o}=this;if(this.stopLoad(),this.setInterval(TICK_INTERVAL),this.level=-1,!this.startFragRequested){let c=o.startLevel;c===-1&&(o.config.testBandwidth&&this.levels.length>1?(c=0,this.bitrateTest=!0):c=o.firstAutoLevel),o.nextLoadLevel=c,this.level=o.loadLevel,this._hasEnoughToStart=!!i}a>0&&e===-1&&!i&&(this.log(`Override startPosition with lastCurrentTime @${a.toFixed(3)}`),e=a),this.state=State.IDLE,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=i?-1:e,this.tick()}else this._forceStartLoad=!0,this.state=State.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case State.WAITING_LEVEL:{const{levels:e,level:i}=this,a=e==null?void 0:e[i],o=a==null?void 0:a.details;if(o&&(!o.live||this.levelLastLoaded===a&&!this.waitForLive(a))){if(this.waitForCdnTuneIn(o))break;this.state=State.IDLE;break}else if(this.hls.nextLoadLevel!==this.level){this.state=State.IDLE;break}break}case State.FRAG_LOADING_WAITING_RETRY:this.checkRetryDate();break}this.state===State.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){var e;super.onTickEnd(),(e=this.media)!=null&&e.readyState&&this.media.seeking===!1&&(this.lastCurrentTime=this.media.currentTime),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:i,levels:a,media:o}=this;if(i===null||!o&&!this.primaryPrefetch&&(this.startFragRequested||!e.config.startFragPrefetch)||this.altAudio&&this.audioOnly)return;const c=this.buffering?e.nextLoadLevel:e.loadLevel;if(!(a!=null&&a[c]))return;const d=a[c],g=this.getMainFwdBufferInfo();if(g===null)return;const b=this.getLevelDetails();if(b&&this._streamEnded(g,b)){const st={};this.altAudio===2&&(st.type="video"),this.hls.trigger(Events.BUFFER_EOS,st),this.state=State.ENDED;return}if(!this.buffering)return;e.loadLevel!==c&&e.manualLevel===-1&&this.log(`Adapting to level ${c} from level ${this.level}`),this.level=e.nextLoadLevel=c;const _=d.details;if(!_||this.state===State.WAITING_LEVEL||this.waitForLive(d)){this.level=c,this.state=State.WAITING_LEVEL,this.startFragRequested=!1;return}const j=g.len,$=this.getMaxBufferLength(d.maxBitrate);if(j>=$)return;this.backtrackFragment&&this.backtrackFragment.start>g.end&&(this.backtrackFragment=null);const _e=this.backtrackFragment?this.backtrackFragment.start:g.end;let tt=this.getNextFragment(_e,_);if(this.couldBacktrack&&!this.fragPrevious&&tt&&isMediaFragment(tt)&&this.fragmentTracker.getState(tt)!==FragmentState.OK){var et;const at=((et=this.backtrackFragment)!=null?et:tt).sn-_.startSN,rt=_.fragments[at-1];rt&&tt.cc===rt.cc&&(tt=rt,this.fragmentTracker.removeFragment(rt))}else this.backtrackFragment&&g.len&&(this.backtrackFragment=null);if(tt&&this.isLoopLoading(tt,_e)){if(!tt.gap){const at=this.audioOnly&&!this.altAudio?ElementaryStreamTypes.AUDIO:ElementaryStreamTypes.VIDEO,rt=(at===ElementaryStreamTypes.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;rt&&this.afterBufferFlushed(rt,at,PlaylistLevelType.MAIN)}tt=this.getNextFragmentLoopLoading(tt,_,g,PlaylistLevelType.MAIN,$)}tt&&(tt.initSegment&&!tt.initSegment.data&&!this.bitrateTest&&(tt=tt.initSegment),this.loadFragment(tt,d,_e))}loadFragment(e,i,a){const o=this.fragmentTracker.getState(e);o===FragmentState.NOT_LOADED||o===FragmentState.PARTIAL?isMediaFragment(e)?this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,i)):super.loadFragment(e,i,a):this._loadInitSegment(e,i):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,PlaylistLevelType.MAIN)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:i}=this;if(i!=null&&i.readyState){let a;const o=this.getAppendedFrag(i.currentTime);o&&o.start>1&&this.flushMainBuffer(0,o.start-1);const c=this.getLevelDetails();if(c!=null&&c.live){const g=this.getMainFwdBufferInfo();if(!g||g.len<c.targetduration*2)return}if(!i.paused&&e){const g=this.hls.nextLoadLevel,b=e[g],_=this.fragLastKbps;_&&this.fragCurrent?a=this.fragCurrent.duration*b.maxBitrate/(1e3*_)+1:a=0}else a=0;const d=this.getBufferedFrag(i.currentTime+a);if(d){const g=this.followingBufferedFrag(d);if(g){this.abortCurrentFrag();const b=g.maxStartPTS?g.maxStartPTS:g.start,_=g.duration,j=Math.max(d.end,b+Math.min(Math.max(_-this.config.maxFragLookUpTolerance,_*(this.couldBacktrack?.5:.125)),_*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(j,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case State.KEY_LOADING:case State.FRAG_LOADING:case State.FRAG_LOADING_WAITING_RETRY:case State.PARSING:case State.PARSED:this.state=State.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,i){super.flushMainBuffer(e,i,this.altAudio===2?"video":null)}onMediaAttached(e,i){super.onMediaAttached(e,i);const a=i.media;addEventListener(a,"playing",this.onMediaPlaying),addEventListener(a,"seeked",this.onMediaSeeked)}onMediaDetaching(e,i){const{media:a}=this;a&&(removeEventListener(a,"playing",this.onMediaPlaying),removeEventListener(a,"seeked",this.onMediaSeeked)),this.videoBuffer=null,this.fragPlaying=null,super.onMediaDetaching(e,i),!i.transferMedia&&(this._hasEnoughToStart=!1)}onManifestLoading(){super.onManifestLoading(),this.log("Trigger BUFFER_RESET"),this.hls.trigger(Events.BUFFER_RESET,void 0),this.couldBacktrack=!1,this.fragLastKbps=0,this.fragPlaying=this.backtrackFragment=null,this.altAudio=0,this.audioOnly=!1}onManifestParsed(e,i){let a=!1,o=!1;for(let c=0;c<i.levels.length;c++){const d=i.levels[c].audioCodec;d&&(a=a||d.indexOf("mp4a.40.2")!==-1,o=o||d.indexOf("mp4a.40.5")!==-1)}this.audioCodecSwitch=a&&o&&!changeTypeSupported(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=i.levels,this.startFragRequested=!1}onLevelLoading(e,i){const{levels:a}=this;if(!a||this.state!==State.IDLE)return;const o=i.levelInfo;(!o.details||o.details.live&&(this.levelLastLoaded!==o||o.details.expired)||this.waitForCdnTuneIn(o.details))&&(this.state=State.WAITING_LEVEL)}onLevelLoaded(e,i){var a;const{levels:o,startFragRequested:c}=this,d=i.level,g=i.details,b=g.totalduration;if(!o){this.warn(`Levels were reset while loading level ${d}`);return}this.log(`Level ${d} loaded [${g.startSN},${g.endSN}]${g.lastPartSn?`[part-${g.lastPartSn}-${g.lastPartIndex}]`:""}, cc [${g.startCC}, ${g.endCC}] duration:${b}`);const _=i.levelInfo,j=this.fragCurrent;j&&(this.state===State.FRAG_LOADING||this.state===State.FRAG_LOADING_WAITING_RETRY)&&j.level!==i.level&&j.loader&&this.abortCurrentFrag();let $=0;if(g.live||(a=_.details)!=null&&a.live){var _e;if(this.checkLiveUpdate(g),g.deltaUpdateFailed)return;$=this.alignPlaylists(g,_.details,(_e=this.levelLastLoaded)==null?void 0:_e.details)}if(_.details=g,this.levelLastLoaded=_,c||this.setStartPosition(g,$),this.hls.trigger(Events.LEVEL_UPDATED,{details:g,level:d}),this.state===State.WAITING_LEVEL){if(this.waitForCdnTuneIn(g))return;this.state=State.IDLE}c&&g.live&&this.synchronizeToLiveEdge(g),this.tick()}synchronizeToLiveEdge(e){const{config:i,media:a}=this;if(!a)return;const o=this.hls.liveSyncPosition,c=this.getLoadPosition(),d=e.fragmentStart,g=e.edge,b=c>=d-i.maxFragLookUpTolerance&&c<=g;if(o!==null&&a.duration>o&&(c<o||!b)){const j=i.liveMaxLatencyDuration!==void 0?i.liveMaxLatencyDuration:i.liveMaxLatencyDurationCount*e.targetduration;if((!b&&a.readyState<4||c<g-j)&&(this._hasEnoughToStart||(this.nextLoadPosition=o),a.readyState))if(this.warn(`Playback: ${c.toFixed(3)} is located too far from the end of live sliding playlist: ${g}, reset currentTime to : ${o.toFixed(3)}`),this.config.liveSyncMode==="buffered"){var _;const $=BufferHelper.bufferInfo(a,o,0);if(!((_=$.buffered)!=null&&_.length)){a.currentTime=o;return}if($.start<=c){a.currentTime=o;return}const{nextStart:tt}=BufferHelper.bufferedInfo($.buffered,c,0);tt&&(a.currentTime=tt)}else a.currentTime=o}}_handleFragmentLoadProgress(e){var i;const a=e.frag,{part:o,payload:c}=e,{levels:d}=this;if(!d){this.warn(`Levels were reset while fragment load was in progress. Fragment ${a.sn} of level ${a.level} will not be buffered`);return}const g=d[a.level];if(!g){this.warn(`Level ${a.level} not found on progress`);return}const b=g.details;if(!b){this.warn(`Dropping fragment ${a.sn} of level ${a.level} after level details were reset`),this.fragmentTracker.removeFragment(a);return}const _=g.videoCodec,j=b.PTSKnown||!b.live,$=(i=a.initSegment)==null?void 0:i.data,_e=this._getAudioCodec(g),tt=this.transmuxer=this.transmuxer||new TransmuxerInterface(this.hls,PlaylistLevelType.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),et=o?o.index:-1,st=et!==-1,at=new ChunkMetadata(a.level,a.sn,a.stats.chunkCount,c.byteLength,et,st),rt=this.initPTS[a.cc];tt.push(c,$,_e,_,a,o,b.totalduration,j,at,rt)}onAudioTrackSwitching(e,i){const a=this.hls,o=this.altAudio===2;if(useAlternateAudio(i.url,a))this.altAudio=1;else{if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const d=this.fragCurrent;d&&(this.log("Switching to main audio track, cancel main fragment load"),d.abortRequests(),this.fragmentTracker.removeFragment(d)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();if(o){this.fragmentTracker.removeAllFragments(),a.once(Events.BUFFER_FLUSHED,()=>{this.hls&&this.hls.trigger(Events.AUDIO_TRACK_SWITCHED,i)}),a.trigger(Events.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null});return}a.trigger(Events.AUDIO_TRACK_SWITCHED,i)}}onAudioTrackSwitched(e,i){const a=useAlternateAudio(i.url,this.hls);if(a){const o=this.videoBuffer;o&&this.mediaBuffer!==o&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=o)}this.altAudio=a?2:0,this.tick()}onBufferCreated(e,i){const a=i.tracks;let o,c,d=!1;for(const g in a){const b=a[g];if(b.id==="main"){if(c=g,o=b,g==="video"){const _=a[g];_&&(this.videoBuffer=_.buffer)}}else d=!0}d&&o?(this.log(`Alternate track found, use ${c}.buffered to schedule main fragment loading`),this.mediaBuffer=o.buffer):this.mediaBuffer=this.media}onFragBuffered(e,i){const{frag:a,part:o}=i,c=a.type===PlaylistLevelType.MAIN;if(c){if(this.fragContextChanged(a)){this.warn(`Fragment ${a.sn}${o?" p: "+o.index:""} of level ${a.level} finished buffering, but was aborted. state: ${this.state}`),this.state===State.PARSED&&(this.state=State.IDLE);return}const g=o?o.stats:a.stats;this.fragLastKbps=Math.round(8*g.total/(g.buffering.end-g.loading.first)),isMediaFragment(a)&&(this.fragPrevious=a),this.fragBufferedComplete(a,o)}const d=this.media;d&&(!this._hasEnoughToStart&&BufferHelper.getBuffered(d).length&&(this._hasEnoughToStart=!0,this.seekToStartPos()),c&&this.tick())}get hasEnoughToStart(){return this._hasEnoughToStart}onError(e,i){var a;if(i.fatal){this.state=State.ERROR;return}switch(i.details){case ErrorDetails.FRAG_GAP:case ErrorDetails.FRAG_PARSING_ERROR:case ErrorDetails.FRAG_DECRYPT_ERROR:case ErrorDetails.FRAG_LOAD_ERROR:case ErrorDetails.FRAG_LOAD_TIMEOUT:case ErrorDetails.KEY_LOAD_ERROR:case ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(PlaylistLevelType.MAIN,i);break;case ErrorDetails.LEVEL_LOAD_ERROR:case ErrorDetails.LEVEL_LOAD_TIMEOUT:case ErrorDetails.LEVEL_PARSING_ERROR:!i.levelRetry&&this.state===State.WAITING_LEVEL&&((a=i.context)==null?void 0:a.type)===PlaylistContextType.LEVEL&&(this.state=State.IDLE);break;case ErrorDetails.BUFFER_ADD_CODEC_ERROR:case ErrorDetails.BUFFER_APPEND_ERROR:if(i.parent!=="main")return;this.reduceLengthAndFlushBuffer(i)&&this.resetLoadingState();break;case ErrorDetails.BUFFER_FULL_ERROR:if(i.parent!=="main")return;this.reduceLengthAndFlushBuffer(i)&&(!this.config.interstitialsController&&this.config.assetPlayerId?this._hasEnoughToStart=!0:this.flushMainBuffer(0,Number.POSITIVE_INFINITY));break;case ErrorDetails.INTERNAL_EXCEPTION:this.recoverWorkerError(i);break}}onFragLoadEmergencyAborted(){this.state=State.IDLE,this._hasEnoughToStart||(this.startFragRequested=!1,this.nextLoadPosition=this.lastCurrentTime),this.tickImmediate()}onBufferFlushed(e,{type:i}){if(i!==ElementaryStreamTypes.AUDIO||!this.altAudio){const a=(i===ElementaryStreamTypes.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;a&&(this.afterBufferFlushed(a,i,PlaylistLevelType.MAIN),this.tick())}}onLevelsUpdated(e,i){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level,this.level===-1&&this.resetWhenMissingContext(this.fragCurrent)),this.levels=i.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const i=e.currentTime;let a=this.startPosition;if(a>=0&&i<a){if(e.seeking){this.log(`could not seek to ${a}, already seeking at ${i}`);return}const o=this.timelineOffset;o&&a&&(a+=o);const c=this.getLevelDetails(),d=BufferHelper.getBuffered(e),g=d.length?d.start(0):0,b=g-a,_=Math.max(this.config.maxBufferHole,this.config.maxFragLookUpTolerance);(this.config.startOnSegmentBoundary||b>0&&(b<_||this.loadingParts&&b<2*((c==null?void 0:c.partTarget)||0)))&&(this.log(`adjusting start position by ${b} to match buffer start`),a+=b,this.startPosition=a),i<a&&(this.log(`seek to target start position ${a} from current time ${i} buffer start ${g}`),e.currentTime=a)}}_getAudioCodec(e){let i=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&i&&(this.log("Swapping audio codec"),i.indexOf("mp4a.40.5")!==-1?i="mp4a.40.2":i="mp4a.40.5"),i}_loadBitrateTestFrag(e,i){e.bitrateTest=!0,this._doFragLoad(e,i).then(a=>{const{hls:o}=this,c=a==null?void 0:a.frag;if(!c||this.fragContextChanged(c))return;i.fragmentError=0,this.state=State.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const d=c.stats;d.parsing.start=d.parsing.end=d.buffering.start=d.buffering.end=self.performance.now(),o.trigger(Events.FRAG_LOADED,a),c.bitrateTest=!1}).catch(a=>{this.state===State.STOPPED||this.state===State.ERROR||(this.warn(a),this.resetFragmentLoading(e))})}_handleTransmuxComplete(e){const i=this.playlistType,{hls:a}=this,{remuxResult:o,chunkMeta:c}=e,d=this.getCurrentContext(c);if(!d){this.resetWhenMissingContext(c);return}const{frag:g,part:b,level:_}=d,{video:j,text:$,id3:_e,initSegment:tt}=o,{details:et}=_,st=this.altAudio?void 0:o.audio;if(this.fragContextChanged(g)){this.fragmentTracker.removeFragment(g);return}if(this.state=State.PARSING,tt){const at=tt.tracks;if(at){const ot=g.initSegment||g;if(this.unhandledEncryptionError(tt,g))return;this._bufferInitSegment(_,at,ot,c),a.trigger(Events.FRAG_PARSING_INIT_SEGMENT,{frag:ot,id:i,tracks:at})}const rt=tt.initPTS,nt=tt.timescale,it=this.initPTS[g.cc];if(isFiniteNumber(rt)&&(!it||it.baseTime!==rt||it.timescale!==nt)){const ot=tt.trackId;this.initPTS[g.cc]={baseTime:rt,timescale:nt,trackId:ot},a.trigger(Events.INIT_PTS_FOUND,{frag:g,id:i,initPTS:rt,timescale:nt,trackId:ot})}}if(j&&et){st&&j.type==="audiovideo"&&this.logMuxedErr(g);const at=et.fragments[g.sn-1-et.startSN],rt=g.sn===et.startSN,nt=!at||g.cc>at.cc;if(o.independent!==!1){const{startPTS:it,endPTS:ot,startDTS:lt,endDTS:ct}=j;if(b)b.elementaryStreams[j.type]={startPTS:it,endPTS:ot,startDTS:lt,endDTS:ct};else if(j.firstKeyFrame&&j.independent&&c.id===1&&!nt&&(this.couldBacktrack=!0),j.dropped&&j.independent){const ht=this.getMainFwdBufferInfo(),dt=(ht?ht.end:this.getLoadPosition())+this.config.maxBufferHole,gt=j.firstKeyFramePTS?j.firstKeyFramePTS:it;if(!rt&&dt<gt-this.config.maxBufferHole&&!nt){this.backtrack(g);return}else nt&&(g.gap=!0);g.setElementaryStreamInfo(j.type,g.start,ot,g.start,ct,!0)}else rt&&it-(et.appliedTimelineOffset||0)>MAX_START_GAP_JUMP&&(g.gap=!0);g.setElementaryStreamInfo(j.type,it,ot,lt,ct),this.backtrackFragment&&(this.backtrackFragment=g),this.bufferFragmentData(j,g,b,c,rt||nt)}else if(rt||nt)g.gap=!0;else{this.backtrack(g);return}}if(st){const{startPTS:at,endPTS:rt,startDTS:nt,endDTS:it}=st;b&&(b.elementaryStreams[ElementaryStreamTypes.AUDIO]={startPTS:at,endPTS:rt,startDTS:nt,endDTS:it}),g.setElementaryStreamInfo(ElementaryStreamTypes.AUDIO,at,rt,nt,it),this.bufferFragmentData(st,g,b,c)}if(et&&_e!=null&&_e.samples.length){const at={id:i,frag:g,details:et,samples:_e.samples};a.trigger(Events.FRAG_PARSING_METADATA,at)}if(et&&$){const at={id:i,frag:g,details:et,samples:$.samples};a.trigger(Events.FRAG_PARSING_USERDATA,at)}}logMuxedErr(e){this.warn(`${isMediaFragment(e)?"Media":"Init"} segment with muxed audiovideo where only video expected: ${e.url}`)}_bufferInitSegment(e,i,a,o){if(this.state!==State.PARSING)return;this.audioOnly=!!i.audio&&!i.video,this.altAudio&&!this.audioOnly&&(delete i.audio,i.audiovideo&&this.logMuxedErr(a));const{audio:c,video:d,audiovideo:g}=i;if(c){const _=e.audioCodec;let j=pickMostCompleteCodecName(c.codec,_);j==="mp4a"&&(j="mp4a.40.5");const $=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){j&&(j.indexOf("mp4a.40.5")!==-1?j="mp4a.40.2":j="mp4a.40.5");const _e=c.metadata;_e&&"channelCount"in _e&&(_e.channelCount||1)!==1&&$.indexOf("firefox")===-1&&(j="mp4a.40.5")}j&&j.indexOf("mp4a.40.5")!==-1&&$.indexOf("android")!==-1&&c.container!=="audio/mpeg"&&(j="mp4a.40.2",this.log(`Android: force audio codec to ${j}`)),_&&_!==j&&this.log(`Swapping manifest audio codec "${_}" for "${j}"`),c.levelCodec=j,c.id=PlaylistLevelType.MAIN,this.log(`Init audio buffer, container:${c.container}, codecs[selected/level/parsed]=[${j||""}/${_||""}/${c.codec}]`),delete i.audiovideo}if(d){d.levelCodec=e.videoCodec,d.id=PlaylistLevelType.MAIN;const _=d.codec;if((_==null?void 0:_.length)===4)switch(_){case"hvc1":case"hev1":d.codec="hvc1.1.6.L120.90";break;case"av01":d.codec="av01.0.04M.08";break;case"avc1":d.codec="avc1.42e01e";break}this.log(`Init video buffer, container:${d.container}, codecs[level/parsed]=[${e.videoCodec||""}/${_}]${d.codec!==_?" parsed-corrected="+d.codec:""}${d.supplemental?" supplemental="+d.supplemental:""}`),delete i.audiovideo}g&&(this.log(`Init audiovideo buffer, container:${g.container}, codecs[level/parsed]=[${e.codecs}/${g.codec}]`),delete i.video,delete i.audio);const b=Object.keys(i);if(b.length){if(this.hls.trigger(Events.BUFFER_CODECS,i),!this.hls)return;b.forEach(_=>{const $=i[_].initSegment;$!=null&&$.byteLength&&this.hls.trigger(Events.BUFFER_APPENDING,{type:_,data:$,frag:a,part:null,chunkMeta:o,parent:a.type})})}this.tickImmediate()}getMainFwdBufferInfo(){const e=this.mediaBuffer&&this.altAudio===2?this.mediaBuffer:this.media;return this.getFwdBufferInfo(e,PlaylistLevelType.MAIN)}get maxBufferLength(){const{levels:e,level:i}=this,a=e==null?void 0:e[i];return a?this.getMaxBufferLength(a.maxBitrate):this.config.maxBufferLength}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=State.IDLE}checkFragmentChanged(){const e=this.media;let i=null;if(e&&e.readyState>1&&e.seeking===!1){const a=e.currentTime;if(BufferHelper.isBuffered(e,a)?i=this.getAppendedFrag(a):BufferHelper.isBuffered(e,a+.1)&&(i=this.getAppendedFrag(a+.1)),i){this.backtrackFragment=null;const o=this.fragPlaying,c=i.level;(!o||i.sn!==o.sn||o.level!==c)&&(this.fragPlaying=i,this.hls.trigger(Events.FRAG_CHANGED,{frag:i}),(!o||o.level!==c)&&this.hls.trigger(Events.LEVEL_SWITCHED,{level:c}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){var e;if(this.fragPlaying)return this.fragPlaying;const i=((e=this.media)==null?void 0:e.currentTime)||this.lastCurrentTime;return isFiniteNumber(i)?this.getAppendedFrag(i):null}get currentProgramDateTime(){var e;const i=((e=this.media)==null?void 0:e.currentTime)||this.lastCurrentTime;if(isFiniteNumber(i)){const a=this.getLevelDetails(),o=this.currentFrag||(a?findFragmentByPTS(null,a.fragments,i):null);if(o){const c=o.programDateTime;if(c!==null){const d=c+(i-o.start)*1e3;return new Date(d)}}}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class KeyLoader extends Logger{constructor(e,i){super("key-loader",i),this.config=void 0,this.keyIdToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(const a in this.keyIdToKeyInfo){const o=this.keyIdToKeyInfo[a].loader;if(o){var i;if(e&&e!==((i=o.context)==null?void 0:i.frag.type))return;o.abort()}}}detach(){for(const e in this.keyIdToKeyInfo){const i=this.keyIdToKeyInfo[e];(i.mediaKeySessionContext||i.decryptdata.isCommonEncryption)&&delete this.keyIdToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyIdToKeyInfo){const i=this.keyIdToKeyInfo[e].loader;i&&i.destroy()}this.keyIdToKeyInfo={}}createKeyLoadError(e,i=ErrorDetails.KEY_LOAD_ERROR,a,o,c){return new LoadError({type:ErrorTypes.NETWORK_ERROR,details:i,fatal:!1,frag:e,response:c,error:a,networkDetails:o})}loadClear(e,i,a){if(this.emeController&&this.config.emeEnabled&&!this.emeController.getSelectedKeySystemFormats().length){if(i.length)for(let o=0,c=i.length;o<c;o++){const d=i[o];if(e.cc<=d.cc&&(!isMediaFragment(e)||!isMediaFragment(d)||e.sn<d.sn)||!a&&o==c-1)return this.emeController.selectKeySystemFormat(d).then(g=>{if(!this.emeController)return;d.setKeyFormat(g);const b=keySystemFormatToKeySystemDomain(g);if(b)return this.emeController.getKeySystemAccess([b])})}if(this.config.requireKeySystemAccessOnStart){const o=getKeySystemsForConfig(this.config);if(o.length)return this.emeController.getKeySystemAccess(o)}}return null}load(e){return!e.decryptdata&&e.encrypted&&this.emeController&&this.config.emeEnabled?this.emeController.selectKeySystemFormat(e).then(i=>this.loadInternal(e,i)):this.loadInternal(e)}loadInternal(e,i){var a,o;i&&e.setKeyFormat(i);const c=e.decryptdata;if(!c){const _=new Error(i?`Expected frag.decryptdata to be defined after setting format ${i}`:`Missing decryption data on fragment in onKeyLoading (emeEnabled with controller: ${this.emeController&&this.config.emeEnabled})`);return Promise.reject(this.createKeyLoadError(e,ErrorDetails.KEY_LOAD_ERROR,_))}const d=c.uri;if(!d)return Promise.reject(this.createKeyLoadError(e,ErrorDetails.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${d}"`)));const g=getKeyId(c);let b=this.keyIdToKeyInfo[g];if((a=b)!=null&&a.decryptdata.key)return c.key=b.decryptdata.key,Promise.resolve({frag:e,keyInfo:b});if(this.emeController&&(o=b)!=null&&o.keyLoadPromise)switch(this.emeController.getKeyStatus(b.decryptdata)){case"usable":case"usable-in-future":return b.keyLoadPromise.then(j=>{const{keyInfo:$}=j;return c.key=$.decryptdata.key,{frag:e,keyInfo:$}})}switch(this.log(`${this.keyIdToKeyInfo[g]?"Rel":"L"}oading${c.keyId?" keyId: "+arrayToHex(c.keyId):""} URI: ${c.uri} from ${e.type} ${e.level}`),b=this.keyIdToKeyInfo[g]={decryptdata:c,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},c.method){case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return c.keyFormat==="identity"?this.loadKeyHTTP(b,e):this.loadKeyEME(b,e);case"AES-128":case"AES-256":case"AES-256-CTR":return this.loadKeyHTTP(b,e);default:return Promise.reject(this.createKeyLoadError(e,ErrorDetails.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${c.method}"`)))}}loadKeyEME(e,i){const a={frag:i,keyInfo:e};if(this.emeController&&this.config.emeEnabled){var o;if(!e.decryptdata.keyId&&(o=i.initSegment)!=null&&o.data){const d=parseKeyIdsFromTenc(i.initSegment.data);if(d.length){const g=d[0];g.some(b=>b!==0)&&(this.log(`Using keyId found in init segment ${arrayToHex(g)}`),e.decryptdata.keyId=g,LevelKey.setKeyIdForUri(e.decryptdata.uri,g))}}const c=this.emeController.loadKey(a);return(e.keyLoadPromise=c.then(d=>(e.mediaKeySessionContext=d,a))).catch(d=>{throw e.keyLoadPromise=null,"data"in d&&(d.data.frag=i),d})}return Promise.resolve(a)}loadKeyHTTP(e,i){const a=this.config,o=a.loader,c=new o(a);return i.keyLoader=e.loader=c,e.keyLoadPromise=new Promise((d,g)=>{const b={keyInfo:e,frag:i,responseType:"arraybuffer",url:e.decryptdata.uri},_=a.keyLoadPolicy.default,j={loadPolicy:_,timeout:_.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},$={onSuccess:(_e,tt,et,st)=>{const{frag:at,keyInfo:rt}=et,nt=getKeyId(rt.decryptdata);if(!at.decryptdata||rt!==this.keyIdToKeyInfo[nt])return g(this.createKeyLoadError(at,ErrorDetails.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),st));rt.decryptdata.key=at.decryptdata.key=new Uint8Array(_e.data),at.keyLoader=null,rt.loader=null,d({frag:at,keyInfo:rt})},onError:(_e,tt,et,st)=>{this.resetLoader(tt),g(this.createKeyLoadError(i,ErrorDetails.KEY_LOAD_ERROR,new Error(`HTTP Error ${_e.code} loading key ${_e.text}`),et,_objectSpread2({url:b.url,data:void 0},_e)))},onTimeout:(_e,tt,et)=>{this.resetLoader(tt),g(this.createKeyLoadError(i,ErrorDetails.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),et))},onAbort:(_e,tt,et)=>{this.resetLoader(tt),g(this.createKeyLoadError(i,ErrorDetails.INTERNAL_ABORTED,new Error("key loading aborted"),et))}};c.load(b,j,$)})}resetLoader(e){const{frag:i,keyInfo:a,url:o}=e,c=a.loader;i.keyLoader===c&&(i.keyLoader=null,a.loader=null);const d=getKeyId(a.decryptdata)||o;delete this.keyIdToKeyInfo[d],c&&c.destroy()}}function getKeyId(s){if(s.keyFormat!==KeySystemFormats.FAIRPLAY){const e=s.keyId;if(e)return arrayToHex(e)}return s.uri}function mapContextToLevelType(s){const{type:e}=s;switch(e){case PlaylistContextType.AUDIO_TRACK:return PlaylistLevelType.AUDIO;case PlaylistContextType.SUBTITLE_TRACK:return PlaylistLevelType.SUBTITLE;default:return PlaylistLevelType.MAIN}}function getResponseUrl(s,e){let i=s.url;return(i===void 0||i.indexOf("data:")===0)&&(i=e.url),i}class PlaylistLoader{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.onManifestLoaded=this.checkAutostartLoad,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Events.LEVEL_LOADING,this.onLevelLoading,this),e.on(Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.on(Events.LEVELS_UPDATED,this.onLevelsUpdated,this)}unregisterListeners(){const{hls:e}=this;e.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Events.LEVEL_LOADING,this.onLevelLoading,this),e.off(Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.off(Events.LEVELS_UPDATED,this.onLevelsUpdated,this)}createInternalLoader(e){const i=this.hls.config,a=i.pLoader,o=i.loader,c=a||o,d=new c(i);return this.loaders[e.type]=d,d}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const i=this.loaders[e];i&&i.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,i){const{url:a}=i;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:PlaylistContextType.MANIFEST,url:a,deliveryDirectives:null,levelOrTrack:null})}onLevelLoading(e,i){const{id:a,level:o,pathwayId:c,url:d,deliveryDirectives:g,levelInfo:b}=i;this.load({id:a,level:o,pathwayId:c,responseType:"text",type:PlaylistContextType.LEVEL,url:d,deliveryDirectives:g,levelOrTrack:b})}onAudioTrackLoading(e,i){const{id:a,groupId:o,url:c,deliveryDirectives:d,track:g}=i;this.load({id:a,groupId:o,level:null,responseType:"text",type:PlaylistContextType.AUDIO_TRACK,url:c,deliveryDirectives:d,levelOrTrack:g})}onSubtitleTrackLoading(e,i){const{id:a,groupId:o,url:c,deliveryDirectives:d,track:g}=i;this.load({id:a,groupId:o,level:null,responseType:"text",type:PlaylistContextType.SUBTITLE_TRACK,url:c,deliveryDirectives:d,levelOrTrack:g})}onLevelsUpdated(e,i){const a=this.loaders[PlaylistContextType.LEVEL];if(a){const o=a.context;o&&!i.levels.some(c=>c===o.levelOrTrack)&&(a.abort(),delete this.loaders[PlaylistContextType.LEVEL])}}load(e){var i;const a=this.hls.config;let o=this.getInternalLoader(e);if(o){const _=this.hls.logger,j=o.context;if(j&&j.levelOrTrack===e.levelOrTrack&&(j.url===e.url||j.deliveryDirectives&&!e.deliveryDirectives)){j.url===e.url?_.log(`[playlist-loader]: ignore ${e.url} ongoing request`):_.log(`[playlist-loader]: ignore ${e.url} in favor of ${j.url}`);return}_.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),o.abort()}let c;if(e.type===PlaylistContextType.MANIFEST?c=a.manifestLoadPolicy.default:c=_extends({},a.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),o=this.createInternalLoader(e),isFiniteNumber((i=e.deliveryDirectives)==null?void 0:i.part)){let _;if(e.type===PlaylistContextType.LEVEL&&e.level!==null?_=this.hls.levels[e.level].details:e.type===PlaylistContextType.AUDIO_TRACK&&e.id!==null?_=this.hls.audioTracks[e.id].details:e.type===PlaylistContextType.SUBTITLE_TRACK&&e.id!==null&&(_=this.hls.subtitleTracks[e.id].details),_){const j=_.partTarget,$=_.targetduration;if(j&&$){const _e=Math.max(j*3,$*.8)*1e3;c=_extends({},c,{maxTimeToFirstByteMs:Math.min(_e,c.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(_e,c.maxTimeToFirstByteMs)})}}}const d=c.errorRetry||c.timeoutRetry||{},g={loadPolicy:c,timeout:c.maxLoadTimeMs,maxRetry:d.maxNumRetry||0,retryDelay:d.retryDelayMs||0,maxRetryDelay:d.maxRetryDelayMs||0},b={onSuccess:(_,j,$,_e)=>{const tt=this.getInternalLoader($);this.resetInternalLoader($.type);const et=_.data;j.parsing.start=performance.now(),M3U8Parser.isMediaPlaylist(et)||$.type!==PlaylistContextType.MANIFEST?this.handleTrackOrLevelPlaylist(_,j,$,_e||null,tt):this.handleMasterPlaylist(_,j,$,_e)},onError:(_,j,$,_e)=>{this.handleNetworkError(j,$,!1,_,_e)},onTimeout:(_,j,$)=>{this.handleNetworkError(j,$,!0,void 0,_)}};o.load(e,g,b)}checkAutostartLoad(){if(!this.hls)return;const{config:{autoStartLoad:e,startPosition:i},forceStartLoad:a}=this.hls;(e||a)&&(this.hls.logger.log(`${e?"auto":"force"} startLoad with configured startPosition ${i}`),this.hls.startLoad(i))}handleMasterPlaylist(e,i,a,o){const c=this.hls,d=e.data,g=getResponseUrl(e,a),b=M3U8Parser.parseMasterPlaylist(d,g);if(b.playlistParsingError){i.parsing.end=performance.now(),this.handleManifestParsingError(e,a,b.playlistParsingError,o,i);return}const{contentSteering:_,levels:j,sessionData:$,sessionKeys:_e,startTimeOffset:tt,variableList:et}=b;this.variableList=et,j.forEach(nt=>{const{unknownCodecs:it}=nt;if(it){const{preferManagedMediaSource:ot}=this.hls.config;let{audioCodec:lt,videoCodec:ct}=nt;for(let ht=it.length;ht--;){const dt=it[ht];areCodecsMediaSourceSupported(dt,"audio",ot)?(nt.audioCodec=lt=lt?`${lt},${dt}`:dt,sampleEntryCodesISO.audio[lt.substring(0,4)]=2,it.splice(ht,1)):areCodecsMediaSourceSupported(dt,"video",ot)&&(nt.videoCodec=ct=ct?`${ct},${dt}`:dt,sampleEntryCodesISO.video[ct.substring(0,4)]=2,it.splice(ht,1))}}});const{AUDIO:st=[],SUBTITLES:at,"CLOSED-CAPTIONS":rt}=M3U8Parser.parseMasterPlaylistMedia(d,g,b);st.length&&!st.some(it=>!it.url)&&j[0].audioCodec&&!j[0].attrs.AUDIO&&(this.hls.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),st.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new AttrList({}),bitrate:0,url:""})),c.trigger(Events.MANIFEST_LOADED,{levels:j,audioTracks:st,subtitles:at,captions:rt,contentSteering:_,url:g,stats:i,networkDetails:o,sessionData:$,sessionKeys:_e,startTimeOffset:tt,variableList:et})}handleTrackOrLevelPlaylist(e,i,a,o,c){const d=this.hls,{id:g,level:b,type:_}=a,j=getResponseUrl(e,a),$=isFiniteNumber(b)?b:isFiniteNumber(g)?g:0,_e=mapContextToLevelType(a),tt=M3U8Parser.parseLevelPlaylist(e.data,j,$,_e,0,this.variableList);if(_===PlaylistContextType.MANIFEST){const et={attrs:new AttrList({}),bitrate:0,details:tt,name:"",url:j};tt.requestScheduled=i.loading.start+computeReloadInterval(tt,0),d.trigger(Events.MANIFEST_LOADED,{levels:[et],audioTracks:[],url:j,stats:i,networkDetails:o,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}i.parsing.end=performance.now(),a.levelDetails=tt,this.handlePlaylistLoaded(tt,e,i,a,o,c)}handleManifestParsingError(e,i,a,o,c){this.hls.trigger(Events.ERROR,{type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.MANIFEST_PARSING_ERROR,fatal:i.type===PlaylistContextType.MANIFEST,url:e.url,err:a,error:a,reason:a.message,response:e,context:i,networkDetails:o,stats:c})}handleNetworkError(e,i,a=!1,o,c){let d=`A network ${a?"timeout":"error"+(o?" (status "+o.code+")":"")} occurred while loading ${e.type}`;e.type===PlaylistContextType.LEVEL?d+=`: ${e.level} id: ${e.id}`:(e.type===PlaylistContextType.AUDIO_TRACK||e.type===PlaylistContextType.SUBTITLE_TRACK)&&(d+=` id: ${e.id} group-id: "${e.groupId}"`);const g=new Error(d);this.hls.logger.warn(`[playlist-loader]: ${d}`);let b=ErrorDetails.UNKNOWN,_=!1;const j=this.getInternalLoader(e);switch(e.type){case PlaylistContextType.MANIFEST:b=a?ErrorDetails.MANIFEST_LOAD_TIMEOUT:ErrorDetails.MANIFEST_LOAD_ERROR,_=!0;break;case PlaylistContextType.LEVEL:b=a?ErrorDetails.LEVEL_LOAD_TIMEOUT:ErrorDetails.LEVEL_LOAD_ERROR,_=!1;break;case PlaylistContextType.AUDIO_TRACK:b=a?ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:ErrorDetails.AUDIO_TRACK_LOAD_ERROR,_=!1;break;case PlaylistContextType.SUBTITLE_TRACK:b=a?ErrorDetails.SUBTITLE_TRACK_LOAD_TIMEOUT:ErrorDetails.SUBTITLE_LOAD_ERROR,_=!1;break}j&&this.resetInternalLoader(e.type);const $={type:ErrorTypes.NETWORK_ERROR,details:b,fatal:_,url:e.url,loader:j,context:e,error:g,networkDetails:i,stats:c};if(o){const _e=(i==null?void 0:i.url)||e.url;$.response=_objectSpread2({url:_e,data:void 0},o)}this.hls.trigger(Events.ERROR,$)}handlePlaylistLoaded(e,i,a,o,c,d){const g=this.hls,{type:b,level:_,levelOrTrack:j,id:$,groupId:_e,deliveryDirectives:tt}=o,et=getResponseUrl(i,o),st=mapContextToLevelType(o);let at=typeof o.level=="number"&&st===PlaylistLevelType.MAIN?_:void 0;const rt=e.playlistParsingError;if(rt){if(this.hls.logger.warn(`${rt} ${e.url}`),!g.config.ignorePlaylistParsingErrors){g.trigger(Events.ERROR,{type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.LEVEL_PARSING_ERROR,fatal:!1,url:et,error:rt,reason:rt.message,response:i,context:o,level:at,parent:st,networkDetails:c,stats:a});return}e.playlistParsingError=null}if(!e.fragments.length){const nt=e.playlistParsingError=new Error("No Segments found in Playlist");g.trigger(Events.ERROR,{type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.LEVEL_EMPTY_ERROR,fatal:!1,url:et,error:nt,reason:nt.message,response:i,context:o,level:at,parent:st,networkDetails:c,stats:a});return}switch(e.live&&d&&(d.getCacheAge&&(e.ageHeader=d.getCacheAge()||0),(!d.getCacheAge||isNaN(e.ageHeader))&&(e.ageHeader=0)),b){case PlaylistContextType.MANIFEST:case PlaylistContextType.LEVEL:if(at){if(!j)at=0;else if(j!==g.levels[at]){const nt=g.levels.indexOf(j);nt>-1&&(at=nt)}}g.trigger(Events.LEVEL_LOADED,{details:e,levelInfo:j||g.levels[0],level:at||0,id:$||0,stats:a,networkDetails:c,deliveryDirectives:tt,withoutMultiVariant:b===PlaylistContextType.MANIFEST});break;case PlaylistContextType.AUDIO_TRACK:g.trigger(Events.AUDIO_TRACK_LOADED,{details:e,track:j,id:$||0,groupId:_e||"",stats:a,networkDetails:c,deliveryDirectives:tt});break;case PlaylistContextType.SUBTITLE_TRACK:g.trigger(Events.SUBTITLE_TRACK_LOADED,{details:e,track:j,id:$||0,groupId:_e||"",stats:a,networkDetails:c,deliveryDirectives:tt});break}}}class Hls{static get version(){return version}static isMSESupported(){return isMSESupported()}static isSupported(){return isSupported()}static getMediaSource(){return getMediaSource()}static get Events(){return Events}static get MetadataSchema(){return MetadataSchema}static get ErrorTypes(){return ErrorTypes}static get ErrorDetails(){return ErrorDetails}static get DefaultConfig(){return Hls.defaultConfig?Hls.defaultConfig:hlsDefaultConfig}static set DefaultConfig(e){Hls.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.logger=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new EventEmitter,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioStreamController=void 0,this.subtititleStreamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.interstitialsController=void 0,this.gapController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this._url=null,this._sessionId=void 0,this.triggeringException=void 0,this.started=!1;const i=this.logger=enableLogs(e.debug||!1,"Hls instance",e.assetPlayerId),a=this.config=mergeConfig(Hls.DefaultConfig,e,i);this.userConfig=e,a.progressive&&enableStreamingMode(a,i);const{abrController:o,bufferController:c,capLevelController:d,errorController:g,fpsController:b}=a,_=new g(this),j=this.abrController=new o(this),$=new FragmentTracker(this),_e=a.interstitialsController,tt=_e?this.interstitialsController=new _e(this,Hls):null,et=this.bufferController=new c(this,$),st=this.capLevelController=new d(this),at=new b(this),rt=new PlaylistLoader(this),nt=a.contentSteeringController,it=nt?new nt(this):null,ot=this.levelController=new LevelController(this,it),lt=new ID3TrackController(this),ct=new KeyLoader(this.config,this.logger),ht=this.streamController=new StreamController(this,$,ct),dt=this.gapController=new GapController(this,$);st.setStreamController(ht),at.setStreamController(ht);const gt=[rt,ot,ht];tt&&gt.splice(1,0,tt),it&&gt.splice(1,0,it),this.networkControllers=gt;const vt=[j,et,dt,st,at,lt,$];this.audioTrackController=this.createController(a.audioTrackController,gt);const St=a.audioStreamController;St&&gt.push(this.audioStreamController=new St(this,$,ct)),this.subtitleTrackController=this.createController(a.subtitleTrackController,gt);const Tt=a.subtitleStreamController;Tt&&gt.push(this.subtititleStreamController=new Tt(this,$,ct)),this.createController(a.timelineController,vt),ct.emeController=this.emeController=this.createController(a.emeController,vt),this.cmcdController=this.createController(a.cmcdController,vt),this.latencyController=this.createController(LatencyController,vt),this.coreComponents=vt,gt.push(_);const Ct=_.onErrorOut;typeof Ct=="function"&&this.on(Events.ERROR,Ct,_),this.on(Events.MANIFEST_LOADED,rt.onManifestLoaded,rt)}createController(e,i){if(e){const a=new e(this);return i&&i.push(a),a}return null}on(e,i,a=this){this._emitter.on(e,i,a)}once(e,i,a=this){this._emitter.once(e,i,a)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,i,a=this,o){this._emitter.off(e,i,a,o)}listeners(e){return this._emitter.listeners(e)}emit(e,i,a){return this._emitter.emit(e,i,a)}trigger(e,i){if(this.config.debug)return this.emit(e,e,i);try{return this.emit(e,e,i)}catch(a){if(this.logger.error("An internal error happened while handling event "+e+'. Error message: "'+a.message+'". Here is a stacktrace:',a),!this.triggeringException){this.triggeringException=!0;const o=e===Events.ERROR;this.trigger(Events.ERROR,{type:ErrorTypes.OTHER_ERROR,details:ErrorDetails.INTERNAL_EXCEPTION,fatal:o,event:e,error:a}),this.triggeringException=!1}}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){this.logger.log("destroy"),this.trigger(Events.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this._url=null,this.networkControllers.forEach(i=>i.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(i=>i.destroy()),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){if(!e||"media"in e&&!e.media){const c=new Error(`attachMedia failed: invalid argument (${e})`);this.trigger(Events.ERROR,{type:ErrorTypes.OTHER_ERROR,details:ErrorDetails.ATTACH_MEDIA_ERROR,fatal:!0,error:c});return}this.logger.log("attachMedia"),this._media&&(this.logger.warn("media must be detached before attaching"),this.detachMedia());const i="media"in e,a=i?e.media:e,o=i?e:{media:a};this._media=a,this.trigger(Events.MEDIA_ATTACHING,o)}detachMedia(){this.logger.log("detachMedia"),this.trigger(Events.MEDIA_DETACHING,{}),this._media=null}transferMedia(){this._media=null;const e=this.bufferController.transferMedia();return this.trigger(Events.MEDIA_DETACHING,{transferMedia:e}),e}loadSource(e){this.stopLoad();const i=this.media,a=this._url,o=this._url=urlToolkitExports.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.logger.log(`loadSource:${o}`),i&&a&&(a!==o||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(i)),this.trigger(Events.MANIFEST_LOADING,{url:e})}get url(){return this._url}get hasEnoughToStart(){return this.streamController.hasEnoughToStart}get startPosition(){return this.streamController.startPositionValue}startLoad(e=-1,i){this.logger.log(`startLoad(${e+(i?", <skip seek to start>":"")})`),this.started=!0,this.resumeBuffering();for(let a=0;a<this.networkControllers.length&&(this.networkControllers[a].startLoad(e,i),!(!this.started||!this.networkControllers));a++);}stopLoad(){this.logger.log("stopLoad"),this.started=!1;for(let e=0;e<this.networkControllers.length&&(this.networkControllers[e].stopLoad(),!(this.started||!this.networkControllers));e++);}get loadingEnabled(){return this.started}get bufferingEnabled(){return this.streamController.bufferingEnabled}resumeBuffering(){this.bufferingEnabled||(this.logger.log("resume buffering"),this.networkControllers.forEach(e=>{e.resumeBuffering&&e.resumeBuffering()}))}pauseBuffering(){this.bufferingEnabled&&(this.logger.log("pause buffering"),this.networkControllers.forEach(e=>{e.pauseBuffering&&e.pauseBuffering()}))}get inFlightFragments(){const e={[PlaylistLevelType.MAIN]:this.streamController.inFlightFrag};return this.audioStreamController&&(e[PlaylistLevelType.AUDIO]=this.audioStreamController.inFlightFrag),this.subtititleStreamController&&(e[PlaylistLevelType.SUBTITLE]=this.subtititleStreamController.inFlightFrag),e}swapAudioCodec(){this.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){this.logger.log("recoverMediaError");const e=this._media,i=e==null?void 0:e.currentTime;this.detachMedia(),e&&(this.attachMedia(e),i&&this.startLoad(i))}removeLevel(e){this.levelController.removeLevel(e)}get sessionId(){let e=this._sessionId;return e||(e=this._sessionId=uuid()),e}get levels(){const e=this.levelController.levels;return e||[]}get latestLevelDetails(){return this.streamController.getLevelDetails()||null}get loadLevelObj(){return this.levelController.loadLevelObj}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){this.logger.log(`set currentLevel:${e}`),this.levelController.manualLevel=e,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){this.logger.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){this.logger.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){this.logger.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){const e=this.levelController.startLevel;return e===-1&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:e}set startLevel(e){this.logger.log(`set startLevel:${e}`),e!==-1&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const i=!!e;i!==this.config.capLevelToPlayerSize&&(i?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=i)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}set bandwidthEstimate(e){this.abrController.resetEstimator(e)}get abrEwmaDefaultEstimate(){const{bwEstimator:e}=this.abrController;return e?e.defaultEstimate:NaN}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(this.logger.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){isHdcpLevel(e)&&this._maxHdcpLevel!==e&&(this._maxHdcpLevel=e,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:i}}=this;if(!e)return 0;const a=e.length;for(let o=0;o<a;o++)if(e[o].maxBitrate>=i)return o;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:i,maxHdcpLevel:a}=this;let o;if(i===-1&&e!=null&&e.length?o=e.length-1:o=i,a)for(let c=o;c--;){const d=e[c].attrs["HDCP-LEVEL"];if(d&&d<=a)return c}return o}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(e){this.abrController.nextAutoLevel=e}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get maxBufferLength(){return this.streamController.maxBufferLength}setAudioOption(e){var i;return((i=this.audioTrackController)==null?void 0:i.setAudioOption(e))||null}setSubtitleOption(e){var i;return((i=this.subtitleTrackController)==null?void 0:i.setSubtitleOption(e))||null}get allAudioTracks(){const e=this.audioTrackController;return e?e.allAudioTracks:[]}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const i=this.audioTrackController;i&&(i.audioTrack=e)}get allSubtitleTracks(){const e=this.subtitleTrackController;return e?e.allSubtitleTracks:[]}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const i=this.subtitleTrackController;i&&(i.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return e?e.subtitleDisplay:!1}set subtitleDisplay(e){const i=this.subtitleTrackController;i&&(i.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}set targetLatency(e){this.latencyController.targetLatency=e}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}get pathways(){return this.levelController.pathways}get pathwayPriority(){return this.levelController.pathwayPriority}set pathwayPriority(e){this.levelController.pathwayPriority=e}get bufferedToEnd(){var e;return!!((e=this.bufferController)!=null&&e.bufferedToEnd)}get interstitialsManager(){var e;return((e=this.interstitialsController)==null?void 0:e.interstitialsManager)||null}getMediaDecodingInfo(e,i=this.allAudioTracks){const a=getAudioTracksByGroup(i);return getMediaDecodingInfoPromise(e,a,navigator.mediaCapabilities)}}Hls.defaultConfig=void 0;function Movieplayer(){const s=useLocation(),e=useNavigate(),i=s.state||{},a=i.type||"Movie",o=i.movie_uuid||null,c=i.user_uid||null,d=i.user_id||null,g=i.referenceUid||null,b=i.language_Id||null,_=i.movieWatchTime||0,j=i.videoUrl||null;reactExports.useEffect(()=>{j||e(-1)},[j,e]);const $=reactExports.useRef(null),_e=reactExports.useRef(null),tt=reactExports.useRef(null),et=reactExports.useRef(_||0),st=reactExports.useRef(_||0),at=reactExports.useRef(1),[rt,nt]=reactExports.useState(!0),[it,ot]=reactExports.useState(_||0),[lt,ct]=reactExports.useState(0),[ht,dt]=reactExports.useState(1),[gt,vt]=reactExports.useState(!0),[St,Tt]=reactExports.useState([]),[Ct,Rt]=reactExports.useState([]),[bt,pt]=reactExports.useState("720p"),[yt,ut]=reactExports.useState(b?String(b):"1"),[ft,xt]=reactExports.useState(j),[mt,Et]=reactExports.useState(!1),[At,Pt]=reactExports.useState(""),[wt,It]=reactExports.useState(!1),[Mt,Bt]=reactExports.useState(!1),[Gt,Ft]=reactExports.useState("CENTER"),[Ut,Xt]=reactExports.useState(1),[kt,Lt]=reactExports.useState({section:"AUDIO",index:0}),Wt={top:reactExports.useRef([]),center:reactExports.useRef([]),bottom:reactExports.useRef([])},Nt={audio:reactExports.useRef([]),quality:reactExports.useRef([]),close:reactExports.useRef(null)},Kt=()=>{tt.current&&clearTimeout(tt.current),vt(!0),tt.current=setTimeout(()=>{vt(!1)},4e3)};reactExports.useEffect(()=>()=>{tt.current&&clearTimeout(tt.current),_e.current&&(_e.current.destroy(),_e.current=null)},[]),reactExports.useEffect(()=>{et.current=_||0,st.current=_||0,ot(_||0)},[_]),reactExports.useEffect(()=>{(async()=>{var Ot,Yt,ar,or;if(a!=="Movie"||!o||!c){Tt(["720p"]),Rt([{id:"1",name:"Default"}]),pt("720p"),ut(b?String(b):"1");return}try{const rr=(await Movieapi.get(`${o}/${c}/resolutionsandlanguages`)).data,Jt=(Ot=rr.resolutions)!=null&&Ot.length?rr.resolutions:["720p"],lr=(Yt=rr.languages)!=null&&Yt.length?rr.languages:[{id:"1",name:"Default"}];if(Tt(Jt),Rt(lr),rr.userPreferences){pt(rr.userPreferences.resolution||"720p");const ir=rr.userPreferences.languageId||b||((ar=lr[0])==null?void 0:ar.id)||"1";ut(String(ir))}else{pt("720p");const ir=b||((or=lr[0])==null?void 0:or.id)||"1";ut(String(ir))}}catch(ur){console.error("Failed to load options:",ur),Tt(["720p"]),Rt([{id:"1",name:"Default"}]),pt("720p"),ut(b?String(b):"1")}})()},[a,o,c,b]);const Qt=async(Dt,Ot)=>{if(!(!o||!c))try{await Movieapi.post("savemoviepreferences",{movie_uuid:o,resolution:Dt,languageId:Ot,user_uuid:c})}catch(Yt){console.error("Failed to save preferences:",Yt)}},tr=Dt=>{const Ot=$.current;if(!(!Ot||!Dt))if(Pt(""),_e.current&&(_e.current.destroy(),_e.current=null),Hls.isSupported()&&Dt.includes(".m3u8")){const Yt=new Hls({enableWorker:!0,debug:!1,xhrSetup:ar=>{ar.withCredentials=!1}});_e.current=Yt,Yt.loadSource(Dt),Yt.attachMedia(Ot),Yt.on(Hls.Events.MANIFEST_PARSED,()=>{Pt("")}),Yt.on(Hls.Events.ERROR,(ar,or)=>{or.fatal&&(console.error("HLS Fatal Error:",or),Pt("Failed to load video stream. Please try again."))})}else Ot.src=Dt,Ot.load()};reactExports.useEffect(()=>{ft&&tr(ft)},[ft]);const zt=async(Dt,Ot)=>{if(a!=="Movie"||!o||!c)return;It(!0);const Yt=!rt,ar=ft,or=et.current||0;_t.current=Yt;try{const rr=(await Movieapi.get(`${o}/videourl?resolution=${Dt}&languageId=${Ot}`)).data;if(!rr.videoUrl){Pt("No video URL found."),It(!1);return}await Qt(Dt,Ot),st.current=or,Et(!1),nt(!0),xt(null),setTimeout(()=>{xt(rr.videoUrl),pt(Dt),ut(String(Ot)),It(!1),setTimeout(()=>{nt(!1)},400)},100)}catch(ur){console.error("Source change failed:",ur),Pt("Failed to switch. Reverting..."),xt(ar),setTimeout(()=>Pt(""),2e3)}finally{It(!1)}},Zt=()=>{const Dt=$.current;if(!Dt)return;ct(Dt.duration||0);const Ot=st.current;Ot>0&&Ot<(Dt.duration||1/0)&&(Dt.currentTime=Ot,et.current=Ot,ot(Ot)),(!Mt||_t)&&(Dt.play().catch(()=>{console.log("Autoplay prevented by browser."),nt(!0)}),nt(!1),Bt(!0))},_t=reactExports.useRef(!1),$t=()=>{const Dt=$.current;if(!Dt)return;Kt();const Ot=Dt.currentTime;et.current=Ot,ot(Ot)},Ht=Dt=>{const Ot=$.current;if(!Ot)return;const Yt=Math.min(Math.max(Dt,0),lt||0);Ot.currentTime=Yt,et.current=Yt,ot(Yt),st.current=Yt},Vt=Dt=>Ht((it||0)+Dt),jt=()=>{const Dt=$.current;Dt&&(rt?(Dt.play().catch(()=>{}),nt(!1)):(Dt.pause(),nt(!0)))},er=()=>{const Dt=$.current;if(Dt)if(ht===0){const Ot=at.current||1;dt(Ot),Dt.volume=Ot}else at.current=ht,dt(0),Dt.volume=0},qt=Dt=>{const Ot=Math.max(0,Math.min(1,Dt));dt(Ot),$.current&&($.current.volume=Ot)};reactExports.useEffect(()=>{$.current&&($.current.volume=ht)},[ht]);const sr=Dt=>{if(!Dt||Number.isNaN(Dt))return"0:00";const Ot=Math.floor(Dt/60),Yt=Math.floor(Dt%60);return`${Ot}:${Yt<10?"0":""}${Yt}`},nr=()=>{gt?(vt(!1),tt.current&&clearTimeout(tt.current)):(vt(!0),Kt())},cr=()=>{const Dt=Math.floor(et.current||0);g&&Moviestatapi.post("/addwatchtime",{reference_uid:g,watch_time:Dt,videotype:a}).catch(()=>{}),d&&o&&Moviestatapi.post("/addwatchhistory",{user_id:d,movie_uid:o,video_type:a,watch_time:Dt}).catch(()=>{}),e(-1)};return reactExports.useEffect(()=>{if(!o||!d)return;const Dt=setInterval(()=>{et.current>0&&Moviestatapi.post("/addwatchhistory",{user_id:d,movie_uid:o,video_type:a,watch_time:Math.floor(et.current)}).catch(()=>{})},15e3);return()=>clearInterval(Dt)},[o,d,a]),reactExports.useEffect(()=>{const Dt=Ot=>{var Yt,ar,or,ur,rr;if(!gt){Kt(),Ot.preventDefault();return}if(Ot.preventDefault(),mt){const{section:Jt,index:lr}=kt;Ot.key==="ArrowUp"?Jt==="QUALITY"?Lt({section:"AUDIO",index:0}):Jt==="AUDIO"&&Lt({section:"CLOSE",index:0}):Ot.key==="ArrowDown"?Jt==="CLOSE"?Lt({section:"AUDIO",index:0}):Jt==="AUDIO"&&Lt({section:"QUALITY",index:0}):Ot.key==="ArrowLeft"?Jt==="QUALITY"&&lr===0?Lt({section:"AUDIO",index:Ct.length-1}):Jt!=="CLOSE"&&Lt(ir=>({...ir,index:Math.max(0,ir.index-1)})):Ot.key==="ArrowRight"?Jt==="AUDIO"&&lr===Ct.length-1?Lt({section:"QUALITY",index:0}):Jt==="AUDIO"?Lt(ir=>({...ir,index:ir.index+1})):Jt==="QUALITY"&&Lt(ir=>({...ir,index:Math.min(St.length-1,ir.index+1)})):Ot.key==="Enter"?(Jt==="CLOSE"&&((Yt=Nt.close.current)==null||Yt.click()),Jt==="AUDIO"&&((ar=Nt.audio.current[lr])==null||ar.click()),Jt==="QUALITY"&&((or=Nt.quality.current[lr])==null||or.click())):(Ot.key==="Backspace"||Ot.key==="Escape")&&Et(!1);return}switch(Gt){case"TOP":Ot.key==="ArrowDown"?(Ft("CENTER"),Xt(1)):Ot.key==="Enter"&&((ur=Wt.top.current[0])==null||ur.click());break;case"CENTER":Ot.key==="ArrowUp"?(Ft("TOP"),Xt(0)):Ot.key==="ArrowDown"?(Ft("BOTTOM"),Xt(0)):Ot.key==="ArrowLeft"?Xt(Jt=>Math.max(0,Jt-1)):Ot.key==="ArrowRight"?Xt(Jt=>Math.min(2,Jt+1)):Ot.key==="Enter"&&((rr=Wt.center.current[Ut])==null||rr.click());break;case"BOTTOM":if(Ot.key==="ArrowUp")Ft("CENTER"),Xt(1);else if(Ot.key==="ArrowLeft")Ut===0?Vt(-10):Xt(Jt=>Jt-1);else if(Ot.key==="ArrowRight")if(Ut===0)Vt(10);else{const Jt=a==="Movie"?4:3;Xt(lr=>Math.min(Jt,lr+1))}else if(Ot.key==="ArrowDown")Ut===0?Xt(1):Ut===1&&qt(ht-.1);else if(Ot.key==="ArrowUp")Ut===1?qt(ht+.1):(Ft("CENTER"),Xt(1));else if(Ot.key==="Enter"){const Jt=Wt.bottom.current[Ut];Jt&&Ut>0&&Jt.click()}break}};return window.addEventListener("keydown",Dt),()=>window.removeEventListener("keydown",Dt)},[gt,mt,Gt,Ut,kt,Ct,St,Vt,ht]),reactExports.useEffect(()=>{if(mt){const{section:Dt,index:Ot}=kt;let Yt;Dt==="CLOSE"?Yt=Nt.close.current:Dt==="AUDIO"?Yt=Nt.audio.current[Ot]:Dt==="QUALITY"&&(Yt=Nt.quality.current[Ot]),Yt==null||Yt.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})}},[mt,kt]),j?jsxRuntimeExports.jsxs("div",{className:"w-full h-screen bg-black relative overflow-hidden",onMouseMove:Kt,onClick:Dt=>Dt.target===Dt.currentTarget&&nr(),children:[jsxRuntimeExports.jsx("video",{ref:$,className:"w-full h-full object-contain bg-black",onLoadedMetadata:Zt,onTimeUpdate:$t,onPlay:()=>nt(!1),onPause:()=>nt(!0),onEnded:()=>{nt(!0),ot(0),et.current=0,st.current=0},controls:!1,playsInline:!0,autoPlay:!1}),jsxRuntimeExports.jsx("div",{className:"absolute inset-0",onClick:nr}),wt&&jsxRuntimeExports.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50",children:jsxRuntimeExports.jsxs("div",{className:"text-white flex flex-col items-center",children:[jsxRuntimeExports.jsx("div",{className:"w-12 h-12 border-t-4 border-red-600 rounded-full animate-spin mb-3"}),jsxRuntimeExports.jsx("span",{children:"Switching quality..."})]})}),gt&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"absolute top-4 left-4 right-4 flex justify-between text-white z-30",children:jsxRuntimeExports.jsx("button",{ref:Dt=>Wt.top.current[0]=Dt,className:`p-2 bg-black bg-opacity-50 rounded-full hover:bg-opacity-70 transition ${Gt==="TOP"?"ring-4 ring-[#c02628]":""}`,onClick:cr,children:jsxRuntimeExports.jsx(ArrowLeft,{size:32})})}),jsxRuntimeExports.jsxs("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 flex items-center gap-10 z-30",children:[jsxRuntimeExports.jsx("button",{ref:Dt=>Wt.center.current[0]=Dt,className:`p-4 bg-black bg-opacity-60 rounded-full hover:bg-opacity-80 transition-transform ${Gt==="CENTER"&&Ut===0?"scale-110 ring-4 ring-[#c02628]":""}`,onClick:()=>Vt(-10),children:jsxRuntimeExports.jsx(RotateCcw,{color:"white",size:32})}),jsxRuntimeExports.jsx("button",{ref:Dt=>Wt.center.current[1]=Dt,className:`p-3 bg-red-600 rounded-full hover:bg-red-700 transition shadow-lg ${Gt==="CENTER"&&Ut===1?"scale-110 ring-4 ring-white":""}`,onClick:jt,children:rt?jsxRuntimeExports.jsx(Play,{color:"white",size:40}):jsxRuntimeExports.jsx(Pause,{color:"white",size:40})}),jsxRuntimeExports.jsx("button",{ref:Dt=>Wt.center.current[2]=Dt,className:`p-4 bg-black bg-opacity-60 rounded-full hover:bg-opacity-80 transition-transform ${Gt==="CENTER"&&Ut===2?"scale-110 ring-4 ring-[#c02628]":""}`,onClick:()=>Vt(10),children:jsxRuntimeExports.jsx(RotateCw,{color:"white",size:32})})]}),jsxRuntimeExports.jsxs("div",{className:"absolute bottom-4 left-0 right-0 flex flex-col items-center gap-3 text-white z-30",children:[jsxRuntimeExports.jsxs("div",{className:"w-full justify-between flex items-center gap-2 px-6",children:[jsxRuntimeExports.jsx("span",{className:"text-xl font-medium w-12 text-center",children:sr(it)}),jsxRuntimeExports.jsx("input",{ref:Dt=>Wt.bottom.current[0]=Dt,type:"range",min:0,max:lt||0,step:.1,value:it,onChange:Dt=>Ht(Number(Dt.target.value)),className:`flex-1 h-1 accent-red-600 cursor-pointer rounded-full ${Gt==="BOTTOM"&&Ut===0?"ring-2 ring-white":""}`,style:{background:`linear-gradient(to right, #c02628 ${it/lt*100||0}%, #374151 ${it/lt*100||0}%)`}}),jsxRuntimeExports.jsx("span",{className:"text-xl font-medium w-12 text-center",children:sr(lt)})]}),jsxRuntimeExports.jsxs("div",{className:"w-full flex justify-between items-center gap-4 px-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("button",{ref:Dt=>Wt.bottom.current[1]=Dt,className:`p-2 text-2xl rounded-full ${Gt==="BOTTOM"&&Ut===1?"ring-4 ring-[#c02628]":""}`,onClick:()=>qt(ht-.1),children:jsxRuntimeExports.jsx(Minus,{color:"white",size:32})}),jsxRuntimeExports.jsx("button",{ref:Dt=>Wt.bottom.current[2]=Dt,className:`p-2 rounded-full ${Gt==="BOTTOM"&&Ut===2?"ring-4 ring-[#c02628]":""}`,onClick:er,children:ht>0?jsxRuntimeExports.jsx(Volume2,{color:"white",size:32}):jsxRuntimeExports.jsx(VolumeOff,{color:"white",size:32})}),jsxRuntimeExports.jsx("button",{ref:Dt=>Wt.bottom.current[3]=Dt,className:`p-2 text-2xl rounded-full ${Gt==="BOTTOM"&&Ut===3?"ring-4 ring-[#c02628]":""}`,onClick:()=>qt(ht+.1),children:jsxRuntimeExports.jsx(Plus,{color:"white",size:32})})]}),a==="Movie"&&jsxRuntimeExports.jsx("button",{ref:Dt=>Wt.bottom.current[4]=Dt,className:`p-2 rounded-full ${Gt==="BOTTOM"&&Ut===4?"ring-4 ring-[#c02628]":""}`,onClick:()=>Et(!0),children:jsxRuntimeExports.jsx(Settings$1,{color:"white",size:32})})]})]})]}),mt&&jsxRuntimeExports.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-70 z-40 flex items-center justify-center p-4",children:jsxRuntimeExports.jsxs("div",{className:"bg-gray-900 text-white rounded-lg p-6 w-full max-w-2xl flex gap-8 relative",children:[jsxRuntimeExports.jsx("button",{ref:Nt.close,className:`absolute top-3 right-3 p-1 hover:bg-gray-800 rounded ${kt.section==="CLOSE"?"ring-4 ring-[#c02628]":""}`,onClick:()=>Et(!1),children:jsxRuntimeExports.jsx(X,{color:"#e50914",size:24})}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Audio"}),jsxRuntimeExports.jsx("div",{className:"flex gap-2 flex-wrap",children:Ct.map((Dt,Ot)=>jsxRuntimeExports.jsx("button",{ref:Yt=>Nt.audio.current[Ot]=Yt,className:`px-4 py-2 rounded transition-all duration-200 ${kt.section==="AUDIO"&&kt.index===Ot?"bg-red-600 text-white scale-110 ring-4 ring-white":"bg-gray-700 hover:bg-gray-600"}`,onClick:()=>zt(bt,Dt.id),disabled:wt,children:Dt.name},Dt.id))})]}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Quality"}),jsxRuntimeExports.jsx("div",{className:"flex gap-2 flex-wrap",children:St.map((Dt,Ot)=>jsxRuntimeExports.jsx("button",{ref:Yt=>Nt.quality.current[Ot]=Yt,className:`px-4 py-2 rounded transition-all duration-200 ${kt.section==="QUALITY"&&kt.index===Ot?"bg-red-600 text-white scale-110 ring-4 ring-white":"bg-gray-700 hover:bg-gray-600"}`,onClick:()=>zt(Dt,yt),disabled:wt,children:Dt},Dt))})]})]})}),At&&jsxRuntimeExports.jsx("div",{className:"absolute top-4 left-1/2 -translate-x-1/2 bg-red-600 text-white px-6 py-3 rounded-lg shadow-lg z-50 animate-pulse",children:At})]}):null}function Approuter(){const{isLogged:s}=useUserdetails(),e=({isLoggedIn:o})=>o===!1?jsxRuntimeExports.jsx(Navigate,{to:"/",replace:!0}):jsxRuntimeExports.jsx(Outlet,{}),i=({isLoggedIn:o})=>o===!0?jsxRuntimeExports.jsx(Navigate,{to:"/browse",replace:!0}):jsxRuntimeExports.jsx(Outlet,{}),a=()=>jsxRuntimeExports.jsx(Outlet,{});return jsxRuntimeExports.jsxs(Routes,{children:[jsxRuntimeExports.jsxs(Route,{element:jsxRuntimeExports.jsx(a,{}),children:[jsxRuntimeExports.jsx(Route,{path:"/movie/:uuid",element:jsxRuntimeExports.jsx(SingleMoviePage,{})}),jsxRuntimeExports.jsx(Route,{path:"/player",element:jsxRuntimeExports.jsx(Movieplayer,{})})]}),jsxRuntimeExports.jsxs(Route,{element:jsxRuntimeExports.jsx(i,{isLoggedIn:s}),children:[jsxRuntimeExports.jsx(Route,{path:"/",element:jsxRuntimeExports.jsx(LandingPage,{})}),jsxRuntimeExports.jsx(Route,{path:"/login",element:jsxRuntimeExports.jsx(LoginPage,{})})]}),jsxRuntimeExports.jsxs(Route,{element:jsxRuntimeExports.jsx(e,{isLoggedIn:s}),children:[jsxRuntimeExports.jsx(Route,{path:"/browse",element:jsxRuntimeExports.jsx(BrowsePage,{})}),jsxRuntimeExports.jsx(Route,{path:"/myaccount/*",element:jsxRuntimeExports.jsx(MyaccountWrapperPage,{})}),jsxRuntimeExports.jsx(Route,{path:"/categories",element:jsxRuntimeExports.jsx(CategoriesPage,{})}),jsxRuntimeExports.jsx(Route,{path:"/searchmovie",element:jsxRuntimeExports.jsx(SearchMoviePage,{})})]}),jsxRuntimeExports.jsx(Route,{path:"*",element:jsxRuntimeExports.jsx(Navigate,{to:s?"/browse":"/",replace:!0})})]})}function App(){return jsxRuntimeExports.jsx("div",{className:"w-screen h-screen overflow-hidden",children:jsxRuntimeExports.jsx(Approuter,{})})}client.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(React.StrictMode,{children:jsxRuntimeExports.jsx(HashRouter,{children:jsxRuntimeExports.jsx(App,{})})}));
